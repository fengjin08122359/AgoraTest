!function(a){"use strict";function b(a){this.clientConfiguration=a,this.user=void 0,this.mediaServicesFactory=void 0,this.version="1.2.0.8",b.Base.Logger.clearLoggers()}b.prototype={createUser:function(a){return this.user||(void 0===this.mediaServicesFactory&&(this.mediaServicesFactory=new b.Base.MediaServicesFactory),this.user=new b.User(a,this.mediaServicesFactory,this.version)),this.user},registerLogger:function(a,c){b.Base.Logger.addLogger(a,c)},getMediaServices:function(){return void 0===this.mediaServicesFactory&&(this.mediaServicesFactory=new b.Base.MediaServicesFactory),this.mediaServicesFactory.getMediaServices()},getVersion:function(){return this.version}},a.AvayaClientServices=b}(window),function(a){"use strict";!function(a){a.Base=a.Base||{}}(a),function(a){a.Config=a.Config||{}}(a),function(a){a.Services=a.Services||{}}(a),function(a){a.Services.Call=a.Services.Call||{}}(a),function(a){a.Services.Collaboration=a.Services.Collaboration||{}}(a),function(a){a.Services.Messaging=a.Services.Messaging||{}}(a),function(a){a.Services.Conference=a.Services.Conference||{}}(a),function(a){a.Services.Contacts=a.Services.Contacts||{}}(a),function(a){a.Services.ContentSharing=a.Services.ContentSharing||{}}(a),function(a){a.Services.Presence=a.Services.Presence||{}}(a),function(a){a.Services.VoiceMessaging=a.Services.VoiceMessaging||{}}(a)}(AvayaClientServices),function(a){"use strict";!function(a){a.Base.Validators=a.Base.Validators||{}}(a),function(a){a.Providers=a.Providers||{}}(a),function(a){a.Providers.Analytics=a.Providers.Analytics||{}}(a),function(a){a.Providers.Interfaces=a.Providers.Interfaces||{}}(a),function(a){a.Providers.AMM=a.Providers.AMM||{}}(a),function(a){a.Providers.Call=a.Providers.Call||{}}(a),function(a){a.Providers.CallGateway=a.Providers.CallGateway||{}}(a),function(a){a.Providers.CallServiceGateway=a.Providers.CallServiceGateway||{}}(a),function(a){a.Providers.Scopia=a.Providers.Scopia||{}}(a),function(a){a.Providers.CM=a.Providers.CM||{}}(a),function(a){a.Providers.Focus=a.Providers.Focus||{}}(a),function(a){a.Providers.RTC=a.Providers.RTC||{}}(a),function(a){a.Providers.UCCP=a.Providers.UCCP||{}}(a),function(a){a.Providers.WCS=a.Providers.WCS||{}}(a),function(a){a.User=a.User||{}}(a),function(a){a.Services.Call=a.Services.Call||{}}(a),function(a){a.Services.Call.Capabilities=a.Services.Call.Capabilities||{}}(a),function(a){a.Services.Call.Modes=a.Services.Call.Modes||{}}(a),function(a){a.Services.SessionLogs=a.Services.SessionLogs||{}}(a),function(a){a.Services.Messaging.Common=a.Services.Messaging.Common||{}}(a),function(a){a.Providers.ACS=a.Providers.ACS||{}}(a),function(a){a.Services.SessionLogs=a.Services.SessionLogs||{}}(a),function(a){a.Providers.ContentSharing=a.Providers.ContentSharing||{}}(a),function(a){a.Services.Analytics=a.Services.Analytics||{}}(a)}(AvayaClientServices),function(a){"use strict";function b(a,b){this.pointcutType=a,this.adviceFunction=b}b.prototype={},a.Base.AOPAdvice=b}(AvayaClientServices),function(a){"use strict";var b={BEFORE:"BEFORE",AROUND:"AROUND"};a.Base.AOPPointcutType=b}(AvayaClientServices),function(a){"use strict";var b={addAdvices:function(a,c,d,e){for(var f=0;f<d.length;f++)b.addAdvicesToProperty(a,c,d[f],e)},addAdvicesToProperty:function(c,d,e,f){var g=b._getAdviceFunction(a.Base.AOPPointcutType.BEFORE,f),h=b._getAdviceFunction(a.Base.AOPPointcutType.AROUND,f),i=c.prototype[e];if("function"!=typeof i)throw Error("AOPTools: "+d+"."+e+" is not a function.");c.prototype[e]=function(){g&&g(c,d,e,arguments);return h?h(c,d,e,this,i,arguments):i.apply(this,arguments)}},_getAdviceFunction:function(a,b){for(var c=0;c<b.length;c++)if(b[c].pointcutType===a)return b[c].adviceFunction}};a.Base.AOPTools=b}(AvayaClientServices),function(a){"use strict";function b(b){this._servers=[],this._config=b,this._calls=[],this._currentResolution=a.Base.VideoResolution[this._config.mediaConfiguration.voipConfigurationVideo.videoResolution],this._observationInterval=30,this._historyConsiderationPeriod=6}b.prototype={registerCall:function(a){this._calls.push(a),this.start()},unregisterCall:function(a){var b=this._calls.indexOf(a);this._calls.splice(b,1)},registerServer:function(a){this._servers.push(a),a._onStop=function(){this._restoreOriginalResolution()}.bind(this),this.start()},start:function(){this._config.mediaConfiguration.voipConfigurationVideo.presenationHigherPriorityThanPeopleVideo&&!this._interval&&(this._interval=setInterval(function(){this.recalculateBandwidth()}.bind(this),1e3*this._observationInterval))},_restoreOriginalResolution:function(){var b=this._calls.filter(function(b){return b.getState()===a.Services.Call.CallStates.ESTABLISHED&&!b.isRemote()})[0];b&&this._currentResolution!==a.Base.VideoResolution[this._config.mediaConfiguration.voipConfigurationVideo.videoResolution]&&(this._currentResolution=a.Base.VideoResolution[this._config.mediaConfiguration.voipConfigurationVideo.videoResolution],a.Base.Logger.info(a.Base.LoggerTags.BANDWIDTH_MANAGER,"Changing resolution back to default: "+this._config.mediaConfiguration.voipConfigurationVideo.videoResolution),b._callService._updateVideoResolution(b,a.Base.VideoResolution[this._config.mediaConfiguration.voipConfigurationVideo.videoResolution]).then(function(b){this._currentResolution=b,a.Base.Logger.info(a.Base.LoggerTags.BANDWIDTH_MANAGER,"Successfully changed video bandwidth to: "+this._currentResolution.getMinBandwidth())}.bind(this),function(){try{this._currentResolution=b._callService._callProvider._cpCalls[b._callId].getVideoResolution(),a.Base.Logger.info(a.Base.LoggerTags.BANDWIDTH_MANAGER,"Video bandwidth has been set to: "+this._currentResolution.getMinBandwidth())}catch(c){a.Base.Logger.error(a.Base.LoggerTags.BANDWIDTH_MANAGER,"Could not retrieve current video resolution: "+c)}}.bind(this)))},recalculateBandwidth:function(){var b=this.getBufferedBytes(),c=8*b/1e3/this._observationInterval,d=this._calls.filter(function(b){return b.getState()===a.Services.Call.CallStates.ESTABLISHED&&!b.isRemote()})[0];if(c>0&&d){var e=this._currentResolution.getMinBandwidth(),f=e-c,g=Object.keys(a.Base.VideoResolution).filter(function(b){return a.Base.VideoResolution[b].getMinBandwidth()<=f})[0];g=a.Base.VideoResolution[g]||a.Base.VideoResolution[a.Config.VideoResolution.RESOLUTION_180p],this._currentResolution!==g&&(this._currentResolution=g,a.Base.Logger.info(a.Base.LoggerTags.BANDWIDTH_MANAGER,"Changing resolution to: "+this._currentResolution.getMinBandwidth()+" due to bandwidth limitation."),d._callService._updateVideoResolution(d,this._currentResolution,!0).then(function(b){this._currentResolution=b,a.Base.Logger.info(a.Base.LoggerTags.BANDWIDTH_MANAGER,"Successfully set video bandwidth to: "+this._currentResolution.getMinBandwidth())}.bind(this),function(){try{this._currentResolution=d._callService._callProvider._cpCalls[d._callId].getVideoResolution(),a.Base.Logger.info(a.Base.LoggerTags.BANDWIDTH_MANAGER,"Video bandwidth has been set to: "+this._currentResolution.getMinBandwidth())}catch(b){a.Base.Logger.error(a.Base.LoggerTags.BANDWIDTH_MANAGER,"Could not retrieve current video resolution: "+b)}}.bind(this)))}},getBufferedBytes:function(){return this._servers.map(function(a){return a.getHistory()}).map(function(a){var b=this._historyConsiderationPeriod;return a.length<this._historyConsiderationPeriod&&(b=a.length),a.slice(a.length-b).reduce(function(a,b){return a+Math.max(b.buffered,0)},0)}.bind(this)).reduce(function(a,b){return a+b},0)}},a.Base.BandwidthManager=b}(AvayaClientServices),function(a){"use strict";function b(a,b){Error.call(this,a),this.message=a,this.name="BaseError",this._data=b}b.prototype=Object.create(Error.prototype),b.prototype.getMessage=function(){return this.message},b.prototype.getData=function(){return this._data},b.prototype.getName=function(){return this.name},a.Base.BaseError=b}(AvayaClientServices),function(a){"use strict";a.ajaxTransport("+binary",function(a){if(window.FormData&&(a.dataType&&"binary"===a.dataType||a.data&&(window.ArrayBuffer&&a.data instanceof ArrayBuffer||window.Blob&&a.data instanceof Blob))){var b;return{send:function(c,d){b=new window.XMLHttpRequest;var e=a.url,f=a.type,g=a.async||!0,h="text",i=a.data||null,j=a.username||null,k=a.password||null,l=0;b.addEventListener("load",function(){var c={};c[a.dataType]=b.response,d(b.status,b.statusText,c,b.getAllResponseHeaders()),l=0}),b.addEventListener("progress",function(){this.readyState&&this.response&&("function"==typeof a.binaryProgressCallback&&a.binaryProgressCallback(AvayaClientServices.Base.Utils.stringToArrayBuffer(this.response.slice(l))),l=this.responseText.length)},!1),b.addEventListener("readystatechange",function(){this.readyState&&a.keepAliveCallback&&a.keepAliveCallback(this.readyState)}),b.open(f,e,g,j,k),b.overrideMimeType("text/xml; charset=x-user-defined");for(var m in c)c.hasOwnProperty(m)&&b.setRequestHeader(m,c[m]);b.responseType=h,b.send(i)},abort:function(){b.abort()}}}})}(window.jQuery),function(a){"use strict";var b={CHROME:"chrome",CHROME_EXTENSION:"chrome_extension",FIREFOX:"firefox",FIREFOX_EXTENSION:"moz_extension",IE:"ie",SAFARI:"safari",EDGE:"edge",UNKNOWN:"unknown"};a.Base.BrowserType=b}(AvayaClientServices),function(a){"use strict";var b=function(){this.maxElements=void 0,this.timeToLive=void 0,this.auditInterval=void 0};a.Base.CacheOptions=b}(AvayaClientServices),function(a){"use strict";var b={ELEMENT_ADDED:"ELEMENT_ADDED",ELEMENT_UPDATED:"ELEMENT_UPDATED",ELEMENT_DELETED:"ELEMENT_DELETED"};a.Base.ElementCacheEvents=b}(AvayaClientServices),function(a){"use strict";var b={EXACT_MATCH:"EXACT_MATCH",CONTAINS:"CONTAINS",BEGINS_WITH:"BEGINS_WITH"};a.Base.IMDBSearchOptions=b}(AvayaClientServices),function(a){"use strict";function b(b,c){this._validateKeyNames(b),this._cache=new a.Base.ElementCache(c),this._cache.on(a.Base.ElementCacheEvents.ELEMENT_DELETED,function(a){this._onCacheElementsDelete(a)}.bind(this)),this._keyToCacheIds={};for(var d=0;d<b.length;d++)this._keyToCacheIds[b[d]]={};this._cacheIdLength=6,this._generateIdFailureCounter=0}b.prototype.addElement=function(b,c){var d=new Date;this._validateKeys(b);var e=this._generateCacheId(),f={keys:b,element:c,cacheId:e};if(!this._cache.addElement(e,f)){var g="SimpleIMDB: Failed to add object to underlying single-key cache. CacheId: "+e;throw a.Base.Logger.error(a.Base.LoggerTags.CACHE,g,f),new Error(g)}this._addCacheIdWithKeys(e,b),a.Base.Logger.info(a.Base.LoggerTags.CACHE,"SimpleIMDB: Successfully added element in "+(new Date-d)+" milliseconds")},b.prototype.addElements=function(b){var c=new Date,d=[],e=[],f=this.getCacheMaxSize(),g=b.length;d=f&&g>f?b.slice(-f):b.slice();var h,i=d.length;for(h=0;h<i;h++)try{this._validateKeys(d[h].keys);var j=this._generateCacheId();d[h].elementId=j,e.push({elementId:j,element:d[h]})}catch(error){d.splice(h,1),a.Base.Logger.error(a.Base.LoggerTags.CACHE,"Invalid keys of object",error)}var k=this._cache.addElements(e);for(h=0;h<k.length;h++)this._addCacheIdWithKeys(k[h].elementId,k[h].element.keys);a.Base.Logger.info(a.Base.LoggerTags.CACHE,"SimpleIMDB: Successfully added elements in "+(new Date-c)+" milliseconds")},b.prototype.getCacheMaxSize=function(){return this._cache.getCacheMaxSize()},b.prototype._addCacheIdWithKeys=function(a,b){var c,d;for(c in b)if(b.hasOwnProperty(c)){d=b[c];for(var e=0;e<d.length;e++){void 0===this._keyToCacheIds[c][d[e]]&&(this._keyToCacheIds[c][d[e]]=[]);var f=this._keyToCacheIds[c][d[e]];f.push(a)}}},b.prototype.updateElement=function(b,c,d){var e=new Date;this._validateKeys(b),this._validateKeys(c);var f,g=this.searchByKeys(b);if(g.length>1)throw f="SimpleIMDB: Update failed because multiple objects found",a.Base.Logger.error(a.Base.LoggerTags.CACHE,f),new Error(f);if(g.length<1)throw f="SimpleIMDB: Can not find object to update",a.Base.Logger.error(a.Base.LoggerTags.CACHE,f),new Error(f);this.deleteElements(b),this.addElement(c,d),a.Base.Logger.info(a.Base.LoggerTags.CACHE,"Successfully updated element in "+(new Date-e)+" milliseconds")},b.prototype.deleteElements=function(b){for(var c=new Date,d=this._resolveCacheIdsByKeys(b),e=0,f=0;f<d.length;f++){var g=this._cache.getElement(d[f]);g&&(e++,this._cache.deleteElement(d[f])||a.Base.Logger.warn(a.Base.LoggerTags.CACHE,"Failed to delete object with cacheId "+d[f]+" from underlying cache"),g.keys&&this._deleteCacheIdByKeys(d[f],g.keys))}a.Base.Logger.info(a.Base.LoggerTags.CACHE,"Deleted "+e+" element(s) successfully in "+(new Date-c)+" milliseconds")},b.prototype.searchByKeys=function(b,c){for(var d=new Date,e=[],f=this._resolveCacheIdsByKeys(b,c),g=0;g<f.length;g++){var h=this._cache.getElement(f[g]);h&&h.element&&e.push(h.element)}return e=a.Base.Utils.removeDuplicatesFromArray(e),a.Base.Logger.info(a.Base.LoggerTags.CACHE,"Found "+e.length+" results in "+(new Date-d)+" milliseconds"),e},b.prototype.searchBySingleKey=function(a,b,c){var d={};return d[a]=[b],this.searchByKeys(d,c)},b.prototype.searchByAllKeys=function(b,c){var d=new Date,e=[],f=[];for(var g in this._keyToCacheIds)if(this._keyToCacheIds.hasOwnProperty(g)){var h=this._findMatchingValues(g,b,c);if(h)for(var i=0;i<h.length;i++)f=f.concat(this._keyToCacheIds[g][h[i]])}for(var j=0;j<f.length;j++){var k=this._cache.getElement(f[j]);k&&k.element&&e.push(k.element)}return e=a.Base.Utils.removeDuplicatesFromArray(e),a.Base.Logger.info(a.Base.LoggerTags.CACHE,"Found "+e.length+" results in "+(new Date-d)+" milliseconds"),e},b.prototype.getAllElements=function(){return this._cache.getAllElements().map(function(a){return a.element})},b.prototype._deleteCacheIdByKeys=function(a,b){for(var c in b)if(b.hasOwnProperty(c))for(var d=b[c],e=0;e<d.length;e++){var f=this._keyToCacheIds[c][d[e]],g=f.indexOf(a);g>=0&&f.splice(g,1)}},b.prototype._resolveCacheIdsByKeys=function(b,c){this._validateKeys(b);var d,e,f=[];for(var g in b)if(b.hasOwnProperty(g)){d=g,e=b[g][0];break}var h=this._findMatchingValues(d,e,c),i=[];if(h){for(var j=0;j<h.length;j++)i=i.concat(this._keyToCacheIds[d][h[j]]);for(j=0;j<i.length;j++){var k=i[j],l=this._cache.getElement(k);l?this._areKeys1SubsetOfKeys2(b,l.keys,c)&&f.push(k):a.Base.Logger.warn(a.Base.LoggerTags.CACHE,"Cache object with id "+k+" is not found in underlying single-key cache")}}return f},b.prototype._findMatchingValues=function(b,c,d){return d&&d!==a.Base.IMDBSearchOptions.EXACT_MATCH?Object.keys(this._keyToCacheIds[b]).filter(function(b){return d===a.Base.IMDBSearchOptions.CONTAINS?b.indexOf(c)>-1:d===a.Base.IMDBSearchOptions.BEGINS_WITH?0===b.indexOf(c):void 0}):this._keyToCacheIds[b].hasOwnProperty(c)?[c]:void 0},b.prototype._areKeys1SubsetOfKeys2=function(b,c,d){var e=a.Base.IMDBSearchOptions,f=function(a,b){return d&&d!==e.EXACT_MATCH?d===e.CONTAINS?b.indexOf(a)>-1:d===e.BEGINS_WITH?0===b.indexOf(a):void 0:b===a},g=function(a,b){for(var c=0;c<b.length;c++)if(f(a,b[c]))return!0;return!1};for(var h in b)if(b.hasOwnProperty(h)){if(!c.hasOwnProperty(h))return!1;for(var i=0;i<b[h].length;i++)if(!g(b[h][i],c[h]))return!1}return!0},b.prototype._validateKeyNames=function(a){if(!a||!(a instanceof Array)||a.length<1)throw new Error('SimpleIMDB: "keyNames" argument is invalid. It should be of Array type and have at least one element. keyNames: '+JSON.stringify(a));for(var b=0;b<a.length;b++)if("string"!=typeof a[b])throw new Error("SimpleIMDB: Cache key name "+JSON.stringify(a[b])+" is not of String type. Type: "+typeof a[b])},b.prototype._validateKeys=function(b){var c,d,e;for(c in b)if(b.hasOwnProperty(c)){if(void 0===this._keyToCacheIds[c])throw e="Key name "+c+" is not registered for this IMDB",a.Base.Logger.error(a.Base.LoggerTags.CACHE,e),new Error(e);d=b[c];for(var f=0;f<d.length;f++){var g=d[f];if("string"!=typeof g)throw e="Value "+JSON.stringify(g)+" of key "+c+" is not of string type",a.Base.Logger.error(a.Base.LoggerTags.CACHE,e),new Error(e);if(""===g)throw e="Key "+c+" has empty value",a.Base.Logger.error(a.Base.LoggerTags.CACHE,e),new Error(e)}}},b.prototype._generateCacheId=function(){for(var b,c;!b;)c=a.Base.Utils.makeId(this._cacheIdLength),this._cache.getElement(c)&&++this._generateIdFailureCounter>this._cacheIdLength&&this._cacheIdLength++,b=c;return this._generateIdFailureCounter=0,b},b.prototype._onCacheElementsDelete=function(b){for(var c=0;c<b.length;c++){var d=b[c];d.cacheId&&d.keys?this._deleteCacheIdByKeys(d.cacheId,d.keys):a.Base.Logger.error(a.Base.LoggerTags.CACHE,"Invalid cache object",d)}},a.Base.SimpleIMDB=b}(AvayaClientServices),function(a){"use strict";var b={CAPABILITY_NOT_DENIED:"CAPABILITY_NOT_DENIED",CAPABILITY_INVALID_STATE:"CAPABILITY_INVALID_STATE",CAPABILITY_NOT_SUPPORTED:"CAPABILITY_NOT_SUPPORTED",CAPABILITY_CALL_IS_REMOTE:"CAPABILITY_CALL_IS_REMOTE",CAPABILITY_CALL_IS_NOT_REMOTE:"CAPABILITY_CALL_IS_NOT_REMOTE",CAPABILITY_CALL_HAS_NO_AUDIO:"CAPABILITY_CALL_HAS_NO_AUDIO",CAPABILITY_CALL_HAS_NO_VIDEO:"CAPABILITY_CALL_HAS_NO_VIDEO",CAPABILITY_NOT_ALLOWED:"CAPABILITY_NOT_ALLOWED",CAPABILITY_NEED_SIGNIN:"CAPABILITY_NEED_SIGNIN",CAPABILITY_NEED_MODERATOR:"CAPABILITY_NEED_MODERATOR",CAPABILITY_NEED_SIGNIN_OR_MODERATOR:"CAPABILITY_NEED_SIGNIN_OR_MODERATOR",CAPABILITY_NOT_INSTALLED:"CAPABILITY_NOT_INSTALLED"};a.Base.CapabilityDenialReason=b}(AvayaClientServices),function(a,b){"use strict";function c(c){this.isAllowed=c===a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED,this.denialReason=c,this._onChangedCallbacks=b.Callbacks()}c.prototype={addOnChangedCallback:function(b){a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:"function"}]}),this._onChangedCallbacks.add(b)},removeOnChangedCallback:function(b){a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:"function"}]}),this._onChangedCallbacks.remove(b)},_updateIfChanged:function(a,b){this.isAllowed===a&&this.denialReason===b||(this.isAllowed=a,this.denialReason=b,this._onChangedCallbacks.fire(this))}},a.Base.Capability=c}(AvayaClientServices,jQuery),function(a){"use strict";var b={IN_PROGRESS:"IN_PROGRESS",DONE:"DONE",CANCELLED:"CANCELLED",FAILED:"FAILED"};a.Base.DataRetrievalStatus=b}(AvayaClientServices),function(a,b){"use strict";function c(c){this._dataSet=c||new a.Base.DataSet,this._status=a.Base.DataRetrievalStatus.IN_PROGRESS,this.isCancelled=!1,this.isCompleted=!1,this._dataRetrievalProgress=b.Callbacks(),this._dataRetrievalDone=b.Callbacks(),this._dataRetrievalFailed=b.Callbacks(),this._onCancel=void 0}c.prototype={cancel:function(){this._status===a.Base.DataRetrievalStatus.IN_PROGRESS&&(this._status=a.Base.DataRetrievalStatus.CANCELLED,this.isCancelled=!0,a.Base.Utils.isDefined(this._onCancel)&&this._onCancel())},getDataSet:function(){return this._dataSet},_getStatus:function(){return this._status}},a.Base.DataRetrieval=c}(AvayaClientServices,jQuery),function(a){"use strict";var b={ADDED:"ADDED",REMOVED:"REMOVED",UPDATED:"UPDATED"};a.Base.DataSetChangeTypes=b}(AvayaClientServices),function(a,b){"use strict";function c(){Array.apply(this),this.dataSetChangeCallbacks=b.Callbacks(),this.dataSetInvalidatedCallbacks=b.Callbacks()}c.prototype=Object.create(Array.prototype),c.prototype.addOnDataSetChangedCallback=function(a){this.dataSetChangeCallbacks.add(a)},c.prototype.removeOnDataSetChangedCallback=function(a){this.dataSetChangeCallbacks.remove(a)},c.prototype.onDataSetChanged=function(a,b){this.dataSetChangeCallbacks.fire(a,b)},c.prototype.addOnDataSetInvalidatedCallback=function(a){this.dataSetInvalidatedCallbacks.add(a)},c.prototype.removeOnDataSetInvalidatedCallback=function(a){this.dataSetInvalidatedCallbacks.remove(a)},c.prototype.onDataSetInvalidated=function(){this.dataSetInvalidatedCallbacks.fire(this)},a.Base.DataSet=c}(window.AvayaClientServices,jQuery),function(a){"use strict";var b={PENDING:"pending",RESOLVED:"resolved",REJECTED:"rejected"};a.Base.DeferredStates=b}(AvayaClientServices),function(a){"use strict";function b(a){if(void 0!==c[a])return c[a]}var c={INDETERMINATE:"INDETERMINATE",DETERMINATE:"DETERMINATE"};a.Base.Determinateness=b}(AvayaClientServices=AvayaClientServices||{}),function(a){"use strict";function b(){}b.prototype={generateBatteryLogs:function(a){var b=$.Deferred(),c=[];c.push("----------------------------------"),c.push("Version: "+a.applicationBuildNumber);var d="Unknown";return-1!==window.navigator.userAgent.indexOf("Windows NT 10")?d="Windows 10":-1!==window.navigator.userAgent.indexOf("Windows NT 6.2")?d="Windows 8":-1!==window.navigator.userAgent.indexOf("Windows NT 6.1")?d="Windows 7":-1!==window.navigator.userAgent.indexOf("Windows NT 6.0")?d="Windows Vista":-1!==window.navigator.userAgent.indexOf("Windows NT 5.1")?d="Windows XP":-1!==window.navigator.userAgent.indexOf("Windows NT 5.0")?d="Windows 2000":-1!==window.navigator.userAgent.indexOf("Mac")?d="Mac/iOS":-1!==window.navigator.userAgent.indexOf("X11")?d="UNIX":-1!==window.navigator.userAgent.indexOf("Android")?d="Android":-1!==window.navigator.userAgent.indexOf("iPad")?d="iPad":-1!==window.navigator.userAgent.indexOf("iPhone")?d="iPhone":-1!==window.navigator.userAgent.indexOf("Linux")&&(d="Linux"),c.push("Operating system: "+d),navigator.getBattery&&"function"==typeof navigator.getBattery?navigator.getBattery().then(function(a){c.push("Is Battery Charging : "+a.charging),c.push("Battery Level (%) : "+(100*a.level).toFixed(0)+"%"),c.push("----------------------------------"),b.resolve(c)},function(){c.push("Battery Level (%) : Unavailable"),c.push("----------------------------------"),b.resolve(c)}):(c.push("Battery Level (%) : Unavailable"),c.push("----------------------------------"),b.resolve(c)),b.promise()},generateMessagingLogs:function(a){var b=$.Deferred(),c=[];return a?(c.push("Number of active conversations: "+a._messagingService.conversations.length),c.push("Number of active messages: "+a._messagingService.conversations.reduce(function(a,b){return a+b.getTotalMessageCount()},0)),c.push("Number of draft conversations: "+a.getDraftConversations().length),c.push("Number of draft messages: "+a._messagingService.conversations.reduce(function(a,b){return a+b._draftMessages.length},0)),b.resolve(c)):(c.push("Messaging module is unavailable."),b.resolve(c)),c.push("----------------------------------"),b.promise()},generateContactsLogs:function(a){var b=$.Deferred(),c=[];return a?c.push("Number of contacts in cache: "+a._contactsService._contactsDataSet.length):c.push("Contacts module is unavailable."),c.push("----------------------------------"),b.resolve(c),b.promise()},generateCallLogs:function(a){var b=$.Deferred(),c=[];return a?c.push("Number of calls: "+a.getCallCount()):c.push("Calls module is unavailable."),c.push("----------------------------------"),b.resolve(c),b.promise()},generatePerformanceLogs:function(){var a=$.Deferred(),b=[];return b.push("Request time: "+(window.performance.timing.responseEnd-window.performance.timing.requestStart)+"ms"),b.push("Load time: "+(window.performance.timing.domContentLoadedEventEnd-window.performance.timing.requestStart)+"ms"),b.push("DOM content loaded time: "+(window.performance.timing.domContentLoadedEventEnd-window.performance.timing.domContentLoadedEventStart)+"ms"),b.push("----------------------------------"),window.performance.memory?(b.push("JS Heap Size Limit: "+window.performance.memory.jsHeapSizeLimit),b.push("Total JS Heap Size: "+window.performance.memory.totalJSHeapSize),b.push("Used JS Heap Size: "+window.performance.memory.usedJSHeapSize)):b.push("Memory info is unavailable."),b.push("----------------------------------"),a.resolve(b),a.promise()}},a.Base.DiagnosticDataGenerator=b}(AvayaClientServices),function(a){"use strict";var b={CAPABILITY_INVALID_STATE:"Service is in invalid state.",CAPABILITY_NOT_SUPPORTED:"Feature is not supported.",CAPABILITY_CALL_IS_REMOTE:"",CAPABILITY_CALL_IS_NOT_REMOTE:"",CAPABILITY_CALL_HAS_NO_AUDIO:"",CAPABILITY_CALL_HAS_NO_VIDEO:"",CAPABILITY_NOT_ALLOWED:"Action is not allowed.",CAPABILITY_NEED_SIGN_IN:"",CAPABILITY_NEED_MODERATOR:"",CAPABILITY_NEED_SIGN_IN_OR_MODERATOR:"",CAPABILITY_NOT_INSTALLED:"Extension is not installed.",NETWORK_ERROR:"Failed to perform operation. Network error occurred.",NETWORK_UNAUTHORIZED:"Failed to perform operation due to authorization failure.",NETWORK_AUTHORIZATION_CANCELED:"Failed to perform operation due to canceled authentication.",NETWORK_CANCELED:"Failed to perform operation. Operation was canceled.",INTERNAL_ERROR:"An internal error occurred.",TIMEOUT:"An operation has timed out"};a.Base.ErrorReasons=b}(AvayaClientServices),function(a){"use strict";a.Base.FeatureSupported={isBrowserSharingAvailable:function(){var b=a.Base.Utils.getBrowserType();return b===a.Base.BrowserType.CHROME||b===a.Base.BrowserType.CHROME_EXTENSION||b===a.Base.BrowserType.FIREFOX||b===a.Base.BrowserType.FIREFOX_EXTENSION}}}(AvayaClientServices),function(){"use strict";function a(a,b,c){AvayaClientServices.Base.Utils.isDefined(c)&&a[b].apply(a,c)}function b(a,b,c){AvayaClientServices.Base.Utils.isDefined(c)&&a.log(b,c)}function c(c,f){var g=Array.prototype.slice.call(f,1);g[0]=f[0]+": "+f[1];var h=new Date,i=h.toLocaleString(e);d.forEach(function(d){var e=g.slice();d.disableTimestamps||(e[0]="["+i+"] "+e[0]),"function"==typeof d[c]?a(d,c,e):b(d,c,e)})}var d=[],e="en";AvayaClientServices.Base.Logger={info:function(a,b){c("info",arguments)},error:function(a,b){c("error",arguments)},fatal:function(a,b){c("fatal",arguments)},debug:function(a,b){c("debug",arguments)},trace:function(a,b){c("trace",arguments)},warn:function(a,b){c("warn",arguments)},addLogger:function(a,b){if(!a||void 0===a.log)throw new TypeError("Logger should implement log method.");a.disableTimestamps=b,d.push(a)},removeLogger:function(a){var b=d.indexOf(a);if(-1===b)throw new Error("Specified error does not exist.");d.splice(b,1)},clearLoggers:function(){d=[]}}}(),function(){"use strict";function a(){this.disableTimestamps=!1}a.prototype={info:function(a,b){},warn:function(a,b){},error:function(a,b){},fatal:function(a,b){},debug:function(a,b){},trace:function(a,b){}},AvayaClientServices.Base.LoggerInterface=a}(AvayaClientServices),function(a){"use strict";var b={CACHE:"Cache",MEDIA_ENGINE:"MediaEngine",NETWORK_PROVIDER:"NetworkProvider",REST_NETWORK_PROVIDER:"RESTNetworkProvider",WEBSOCKET_NETWORK_PROVIDER:"WebSocketNetworkProvider",RTC_CALL_CONNECTION_PROVIDER:"RTCCallConnectionProvider",BANDWIDTH_MANAGER:"BandwidthManager",FSM:"FSM",SETTINGS_FILE_PARSER:"SettingsFileParser",UTILS:"Utils",ANALYTICS_SERVICE:"AnalyticsService",CALL_SERVICE:"CallService",COLLABORATION_SERVICE:"CollaborationService",CONFERENCE_SERVICE:"ConferenceService",CONTACTS_SERVICE:"ContactsService",MESSAGING_SERVICE:"MessagingService",PRESENCE_SERVICE:"PresenceService",VOICE_MESSAGING_SERVICE:"VoiceMessagingService",USER_SERVICE:"UserService",ACS_CONTACTS_PROVIDER:"ACSContactsProvider",AMM_MESSAGING_PROVIDER:"AMMMessagingProvider",ANALYTICS_PROVIDER:"AnalyticsProvider",CALL_PROVIDER:"CallProvider",CALL_GATEWAY_PROVIDER:"CallGatewayProvider",CSG_PRESENCE_AND_CALL_PROVIDER:"CSGPresenceAndCallProvider",CM_CONFERENCE_PROVIDER:"CMConferenceProvider",CONTENT_SHARING_COLLABORATION_PROVIDER:"ContentSharingCollaborationProvider",SCOPIA_CONFERENCE_PROVIDER:"ScopiaConferenceProvider",UCCP_CONFERENCE_PROVIDER:"UCCPConferenceProvider",WCS_COLLABORATION_PROVIDER:"WCSCollaborationProvider"};a.Base.LoggerTags=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d){this._kind=d,this._deviceId=a,this._groupId=b,this._label=c}b.prototype={getDeviceId:function(){return this._deviceId},getGroupId:function(){return this._groupId},getLabel:function(){return this._label}},a.Base.AudioDevice=b}(AvayaClientServices),function(a){"use strict";function b(){this._audioContext=void 0,this._volume=1,this._mediaStreamContextMap={}}function c(a,b,c){this.gainFilter=a,this.mediaStreamSource=b,this.origAudioTrack=c}b.prototype.stop=function(){this._audioContext&&(this._audioContext.close&&this._audioContext.close(),this._audioContext=void 0),this._mediaStreamContextMap={}},b.prototype._initAudioContext=function(){var b=window.AudioContext||window.webkitAudioContext;b?a.Base.Utils.isUndefined(this._audioContext)&&(this._audioContext=new b):a.Base.Logger.debug(a.Base.LoggerTags.MEDIA_ENGINE,"Web Audio APIs are unavailable on this browser")},b.prototype.setVolume=function(b){if(b>1||b<0)throw new RangeError("Volume must be a double between 0 and 1");if(this._volume=b,a.Base.Utils.isDefined(this._audioContext))for(var c in this._mediaStreamContextMap)this._mediaStreamContextMap.hasOwnProperty(c)&&(this._mediaStreamContextMap[c].gainFilter.gain.value=this._volume)},b.prototype.getVolume=function(){return this._volume},b.prototype.addMediaStream=function(b){if(a.Base.Logger.debug(a.Base.LoggerTags.MEDIA_ENGINE,"Adding MediaStream to AudioInputVolumeController "+b.id),this._initAudioContext(),a.Base.Utils.isDefined(this._audioContext)){var d=this._audioContext.createGain(),e=this._audioContext.createMediaStreamSource(b);e.connect(d);var f=this._audioContext.createMediaStreamDestination(),g=f.stream;d.connect(f),d.gain.value=this._volume;var h=b.getAudioTracks()[0];b.addTrack(g.getAudioTracks()[0]),b.removeTrack(h),this._mediaStreamContextMap[b.id]=new c(d,e,h)}},b.prototype.removeMediaStream=function(b){if(a.Base.Utils.isDefined(this._audioContext)&&b){a.Base.Logger.debug(a.Base.LoggerTags.MEDIA_ENGINE,"Removing MediaStream from AudioInputVolumeController "+b.id);var c=this._mediaStreamContextMap[b.id];a.Base.Utils.isDefined(c)&&a.Base.Utils.isDefined(c.mediaStreamSource)&&(c.mediaStreamSource.disconnect(),c.gainFilter.disconnect(),a.Base.Logger.debug(a.Base.LoggerTags.MEDIA_ENGINE,"Stopping audio track "+c.origAudioTrack.id),c.origAudioTrack.stop(),delete this._mediaStreamContextMap[b.id])}},a.Base.AudioInputVolumeController=b}(AvayaClientServices),function(a){"use strict";function b(a){this.audioElement=a,this.streamMuted=!1}function c(){this._muted=!1,this._volume=1,this._mediaStreamContextMap={}}c.prototype.stop=function(){this._mediaStreamContextMap={}},c.prototype.playAudioStream=function(c,d){if(c&&c.getAudioTracks().length>0){if(this.isPlaying(c))a.Base.Logger.debug(a.Base.LoggerTags.MEDIA_ENGINE,"Audio track is already playing: "+c.getAudioTracks()[0].id);else{a.Base.Logger.debug(a.Base.LoggerTags.MEDIA_ENGINE,"Playing audio track: "+c.getAudioTracks()[0].id);var e=document.createElement("audio");e.src=URL.createObjectURL(c),e.muted=this._muted||d,e.volume=this._volume,e.autoplay=!0,e.play(),this._mediaStreamContextMap[c.id]=new b(e)}return!0}return!1},c.prototype.stopPlayingAudioStream=function(b,c){if(b){var d=this._mediaStreamContextMap[b.id];if(a.Base.Utils.isDefined(d)){(!a.Base.Utils.isDefined(c)||c)&&this.logStreamChanges(b.getAudioTracks(),"Stopping playing audio for track ");var e=d.audioElement,f=function(){e.pause(),e.src=""};0===e.readyState?e.ondurationchange=f:f(),delete this._mediaStreamContextMap[b.id]}}},c.prototype.isPlaying=function(b){return a.Base.Utils.isDefined(this._mediaStreamContextMap[b.id])},c.prototype.muteStream=function(b){if(b){var c=this._mediaStreamContextMap[b.id];a.Base.Utils.isDefined(c)&&(c.streamMuted=!0,c.audioElement.muted=!0,this.logStreamChanges(b.getAudioTracks(),"Muted audio output for track "))}},c.prototype.unmuteStream=function(b){if(b){var c=this._mediaStreamContextMap[b.id];a.Base.Utils.isDefined(c)&&(c.streamMuted=!1,this._muted||(c.audioElement.muted=!1,this.logStreamChanges(b.getAudioTracks(),"Unmuted audio output for track ")))}},c.prototype.logStreamChanges=function(b,c){b&&b[0]&&a.Base.Logger.debug(a.Base.LoggerTags.MEDIA_ENGINE,c+b[0].id)},c.prototype.setVolume=function(a){if(a>1||a<0)throw new RangeError("Volume must be a double between 0 and 1");for(var b in this._mediaStreamContextMap)if(this._mediaStreamContextMap.hasOwnProperty(b)){var c=this._mediaStreamContextMap[b];c.audioElement.volume=a}this._volume=a},c.prototype.getVolume=function(){return this._volume},c.prototype.mute=function(){
for(var a in this._mediaStreamContextMap)if(this._mediaStreamContextMap.hasOwnProperty(a)){var b=this._mediaStreamContextMap[a];b.audioElement.muted=!0}this._muted=!0},c.prototype.unmute=function(){for(var a in this._mediaStreamContextMap)if(this._mediaStreamContextMap.hasOwnProperty(a)){var b=this._mediaStreamContextMap[a];b.streamMuted||(b.audioElement.muted=!1)}this._muted=!1},c.prototype.isMuted=function(){return this._muted},c.prototype.onSelectedDeviceChanged=function(a){for(var b in this._mediaStreamContextMap)if(this._mediaStreamContextMap.hasOwnProperty(b)){var c=this._mediaStreamContextMap[b];c.audioElement.setSinkId(a.getDeviceId())}},a.Base.AudioOutput=c}(AvayaClientServices),function(a){"use strict";function b(){this._audioInputInterfaceService=void 0,this._audioOutputInterfaceService=void 0,this._audioInterface=void 0,this._videoInterfaceService=void 0,this._videoInterface=void 0,this._mediaServices=void 0,this._mediaServicesService=void 0}b.prototype={start:function(){return $.when(this.getAudioInterface().start(),this.getVideoInterface().start())},stop:function(){return $.when(this.getAudioInterface().stop(),this.getVideoInterface().stop())},getMediaServices:function(){return this._mediaServices||(this._mediaServices=new a.Base.MediaServices(this.getAudioInterface(),this.getVideoInterface())),this._mediaServices},getMediaServicesService:function(){return this._mediaServicesService||(this._mediaServicesService=new a.Base.MediaServicesService(this.getMediaServices(),this.getAudioInputInterfaceService(),this.getAudioOutputInterfaceService(),this.getVideoInterfaceService(),new a.Base.UserMedia)),this._mediaServicesService},getAudioInputInterfaceService:function(){return this._audioInputInterfaceService||this.getAudioInterface(),this._audioInputInterfaceService},getAudioOutputInterfaceService:function(){return this._audioOutputInterfaceService||this.getAudioInterface(),this._audioOutputInterfaceService},getAudioInterface:function(){if(!this._audioInterface){this._audioInputInterfaceService=new a.Base.AudioInputInterfaceService;var b=new a.Base.AudioInputInterface(this._audioInputInterfaceService);this._audioOutputInterfaceService=new a.Base.AudioOutputInterfaceService;var c=new a.Base.AudioOutputInterface(this._audioOutputInterfaceService);this._audioInterface=new a.Base.AudioInterface(b,c)}return this._audioInterface},getVideoInterfaceService:function(){return this._videoInterfaceService||this.getVideoInterface(),this._videoInterfaceService},getVideoInterface:function(){return this._videoInterface||(this._videoInterfaceService=new a.Base.VideoInterfaceService,this._videoInterface=new a.Base.VideoInterface(this._videoInterfaceService)),this._videoInterface}},a.Base.MediaServicesFactory=b}(AvayaClientServices),function(a,b){"use strict";function c(a,b,c,d,e){this._userMedia=e,this._audioInputInterfaceService=b,this._audioOutputInterfaceService=c,this._videoInterfaceService=d,this._mediaServices=a}c.prototype={getAudioInputService:function(){return this._audioInputInterfaceService},getAudioOutputService:function(){return this._audioOutputInterfaceService},getVideoInterfaceService:function(){return this._videoInterfaceService},createLocalMediaStream:function(c,d,e,f,g,h){return d&&!a.Base.Utils.isDefined(g)?b.Deferred().reject("Undefined videoChannelId"):this._userMedia.getUserMedia(c,d,e,f,!1,h).then(function(a,b){return this._setDefaultDevices(a),this._audioInputInterfaceService.localMediaStreamCreated(a),this._videoInterfaceService.localMediaStreamCreated(g,a),{stream:a,videoResolution:b}}.bind(this))},_setDefaultDevices:function(a){var b=a.getAudioTracks()[0];this._setDefaultDevice(b,this._mediaServices.getAudioInterface().getInputInterface());var c=a.getVideoTracks()[0];this._setDefaultDevice(c,this._mediaServices.getVideoInterface()),this._setDefaultOutputDevice(this._mediaServices.getAudioInterface().getOutputInterface())},_setDefaultDevice:function(a,b){if(b.getSelectDeviceCapability().isAllowed&&a&&!b.getSelectedDevice()){var c=b.getAvailableDevices().filter(function(b){return b._label===a.label})[0];c&&b.setSelectedDevice(c)}},_setDefaultOutputDevice:function(a){if(a.getSelectDeviceCapability().isAllowed&&!a.getSelectedDevice()){var b=a.getAvailableDevices().filter(function(a){return"default"===a._deviceId})[0];b&&a.setSelectedDevice(b)}},addVideoTracksToLocalStream:function(c,d,e,f){var g=b.Deferred();return a.Base.Utils.isDefined(d)?this._userMedia.addVideoTracksToStream(c,e,f).then(function(a){this._videoInterfaceService.localMediaStreamCreated(d,a),g.resolve(a)}.bind(this).bind(d),function(a){g.reject(a)}):g.reject("Undefined videoChannelId"),g},removeLocalVideoTracks:function(b){var c=this._videoInterfaceService.getLocalMediaStream(b);if(a.Base.Utils.isDefined(c)){var d=c.getVideoTracks();a.Base.Logger.debug(a.Base.LoggerTags.MEDIA_ENGINE,"removeLocalVideoTracks starting with "+d.length+" tracks.");for(var e=d.length-1;e>=0;e--){var f=d[e],g=d.indexOf(f);g>-1&&(f.stop(),c.removeTrack(f),d.splice(g,1))}d=c.getVideoTracks(),a.Base.Logger.debug(a.Base.LoggerTags.MEDIA_ENGINE,"removeLocalVideoTracks ending with "+d.length+" tracks."),this._videoInterfaceService.removeLocalMediaStream(b)}},getUserMedia:function(){return this._userMedia}},a.Base.MediaServicesService=c}(AvayaClientServices,jQuery),function(a){"use strict";function b(a,b){this._audioInterface=a,this._videoInterface=b}b.prototype={getAudioInterface:function(){return this._audioInterface},getVideoInterface:function(){return this._videoInterface}},a.Base.MediaServices=b}(AvayaClientServices),function(a,b){"use strict";function c(c){this._selectedDevice=void 0,this._mediaInterfaceService=c,this._onDevicesAddedCallbacks=b.Callbacks("unique"),this._onDevicesRemovedCallbacks=b.Callbacks("unique"),this._onSelectedDeviceRemovedCallbacks=b.Callbacks("unique"),this._onSelectedDeviceChangedCallbacks=b.Callbacks("unique"),this._notifiedUnavailability=!1,this._onDevicesUnavailable=b.Callbacks("unique");var d=a.Base.Utils.getBrowserType(),e=d===a.Base.BrowserType.CHROME||d===a.Base.BrowserType.CHROME_EXTENSION||d===a.Base.BrowserType.FIREFOX||d===a.Base.BrowserType.FIREFOX_EXTENSION,f=e?a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED:a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED;this._selectDeviceCapability=new a.Base.Capability(f)}c.prototype={start:function(){return this._mediaInterfaceService.start(this)},stop:function(){return this._mediaInterfaceService.stop(this)},setSelectedDevice:function(a){if(!this._selectDeviceCapability.isAllowed)throw new Error("Selecting devices is not supported in current browser.");a!==this._selectedDevice&&(this._selectedDevice=a,this._onSelectedDeviceChangedCallbacks.fire(this,this._selectedDevice))},getAvailableDevices:function(){return this._mediaInterfaceService.getAvailableDevices()},getSelectedDevice:function(){return this._selectedDevice},getSelectDeviceCapability:function(){return this._selectDeviceCapability},addOnDevicesAddedCallback:function(a){this._onDevicesAddedCallbacks.add(a)},removeOnDevicesAddedCallback:function(a){this._onDevicesAddedCallbacks.remove(a)},addOnDevicesRemovedCallback:function(a){this._onDevicesRemovedCallbacks.add(a)},removeOnDevicesRemovedCallback:function(a){this._onDevicesRemovedCallbacks.remove(a)},addOnSelectedDeviceRemovedCallback:function(a){this._onSelectedDeviceRemovedCallbacks.add(a)},removeOnSelectedDeviceRemovedCallback:function(a){this._onSelectedDeviceRemovedCallbacks.remove(a)},addOnDevicesUnavailableCallback:function(a){this._onDevicesUnavailable.add(a)},removeOnDevicesUnavailableCallback:function(a){this._onDevicesUnavailable.remove(a)},addOnSelectedDeviceChangedCallback:function(a){this._onSelectedDeviceChangedCallbacks.add(a)},removeOnSelectedDeviceChangedCallback:function(a){this._onSelectedDeviceChangedCallbacks.remove(a)}},a.Base.MediaInterface=c}(AvayaClientServices,jQuery),function(a,b){"use strict";function c(){this._devices=[],this._deviceIdentifier="",this._isStarted=!1,this._observeDevicesInterval=void 0}c.prototype={start:function(c){var d=b.Deferred();return c.getSelectDeviceCapability().isAllowed?(this._isStarted?d.resolve():(this._observeDevicesInterval=setInterval(function(){this._observeDevices(c,d)}.bind(this),1e3),this._observeDevices(c,d)),d.promise()):d.reject(new a.Base.BaseError(a.Base.ErrorReasons.CAPABILITY_NOT_ALLOWED)).promise()},stop:function(a){return this._observeDevicesInterval&&(clearInterval(this._observeDevicesInterval),this._observeDevicesInterval=void 0),this._isStarted=!1,b.Deferred().resolve().promise()},getAvailableDevices:function(){return this._devices},_observeDevices:function(a,b){navigator.mediaDevices.enumerateDevices().then(function(c){this._processDevices(a,this._devices,c,this._isStarted),this._isStarted||(this._isStarted=!0,b.resolve())}.bind(this))},_processDevices:function(a,b,c,d){d&&this._updateDevicesLabel(b,c),this._scanForAddedDevices(a,b,c),this._scanForRemovedDevices(a,b,c),this._scanForAvailableDevices(a,b,c)},_getAddedDevices:function(a,b){var c=[];return b.filter(function(a){return a.kind===this._deviceIdentifier}.bind(this)).forEach(function(b){var d=a.filter(function(a){return a.getDeviceId()===b.deviceId}).length>0,e=c.filter(function(a){return a._deviceId===b.deviceId}).length>0;if(!d&&!e){var f=this._buildDevice(b);c.push(f)}}.bind(this)),c},_updateDevicesLabel:function(a,b){b.forEach(function(b){a.filter(function(a){return a.getDeviceId()===b.deviceId&&(a._label=b.label,!0)})})},_scanForAddedDevices:function(a,b,c){var d=this._getAddedDevices(b,c);d.length>0&&(d.forEach(function(a){b.push(a)}),a._notifiedUnavailability=!1,a._onDevicesAddedCallbacks.fire(a,d))},_scanForAvailableDevices:function(a,b,c){0!==b.length||a._notifiedUnavailability||(a._onDevicesUnavailable.fire(a),a._notifiedUnavailability=!0)},_scanForRemovedDevices:function(a,b,c){var d=b.filter(function(a){return 0===c.filter(function(b){return a.getDeviceId()===b.deviceId}).length});if(d.length>0&&(d.forEach(function(a){b.splice(b.indexOf(a),1)}),a._onDevicesRemovedCallbacks.fire(a,d),d.indexOf(a.getSelectedDevice())>-1)){var e=a._selectedDevice;a._selectedDevice=void 0,a._onSelectedDeviceRemovedCallbacks.fire(a,e)}},_buildDevice:function(a){throw new Error("Unable to build device")}},a.Base.MediaInterfaceService=c}(AvayaClientServices,jQuery),function(a){"use strict";var b={AUDIO_INPUT:"audioinput",AUDIO_OUTPUT:"audiooutput",VIDEO_INPUT:"videoinput"};a.Base.MediaTypes=b}(AvayaClientServices),function(a,b){"use strict";function c(){this.isAvailable()||a.Base.Logger.info(a.Base.LoggerTags.MEDIA_ENGINE,"UserMedia not available"),this._isChromeBrowser=this._checkIfBrowserIsChrome()}c.prototype.isAvailable=function(){return!!navigator.mediaDevices&&!!navigator.mediaDevices.getUserMedia},c.prototype.getUserMedia=function(c,d,e,f,g,h,i,j,k){d?a.Base.Logger.debug(a.Base.LoggerTags.MEDIA_ENGINE,"Entering getUserMedia for Audio and Video",h):c&&a.Base.Logger.debug(a.Base.LoggerTags.MEDIA_ENGINE,"Entering getUserMedia for Audio only"),i=!a.Base.Utils.isDefined(i)||i,j=j||h;var l=this.createRTCConstraints(c,d,i,h,e,f);return g&&(l.fake=!0),k=k||b.Deferred(),this.isAvailable()?(a.Base.Logger.debug(a.Base.LoggerTags.MEDIA_ENGINE,"getUserMedia with mediaOptions "+JSON.stringify(l)),navigator.mediaDevices.getUserMedia(l).then(function(b){a.Base.Logger.debug(a.Base.LoggerTags.MEDIA_ENGINE,"Resolving getUserMedia dfd"),k.resolve(b,h)}.bind(this)).catch(function(b){return"DevicesNotFoundError"===b.name?(a.Base.Logger.error(a.Base.LoggerTags.MEDIA_ENGINE,"getUserMedia error: ",h,b),void k.reject(new a.Services.Call.CallException(a.Services.Call.CallError.DEVICES_NOT_FOUND))):b.message.includes("Failed to allocate")?(a.Base.Logger.error(a.Base.LoggerTags.MEDIA_ENGINE,"getUserMedia error: ",h,b),void k.reject(new a.Services.Call.CallException(a.Services.Call.CallError.MEDIA_CREATION_FAILURE))):(a.Base.Logger.warn(a.Base.LoggerTags.MEDIA_ENGINE,"Running constraints fallback: ",h,b),void this._constraintsFallback(c,d,e,f,g,h,i,j,k,b))}.bind(this))):k.reject(new a.Services.Call.CallException(a.Services.Call.CallError.WEBRTC_NOT_SUPPORTED)),k.promise()},c.prototype.addVideoTracksToStream=function(c,d,e){var f=b.Deferred(),g=d.getVideoTracks();return a.Base.Logger.debug(a.Base.LoggerTags.MEDIA_ENGINE,"addVideoTracksToStream starting with "+g.length+" tracks."),this.getUserMedia(!1,!0,void 0,c,!1,e).then(function(b){var c=b.getVideoTracks();a.Base.Logger.debug(a.Base.LoggerTags.MEDIA_ENGINE,"addVideoTracksToStream got new stream with "+c.length+" tracks."),b.getTracks().forEach(function(b){b.kind===a.Providers.Call.CallProvider.Constants.VIDEO_TRACK&&(d.addTrack(b),a.Base.Logger.debug(a.Base.LoggerTags.MEDIA_ENGINE,"addVideoTracksToStream added a track."+b.id))}),f.resolve(d)},function(a){f.reject(a)}),f},c.prototype.createRTCConstraints=function(b,c,d,e,f,g){var h={};return b&&(f?this._isChromeBrowser?h.audio={optional:[{sourceId:f}]}:h.audio={deviceId:{exact:f}}:h.audio=!0),c&&(this._isChromeBrowser?(h.video={optional:[{googCpuOveruseDetection:!1}],mandatory:{maxWidth:e.getWidth(),maxHeight:e.getHeight(),minWidth:e.getWidth(),minHeight:e.getHeight()}},d&&(h.video.mandatory.minFrameRate=e.getFPS()),a.Base.Utils.isDefined(g)&&h.video.optional.push({sourceId:g})):(180===e.getHeight()?h.video={width:{max:e.getWidth()},height:{max:e.getHeight()}}:h.video={width:{exact:e.getWidth()},height:{exact:e.getHeight()}},d&&(h.video.frameRate={min:e.getFPS()}),a.Base.Utils.isDefined(g)&&(h.video.deviceId={exact:g}))),h},c.prototype.createRTCVideoConstraints=function(a,b){var c={};return 180===a.getHeight()?c.video={width:{max:a.getWidth()},height:{max:a.getHeight()}}:c.video={width:{exact:a.getWidth()},height:{exact:a.getHeight()}},b&&(c.deviceId={exact:b}),c},c.prototype._constraintsFallback=function(c,d,e,f,g,h,i,j,k,l){if(!d&&!i&&h===a.Base.VideoResolution.resolution180p)return void k.reject(l);var m,n=b.map(a.Base.VideoResolution,function(a){return a}),o=n.indexOf(h);if(o+1<n.length)m=n[o+1];else{if(!i)return void k.reject(l);i=!1,m=j}this.getUserMedia(c,d,e,f,g,m,i,j,k)},c.prototype.adjustVideoResolution=function(c,d){if(c&&d&&!(d.getMinBandwidth()<=c)){var e=b.map(a.Base.VideoResolution,function(a){return a}),f=e.indexOf(d);-1===f&&(f=0);for(var g=f;g<e.length;g++)if(e[g].getMinBandwidth()<=c&&e[g].getMaxBandwidth()>c)return e[g];return a.Base.VideoResolution.resolution180p}},c.prototype.adjustVideoResolutionForDimensions=function(c,d,e){var f=b.map(a.Base.VideoResolution,function(a){return a}),g=f.indexOf(e);-1===g&&(g=0);for(var h=g;h<f.length;h++)if((a.Base.Utils.isUndefined(d)||0===d||f[h].getWidth()<=d)&&(a.Base.Utils.isUndefined(c)||0===c||f[h].getHeight()<=c))return f[h];return a.Base.VideoResolution.resolution180p},c.prototype.updateStreamUsingApplyConstraints=function(c,d,e,f,g){g=g||b.Deferred();var h=a.Base.UserMedia.prototype.createRTCVideoConstraints(d,f);return c.applyConstraints(h).then(function(){e._updateVideoResolution(d),g.resolve()},function(h){var i,j=b.map(a.Base.VideoResolution,function(a){return a}),k=j.indexOf(d);k+1<j.length?i=j[k+1]:g.reject(h),this.updateStreamUsingApplyConstraints(c,i,e,f,g)}.bind(this)),g.promise()},c.prototype._checkIfBrowserIsChrome=function(){var b=a.Base.Utils.getBrowserType();return b===a.Base.BrowserType.CHROME||b===a.Base.BrowserType.CHROME_EXTENSION},a.Base.UserMedia=c}(window.AvayaClientServices=window.AvayaClientServices||{},jQuery),function(a){"use strict";function b(b,c,d){this._kind=a.Base.MediaTypes.VIDEO_INPUT,this._deviceId=b,this._groupId=c,this._label=d}b.prototype={getDeviceId:function(){return this._deviceId},getGroupId:function(){return this._groupId},getLabel:function(){return this._label}},a.Base.VideoDevice=b}(AvayaClientServices),function(a){"use strict";function b(){a.Base.MediaInterfaceService.call(this),this._deviceIdentifier=a.Base.MediaTypes.VIDEO_INPUT,this._localStreamMap={},this._remoteStreamMap={},this._currentChannelId=1}b.prototype=Object.create(a.Base.MediaInterfaceService.prototype),b.prototype._buildDevice=function(b){return new a.Base.VideoDevice(b.deviceId,b.groupId,b.label)},b.prototype.createVideoChannel=function(){return this._currentChannelId++},b.prototype.getRemoteMediaStream=function(a){return this._remoteStreamMap[a]},b.prototype.getLocalMediaStream=function(a){return this._localStreamMap[a]},b.prototype.setRemoteMediaStream=function(a,b){this._remoteStreamMap[a]=b},b.prototype.localMediaStreamCreated=function(a,b){b.getVideoTracks().length>0&&(this._localStreamMap[a]=b)},b.prototype.removeMediaStreams=function(a){delete this._localStreamMap[a],delete this._remoteStreamMap[a]},b.prototype.removeLocalMediaStream=function(a){delete this._localStreamMap[a]},b.prototype.removeRemoteMediaStream=function(a){delete this._remoteStreamMap[a]},a.Base.VideoInterfaceService=b}(AvayaClientServices),function(a){"use strict";function b(b){a.Base.MediaInterface.call(this,b),this._videoInterfaceService=b}b.prototype=Object.create(a.Base.MediaInterface.prototype),b.prototype.getRemoteMediaStream=function(a){return this._videoInterfaceService.getRemoteMediaStream(a)},b.prototype.getLocalMediaStream=function(a){return this._videoInterfaceService.getLocalMediaStream(a)},a.Base.VideoInterface=b}(AvayaClientServices),function(a){"use strict";var b={HTTP_REDIRECTION:300,HTTP_MOVED_PERMANENTLY:301,HTTP_FOUND:302,HTTP_SEE_OTHER:303,HTTP_NOT_MODIFIED:304,HTTP_USE_PROXY:305,HTTP_TEMPORARY_REDIRECT:307,HTTP_PERMANENT_REDIRECT:308,HTTP_BAD_REQUEST:400,HTTP_UNAUTHORIZED:401,HTTP_PAYMENT_REQUIRED:402,HTTP_FORBIDDEN:403,HTTP_NOT_FOUND:404,HTTP_METHOD_NOT_ALLOWED:405,HTTP_NOT_ACCEPTABLE:406,HTTP_PROXY_AUTHENTICATION_REQUIRED:407,HTTP_REQUEST_TIMEOUT:408,HTTP_CONFLICT:409,HTTP_GONE:410,HTTP_LENGTH_REQUIRED:411,HTTP_PRECONDITION_FAILED:412,HTTP_PAYLOAD_TO_LARGE:413,HTTP_URI_TOO_LONG:414,HTTP_UNSUPPORTED_MEDIA_TYPE:415,HTTP_RANGE_NOT_SATISFIABLE:416,HTTP_EXPECTATION_FAILED:417,HTTP_MISDIRECTED_REQUEST:421,HTTP_UNPROCESSABLE_ENTITY:422,HTTP_LOCKED:423,HTTP_FAILED_DEPENDENCY:424,HTTP_UPGRADE_REQUIRED:426,HTTP_PRECONDITION_REQUIRED:428,HTTP_TOO_MANY_REQUESTS:429,HTTP_REQUEST_HEADERS_TOO_LARGE:431,HTTP_NGINX_NO_RESPONSE:444,HTTP_UNAVAILABLE_FOR_LEGAL:451,HTTP_NGINX_SSL_CERTIFICATE_ERROR:495,HTTP_NGINX_SSL_CERTIFICATE_REQUIRED:496,HTTP_NGINX_HTTP_TO_HTTPS:444,HTTP_NGINX_CLIENT_CLOSED_REQUEST:499,HTTP_INTERNAL_SERVER_ERROR:500,HTTP_NOT_IMPLEMENTED:501,HTTP_BAD_GATEWAY:502,HTTP_SERVICE_UNAVAILABLE:503,HTTP_GATEWAY_TIMEOUT:504,HTTP_NETWORK_AUTHENTICATION_REQUIRED:511,HTTP_NETWORK_ERROR:400001,WEBSOCKET_CLOSE_NORMAL:1e3,WEBSOCKET_UNAUTHORIZED:1006};a.Base.NetworkErrorCodes=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d,e){this._retryHelper=a,this._deferred=b,this._status=c,this._responseText=d,this._retryAfter=this._parseRetryAfter(e)}b.prototype={getRequestRetryHelper:function(){return this._retryHelper},getStatus:function(){return this._status},getResponseText:function(){return this._responseText},getDeferred:function(){return this._deferred},getRetryAfter:function(){return this._retryAfter},_parseRetryAfter:function(b){if(a.Base.Utils.isDefined(b)&&null!==b){var c=parseInt(b);return isNaN(c)?new Date(b)-new Date:1e3*c}}},a.Base.NetworkErrorEvent=b}(AvayaClientServices),function(a){"use strict";var b={UNAUTHORIZED:"UNAUTHORIZED",AUTHORIZED:"AUTHORIZED",RETRYING:"RETRYING"};a.Base.NetworkProviderEvents=b}(AvayaClientServices),function(a){"use strict";function b(a){this._retryCallback=a,this._retryCounter=0}b.prototype={getRetryCallback:function(){return this._retryCallback},getRetryCounter:function(){return this._retryCounter},incrementCounter:function(){this._retryCounter++}},a.Base.NetworkRequestRetryHelper=b}(AvayaClientServices),function(a){"use strict";var b={PING:"Ping"};a.Base.ProvidersEventTypes=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Base.BaseError.call(this,b,c),this.name="NetworkError"}b.prototype=Object.create(a.Base.BaseError.prototype),a.Base.NetworkError=b}(AvayaClientServices),function(a,b){"use strict";function c(){this._listeners={}}c.prototype={on:function(a,b){return"function"!=typeof b?this:(this._listeners[a]=this._listeners[a]||[],this._listeners[a].push(b),this)},off:function(a,b){if("function"!=typeof b)return this;if(void 0===this._listeners[a])throw new Error("There is no such handler for event with name: "+a+".");var c=this._listeners[a].indexOf(b);if(-1===c)throw new Error("There is no such handler for event with name: "+a+".");return this._listeners[a].splice(c,1),this},trigger:function(a,c){var d=this._listeners[a];void 0!==d&&(c=c||[],b.each(d,function(a,b){b.apply(window,c)}))},hasListeners:function(a){var b=this._listeners[a];return void 0!==b&&b.length},_removeListeners:function(){for(var a in this._listeners)if(this._listeners.hasOwnProperty(a))for(var b=0;b<this._listeners[a].length;b++)this.off(a,this._listeners[a][b])}},a.Base.Observable=c}(window.AvayaClientServices=window.AvayaClientServices||{},jQuery=jQuery||{}),function(a){"use strict";function b(){}b.prototype={state:function(){},always:function(a){},done:function(a){},fail:function(a){},progress:function(a){},then:function(a,b,c){}},a.Base.Promise=b}(AvayaClientServices),function(a,b){"use strict";function c(){this.messagingProviders=[],this.conferenceProviders=[],this.callProviders=[],this.collaborationProviders=[],this._ammProviderFactory={},this._ammProvider={},this._wcsProviderFactory={},this._wcsProvider={},this._contactsProviders=[],this._directorySearchProviders=[],this._acsProviderFactory={},this._acsContactsProvider={},this._acsDirectorySearchProvider={},this._presenceProviders=[],this._csgProviderFactory={},this._csgPresenceProvider={},this._scopiaProvider={},this._sgCallProvider={},this._scopiaConferenceProviderFactory={},this._rtcConnectionProviderFactory={}}c.prototype={getMessagingProviders:function(a){if(this.messagingProviders.length>0)return this.messagingProviders;var c=this._getAMMProvider(this._getAMMProviderConfiguration(a));return b.isEmptyObject(c)||this.messagingProviders.push(c),this.messagingProviders},getContactsProviders:function(a){if(0===this._contactsProviders.length){var c=this._getACSContactsProvider();b.isEmptyObject(c)||this._contactsProviders.push(c)}return this._contactsProviders},_getACSContactsProvider:function(){return b.isEmptyObject(this._acsContactsProvider)&&(b.isEmptyObject(this._acsProviderFactory)&&(this._acsProviderFactory=new a.Providers.ACS.ACSProviderFactory),this._acsContactsProvider=this._acsProviderFactory.getACSContactsProvider()),this._acsContactsProvider},getDirectorySearchProviders:function(a){if(0===this._directorySearchProviders.length){var c=this._getACSDirectorySearchProvider();b.isEmptyObject(c)||this._directorySearchProviders.push(c)}return this._directorySearchProviders},_getACSDirectorySearchProvider:function(){return b.isEmptyObject(this._acsDirectorySearchProvider)&&(b.isEmptyObject(this._acsProviderFactory)&&(this._acsProviderFactory=new a.Providers.ACS.ACSProviderFactory),this._acsDirectorySearchProvider=this._acsProviderFactory.getACSDirectorySearchProvider()),this._acsDirectorySearchProvider},getPresenceProviders:function(a){if(0===this._presenceProviders.length){var c=this._getCSGPresenceProvider(a);b.isEmptyObject(c)||this._presenceProviders.push(c)}return this._presenceProviders},_getCSGPresenceProvider:function(a){return b.isEmptyObject(this._csgPresenceProvider)&&(this._csgPresenceProvider=this._getCSGProviderFactory().getCSGPresenceProvider(a)),this._csgPresenceProvider},getConferenceProviders:function(a){if(this.conferenceProviders.length>0)return this.conferenceProviders;var c=this._getScopiaConferenceProvider(a.uccpConfiguration);return b.isEmptyObject(c)||this.conferenceProviders.push(c),this.conferenceProviders},getCallProviders:function(a,c,d){if(this.callProviders.length>0)return this.callProviders;if(a.sgConfiguration&&a.sgConfiguration.enabled){var e=this._getSGCallProvider(a.sgConfiguration,c,d);b.isEmptyObject(e)||this.callProviders.push(e)}return this.callProviders},getVoiceMessagingProvider:function(a){var b=a.networkProviderConfiguration.restConfig,c=b.hostName+":"+b.port;return this._getCSGProviderFactory().getCSGCallsProvider(c)},_getAMMProvider:function(c){return b.isEmptyObject(this._ammProvider)?(b.isEmptyObject(this._ammProviderFactory)&&(this._ammProviderFactory=new a.Providers.AMM.AMMProviderFactory),this._ammProvider=this._ammProviderFactory.getAMMProvider(c),this._ammProvider):this._ammProvider},_getWCSProvider:function(c){return b.isEmptyObject(this._wcsProvider)?(b.isEmptyObject(this._wcsProviderFactory)&&(this._wcsProviderFactory=new a.Providers.WCS.WCSProviderFactory),this._wcsProvider=this._wcsProviderFactory.getWCSProvider(c),this._wcsProvider):this._wcsProvider},_getWCSProviderConfiguration:function(a){return a.wcsConfiguration},_getScopiaConferenceProvider:function(c){return b.isEmptyObject(this._scopiaProvider)?(b.isEmptyObject(this._scopiaConferenceProviderFactory)&&(this._scopiaConferenceProviderFactory=new a.Providers.Scopia.ScopiaConferenceProviderFactory),this._scopiaProvider=this._scopiaConferenceProviderFactory.getScopiaConferenceProvider(c),this._scopiaProvider):this._scopiaProvider},_getSGCallProvider:function(c,d,e){return b.isEmptyObject(this._sgCallProvider)?(this._sgCallProvider=new a.Providers.Call.CallProvider(this._getCSGProviderFactory(),d,e,this._getRTCConnectionProviderFactory()),this._sgCallProvider):this._sgCallProvider},_getCSGProviderFactory:function(){return b.isEmptyObject(this._csgProviderFactory)&&(this._csgProviderFactory=new a.Providers.CallServiceGateway.CallServiceGatewayProviderFactory),this._csgProviderFactory},_getRTCConnectionProviderFactory:function(){return b.isEmptyObject(this._rtcConnectionProviderFactory)&&(this._rtcConnectionProviderFactory=new a.Base.RTCConnectionProviderFactory),this._rtcConnectionProviderFactory},_getAMMProviderConfiguration:function(a){return a.ammConfiguration},getCollaborationProviders:function(a){if(this.collaborationProviders.length>0)return this.collaborationProviders;var c=this._getWCSProvider(this._getWCSProviderConfiguration(a));return b.isEmptyObject(c)||this.collaborationProviders.push(c),this.collaborationProviders},createCollaborationProviders:function(b){return[(new a.Providers.WCS.WCSProviderFactory).getWCSProvider(this._getWCSProviderConfiguration(b))]}},a.Base.ProviderFactory=c}(AvayaClientServices,jQuery),function(a){"use strict";var b={REST_PROVIDER:"RestProvider",WEB_SOCKET_PROVIDER:"WebSocketProvider",SSE_PROVIDER:"SSEProvider",WCS_COMET_PROVIDER:"WCSCometProvider"};a.Base.ProviderTypes=b}(AvayaClientServices),function(a){"use strict";function b(a){this.isAvailable()&&(this.createPeerConnection(a),this._dtmfSender=void 0,this._iceNegotiatedCallback=void 0,this._updateSdpCallback=void 0,this._mediaStreams=[])}var c=window.RTCPeerConnection||window.webkitRTCPeerConnection||window.msRTCPeerConnection,d=window.RTCSessionDescription||window.webkitRTCSessionDescription||window.msRTCSessionDescription;b.prototype.isAvailable=function(){return c&&d},b.prototype.addStream=function(a){},b.prototype.removeStream=function(a){},b.prototype.createPeerConnection=function(b){this.close();var d=a.Base.Utils.queryJSONObject(b,"iceServers"),e=a.Base.Utils.isDefined(d)&&d.length>0?b:null;this._pc=new c(e)},b.prototype.createOffer=function(b,c,e,f,g){this._pc.onicecandidate=this._onIceCandidate.bind(this),this._pc.oniceconnectionstatechange=this._oniceConnectionStateChange.bind(this,function(){});var h=a.Base.Utils.isDefined(f)?this._createOfferOptions(f):{};a.Base.Utils.isDefined(g)&&(h.iceRestart=g),this._pc.createOffer(function(f){a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"after createOffer");var g=f.type,h=f.sdp;"function"==typeof e&&(h=e(h));var i=function(c){this._pc.iceConnectionState!==a.Base.AbstractRTCConnectionProvider.Constants.ICE_CONNECTION_STATE_COMPLETED&&this._pc.iceConnectionState!==a.Base.AbstractRTCConnectionProvider.Constants.ICE_CONNECTION_STATE_CONNECTED||this._pc.iceGatheringState!==a.Base.AbstractRTCConnectionProvider.Constants.ICE_GATHERING_STATE_COMPLETE?(this._iceNegotiatedCallback=b,this._updateSdpCallback=e):(a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"local SDP:\n"+c.sdp),b(c))},j={type:g,sdp:h};this._pc.setLocalDescription(new d(j),function(){a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"After createOffer.setLocalDescription"),this._pc.iceConnectionState!==a.Base.AbstractRTCConnectionProvider.Constants.ICE_CONNECTION_STATE_COMPLETED&&this._pc.iceConnectionState!==a.Base.AbstractRTCConnectionProvider.Constants.ICE_CONNECTION_STATE_CONNECTED||!this._browserRequiresTimeForICEGathering()?i.call(this,j):(this._iceNegotiatedCallback=b,this._updateSdpCallback=e)}.bind(this),function(b){a.Base.Logger.error(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Error setting local description for offer: "+b),c(b)}.bind(this))}.bind(this),function(b){a.Base.Logger.error(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Error creating offer: "+b),c(b)}.bind(this),h)},b.prototype.receiveAnswer=function(a,b,c){this._pc.setRemoteDescription(new d({type:"answer",sdp:a}),b,c)},b.prototype.createAnswer=function(b,c,e,f){a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"createAnswer offer SDP:\n"+b),this._pc.setRemoteDescription(new d({type:"offer",sdp:b}),function(){this._pc.onicecandidate=this._onIceCandidate.bind(this),this._pc.oniceconnectionstatechange=this._oniceConnectionStateChange.bind(this,c),this._pc.createAnswer(function(g){a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"after createAnswer");var h=g.type,i=g.sdp,j=a.Base.SDPUtil.getProfileLevelId(b);a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"offer profile-level-id; ",j),"424028"===j&&(i=a.Base.SDPUtil.updateProfileLevelId(i,"424028")),"function"==typeof f&&(i=f(i));var k=function(b){this._pc.iceConnectionState!==a.Base.AbstractRTCConnectionProvider.Constants.ICE_CONNECTION_STATE_COMPLETED&&this._pc.iceConnectionState!==a.Base.AbstractRTCConnectionProvider.Constants.ICE_CONNECTION_STATE_CONNECTED||this._pc.iceGatheringState!==a.Base.AbstractRTCConnectionProvider.Constants.ICE_GATHERING_STATE_COMPLETE?(this._iceNegotiatedCallback=c,this._updateSdpCallback=f):(a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"local SDP:\n"+b.sdp),c(b))},l={type:h,sdp:i};this._pc.setLocalDescription(new d(l),function(){a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"After createAnswer.setLocalDescription"),this._pc.iceConnectionState!==a.Base.AbstractRTCConnectionProvider.Constants.ICE_CONNECTION_STATE_COMPLETED&&this._pc.iceConnectionState!==a.Base.AbstractRTCConnectionProvider.Constants.ICE_CONNECTION_STATE_CONNECTED||!this._browserRequiresTimeForICEGathering()?k.call(this,l):(this._iceNegotiatedCallback=c,this._updateSdpCallback=f)}.bind(this),function(b){a.Base.Logger.error(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Error while setting answer as local description: "+b),e(b)}.bind(this))}.bind(this),function(b){a.Base.Logger.error(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Error while creating answer for offer: "+b),e(b)}.bind(this))}.bind(this),function(b){a.Base.Logger.error(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Error setting remote description while creating answer: "+b),e(b)}.bind(this))},b.prototype.close=function(){if(this._pc){(a.Base.Utils.isDefined(this._pc.connectionState)?this._pc.connnectionState:this._pc.signalingState)!==a.Base.AbstractRTCConnectionProvider.Constants.RTC_PEER_CONNECTION_STATE_CLOSED&&this._pc.close(),this._mediaStreams=[]}},b.prototype.onAddStream=function(a){},b.prototype._getDTMFSender=function(){},b.prototype._onIceCandidate=function(b){if(a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"onIceCandidate "+this._pc.iceGatheringState),
null===b.candidate&&this._pc.iceGatheringState===a.Base.AbstractRTCConnectionProvider.Constants.ICE_GATHERING_STATE_COMPLETE){if(a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"NO more ICE candidate. GatheringState: "+this._pc.iceGatheringState),a.Base.Utils.isDefined(this._iceNegotiatedCallback)){if("function"==typeof this._updateSdpCallback){var c=this._updateSdpCallback(this._pc.localDescription.sdp),d={type:this._pc.localDescription.type,sdp:c};a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"local SDP:\n"+c),this._iceNegotiatedCallback(d)}else a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"local SDP:\n"+this._pc.localDescription.sdp),this._iceNegotiatedCallback(this._pc.localDescription);this._iceNegotiatedCallback=void 0,this._updateSdpCallback=void 0}}else a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Candidate: "+(null===b.candidate?null:b.candidate.candidate))},b.prototype._oniceConnectionStateChange=function(b,c){if(a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"oniceConnectionStateChange ["+this._pc.iceConnectionState+", "+this._pc.iceGatheringState+"]"),(this._pc.iceConnectionState===a.Base.AbstractRTCConnectionProvider.Constants.ICE_CONNECTION_STATE_COMPLETED||this._pc.iceConnectionState===a.Base.AbstractRTCConnectionProvider.Constants.ICE_CONNECTION_STATE_CONNECTED)&&this._pc.iceGatheringState===a.Base.AbstractRTCConnectionProvider.Constants.ICE_GATHERING_STATE_COMPLETE&&!this._browserRequiresTimeForICEGathering()&&a.Base.Utils.isDefined(this._iceNegotiatedCallback)){if("function"==typeof this._updateSdpCallback){var d=this._updateSdpCallback(this._pc.localDescription.sdp),e={type:this._pc.localDescription.type,sdp:d};a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"local SDP:\n"+d),this._iceNegotiatedCallback(e)}else a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"local SDP:\n"+this._pc.localDescription.sdp),this._iceNegotiatedCallback(this._pc.localDescription);this._iceNegotiatedCallback=void 0,this._updateSdpCallback=void 0}},b.prototype.stopAllStreams=function(){},b.prototype.enableAllStreams=function(){this.enableLocalStreams(),this.enableRemoteStreams()},b.prototype.enableRemoteStreams=function(){this._enableDisableRemoteStreams(!0)},b.prototype.disableRemoteStreams=function(){this._enableDisableRemoteStreams(!1)},b.prototype._enableDisableRemoteStreams=function(a){},b.prototype.enableLocalStreams=function(){this._enableDisableLocalStreams(!0)},b.prototype.disableLocalStreams=function(){this._enableDisableLocalStreams(!1)},b.prototype._enableDisableLocalStreams=function(a){},b.prototype.enableLocalAudioStreams=function(){this._enableDisableLocalAudioStreams(!0)},b.prototype.disableLocalAudioStreams=function(){this._enableDisableLocalAudioStreams(!1)},b.prototype._enableDisableLocalAudioStreams=function(a){},b.prototype.enableLocalVideoStreams=function(){this._enableDisableLocalVideoStreams(!0)},b.prototype.disableLocalVideoStreams=function(){this._enableDisableLocalVideoStreams(!1)},b.prototype._enableDisableLocalVideoStreams=function(a){},b.prototype.enableRemoteVideoStreams=function(){this._enableDisableRemoteVideoStreams(!0)},b.prototype.disableRemoteVideoStreams=function(){this._enableDisableRemoteVideoStreams(!1)},b.prototype._enableDisableRemoteVideoStreams=function(a){},b.prototype.enableVideoTrack=function(b,c){b.getVideoTracks().forEach(function(d){d.id===c.id?(a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Enabling video track: "+d.id+"for "+b.id),d.enabled=!0):(a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Disabling old video track: "+d.id+"for "+b.id),d.enabled=!1)}.bind(this))},b.prototype.sendDTMF=function(b){var c=this._getDTMFSender();return!!a.Base.Utils.isDefined(c)&&(c.insertDTMF(b),!0)},b.prototype.playAudioStream=function(b,c){return!!(b&&c.getAudioTracks().length>0)&&(this.isPlaying(b)||(b.src=URL.createObjectURL(c),b.play(),a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Playing audio track: "+c.getAudioTracks()[0].id)),!0)},b.prototype.isPlaying=function(a){return!!(a.currentTime>0&&!a.paused&&!a.ended&&a.readyState>2)},b.prototype.stopStream=function(b){a.Base.Utils.isDefined(b)&&null!==b&&b.getTracks().forEach(function(a){a.stop()})},b.prototype.hasVideo=function(a){return a&&a.getVideoTracks().length>0},b.prototype._createOfferOptions=function(a){return{offerToReceiveAudio:!0,offerToReceiveVideo:a}},b.prototype._browserRequiresTimeForICEGathering=function(){return!1},b.prototype.addTrack=function(a,b){},b.prototype.removeLocalAudioTrack=function(){},b.prototype.replaceLocalVideoTrack=function(a){},a.Base.AbstractRTCConnectionProvider=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){a.Base.AbstractRTCConnectionProvider.call(this,b)}b.prototype=Object.create(a.Base.AbstractRTCConnectionProvider.prototype),b.prototype.addStream=function(a){a.getTracks().forEach(function(b){this.addTrack(b,a)}.bind(this))},b.prototype.removeStream=function(b){this._pc.getSenders().forEach(function(c){b.getTracks().forEach(function(b){b.id===c.track.id&&(a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Stopping and removing track: "+b.kind+" : "+b.id),b.stop(),this._pc.removeTrack(c))}.bind(this))}.bind(this))},b.prototype.createPeerConnection=function(b){a.Base.AbstractRTCConnectionProvider.prototype.createPeerConnection.call(this,b),this._pc.ontrack=this.onTrackInternal.bind(this)},b.prototype.onTrackInternal=function(a){if(this.onAddStream&&a.streams.length>0){0===this._mediaStreams.filter(function(b){return b.id===a.streams[0].id}.bind(this)).length&&(this._mediaStreams.push(a.streams[0]),this.onAddStream(a.streams[0]))}},b.prototype._getDTMFSender=function(){return a.Base.Utils.isDefined(this._dtmfSender)||this._pc.getSenders().forEach(function(a){a.track instanceof AudioStreamTrack&&(this._dtmfSender=a.dtmf)}),this._dtmfSender},b.prototype.stopAllStreams=function(){this._pc.getSenders().forEach(function(a){a.track.stop(),this._pc.removeTrack(a)}.bind(this)),this._pc.getReceivers().forEach(function(a){a.track.stop()}.bind(this))},b.prototype._enableDisableRemoteStreams=function(b){this._pc.getReceivers().forEach(function(c){c.track.readyState===a.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE&&(a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(b?"Enabling remote ":"Disabling remote ")+c.track.kind+" track: "+c.track.id),c.track.enabled=b)})},b.prototype._enableDisableLocalStreams=function(b){this._pc.getSenders().forEach(function(c){c.track.readyState===a.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE&&(a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(b?"Enabling local ":"Disabling local ")+c.track.kind+" track: "+c.track.id),c.track.enabled=b)})},b.prototype._enableDisableLocalAudioStreams=function(b){this._pc.getSenders().forEach(function(c){c.track.kind===a.Providers.Call.CallProvider.Constants.AUDIO_TRACK&&c.track.readyState===a.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE&&(a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(b?"Enabling":"Disabling")+" local audio track: "+c.track.id),c.track.enabled=b)}.bind(this))},b.prototype._enableDisableLocalVideoStreams=function(b){this._pc.getSenders().forEach(function(c){c.track.kind===a.Providers.Call.CallProvider.Constants.VIDEO_TRACK&&c.track.readyState===a.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE&&(a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(b?"Enabling":"Disabling")+" local video track: "+c.track.id),c.track.enabled=b)}.bind(this))},b.prototype._enableDisableRemoteVideoStreams=function(b){this._pc.getReceivers().forEach(function(c){c.track.kind===a.Providers.Call.CallProvider.Constants.VIDEO_TRACK&&c.track.readyState===a.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE&&(a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(b?"Enabling":"Disabling")+" remote video track: "+c.track.id),c.track.enabled=b)}.bind(this))},b.prototype._browserRequiresTimeForICEGathering=function(){return!0},b.prototype.addTrack=function(b,c){a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Adding local track: "+b.kind+" : "+b.id);var d=this._pc.addTrack(b,c);b.kind===a.Providers.Call.CallProvider.Constants.AUDIO_TRACK&&a.Base.Utils.isDefined(d.dtmf)&&(this._dtmfSender=d.dtmf)},b.prototype.removeLocalAudioTrack=function(){this._pc.getSenders().forEach(function(b){b.track instanceof AudioStreamTrack&&(a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Removing local audio track: "+b.track.id),b.track.stop(),this._pc.removeTrack(b))}.bind(this))},b.prototype.replaceLocalVideoTrack=function(b){this._pc.getSenders().forEach(function(c){c.track instanceof VideoStreamTrack&&(a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Replacing local video track  "+c.track.id+" with "+b.id),c.track.stop(),c.replaceTrack(b))})},a.Base.FirefoxRTCConnectionProvider=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){a.Base.AbstractRTCConnectionProvider.call(this,b)}b.prototype=Object.create(a.Base.AbstractRTCConnectionProvider.prototype),b.prototype.addStream=function(a){this._pc.addStream(a)},b.prototype.removeStream=function(a){this._pc.removeStream(a)},b.prototype.createPeerConnection=function(b){a.Base.AbstractRTCConnectionProvider.prototype.createPeerConnection.call(this,b),this._pc.onaddstream=this.onAddStreamInternal.bind(this)},b.prototype.onAddStreamInternal=function(a){this.onAddStream&&a.stream&&this.onAddStream(a.stream)},b.prototype._getDTMFSender=function(){if(!a.Base.Utils.isDefined(this._dtmfSender)){var b;this._pc.getLocalStreams().forEach(function(c){b=c.getAudioTracks()[0],a.Base.Utils.isDefined(b)&&(this._dtmfSender=this._pc.createDTMFSender(b))}.bind(this))}return this._dtmfSender},b.prototype.stopAllStreams=function(){this._pc.getLocalStreams().forEach(function(a){a.getAudioTracks().forEach(function(a){a.stop()}),a.getVideoTracks().forEach(function(a){a.stop()})}),this._pc.getRemoteStreams().forEach(function(a){a.getAudioTracks().forEach(function(a){a.stop()}),a.getVideoTracks().forEach(function(a){a.stop()})})},b.prototype._enableDisableRemoteStreams=function(b){this._pc.getRemoteStreams().forEach(function(c){c.getAudioTracks().forEach(function(c){c.readyState!==a.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_ENDED&&(a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(b?"Enabling":"Disabling")+" remote audio track: "+c.id),c.enabled=b)}),c.getVideoTracks().forEach(function(c){c.readyState!==a.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_ENDED&&(a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(b?"Enabling":"Disabling")+" remote video track: "+c.id),c.enabled=b)})})},b.prototype._enableDisableLocalStreams=function(b){this._pc.getLocalStreams().forEach(function(c){c.getAudioTracks().forEach(function(c){c.readyState!==a.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_ENDED&&(a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(b?"Enabling":"Disabling")+" local audio track: "+c.id),c.enabled=b)}),c.getVideoTracks().forEach(function(c){c.readyState!==a.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_ENDED&&(a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(b?"Enabling":"Disabling")+" local video track: "+c.id),c.enabled=b)})})},b.prototype._enableDisableLocalAudioStreams=function(b){this._pc.getLocalStreams().forEach(function(c){c.getAudioTracks().forEach(function(c){c.readyState!==a.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_ENDED&&(a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(b?"Enabling":"Disabling")+" local audio track: "+c.id),c.enabled=b)})})},b.prototype._enableDisableLocalVideoStreams=function(b){this._pc.getLocalStreams().forEach(function(c){c.getVideoTracks().forEach(function(c){c.readyState!==a.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_ENDED&&(a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(b?"Enabling":"Disabling")+" local video track: "+c.id),c.enabled=b)})})},b.prototype._enableDisableRemoteVideoStreams=function(b){this._pc.getRemoteStreams().forEach(function(c){c.getVideoTracks().forEach(function(c){c.readyState!==a.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_ENDED&&(a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(b?"Enabling":"Disabling")+" remote video track: "+c.id),c.enabled=b)})})},a.Base.RTCConnectionProvider=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";var b={ICE_GATHERING_STATE_COMPLETE:"complete",ICE_CONNECTION_STATE_COMPLETED:"completed",ICE_CONNECTION_STATE_CONNECTED:"connected",RTC_PEER_CONNECTION_STATE_CLOSED:"closed",MEDIA_STREAM_TRACK_READY_STATE_LIVE:"live",MEDIA_STREAM_TRACK_READY_STATE_ENDED:"ended"};a.Base.AbstractRTCConnectionProvider.Constants=b}(AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(){}b.prototype={create:function(b){var c=a.Base.Utils.getBrowserType();return c===a.Base.BrowserType.CHROME||c===a.Base.BrowserType.CHROME_EXTENSION?new a.Base.RTCConnectionProvider(b):new a.Base.FirefoxRTCConnectionProvider(b)}},a.Base.RTCConnectionProviderFactory=b}(AvayaClientServices),function(a){"use strict";var b="m=audio",c="m=video",d="a=recvonly",e="a=sendonly",f="a=sendrecv ",g="a=inactive",h="profile-level-id";a.Base.SDPUtil={updateAudioSdpInactive:function(c){return a.Base.SDPUtil.updateSdp(c,b,g)},updateAudioSdpRecvOnly:function(c){return a.Base.SDPUtil.updateSdp(c,b,d)},updateAudioSdpSendOnly:function(c){return a.Base.SDPUtil.updateSdp(c,b,e)},updateAudioSdpSendRecv:function(c){return a.Base.SDPUtil.updateSdp(c,b,f)},updateVideoSdpInactive:function(b){return a.Base.SDPUtil.updateSdp(b,c,g)},updateVideoSdpRecvOnly:function(b){return a.Base.SDPUtil.updateSdp(b,c,d)},updateVideoSdpSendOnly:function(b){return a.Base.SDPUtil.updateSdp(b,c,e)},updateVideoSdpSendRecv:function(b){return a.Base.SDPUtil.updateSdp(b,c,f)},updateSdp:function(a,d,e){if(-1===a.indexOf(d))return a;var f=a.indexOf(b),g=a.indexOf(c);return d===b?f<g?a.substring(0,f)+a.substring(f,g).replace(/a=inactive|a=sendrecv|a=recvonly|a=sendonly/,e)+a.substring(g):a.substring(0,f)+a.substring(f).replace(/a=inactive|a=sendrecv|a=recvonly|a=sendonly/,e):g<f?a.substring(0,g)+a.substring(g,f).replace(/a=inactive|a=sendrecv|a=recvonly|a=sendonly/,e)+a.substring(f):a.substring(0,g)+a.substring(g).replace(/a=inactive|a=sendrecv|a=recvonly|a=sendonly/,e)},rejectMedia:function(a,d){return-1===a.indexOf(d)?a:d===b?a.replace(/(m=audio)\s+(\d+)\s+(.*)/,"m=audio 0 $3"):d===c?a.replace(/(m=video)\s+(\d+)\s+(.*)/,"m=video 0 $3"):a},updateProfileLevelId:function(b,c){var d=b.indexOf(h);if(d>-1){var e=b.substring(d+h.length+1,d+h.length+1+6);e!==c&&(b=b.replace(e,c),a.Base.Logger.debug(a.Base.LoggerTags.UTILS,"CHANGED the profile-level-id value of the SDP from:",e,"to:",c))}return b},getProfileLevelId:function(a){var b=a.indexOf(h);if(b>-1)return a.substring(b+h.length+1,b+h.length+1+6)}}}(AvayaClientServices),function(a){"use strict";function b(a,b,c){this._data="",this._currentLineIndex=0,this._getSettingsFileVariable="function"==typeof a?a:void 0,this._setSettingsFileVariable="function"==typeof b?b:void 0,this._onAdditionalSettingsFileRequested="function"==typeof c?c:void 0}var c="GOTO";b.prototype.parse=function(a){return"string"!=typeof a||0===a.length||(this._data=a,this._currentLineIndex=0,this.proceed())},b.prototype.proceed=function(){for(var b,d,e=this._splitByLines(this._data),f=e.length,g=!0;this._currentLineIndex<f;this._currentLineIndex++)if(d=e[this._currentLineIndex].trim(),0!==d.length&&"#"!==d.charAt(0)){var h=this._getLineArr(d),i=h.length;if(i){var j=h[0].toUpperCase(),k=h.slice(1);switch(j){case"SET":this._processSET(k);break;case c:(b=this._processGOTO(k))>=0&&(this._currentLineIndex=b);break;case"IF":(b=this._processIF(k))>=0&&(this._currentLineIndex=b);break;case"GET":this._currentLineIndex++,g=this._processGET(k);break;default:a.Base.Logger.warn(a.Base.LoggerTags.SETTINGS_FILE_PARSER,"SettingsFileParser: Unknown command",j)}}if(!g)return!1}return!0},b.prototype._splitByLines=function(a){return a.split(/\r\n|\r|\n/g)},b.prototype._trimSharp=function(a){return a.trim().replace(/^#+|#+$/g,"").trim()},b.prototype._getLineArr=function(a){var b=a.match(/("([^"]*)"|([^"\s]+))+(?=(\s*|\s*$))/g)||[];return b.length&&b.forEach(function(a,c,d){b[c]=a.replace(/"/g,"")}),b},b.prototype._processSET=function(a){if(this._setSettingsFileVariable){var b=a.length;if(b){var c=a[0],d=b>1?a[1]:"";this._setSettingsFileVariable(c,d)}}},b.prototype._processGET=function(a){return!this._onAdditionalSettingsFileRequested||!a.length||(this._onAdditionalSettingsFileRequested(a[0]),!1)},b.prototype._processGOTO=function(a){var b=-1;if(a.length)for(var c,d,e=a[0],f=this._splitByLines(this._data),g=f.length,h=0;h<g;h++)if(d=f[h].trim(),"#"===d.charAt(0)&&"#"!==d.charAt(1)&&(c=this._trimSharp(d),e===c)){b=h;break}return b},b.prototype._processIF=function(a){if(!this._getSettingsFileVariable)return-1;if(a.length<5)return-1;var b=a[0],d=a[1],e=a[2],f=a[3],g=a[4];return b.toString().length<=1||"$"!==b.charAt(0)?-1:"SEQ"!==d.toUpperCase()?-1:0===e.toString().length?-1:f.toUpperCase()!==c?-1:(b=b.substr(1).toUpperCase(),this._getSettingsFileVariable(b)===e?this._processGOTO([g]):-1)},a.Base.SettingsFileParser=b}(AvayaClientServices),function(a){"use strict";function b(){this._handlers={},this.currentState=null}a.Base.SimpleFsm=function(){},b.prototype={handleEvent:function(b){if(!b.stringValue)return void a.Base.Logger.error(a.Base.LoggerTags.FSM,"Unknown event: "+b);if(!this.currentState||!this._handlers)return void a.Base.Logger.error(a.Base.LoggerTags.FSM,"State machine's state was not initialized");if(!this._handlers[this.currentState.stringValue])return void a.Base.Logger.error(a.Base.LoggerTags.FSM,"No handler bound for state "+this.currentState.stringValue+" and event "+b.stringValue);if(!this._handlers[this.currentState.stringValue][b.stringValue])return void a.Base.Logger.error(a.Base.LoggerTags.FSM,"No handler bound for state "+this.currentState.stringValue+" and event "+b.stringValue);a.Base.Logger.debug(a.Base.LoggerTags.FSM,"Executing handler for state "+this.currentState.stringValue+" and event "+b.stringValue+" "+this._handlers[this.currentState.stringValue][b.stringValue].name);var c=this._handlers[this.currentState.stringValue][b.stringValue](b);a.Base.Logger.debug(a.Base.LoggerTags.FSM,"Executed handler "+this._handlers[this.currentState.stringValue][b.stringValue].name),c&&c.nextState&&(a.Base.Logger.debug(a.Base.LoggerTags.FSM,"Next state: "+c.nextState.stringValue),this.currentState=c.nextState),c&&c.nextEvent&&(a.Base.Logger.debug(a.Base.LoggerTags.FSM,"Next event: "+c.nextEvent.stringValue),this.handleEvent(c.nextEvent))},registerHandler:function(a,b,c){if(this._handlers[a.stringValue]||(this._handlers[a.stringValue]={}),this._handlers[a.stringValue][b.stringValue])throw"Duplicate FSM registration state "+a.stringValue+" event "+b.stringValue;this._handlers[a.stringValue][b.stringValue]=c},registerNoOpHandler:function(a,b){this.registerHandler(a,b,function(){})},start:function(a){this.currentState=a}},a.Base.SimpleFsm.SimpleFsm=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(a,b){this.stringValue=a,this.data=b}b.prototype={},a.Base.SimpleFsm.SimpleFsmEvent=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(a){this.stringValue=a}b.prototype={},a.Base.SimpleFsm.SimpleFsmState=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";var b="AVAYA_JSCSDK_1.0";a.Base.Storage={TYPES:{LOCAL:window.localStorage,SESSION:window.sessionStorage},get:function(a,c){if(a){a[b]||this._initNamespace(a);return JSON.parse(a[b])[c]}},set:function(a,c,d){if(!a)return!1;a[b]||this._initNamespace(a);var e=JSON.parse(a[b]);return e[c]=d,a[b]=JSON.stringify(e),!0},_initNamespace:function(a){return a[b]=JSON.stringify({}),!0}}}(AvayaClientServices),function(a){"use strict";function b(a,b,c){Error.call(this,a),this.message=a,this.validatedObject=b,this.violatedRule=c,this.name="ValidationError"}b.prototype=Object.create(Error.prototype),a.Base.ValidationError=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={validate:function(){throw new Error("Function is not implemented!")},_processCondition:function(a,b,c,d){if(a)return!0;var e=c.message||this.defaultMessage;return this._handleValidationError(e,b,c,d)},_handleValidationError:function(b,c,d,e){if(e)return!1;throw new a.Base.ValidationError(b,c,d)}},a.Base.Validators.BaseValidator=b}(AvayaClientServices),function(a){"use strict";function b(){this.defaultMessage="Provided element is not defined."}b.prototype=Object.create(a.Base.Validators.BaseValidator.prototype),b.prototype.validate=function(a,b,c){var d=void 0!==a;return this._processCondition(d,a,b,c)},a.Base.Validators.DefinedValidator=b}(AvayaClientServices),function(a){"use strict";function b(){this.defaultMessage="Provided element is not compatible with required type."}b.prototype=Object.create(a.Base.Validators.BaseValidator.prototype),b.prototype.validate=function(a,b,c){var d=typeof a===b.expected||"object"==typeof a&&a instanceof b.expected;return this._processCondition(d,a,b,c)},a.Base.Validators.TypeValidator=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d,e){this._width=a,this._height=b,this._fps=e||30,this._minBandwidth=c,this._maxBandwidth=d}b.prototype={getWidth:function(){return this._width},getHeight:function(){return this._height},getFPS:function(){return this._fps},getMinBandwidth:function(){return this._minBandwidth},getMaxBandwidth:function(){return this._maxBandwidth}},a.Base.VideoResolutionDetails=b}(AvayaClientServices),function(a){"use strict";function b(){this._onInvalidCredentialsProvidedCallbacks=$.Callbacks()}b.prototype={onAuthenticationChallenge:function(a,b){},addOnInvalidCredentialsCallback:function(a){this._onInvalidCredentialsProvidedCallbacks.add(a)},removeOnInvalidCredentialsCallback:function(a){this._onInvalidCredentialsProvidedCallbacks.remove(a)}},a.Config.AbstractCredentialProvider=b}(AvayaClientServices),function(a){"use strict";function b(){this.enabled=!1,this.credentialProvider=new a.Config.AbstractCredentialProvider,this.networkProviderConfiguration=new a.Config.NetworkProviderConfiguration}b.prototype={},a.Config.ACSConfiguration=b}(AvayaClientServices),function(a){"use strict";function b(){this.enabled=!1,this.pollingIntervalInMinutes=0,this.networkProviderConfiguration=new a.Config.NetworkProviderConfiguration,this.credentialProvider=new a.Config.CredentialProvider}b.prototype={},a.Config.AMMConfiguration=b}(AvayaClientServices),function(a){"use strict";function b(){this.enabled=!1}a.Config.AnalyticsConfiguration=b}(AvayaClientServices),function(a){"use strict";function b(){this.incomingCall=!1,this.videoEnabled=!1,this.incomingVideoRequestTimeout=c.INCOMING_VIDEO_REQUEST_TIMEOUT,this.videoMaxBandwidthAnyNetwork=c.VIDEO_MAX_BANDWIDTH_ANY_NETWORK}var c={INCOMING_VIDEO_REQUEST_TIMEOUT:15e3,VIDEO_MAX_BANDWIDTH_ANY_NETWORK:1024};a.Config.CallUserConfiguration=b,a.Config.CallUserConfiguration.DefaultValues=c}(AvayaClientServices),function(a){"use strict";function b(){this.contentSharingWorkerPath=void 0}a.Config.CollaborationConfiguration=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d){a.Config.AbstractCredentialProvider.call(this),this.username=b,this.password=c,this.domain=d,this.displayName="",this.isGuest=!1}b.prototype=Object.create(a.Config.AbstractCredentialProvider.prototype),b.prototype.onAuthenticationChallenge=function(a,b){b({username:this.username,password:this.password,domain:this.domain,isGuest:this.isGuest,displayName:this.displayName})},a.Config.CredentialProvider=b}(AvayaClientServices),function(a){"use strict";function b(b){a.Config.AbstractCredentialProvider.call(this),this.token=b}b.prototype=Object.create(a.Config.AbstractCredentialProvider.prototype),b.prototype.onAuthenticationChallenge=function(a,b){b({token:this.token})},a.Config.CredentialTokenProvider=b}(AvayaClientServices),function(a){"use strict";function b(b){a.Config.CredentialProvider.call(this),this.username=this._createGuestUser(),this.password="",this.domain="",this.displayName=b,this.isGuest=!0}b.prototype=Object.create(a.Config.CredentialProvider.prototype),b.prototype.getDisplayName=function(){return encodeURI(this.displayName)},b.prototype.setDisplayName=function(a){this.displayName=a},b.prototype._generateUUID=function(){var a=window.crypto||window.msCrypto;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=a.getRandomValues(new Uint8Array(1))[0]%16|0;return("x"===b?c:3&c|8).toString(16)})},b.prototype._createGuestUser=function(){return"csaGuest/jsg-"+this._generateUUID()},a.Config.GuestCredentialProvider=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c){this._failureCount=a,this._retryCallback=b,this._cancelCallback=c}b.prototype={getFailureCount:function(){return this._failureCount},retry:function(a){this._retryCallback(a)},cancel:function(){this._cancelCallback()}},a.Config.InvalidCredentialsEvent=b}(AvayaClientServices),function(a){"use strict";function b(){this.voipConfigurationAudio=new a.Config.VoIPConfigurationAudio,this.voipConfigurationVideo=new a.Config.VoIPConfigurationVideo}b.prototype={},a.Config.MediaConfiguration=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d){this.webSocketConfig=b,this.sseConfig=c,this.restConfig=a,this.maxConnectionErrorCount=d||5}b.prototype={},a.Config.NetworkProviderConfiguration=b}(AvayaClientServices),function(a){"use strict";function b(){this.enabled=!1}a.Config.PresenceConfiguration=b}(AvayaClientServices),function(a){"use strict";var b={BEST_EFFORT:"BEST_EFFORT",DISABLED:"DISABLED",REQUIRED:"REQUIRED"};a.Config.SecurityPolicy=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d,e,f){this.hostName=a||"",this.port=b,this.isSecure=!!c,this.path=d||"",this.credentials=e||"",this.query=f||""}b.prototype={getUrl:function(a){var b=a?"ws":"http";return this.isSecure&&(b+="s"),b+="://",this.credentials&&(b+=this.credentials+"@"),b=+this.hostName,this.port&&(b+=":"+this.port),b+=this.path,b+=this.query}},a.Config.ServerInfo=b}(AvayaClientServices),function(a){"use strict";function b(){this.enabled=!1,this.networkProviderConfiguration=new a.Config.NetworkProviderConfiguration,this.credentialProvider=new a.Config.CredentialProvider}b.prototype={},a.Config.SGConfiguration=b}(AvayaClientServices),function(a){"use strict";function b(){this.enabled=!1,this.networkProviderConfiguration=new a.Config.NetworkProviderConfiguration,this.credentialProvider=new a.Config.CredentialProvider}b.prototype={},a.Config.UCCPConfiguration=b}(AvayaClientServices),function(a){"use strict";function b(){this.applicationBuildNumber="",this.applicationProductName="",this.applicationProductVersion="",this.ammConfiguration=new a.Config.AMMConfiguration,this.acsConfiguration=new a.Config.ACSConfiguration,this.uccpConfiguration=new a.Config.UCCPConfiguration,this.sgConfiguration=new a.Config.SGConfiguration,this.callUserConfiguration=new a.Config.CallUserConfiguration,this.presenceConfiguration=new a.Config.PresenceConfiguration,this.wcsConfiguration=new a.Config.WCSConfiguration,this.mediaConfiguration=new a.Config.MediaConfiguration,this.collaborationConfiguration=new a.Config.CollaborationConfiguration,this.analyticsConfiguration=new a.Config.AnalyticsConfiguration}b.prototype={},a.Config.UserConfiguration=b}(AvayaClientServices),function(a){"use strict";var b={RESOLUTION_1080p:"resolution1080p",RESOLUTION_720p:"resolution720p",RESOLUTION_480p:"resolution480p",RESOLUTION_360p:"resolution360p",RESOLUTION_240p:"resolution240p",RESOLUTION_180p:"resolution180p"};a.Config.VideoResolution=b}(AvayaClientServices),function(a){"use strict";function b(){this.bgnMode=!1,this.codecList=[],this.echoMode=!1,this.mediaMode=!1,this.mobileEchoMode=!1,this.noiseSupMode=!1,this.opusMode=!1,this.receiveGainMode=!1,this.receiveSupMode=!1,this.transmitGainMode=!1,this.vadMode=!1}b.prototype={},a.Config.VoIPConfigurationAudio=b}(AvayaClientServices),function(a){"use strict";function b(){this.anyNetworkBandwidthMode=!1,this.congestionControlAlgorithm=!1,this.videoResolution=a.Config.VideoResolution.RESOLUTION_720p,this.presenationHigherPriorityThanPeopleVideo=!0}b.prototype={},a.Config.VoIPConfigurationVideo=b}(AvayaClientServices),function(a){"use strict";function b(){this.enabled=!1,this.networkProviderConfiguration=new a.Config.NetworkProviderConfiguration,this.credentialProvider=new a.Config.CredentialProvider}b.prototype={},a.Config.WCSConfiguration=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d,e,f){a.Config.AbstractCredentialProvider.call(this),this.token=b,this.username=c,this.attendeeId=d,this.sessionId=e,this.mode=f}b.prototype=Object.create(a.Config.AbstractCredentialProvider.prototype),b.prototype.onAuthenticationChallenge=function(b,c){c(new a.Config.WCSCredentials(this.token,this.username,this.attendeeId,this.sessionId,this.mode))},a.Config.WCSCredentialTokenProvider=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d,e){this.token=a,this.username=b,this.participantId=c,this.sessionId=d,this.mode=e}a.Config.WCSCredentials=b}(AvayaClientServices),function(a){"use strict";var b={SVC_GET_CONTACTS:"getContacts",SVC_SEARCH_CONTACTS:"searchContacts",BASIC_AUTHORIZATION_WITH_SPACE:"Basic ",BEARER_AUTHORIZATION_WITH_SPACE:"Bearer ",UPTOKEN:"UPToken",TERMINAL_TYPE:"TERMINAL",PROVENANCE_TYPE_AVAYA:"Avaya",PROVENANCE_SUBTYPE_ADMINISTERED:"Administered"};a.Providers.ACS.ACSConstants=b}(AvayaClientServices),function(a){"use strict";function b(){this._quickSerachCache=new a.Base.SimpleIMDB(["searchString","searchScope"],{maxElements:250,timeToLive:1728e5,auditInterval:5e3})}b.prototype.addQuickSearchResultsToCache=function(a){for(var b,c,d=[],e=this._quickSerachCache.getCacheMaxSize(),f=this._trimToCacheMaxSize(a,e),g=0;g<f.length;g++)b={searchString:[f[g].searchString],searchScope:[f[g].searchScope]},c={keys:b,element:f[g]},d.push(c);this._quickSerachCache.addElements(d)},b.prototype.getQuickSearchResultsFromCache=function(b,c){var d={searchString:[b],searchScope:[c]};return this._quickSerachCache.searchByKeys(d,a.Base.IMDBSearchOptions.EXACT_MATCH)},b.prototype._trimToCacheMaxSize=function(a,b){return b&&a.length>b?a.slice(-b):a.slice()},a.Providers.ACS.ACSContactsCache=b}(AvayaClientServices),function(a,b){"use strict";function c(){}c.prototype={convertACSContactArraytoContactArray:function(a){var b=[];if(a&&a.length>0)for(var c=0;c<a.length;c++)b.push(this.convertACSContactV1toContact(a[c]));return b},convertACSContactV1toContact:function(b){var c=a.Base.Utils,d=new a.Services.Contacts.Contact;if(c.isDefined(b)){c.isDefined(b.contactUrl)&&c.isDefined(b.contactUrl.value)&&(d._uniqueAddressForMatching=b.contactUrl.value);var e=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),f=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),g=function(a,b,d){if(c.isDefined(a)&&c.isDefined(a.value)){var g;"string"===d?g=a.value:"boolean"===d?g="true"===a.value:"float"===d&&(g=parseFloat(a.value)),b()._value=g}
var h=c.isDefined(a)&&c.isDefined(a.editable)&&!a.editable;b()._setWriteCapability(h?e:f)};if(g(b.surName,d.getLastName.bind(d),"string"),g(b.givenName,d.getFirstName.bind(d),"string"),g(b.displayName,d.getDisplayName.bind(d),"string"),g(b.asciiSurName,d.getASCIILastName.bind(d),"string"),g(b.asciiGivenName,d.getASCIIFirstName.bind(d),"string"),g(b.asciiDisplayName,d.getASCIIDisplayName.bind(d),"string"),g(b.alias,d.getAlias.bind(d),"string"),g(b.location,d.getLocation.bind(d),"string"),g(b.workRoomNo,d.getWorkRoomNumber.bind(d),"string"),g(b.streetAddress,d.getStreetAddress.bind(d),"string"),g(b.city,d.getCity.bind(d),"string"),g(b.state,d.getState.bind(d),"string"),g(b.country,d.getCountry.bind(d),"string"),g(b.postalCode,d.getPostalCode.bind(d),"string"),g(b.company,d.getCompany.bind(d),"string"),g(b.manager,d.getManager.bind(d),"string"),g(b.department,d.getDepartment.bind(d),"string"),g(b.preferredLanguage,d.getLanguage.bind(d),"string"),g(b.notes,d.getNotes.bind(d),"string"),g(b.scopiaUserId,d.getScopiaUserId.bind(d),"string"),g(b.scopiaLoginId,d.getScopiaLoginId.bind(d),"string"),g(b.rank,d.getRank.bind(d),"float"),g(b.isBuddy,d.isBuddy.bind(d),"boolean"),g(b.favourite,d.isFavorite.bind(d),"boolean"),g(b.videoCapable,d.isVideoCapable.bind(d),"boolean"),c.isDefined(b.pictureUrl)&&c.isDefined(b.pictureUrl.value)&&""!==b.pictureUrl.value)for(var h in a.Services.Contacts.ContactPictureSize)a.Services.Contacts.ContactPictureSize.hasOwnProperty(h)&&d.addPictureUrl(h,b.pictureUrl.value+"?size="+a.Services.Contacts.ContactPictureSize[h].toLowerCase());var i;if(c.isDefined(b.emailAddresses)){var j=b.emailAddresses.length;for(i=0;i<j;i++){var k=new a.Services.Contacts.ContactEmailAddressField;c.isDefined(b.emailAddresses[i].value)&&(k._address=b.emailAddresses[i].value),c.isDefined(b.emailAddresses[i].type)&&(k._emailAddressType=this._convertACSEmailAddressTypeToContactEmailAddressType(b.emailAddresses[i].type)),b.emailAddresses[i].editable?k._setWriteCapability(f):k._setWriteCapability(e),d.getEmailAddresses().getValues().push(k)}}if(c.isDefined(b.phoneNumberList)){var l=b.phoneNumberList.length;for(i=0;i<l;i++){var m=new a.Services.Contacts.ContactPhoneField;c.isDefined(b.phoneNumberList[i].phoneNumber)&&(m._phoneNumber=b.phoneNumberList[i].phoneNumber),c.isDefined(b.phoneNumberList[i].label1)&&(m._label1=b.phoneNumberList[i].label1),c.isDefined(b.phoneNumberList[i].label2)&&(m._label2=b.phoneNumberList[i].label2),c.isDefined(b.phoneNumberList[i].type)&&(m._phoneNumberType=this._convertACSPhoneNumberTypeToContactPhoneNumberType(b.phoneNumberList[i].type)),c.isDefined(b.phoneNumberList[i].speedDialEnabled)&&(m._speedDialEnabled="true"===b.phoneNumberList[i].speedDialEnabled),c.isDefined(b.phoneNumberList[i].isPrimary)&&(m._default="true"===b.phoneNumberList[i].isPrimary),b.phoneNumberList[i].editable?m._setWriteCapability(f):m._setWriteCapability(e);var n=b.phoneNumberList[i].provenance;if(n)for(var o=0;o<n.length;o++)n[o].type===a.Providers.ACS.ACSConstants.PROVENANCE_TYPE_AVAYA&&n[o].subType===a.Providers.ACS.ACSConstants.PROVENANCE_SUBTYPE_ADMINISTERED&&m.setAvayaAdministered(!0);d.getPhoneNumbers().getValues().push(m)}}if(c.isDefined(b.imaddresses)){var p=b.imaddresses.length;for(i=0;i<p;i++){var q=new a.Services.Contacts.ContactIMAddressField;c.isDefined(b.imaddresses[i].value)&&(q._address=b.imaddresses[i].value),c.isDefined(b.imaddresses[i].type)&&(q._imAddressType=this._convertACSHandleTypeToContactHandleType(b.imaddresses[i].type)),b.imaddresses[i].editable?q._setWriteCapability(f):q._setWriteCapability(e);var r=b.imaddresses[i].provenance;if(r)for(var s=0;s<r.length;s++)r[s].type===a.Providers.ACS.ACSConstants.PROVENANCE_TYPE_AVAYA&&r[s].subType===a.Providers.ACS.ACSConstants.PROVENANCE_SUBTYPE_ADMINISTERED&&q.setAvayaAdministered(!0);d.getIMAddresses().getValues().push(q)}}if(c.isDefined(b.custom1)&&c.isDefined(b.custom1.value)){var t=new a.Services.Contacts.ContactStringField;t._value=b.custom1.value,t._setWriteCapability(e),d.getCustom1().getValues().push(t)}if(d.getCustom1()._setWriteCapability(e),c.isDefined(b.custom2)&&c.isDefined(b.custom2.value)){var u=new a.Services.Contacts.ContactStringField;u._value=b.custom2.value,u._setWriteCapability(e),d.getCustom2().getValues().push(u)}if(d.getCustom2()._setWriteCapability(e),c.isDefined(b.custom3)&&c.isDefined(b.custom3.value)){var v=new a.Services.Contacts.ContactStringField;v._value=b.custom3.value,v._setWriteCapability(e),d.getCustom3().getValues().push(v)}d.getCustom3()._setWriteCapability(e),c.isDefined(b.type)&&b.type===a.Providers.ACS.ACSConstants.TERMINAL_TYPE&&(d.getTerminal()._terminalId=b.contactIdentifier.value,d.getTerminal()._terminalName=b.givenName.value)}return d},convertQuickSearchResults:function(b,c,d){for(var e=[],f=0;f<b.length;f++){var g=c[b[f].correlationId],h=this.convertACSContactArraytoContactArray(b[f].contacts),i=new a.Services.Contacts.ResolveContactResult(g,d,h);e.push(i)}return e},convertContactToACSContactV1:function(b){return this.mergeContactWithACSContactV1(b,new a.Providers.ACS.ContactV1)},mergeContactWithACSContactV1:function(b,c){var d;if(b&&c){d=new a.Providers.ACS.ContactV1,b.getUniqueAddressForMatching()&&(d.contactUrl.value=b.getUniqueAddressForMatching()),d.id.value=c.id.value,a.Base.Utils.isDefined(b._terminal)&&""!==b.getTerminal().getTerminalId()?d.contactIdentifier.value=b.getTerminal().getTerminalId():d.contactIdentifier.value=c.contactIdentifier.value,d.pictureUrl.value=c.pictureUrl.value,d.asciiSurName.value=b.getASCIILastName().getValue(),d.asciiGivenName.value=b.getASCIIFirstName().getValue(),d.asciiDisplayName.value=b.getASCIIDisplayName().getValue(),d.surName.value=b.getLastName().getValue(),d.givenName.value=b.getFirstName().getValue(),d.displayName.value=b.getDisplayName().getValue(),d.alias.value=b.getAlias().getValue(),d.location.value=b.getLocation().getValue(),d.workRoomNo.value=b.getWorkRoomNumber().getValue(),d.streetAddress.value=b.getStreetAddress().getValue(),d.city.value=b.getCity().getValue(),d.state.value=b.getState().getValue(),d.country.value=b.getCountry().getValue(),d.postalCode.value=b.getPostalCode().getValue(),d.company.value=b.getCompany().getValue(),d.manager.value=b.getManager().getValue(),d.department.value=b.getDepartment().getValue(),d.preferredLanguage.value=b.getLanguage().getValue(),d.notes.value=b.getNotes().getValue(),a.Base.Utils.isDefined(b._scopiaUserId)&&(d.scopiaUserId.value=b.getScopiaUserId().getValue()),a.Base.Utils.isDefined(b._scopiaLoginId)&&(d.scopiaLoginId.value=b.getScopiaLoginId().getValue()),d.rank.value=b.getRank().getValue().toString(),d.isBuddy.value=b.isBuddy().getValue().toString(),d.favourite.value=b.isFavorite().getValue().toString(),d.videoCapable.value=b.isVideoCapable().getValue().toString();var e,f=[],g=b.getEmailAddresses().getValues();for(e=0;e<g.length;e++){var h=new a.Providers.ACS.ContactEmailData;h.value=g[e].getAddress(),h.type=this._convertContactEmailAddressTypeToACSEmailAddressType(g[e].getEmailAddressType()),f.push(h)}d.emailAddresses=f;var i=[],j=b.getPhoneNumbers().getValues();for(e=0;e<j.length;e++){var k=new a.Providers.ACS.ContactPhoneData;k.phoneNumber=j[e].getPhoneNumber(),k.label1=j[e].getLabel1(),k.label2=j[e].getLabel2(),k.type=this._convertContactPhoneNumberTypeToACSPhoneType(j[e].getPhoneNumberType()),k.speedDialEnabled=j[e].isSpeedDialEnabled().toString(),k.isPrimary=j[e].isDefault().toString(),i.push(k)}d.phoneNumberList=i;var l=[],m=b.getIMAddresses().getValues();for(e=0;e<m.length;e++){var n=new a.Providers.ACS.ContactHandleData;n.value=m[e].getAddress(),n.type=this._convertContactHandleTypeToACSHandleType(m[e].getIMAddressType()),l.push(n)}d.imaddresses=l}return d},_convertACSPhoneNumberTypeToContactPhoneNumberType:function(b){if(!b)return a.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_WORK;switch(b){case a.Providers.ACS.ACSPhoneNumberType.WORK:return a.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_WORK;case a.Providers.ACS.ACSPhoneNumberType.HOME:return a.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_HOME;case a.Providers.ACS.ACSPhoneNumberType.HANDLE:return a.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_HANDLE;case a.Providers.ACS.ACSPhoneNumberType.MOBILE:return a.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_MOBILE;case a.Providers.ACS.ACSPhoneNumberType.FAX:return a.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_FAX;case a.Providers.ACS.ACSPhoneNumberType.PAGER:return a.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_PAGER;default:return a.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_WORK}},_convertContactPhoneNumberTypeToACSPhoneType:function(b){if(!b)return a.Providers.ACS.ACSPhoneNumberType.PHONE_NUMBER_WORK;switch(b){case a.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_WORK:return a.Providers.ACS.ACSPhoneNumberType.WORK;case a.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_HANDLE:return a.Providers.ACS.ACSPhoneNumberType.HANDLE;case a.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_HOME:return a.Providers.ACS.ACSPhoneNumberType.HOME;case a.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_MOBILE:return a.Providers.ACS.ACSPhoneNumberType.MOBILE;case a.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_FAX:return a.Providers.ACS.ACSPhoneNumberType.FAX;case a.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_PAGER:return a.Providers.ACS.ACSPhoneNumberType.PAGER;default:return a.Providers.ACS.ACSPhoneNumberType.PHONE_NUMBER_WORK}},_convertACSEmailAddressTypeToContactEmailAddressType:function(b){if(!b)return a.Services.Contacts.ContactEmailAddressType.EMAIL_ADDRESS_OTHER;switch(b){case a.Providers.ACS.ACSEmailAddressType.WORK:return a.Services.Contacts.ContactEmailAddressType.EMAIL_ADDRESS_WORK;case a.Providers.ACS.ACSEmailAddressType.OTHER:default:return a.Services.Contacts.ContactEmailAddressType.EMAIL_ADDRESS_OTHER}},_convertContactEmailAddressTypeToACSEmailAddressType:function(b){if(!b)return a.Providers.ACS.ACSEmailAddressType.OTHER;switch(b){case a.Services.Contacts.ContactEmailAddressType.EMAIL_ADDRESS_WORK:return a.Providers.ACS.ACSEmailAddressType.WORK;case a.Services.Contacts.ContactEmailAddressType.EMAIL_ADDRESS_OTHER:default:return a.Providers.ACS.ACSEmailAddressType.OTHER}},_convertACSHandleTypeToContactHandleType:function(b){if(!b)return a.Services.Contacts.ContactIMAddressType.IM_ADDRESS_OTHER;switch(b){case a.Providers.ACS.ACSHandleType.WORK:return a.Services.Contacts.ContactIMAddressType.IM_ADDRESS_WORK;case a.Providers.ACS.ACSHandleType.OTHER:default:return a.Services.Contacts.ContactIMAddressType.IM_ADDRESS_OTHER}},_convertContactHandleTypeToACSHandleType:function(b){if(!b)return a.Providers.ACS.ACSHandleType.OTHER;switch(b){case a.Services.Contacts.ContactIMAddressType.IM_ADDRESS_WORK:return a.Providers.ACS.ACSHandleType.WORK;case a.Services.Contacts.ContactIMAddressType.IM_ADDRESS_OTHER:default:return a.Providers.ACS.ACSHandleType.OTHER}},extendAcsContact:function(b){var c=a.Base.Utils.deepMerge;b=c(new a.Providers.ACS.ContactV1,b);var d;if(b.emailAddresses){var e=b.emailAddresses.length;for(d=0;d<e;d++)b.emailAddresses[d]=c(new a.Providers.ACS.ContactEmailData,b.emailAddresses[d])}if(b.phoneNumberList){var f=b.phoneNumberList.length;for(d=0;d<f;d++)b.phoneNumberList[d]=c(new a.Providers.ACS.ContactPhoneData,b.phoneNumberList[d])}if(b.imaddresses){var g=b.imaddresses.length;for(d=0;d<g;d++)b.imaddresses[d]=c(new a.Providers.ACS.ContactHandleData,b.imaddresses[d])}return b}},a.Providers.ACS.ACSContactsConverter=c}(AvayaClientServices,jQuery),function(a){"use strict";var b={ADD:"ADD",UPDATE:"UPDATE",DELETE:"DELETE",REFRESH:"refreshContactList"};a.Providers.ACS.ACSContentsActions=b}(AvayaClientServices),function(a){"use strict";function b(){this._acsRequestBuilder=null,this._acsContactsConverter=null,this._acsNetworkProvider=null,this._acsContactsProvider=null,this._acsDirectorySearchProvider=null,this._contactsAnalyticsService=new a.Services.Analytics.ContactsAnalyticsService,this._acsContactsCache=new a.Providers.ACS.ACSContactsCache}b.prototype={getACSContactsProvider:function(){if(!this._acsContactsProvider){var b=this._createACSContactsProviderV1();this._acsContactsProvider=new a.Providers.ACS.ACSContactsProvider,this._acsContactsProvider.registerACSContactsProvider(1,b)}return this._acsContactsProvider},getACSDirectorySearchProvider:function(){if(!this._acsDirectorySearchProvider){var b=this._createACSDirectorySearchProviderV1();this._acsDirectorySearchProvider=new a.Providers.ACS.ACSDirectorySearchProvider,this._acsDirectorySearchProvider.registerACSDirectorySearchProvider(1,b)}return this._acsDirectorySearchProvider},_createACSContactsProviderV1:function(){return new a.Providers.ACS.ACSContactsProviderV1(this._getACSNetworkProvider(),this._getACSContactsConverter(),this._getACSRequestBuilder())},_createACSDirectorySearchProviderV1:function(){return new a.Providers.ACS.ACSDirectorySearchProviderV1(this._getACSNetworkProvider(),this._getACSContactsConverter(),this._getACSRequestBuilder(),this._contactsAnalyticsService,this._acsContactsCache)},_getACSContactsConverter:function(){return this._acsContactsConverter||(this._acsContactsConverter=new a.Providers.ACS.ACSContactsConverter),this._acsContactsConverter},_getACSRequestBuilder:function(){return this._acsRequestBuilder||(this._acsRequestBuilder=new a.Providers.ACS.ACSRequestBuilder),this._acsRequestBuilder},_getACSNetworkProvider:function(){if(!this._acsNetworkProvider){var b=[a.Providers.ACS.ACSEventTypes.CAS_NOTIFICATION,a.Providers.ACS.ACSEventTypes.PING],c=new a.Base.SSEProvider(b),d=new a.Base.RESTProvider,e=new a.Base.SSEIntegrationProvider(d,c),f=new a.Base.WebSocketProvider,g=new a.Base.NetworkProvider(f,e),h=new a.Base.NetworkProvider(new a.Base.RESTProvider);this._acsNetworkProvider=new a.Providers.ACS.ACSNetworkProvider(this._getACSRequestBuilder(),h,g,this._contactsAnalyticsService)}return this._acsNetworkProvider}},a.Providers.ACS.ACSProviderFactory=b}(AvayaClientServices),function(a){"use strict";var b={STARTING:"STARTING",STARTED:"STARTED",STOPPING:"STOPPING",STOPPED:"STOPPED"};a.Providers.ACS.ACSProviderStates=b}(AvayaClientServices),function(a){"use strict";function b(){this._acsResources={},this._endpoints={},this._contentTypes={resourcesV1:"application/vnd.avaya.acs.resources.v1+json",resourcesV2:"application/vnd.avaya.acs.resources.v2+json",errorV1:"application/vnd.avaya.acs.error.v1+json",contactsV1:"application/vnd.avaya.acs.contacts.v1+json",contactV1:"application/vnd.avaya.acs.contact.v1+json",searchV1:"application/vnd.avaya.acs.search.v1+json",searchresultV1:"application/vnd.avaya.acs.searchresult.v1+json",quicksearchV1:"application/vnd.avaya.acs.quicksearch.v1+json"},this._usedIds={}}b.prototype={},b.prototype.setResources=function(a){this._acsResources=a,this._endpoints.getContacts=this._acsResources.resources.contacts.GET.getContacts.href,this._endpoints.searchContacts=this._endpoints.getContacts+"/searches",this._endpoints.quickSearchContacts=this._endpoints.getContacts+"/quicksearches",this._endpoints.addUpdateContact=this._acsResources.resources.contacts.POST.addUpdateContact.href},b.prototype.buildResourcesOptions=function(){return{urlSuffix:"/acs/resources",sendType:"GET",dataType:"JSON",crossDomain:!0,headers:{Accept:[this._contentTypes.resourcesV2,this._contentTypes.resourcesV1,this._contentTypes.errorV1].join(", ")}}},b.prototype.buildInvalidateSessionOptions=function(){return{urlSuffix:"/acs/session",sendType:"DELETE",headers:{Accept:this._contentTypes.errorV1}}},b.prototype.buildRefreshRestSessionOptions=function(){return{urlSuffix:"/acs/session",sendType:"GET",headers:{Accept:this._contentTypes.errorV1}}},b.prototype.buildRefreshNotificationSessionOptions=function(){return{urlSuffix:"/notification/session",sendType:"GET",headers:{Accept:this._contentTypes.errorV1}}},b.prototype.buildGetContactsOptions=function(a){var b={headers:{}};return b.url=this._endpoints.getContacts+"?count=250",a&&(b.url+="&after="+a),b.sendType="GET",b.dataType="JSON",b.headers.Accept=[this._contentTypes.contactsV1,this._contentTypes.errorV1].join(", "),b},b.prototype.buildGetContactOptions=function(a){return{url:a,sendType:"GET",dataType:"JSON",headers:{Accept:[this._contentTypes.contactV1,this._contentTypes.errorV1].join(", ")}}},b.prototype.buildAddContactOptions=function(){return{url:this._endpoints.addUpdateContact,sendType:"POST",dataType:"JSON",headers:{Accept:[this._contentTypes.contactV1,this._contentTypes.errorV1].join(", "),"Content-Type":this._contentTypes.contactsV1}}},b.prototype.buildUpdateContactOptions=function(){return{url:this._endpoints.addUpdateContact,sendType:"PUT",dataType:"JSON",headers:{Accept:[this._contentTypes.contactV1,this._contentTypes.errorV1].join(", "),"Content-Type":this._contentTypes.contactsV1}}},b.prototype.buildAddUpdateContactData=function(a){return JSON.stringify({userEmail:this._acsResources.self,contacts:[a]},this._stringifyReplacer)},b.prototype.buildDeleteContactOptions=function(a){return{url:a,sendType:"DELETE",headers:{Accept:this._contentTypes.errorV1}}},b.prototype.buildSearchContactsData=function(b){var c,d=b.getSearchString(),e=b.getSearchField();e===a.Services.Contacts.SearchFieldType.NAME?c=["Displayname,"+d]:e===a.Services.Contacts.SearchFieldType.HANDLE?c=["EmailAddress,"+d]:e===a.Services.Contacts.SearchFieldType.LOGIN_ID?c=["LoginID,"+d]:e===a.Services.Contacts.SearchFieldType.TERMINAL?c=["Terminal,"+d]:e===a.Services.Contacts.SearchFieldType.ALL&&(c=["ALL,"+d]);var f=b.getMaxResults();return 0===f&&(f=void 0),JSON.stringify({searchCriteria:c,maxResults:f})},b.prototype.buildQuickSearchContactsOptions=function(){return{url:this._endpoints.quickSearchContacts+"?maxResults=100",sendType:"POST",dataType:"text",headers:{Accept:[this._contentTypes.searchresultV1,this._contentTypes.errorV1],"Content-Type":this._contentTypes.quicksearchV1}}},b.prototype.buildQuickSearchContactsData=function(b,c){var d,e=["EmailAddress","FirstName","LastName","PhoneNumber","IMHandle"],f=[],g=a.Services.Contacts.ResolveContactsFieldType;switch(c){case g.HANDLE:d="Handle";break;case g.PHONE_NUMBER:d="PhoneNumber";break;default:a.Base.Logger.warn(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Invalid field type of resolving contacts",c)}if(d)for(var h=0;h<b.length;h++){var i={correlationId:String(h),criteria:{}};i.criteria[d]=b[h],f.push(i)}return JSON.stringify({filter:e,searchCriteria:f})},b.prototype.buildSearchContactsOptions=function(){return{url:this._endpoints.searchContacts+"?searchDirectory=true",sendType:"POST",dataType:"JSON",headers:{Accept:[this._contentTypes.searchV1,this._contentTypes.errorV1].join(", "),"Content-Type":"application/json"}}},b.prototype.buildNotificationsOptions=function(){return{dataType:"JSON",headers:{"Content-Type":"application/json"}}},b.prototype.buildSubscribeForACSNotifications=function(a){return{subscribe:{requestId:"subscribe-"+this._generateId(),resources:[{application:"acs",service:a,resource:this._endpoints[a]}],version:"1"}}},b.prototype.buildUnsubscribeFromACSNotifications=function(a){return{unsubscribe:{requestId:"unsubscribe-"+this._generateId(),resources:[{application:"acs",service:a,resource:this._endpoints[a]}],version:"1"}}},b.prototype._stringifyReplacer=function(a,b){return b&&b.hasOwnProperty("value")&&void 0===b.value?void 0:b},b.prototype._generateId=function(b,c){var d;do{d=a.Base.Utils.makeId()}while(this._usedIds[d]);return d},a.Providers.ACS.ACSRequestBuilder=b}(AvayaClientServices),function(a){"use strict";var b={WORK:"work",OTHER:"other"};a.Providers.ACS.ACSEmailAddressType=b}(AvayaClientServices),function(a){"use strict";var b={CAS_NOTIFICATION:"CASNotification",PING:"Ping"};a.Providers.ACS.ACSEventTypes=b}(AvayaClientServices),function(a){"use strict";var b={WORK:"work",OTHER:"other"};a.Providers.ACS.ACSHandleType=b}(AvayaClientServices),function(a){"use strict";var b={WORK:"work",HANDLE:"handle",MOBILE:"mobile",HOME:"home",FAX:"fax",PAGER:"pager"};a.Providers.ACS.ACSPhoneNumberType=b}(AvayaClientServices),function(a){"use strict";function b(){this.value=void 0,this.editable=void 0}b.prototype={equals:function(a){return this.value===a.value&&this.editable===a.editable}},a.Providers.ACS.ContactAttribute=b}(AvayaClientServices),function(a){"use strict";function b(){this.value=void 0,this.type=a.Providers.ACS.ACSEmailAddressType.OTHER,this.editable=void 0}b.prototype={equals:function(a){return this.value===a.value&&this.type===a.type&&this.editable===a.editable}},a.Providers.ACS.ContactEmailData=b}(AvayaClientServices),function(a){"use strict";function b(){this.value=void 0,this.type=a.Providers.ACS.ACSHandleType.OTHER,this.editable=void 0,this.provenance=void 0}b.prototype={equals:function(a){return this.value===a.value&&this.type===a.type&&this.editable===a.editable&&this.provenance===a.provenance}},a.Providers.ACS.ContactHandleData=b}(AvayaClientServices),function(a){"use strict";function b(){this.phoneNumber=void 0,this.label1=void 0,this.label2=void 0,this.type=a.Providers.ACS.ACSPhoneNumberType.WORK,this.speedDialEnabled=!1,this.isPrimary=!1,this.editable=void 0}b.prototype={equals:function(a){return this.phoneNumber===a.phoneNumber&&this.label1===a.label1&&this.label2===a.label2&&this.type===a.type&&this.speedDialEnabled===a.speedDialEnabled&&this.isPrimary===a.isPrimary&&this.editable===a.editable}},a.Providers.ACS.ContactPhoneData=b}(AvayaClientServices),function(a){"use strict";function b(){this.id=new a.Providers.ACS.ContactAttribute,this.contactIdentifier=new a.Providers.ACS.ContactAttribute,this.contactUrl=new a.Providers.ACS.ContactAttribute,this.surName=new a.Providers.ACS.ContactAttribute,this.givenName=new a.Providers.ACS.ContactAttribute,this.displayName=new a.Providers.ACS.ContactAttribute,this.alias=new a.Providers.ACS.ContactAttribute,this.company=new a.Providers.ACS.ContactAttribute,this.location=new a.Providers.ACS.ContactAttribute,this.workRoomNo=new a.Providers.ACS.ContactAttribute,this.streetAddress=new a.Providers.ACS.ContactAttribute,this.city=new a.Providers.ACS.ContactAttribute,this.state=new a.Providers.ACS.ContactAttribute,this.country=new a.Providers.ACS.ContactAttribute,this.postalCode=new a.Providers.ACS.ContactAttribute,this.manager=new a.Providers.ACS.ContactAttribute,this.department=new a.Providers.ACS.ContactAttribute,this.asciiGivenName=new a.Providers.ACS.ContactAttribute,this.asciiSurName=new a.Providers.ACS.ContactAttribute,this.asciiDisplayName=new a.Providers.ACS.ContactAttribute,this.pictureUrl=new a.Providers.ACS.ContactAttribute,this.isBuddy=new a.Providers.ACS.ContactAttribute,this.favourite=new a.Providers.ACS.ContactAttribute,this.videoCapable=new a.Providers.ACS.ContactAttribute,this.preferredLanguage=new a.Providers.ACS.ContactAttribute,this.notes=new a.Providers.ACS.ContactAttribute,this.rank=new a.Providers.ACS.ContactAttribute,this.custom1=new a.Providers.ACS.ContactAttribute,this.custom2=new a.Providers.ACS.ContactAttribute,this.custom3=new a.Providers.ACS.ContactAttribute,this.scopiaUserId=new a.Providers.ACS.ContactAttribute,this.scopiaLoginId=new a.Providers.ACS.ContactAttribute,this.phoneNumberList=[],this.emailAddresses=[],this.imaddresses=[]}b.prototype={equals:function(a){if(!(this.id.equals(a.id)&&this.contactIdentifier.equals(a.contactIdentifier)&&this.contactUrl.equals(a.contactUrl)&&this.surName.equals(a.surName)&&this.givenName.equals(a.givenName)&&this.displayName.equals(a.displayName)&&this.alias.equals(a.alias)&&this.company.equals(a.company)&&this.location.equals(a.location)&&this.workRoomNo.equals(a.workRoomNo)&&this.streetAddress.equals(a.streetAddress)&&this.city.equals(a.city)&&this.state.equals(a.state)&&this.country.equals(a.country)&&this.postalCode.equals(a.postalCode)&&this.manager.equals(a.manager)&&this.department.equals(a.department)&&this.asciiGivenName.equals(a.asciiGivenName)&&this.asciiSurName.equals(a.asciiSurName)&&this.asciiDisplayName.equals(a.asciiDisplayName)&&this.pictureUrl.equals(a.pictureUrl)&&this.isBuddy.equals(a.isBuddy)&&this.favourite.equals(a.favourite)&&this.videoCapable.equals(a.videoCapable)&&this.preferredLanguage.equals(a.preferredLanguage)&&this.notes.equals(a.notes)&&this.rank.equals(a.rank)&&this.custom1.equals(a.custom1)&&this.custom2.equals(a.custom2)&&this.custom3.equals(a.custom3)&&this.scopiaUserId.equals(a.scopiaUserId)&&this.scopiaLoginId.equals(a.scopiaLoginId))||this.phoneNumberList.length!==a.phoneNumberList.length||this.emailAddresses.length!==a.emailAddresses.length||this.imaddresses.length!==a.imaddresses.length)return!1;for(var b=0;b<this.phoneNumberList.length;b++)if(!this.phoneNumberList[b].equals(a.phoneNumberList[b]))return!1;for(b=0;b<this.emailAddresses.length;b++)if(!this.emailAddresses[b].equals(a.emailAddresses[b]))return!1;for(b=0;b<this.imaddresses.length;b++)if(!this.imaddresses[b].equals(a.imaddresses[b]))return!1;return!0}},a.Providers.ACS.ContactV1=b}(AvayaClientServices),function(a){"use strict";function b(){this.userEmail="",this.contacts=[],this.hasMoreResults=!1}b.prototype={},a.Providers.ACS.ContactsV1=b}(AvayaClientServices),function(a){"use strict";function b(){this.displayMsg="",this.errorMsg=""}b.prototype={},a.Providers.ACS.ErrorV1=b}(AvayaClientServices),function(a){"use strict";function b(){this.version=1,this.applications=[],this.capabilities=[],this.commandURL="",this.sessionManagement={}}b.prototype={},a.Providers.ACS.NotificationResourcesV1=b}(AvayaClientServices),function(a){"use strict";function b(){this.version=1,this.resources={avayaRequestTimeout:{maximum:void 0,minimum:void 0,recommended:void 0},capabilities:[],contactSearchCapabilities:[],resources:{notification:{websocket:{href:void 0},sse:{href:void 0}},contacts:{POST:{addUpdateContact:{href:void 0}},GET:{getContacts:{href:void 0,limits:{maxSearchResultsPerPage:void 0,maxSearchResultsTotal:void 0}}}},pictures:{GET:{getUserPicture:{href:void 0}}}},self:void 0,sessionManagement:{href:void 0,timeout:void 0}}}b.prototype={},a.Providers.ACS.ResourcesV1=b}(AvayaClientServices),function(a){"use strict";function b(){a.Providers.ACS.ResourcesV1.call(this),this.version=2,this.v2MediaType=!0}b.prototype={},a.Providers.ACS.ResourcesV2=b}(AvayaClientServices),function(a){"use strict";var b={CAS_NOTIFICATION:"CASNotification",PING:"Ping"};a.Providers.AMM.AMM3EventTypes=b}(AvayaClientServices),function(a){"use strict";var b={TYPING:"typing",RECORDING_AUDIO:"recordingAudio",RECORDING_VIDEO:"recordingVideo",ATTACHING_FILE:"attachingFile",TAKING_PICTURE:"takingPicture",OTHER:"other"};a.Providers.AMM.ChatStateActions=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d,e,f){this.action=b.action,this.state=b.state,this.self=c,this.timeout=setTimeout(function(){c?f(b):(b.action="",b.state=a.Providers.AMM.ChatStates.PAUSED,d.fire(b))},e)}a.Providers.AMM.AMMChatStateNotification=b}(AvayaClientServices),function(a){"use strict";function b(){this._chatStateNotifications=[],this._conversationId="",this._localComposingInactivityTimeout=15e3,this._remoteComposingInactivityTimeout=6e4,this._composingRefreshTimeout=5e3,this._chatStateRefresh=!1,this._chatStateRefreshTimeout={}}b.prototype={setConversationId:function(a){this._conversationId=a},getConversationId:function(){return this._conversationId},setChatStateNotification:function(b,c,d){b.state===a.Providers.AMM.ChatStates.COMPOSING?this._setTypingNotification(b,c,d):this._chatStateNotifications[b.address]&&b.state===a.Providers.AMM.ChatStates.PAUSED&&(clearTimeout(this._chatStateNotifications[b.address].timeout),delete this._chatStateNotifications[b.address])},setChatStateRefreshTimeout:function(){this._chatStateRefresh=!0,this._chatStateRefreshTimeout=setTimeout(function(){this._chatStateRefresh=!1}.bind(this),this._composingRefreshTimeout)},getChatNotification:function(a){return this._chatStateNotifications[a]},clearChatStateRefreshTimeout:function(){this._chatStateRefresh=!1,clearTimeout(this._chatStateRefreshTimeout)},clearChatStateNotifications:function(){this._chatStateNotifications=[]},isChatStateAdded:function(){return this._chatStateRefresh},onPauseChatState:function(a,b){},_setTypingNotification:function(b,c,d){var e=c?this._localComposingInactivityTimeout:this._remoteComposingInactivityTimeout,f=function(a){this._localTimeoutEvent(a)}.bind(this);this._chatStateNotifications[b.address]?(clearTimeout(this._chatStateNotifications[b.address].timeout),this._chatStateNotifications[b.address].timeout=setTimeout(function(){c?this._localTimeoutEvent(b):this._remoteTimeoutEvent(b,d)}.bind(this),e)):this._chatStateNotifications[b.address]=new a.Providers.AMM.AMMChatStateNotification(b,c,d,e,f)},_localTimeoutEvent:function(a){this.onPauseChatState(a.action,this._conversationId)},_remoteTimeoutEvent:function(b,c){b.action="",b.state=a.Providers.AMM.ChatStates.PAUSED,c.fire(b)}},a.Providers.AMM.AMMChatStateNotifications=b}(AvayaClientServices),function(a){"use strict";var b={COMPOSING:"composing",PAUSED:"paused"};a.Providers.AMM.ChatStates=b}(AvayaClientServices),function(a){"use strict";function b(){this._parsers=[]}b.prototype={register:function(a,b){this._parsers[a]=b},unregister:function(a){this._parsers[a]=void 0},parse:function(a,b){return this._parsers[a]?this._delegateParser(a,b):b},_delegateParser:function(b,c){if(void 0!==this._parsers[b])return this._parsers[b].parse(c);a.Base.Logger.error(a.Base.LoggerTags.AMM_MESSAGING_PROVIDER,"No parser specified!",b)}},a.Providers.AMM.AMMMessagesParser=b}(AvayaClientServices),function(a){"use strict";var b={CONVERSATION:"conversation",CHAT_STATE:"chatState"};a.Providers.AMM.MessagesService=b}(AvayaClientServices),function(a,b){"use strict";function c(){this._ammProvider={}}c.prototype={getAMMProvider:function(c){if(a.Base.Utils.isDefined(c)&&c.enabled){if(b.isEmptyObject(this._ammProvider)){var d=this._createAMM2Provider(),e=this._createAMM3Provider();this._ammProvider=new a.Providers.AMM.AMMProvider,this._ammProvider.registerAMMProvider(2.1,d),this._ammProvider.registerAMMProvider(3,e)}return this._ammProvider}},_createAMM2Provider:function(){var b=new a.Base.RESTProvider,c=new a.Base.NetworkProvider(b),d=this._createEventsV2Parser();return new a.Providers.AMM.AMM2Provider(c,d)},_createEventsV2Parser:function(){var b=new a.Providers.AMM.AMMMessagesParser;return b.register(a.Providers.AMM.AMMResponsesTypes.GET_CONVERSATIONS,new a.Providers.AMM.GetConversationsParser),b.register(a.Providers.AMM.AMMResponsesTypes.VALIDATE_USERS,new a.Providers.AMM.ValidateUsersParser),b.register(a.Providers.AMM.AMMResponsesTypes.SEND,new a.Providers.AMM.SendParser),b.register(a.Providers.AMM.AMMResponsesTypes.GET_MESSAGES,new a.Providers.AMM.GetMessagesParser),b.register(a.Providers.AMM.AMMResponsesTypes.ADD_PARTICIPANTS,new a.Providers.AMM.AddParticipantsParser),b.register(a.Providers.AMM.AMMResponsesTypes.CLOSE,new a.Providers.AMM.CloseParser),b.register(a.Providers.AMM.AMMResponsesTypes.NOTIFICATION,new a.Providers.AMM.NotificationParser),b.register(a.Providers.AMM.AMMResponsesTypes.NOTIFIED,new a.Providers.AMM.NotifiedParser),b.register(a.Providers.AMM.AMMResponsesTypes.DISCOVERY,new a.Providers.AMM.DiscoveryV2Parser),b.register(a.Providers.AMM.AMMResponsesTypes.SUBSCRIBED,new a.Providers.AMM.SubscribedParser),b.register(a.Providers.AMM.AMMResponsesTypes.UNSUBSCRIBED,new a.Providers.AMM.UnsubscribedParser),b},_createAMM3Provider:function(){var b=[a.Providers.AMM.AMM3EventTypes.CAS_NOTIFICATION,a.Providers.AMM.AMM3EventTypes.PING],c=new a.Base.SSEProvider(b),d=new a.Base.RESTProvider,e=new a.Base.SSEIntegrationProvider(d,c),f=new a.Base.WebSocketProvider,g=new a.Base.NetworkProvider(f,e),h=new a.Base.RESTProvider,i=new a.Base.NetworkProvider(h),j=this._createEventsV3Parser(),k=new a.Providers.AMM.AMMChatStateNotifications;return new a.Providers.AMM.AMM3Provider(i,g,k,j)},_createEventsV3Parser:function(){var b=new a.Providers.AMM.AMMMessagesParser
;return b.register(a.Providers.AMM.AMMResponsesTypes.GET_CONVERSATIONS,new a.Providers.AMM.GetConversationsParser),b.register(a.Providers.AMM.AMMResponsesTypes.VALIDATE_USERS,new a.Providers.AMM.ValidateUsersParser),b.register(a.Providers.AMM.AMMResponsesTypes.SEND,new a.Providers.AMM.SendParser),b.register(a.Providers.AMM.AMMResponsesTypes.GET_MESSAGES,new a.Providers.AMM.GetMessagesParser),b.register(a.Providers.AMM.AMMResponsesTypes.ADD_PARTICIPANTS,new a.Providers.AMM.AddParticipantsParser),b.register(a.Providers.AMM.AMMResponsesTypes.CLOSE,new a.Providers.AMM.CloseParser),b.register(a.Providers.AMM.AMMResponsesTypes.NOTIFICATION,new a.Providers.AMM.NotificationParser),b.register(a.Providers.AMM.AMMResponsesTypes.NOTIFIED,new a.Providers.AMM.NotifiedParser),b.register(a.Providers.AMM.AMMResponsesTypes.DISCOVERY,new a.Providers.AMM.DiscoveryV3Parser),b.register(a.Providers.AMM.AMMResponsesTypes.DISCOVERY_NOTIFICATION,new a.Providers.AMM.DiscoveryNotificationParser),b.register(a.Providers.AMM.AMMResponsesTypes.SUBSCRIBED,new a.Providers.AMM.SubscribedParser),b.register(a.Providers.AMM.AMMResponsesTypes.UNSUBSCRIBED,new a.Providers.AMM.UnsubscribedParser),b}},a.Providers.AMM.AMMProviderFactory=c}(AvayaClientServices,jQuery),function(a){"use strict";var b={AVAILABLE:"available",UNAVAILABLE:"unavailable"};a.Providers.AMM.ProviderStates=b}(AvayaClientServices),function(a){"use strict";var b={ADD_PARTICIPANTS:"AddParticipants",GET_CONVERSATIONS:"GetConversations",VALIDATE_USERS:"ValidateUsers",SEND:"Send",GET_MESSAGES:"GetMessages",CLOSE:"Close",NOTIFICATION:"Notification",NOTIFIED:"Notified",DISCOVERY:"Discovery",DISCOVERY_NOTIFICATION:"DiscoveryNotification",SUBSCRIBED:"Subscribed",UNSUBSCRIBED:"Unsubscribed"};a.Providers.AMM.AMMResponsesTypes=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(a){throw new Error("Method not implemented!")}},a.Providers.AMM.AbstractParser=b}(AvayaClientServices=AvayaClientServices||{}),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.AMM.AbstractParser.prototype),b.prototype.parse=function(b){var c={};c.participants=[];for(var d=0;d<b.participants.length;d++){var e=new a.Providers.AMM.AddParticipantsResponse(b.participants[d].address,b.participants[d].givenName,b.participants[d].language,b.participants[d].modalities,b.participants[d].nativeGivenName,b.participants[d].nativeSurname,b.participants[d].surname,b.participants[d].type);c.participants.push(e)}return c},a.Providers.AMM.AddParticipantsParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.AMM.AbstractParser.prototype),b.prototype.parse=function(b){return new a.Providers.AMM.CloseResponse(b.closed,b.href,b.sensitivity)},a.Providers.AMM.CloseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.AMM.AbstractParser.prototype),b.prototype.parse=function(b){return new a.Providers.AMM.DiscoveryNotificationResponse(b.applications,b.capabilities,b.sessionManagement,b.version,b.commandURL)},a.Providers.AMM.DiscoveryNotificationParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.AMM.AbstractParser.prototype),b.prototype.parse=function(b){return new a.Providers.AMM.DiscoveryV2Response(b.addresses,b.avayaRequestTimeout,b.capabilities,b.conversationsResource,b.domains,b.limits,b.messages,b.outbox,b.self,b.services)},a.Providers.AMM.DiscoveryV2Parser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.AMM.AbstractParser.prototype),b.prototype.parse=function(b){return new a.Providers.AMM.DiscoveryV3Response(b.avayaRequestTimeout,b.contacts,b.conversationsResource,b.domains,b.messages,b.notificationService,b.notifications,b.outbox,b.picture,b.self,b.services,b.sessionManagement,b.users)},a.Providers.AMM.DiscoveryV3Parser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.AMM.AbstractParser.prototype),b.prototype.parse=function(b){return new a.Providers.AMM.GetConversationsResponse(b.conversations,b.href,b.lastUpdated,b.moreSearchResults)},a.Providers.AMM.GetConversationsParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.AMM.AbstractParser.prototype),b.prototype.parse=function(b){return new a.Providers.AMM.GetMessagesResponse(b.attachmentCount,b.counts,b.flags,b.href,b.id,b.lastAccessedTime,b.lastUpdated,b.latestEntryTimestamp,b.messages,b.participants,b.subject,b.totalCount,b.type,b.unreadAttachmentCount,b.unreadCount)},a.Providers.AMM.GetMessagesParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.AMM.AbstractParser.prototype),b.prototype.parse=function(b){return new a.Providers.AMM.NotificationResponse(b.application,b.contents,b.resource,b.service,b.version)},a.Providers.AMM.NotificationParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.AMM.AbstractParser.prototype),b.prototype.parse=function(b){return new a.Providers.AMM.NotifiedResponse(b.requestId,b.results,b.version)},a.Providers.AMM.NotifiedParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.AMM.AbstractParser.prototype),b.prototype.parse=function(b){return new a.Providers.AMM.SendResponse(b.body,b.event,b.flags,b.from,b.href,b.id,b.lastModifiedDate,b.parts,b.receivedDate,b.subject,b.threadId,b.to,b.inReplyTo)},a.Providers.AMM.SendParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.AMM.AbstractParser.prototype),b.prototype.parse=function(b){return new a.Providers.AMM.SubscribedResponse(b.results,b.version)},a.Providers.AMM.SubscribedParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.AMM.AbstractParser.prototype),b.prototype.parse=function(b){return new a.Providers.AMM.UnsubscribedResponse(b.results,b.version)},a.Providers.AMM.UnsubscribedParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.AMM.AbstractParser.prototype),b.prototype.parse=function(b){var c={};c.validatedAddresses=[];for(var d=0;d<b.validatedAddresses.length;d++){var e=new a.Providers.AMM.ValidateUsersResponse(b.validatedAddresses[d].addresses,b.validatedAddresses[d].query);c.validatedAddresses.push(e)}return c},a.Providers.AMM.ValidateUsersParser=b}(AvayaClientServices),function(a){"use strict";function b(){this.active=!1,this.closed=!1,this.href="",this.sensitivity=""}b.prototype={},a.Providers.AMM.ConversationFlagsV1=b}(AvayaClientServices),function(a){"use strict";function b(){this.href="",this.id="",this.lastAccessedTime="",this.lastUpdated=""}b.prototype={},a.Providers.AMM.ConversationIdV1=b}(AvayaClientServices),function(a){"use strict";function b(){this.conversationIds=[],this.href="",this.lastUpdated=""}b.prototype={},a.Providers.AMM.ConversationIdsV1=b}(AvayaClientServices),function(a){"use strict";function b(){this.attachmentCount=0,this.href="",this.id="",this.flags=new a.Providers.AMM.ConversationFlagsV1,this.lastAccessedTime="",this.lastUpdated="",this.latestEntryTimestamp="",this.messages=[],this.name="",this.owner="",this.participants={href:""},this.totalCount=0,this.type="",this.unreadAttachmentCount=0,this.unreadCount=0,this.counts={eventCount:0,eventUnreadMessage:0,messageAttachment:0,messageCount:0,messageUnreadAttachment:0,messageUnreadMessage:0}}b.prototype={},a.Providers.AMM.ConversationV1=b}(AvayaClientServices),function(a){"use strict";function b(){this.conversations=[],this.href="",this.lastUpdated="",this.moreSearchResults=!1}b.prototype={},a.Providers.AMM.ConversationsV1=b}(AvayaClientServices),function(a){"use strict";function b(){this.address="",this.givenName="",this.language="",this.modalities=[],this.nativeGivenName="",this.nativeSurname="",this.picture="",this.surname="",this.subType="",this.type=""}b.prototype={},a.Providers.AMM.EntityV1=b}(AvayaClientServices),function(a){"use strict";function b(){this.displayMsg="",this.errorMsg="",this.errorCode=0}b.prototype={},a.Providers.AMM.ErrorV1=b}(AvayaClientServices),function(a){"use strict";function b(){this.participants=[],this.reason="",this.type="",this.units="",this.value=0}b.prototype={},a.Providers.AMM.EventV1=b}(AvayaClientServices),function(a){"use strict";function b(){this.doNotForward=!1,this.href="",this.importance="",this.read=!1,this.sensitivity=""}b.prototype={},a.Providers.AMM.MessageFlagsV1=b}(AvayaClientServices),function(a){"use strict";function b(){this.body="",this.event=new a.Providers.AMM.EventV1,this.flags=new a.Providers.AMM.MessageFlagsV1,this.from=new a.Providers.AMM.EntityV1,this.href="",this.id="",this.inReplyTo="",this.lastModifiedDate="",this.parts=[],this.receivedDate="",this.subject="",this.threadId="",this.to=[]}b.prototype={},a.Providers.AMM.MessageV1=b}(AvayaClientServices),function(a){"use strict";function b(){this.version=1,this.applications=[],this.capabilities=[],this.commandURL="",this.sessionManagement={}}b.prototype={},a.Providers.AMM.NotificationResourcesV1=b}(AvayaClientServices),function(a){"use strict";function b(){this.action="",this.address="",this.state="",this.timestamp=""}b.prototype={},a.Providers.AMM.NotificationContentsV1=b}(AvayaClientServices),function(a){"use strict";function b(){this.disposition="",this.duration=0,this.media="",this.mimeType="",this.partId="",this.size=0}b.prototype={},a.Providers.AMM.PartV1=b}(AvayaClientServices),function(a){"use strict";function b(){this.participants=[]}b.prototype={},a.Providers.AMM.ParticipantsV1=b}(AvayaClientServices),function(a){"use strict";function b(){this.version=2,this.addresses="",this.avayaRequestTimeout={recommended:0,maximum:0,minimum:0},this.capabilities={richContent:!1},this.conversationsResource={href:"",maxIdsLimit:0,maxMessageCount:0},this.domains=[],this.limits={maxAudioSize:0,maxGenericAttachmentSize:0,maxImageSize:0,maxTextLength:0,maxVideoSize:0},this.messages="",this.outbox="",this.self="",this.services={markAsReadIf:"",validateAddress:""}}b.prototype={},a.Providers.AMM.ResourcesV2=b}(AvayaClientServices),function(a){"use strict";function b(){this.version=3,this.avayaRequestTimeout={recommended:0,maximum:0,minimum:0},this.capabilities={richContent:!1},this.conversationsResource={href:"",maxIdsLimit:0,maxMessageCount:0},this.domains=[],this.limits={maxAudioSize:0,maxGenericAttachmentSize:0,maxImageSize:0,maxTextLength:0,maxVideoSize:0},this.messages="",this.outbox="",this.self="",this.picture="",this.contacts="",this.services={markAsReadIf:{href:""},validateAddresses:{href:""},markAsReadBatch:{href:"",limits:{maxBatchSize:0}}}}b.prototype={},a.Providers.AMM.ResourcesV3=b}(AvayaClientServices),function(a){"use strict";function b(){this.version=4,this.avayaRequestTimeout={recommended:0,maximum:0,minimum:0},this.capabilities={richContent:!1},this.contacts={href:""},this.conversationsResource={href:"",capabilities:{automaticLastAccessedDate:!1,postSessionEvent:!1,subjectChange:!1},limits:{maxMessageCount:0,maxIdsLimit:0}},this.domains=[],this.messages={href:""},this.notifications={href:""},this.outbox={href:"",capabilities:{richContent:!1},limits:{maxAudioSize:0,maxGenericAttachmentSize:0,maxImageSize:0,maxTextLength:0,maxVideoSize:0}},this.picture={href:""},this.self="",this.services={markAsReadIf:{href:""},validateAddresses:{href:""},markAsReadBatch:{href:"",limits:{maxBatchSize:0}}},this.notificationService={sse:{href:""},websocket:{href:""}},this.users={href:""},this.sessionManagement={href:"",timeout:0,username:""}}b.prototype={},a.Providers.AMM.ResourcesV4=b}(AvayaClientServices),function(a){"use strict";function b(){this.query="",this.addresses=[]}b.prototype={},a.Providers.AMM.ValidatedAddressesV1=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d,e,f,g,h){this._address=a,this.givenName=b,this.language=c,this.modalities=d,this.nativeGivenName=e,this.nativeSurname=f,this.surname=g,this.type=h}a.Providers.AMM.AddParticipantsResponse=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c){this.closed=a,this.href=b,this.sensitivity=c}a.Providers.AMM.CloseResponse=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d,e){this.applications=a,this.capabilities=b,this.sessionManagement=c,this.version=d,this.commandURL=e}a.Providers.AMM.DiscoveryNotificationResponse=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d,e,f,g,h,i,j){this.addresses=a,this.avayaRequestTimeout=b,this.capabilities=c,this.conversationsResource=d,this.domains=e,this.limits=f,this.messages=g,this.outbox=h,this.self=i,this.services=j}a.Providers.AMM.DiscoveryV2Response=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d,e,f,g,h,i,j,k,l,m){this.avayaRequestTimeout=a,this.contacts=b,this.conversationsResource=c,this.domains=d,this.messages=e,this.notificationService=f,this.notifications=g,this.outbox=h,this.picture=i,this.self=j,this.services=k,this.sessionManagement=l,this.users=m}a.Providers.AMM.DiscoveryV3Response=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d){this.conversations=a,this.href=b,this.lastUpdated=c,this.moreSearchResults=d;for(var e=0;e<this.conversations.length;e++)for(var f=0;f<this.conversations[e].messages.length;f++){this.conversations[e].messages[f].from._address=this.conversations[e].messages[f].from.address,delete this.conversations[e].messages[f].from.address;for(var g=0;g<this.conversations[e].messages[f].to.length;g++)this.conversations[e].messages[f].to[g]._address=this.conversations[e].messages[f].to[g].address,delete this.conversations[e].messages[f].to[g].address}}a.Providers.AMM.GetConversationsResponse=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){this.attachmentCount=a,this.counts=b,this.flags=c,this.href=d,this.id=e,this.lastAccessedTime=f,this.lastUpdated=g,this.latestEntryTimestamp=h,this.messages=i,this.participants=j,this.subject=k,this.totalCount=l,this.type=m,this.unreadAttachmentCount=n,this.unreadCount=o}a.Providers.AMM.GetMessagesResponse=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d,e){this.application=a,this.contents=b,this.resource=c,this.service=d,this.version=e}a.Providers.AMM.NotificationResponse=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c){this.requestId=a,this.results=b,this.version=c}a.Providers.AMM.NotifiedResponse=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d,e,f,g,h,i,j,k,l,m){this.body=a,this.event=b,this.flags=c,this.from=d,this.href=e,this.id=f,this.lastModifiedDate=g,this.parts=h,this.receivedDate=i,this.subject=j,this.threadId=k,this.to=l,this.inReplyTo=m}a.Providers.AMM.SendResponse=b}(AvayaClientServices),function(a){"use strict";function b(a,b){this.results=a,this.version=b}a.Providers.AMM.SubscribedResponse=b}(AvayaClientServices),function(a){"use strict";function b(a,b){this.results=a,this.version=b}a.Providers.AMM.UnsubscribedResponse=b}(AvayaClientServices),function(a){"use strict";function b(a,b){this.addresses=[],this.query=b;for(var c=0;c<a.length;c++){var d={_address:a[c].address,givenName:a[c].givenName,language:a[c].language,modalities:a[c].modalities,nativeGivenName:a[c].nativeGivenName,nativeSurname:a[c].nativeSurname,surname:a[c].surname,type:a[c].type};this.addresses.push(d)}}a.Providers.AMM.ValidateUsersResponse=b}(AvayaClientServices),function(a){"use strict";var b={CLIENT:"Client",USER:"User",SERVICES:"Services",PROVIDERS:"Providers",ANALYTICS:"Analytics",MESSAGING:"Messaging",CONTACTS:"Contacts",CALLS:"Calls",COLLABORATIONS:"Collaborations",CALL_FEATURES:"Call Features"};a.Providers.Analytics.AnalyticsCategories=b}(AvayaClientServices),function(a){"use strict";var b={PRODUCT_VENDOR:1,PRODUCT_NAME:2,PRODUCT_VERSION:3,PROVIDER_TYPE:4,MIME_TYPE:5};a.Providers.Analytics.AnalyticsCustomDimensions=b}(AvayaClientServices),function(a){"use strict";var b={CONTACTS:"AADS",MESSAGING:"AMM",CALLS:"ESG",PRESENCE:"ESG",VOICE_MESSAGING:"ESG",COLLABORATION:"WCS",CONFERENCE:"UCCP"};a.Providers.Analytics.AnalyticsProvidersTypes=b}(AvayaClientServices),function(a){"use strict";var b={CALL:"Call",COLLABORATION:"Collaboration",CONTACT:"Contact",MESSAGING:"Messaging",PRESENCE:"Presence",VOICE_MESSAGING:"Voice Messaging"};a.Providers.Analytics.AnalyticsServicesNames=b}(AvayaClientServices),function(a,b){"use strict";function c(b,c,d,e){a.Base.Logger.debug(a.Base.LoggerTags.CALL_PROVIDER,"Initializing"),a.Base.Observable.call(this),this._config=void 0,this._csgwProviderFactory=b,this._configCallGwProvider=void 0,this._mediaServiceFactory=c,this._cpCalls={},this._sdpMediaOfferNotifications={},this._rtcConfiguration={},this._videoResolution={},this._consultConferencePromises={},this._callsAnalyticsService=d,this._rtcConnectionProviderFactory=e,a.Base.Logger.debug(a.Base.LoggerTags.CALL_PROVIDER,"Initialized")}c.prototype=Object.create(a.Base.Observable.prototype),c.prototype.start=function(c,d){if(!this._isBrowserSupported())return this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.CALL_SERVICE_AVAILABLE,[]),this._callsAnalyticsService.sendUnavailableEvent(a.Services.Analytics.AnalyticsErrorCode.WEBRTC_NOT_SUPPORTED),b.Deferred().resolve().promise();this._config=c,this._videoResolution=d;var e,f=this._config.sgConfiguration.networkProviderConfiguration.restConfig;e=f.isSecure?a.Base.Utils.isDefined(f.port)?f.port:"443":a.Base.Utils.isDefined(f.port)?f.port:"80";var g=f.hostName+":"+e;return this._configCallGwProvider=this._csgwProviderFactory.getCSGCallsProvider(g),this._startCallGwProvider(this._configCallGwProvider,this._config.sgConfiguration,this._config.callUserConfiguration.incomingCall,d)},c.prototype._startCallGwProvider=function(b,c,d,e){return b._removeListeners(),b.on(a.Providers.CallServiceGateway.ObservableEvents.ANSWER_CALL_REQUEST,this._answerCallRequestedHandler.bind(this)),b.on(a.Providers.CallServiceGateway.ObservableEvents.CALL_RINGING,this._callRingingHandler.bind(this)),b.on(a.Providers.CallServiceGateway.ObservableEvents.CALL_ESTABLISHED,this._callEstablishedHandler.bind(this)),b.on(a.Providers.CallServiceGateway.ObservableEvents.CREATE_MEDIA_REQUEST,this._createMediaRequestHandler.bind(this)),b.on(a.Providers.CallServiceGateway.ObservableEvents.CALL_ENDED,this._remoteCallEndedHandler.bind(this)),b.on(a.Providers.CallServiceGateway.ObservableEvents.CALL_INCOMING,this._incomingCallHandler.bind(this)),b.on(a.Providers.CallServiceGateway.ObservableEvents.CALL_FAILURE,this._callFailureHandler.bind(this)),b.on(a.Providers.CallServiceGateway.ObservableEvents.CALL_STATE_FAILURE,this._callStateFailureHandler.bind(this)),b.on(a.Providers.CallServiceGateway.ObservableEvents.MAKE_CALL_REQUEST,this._makeCallRequestedHandler.bind(this)),b.on(a.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,this._networkFailureHandler.bind(this)),b.on(a.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_AVAILABLE,this._networkAvailabilityHandler.bind(this)),b.on(a.Providers.CallServiceGateway.ObservableEvents.UPDATE_TRANSFER_STATUS,this._updateTransferStatusHandler.bind(this)),b.on(a.Providers.CallServiceGateway.ObservableEvents.UPDATE_CONSULT_CONFERENCE_STATUS,this._updateConsultConferenceStatusHandler.bind(this)),b.on(a.Providers.CallServiceGateway.ObservableEvents.UPDATE_CALL_DATA,this._updateCallDataHandler.bind(this)),b.on(a.Providers.CallServiceGateway.ObservableEvents.UPDATE_CALL_REQUEST,this._updateCallRequestedHandler.bind(this)),b.on(a.Providers.CallServiceGateway.ObservableEvents.ICE_CONFIG_UPDATES,this._iceConfigUpdatesHandler.bind(this)),b.on(a.Providers.CallServiceGateway.ObservableEvents.VIDEO_LICENSE_UPDATED,this._videoLicenseUpdatedHandler.bind(this)),b.on(a.Providers.CallServiceGateway.ObservableEvents.RINGBACK_TONE_URLS_CHANGED,this._ringbackToneURLsChangedHandler.bind(this)),b.on(a.Providers.CallServiceGateway.ObservableEvents.TERMINATE_CALL_REQUEST,this._terminateCallRequestedHandler.bind(this)),b.on(a.Providers.CallServiceGateway.ObservableEvents.IVIEW_TOKEN_UPDATE,function(b){this.trigger(a.Providers.CallServiceGateway.ObservableEvents.IVIEW_TOKEN_UPDATE,[b])}.bind(this)),b.on(a.Base.NetworkProviderEvents.UNAUTHORIZED,function(){this.trigger(a.Base.NetworkProviderEvents.UNAUTHORIZED,[])}.bind(this)),b.on(a.Base.NetworkProviderEvents.AUTHORIZED,function(){this.trigger(a.Base.NetworkProviderEvents.AUTHORIZED,[])}.bind(this)),b.start(this,c,d,e)},c.prototype.stop=function(){if(!this._isBrowserSupported())return b.Deferred().resolve().promise();var c=b.Deferred();this._triggerEndCalls();var d=[];return this._csgwProviderFactory.getCSGCallsProviderAsArray().forEach(function(b){a.Base.Logger.info(a.Base.LoggerTags.CALL_PROVIDER,"Stopping call gateway provider for "+b._host),d.push(b.stop())}),b.when.apply(b,d).then(function(){a.Base.Logger.info(a.Base.LoggerTags.CALL_PROVIDER,"Stopped call gateway provider(s)"),this._removeListeners(),this._cpCalls={},c.resolve()}.bind(this),function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Error encountered while stopping stop call gateway provider(s)",b),this._removeListeners(),this._cpCalls={},c.reject(b)}.bind(this)),c.promise()},c.prototype.stopImmediately=function(){var c=b.Deferred(),d=[];return this._csgwProviderFactory.getCSGCallsProviderAsArray().forEach(function(b){a.Base.Logger.info(a.Base.LoggerTags.CALL_PROVIDER,"Force stopping call gateway provider for "+b._host),d.push(b.stopImmediately())}),b.when.apply(b,d).done(function(){a.Base.Logger.info(a.Base.LoggerTags.CALL_PROVIDER,"Force stopped call gateway provider(s)"),c.resolve()}.bind(this)),c.promise()},c.prototype.startCall=function(c,d,e,f,g,h,i){var j=b.Deferred();if(a.Base.Utils.isDefined(c._callCreationInfo)&&a.Base.Utils.isDefined(c._callCreationInfo.getServiceGatewayURL())){var k,l=a.Base.Utils.parseUrl(c._callCreationInfo.getServiceGatewayURL());k=!a.Base.Utils.isDefined(l.port)||Number.isNaN(l.port)?l.isSecure?"443":"80":l.port;var m=l.hostname+":"+k,n=this._csgwProviderFactory.getCSGCallsProvider(m),o=c._callService._callManager.getActiveCall();o&&this._cpCalls[o.getCallId()]._callGatewayProvider._host===m?this._startNewCall(c,d,e,f,g,h,i,j):this._startExternalGwCall(n,l.isSecure,c._callCreationInfo.getMeetMeUserName(),c,d,e,f,g,h,i,j)}else this._startNewCall(c,d,e,f,g,h,i,j);return j.promise()},c.prototype._startExternalGwCall=function(b,c,d,e,f,g,h,i,j,k,l){var m=b._host.split(":"),n=new a.Config.SGConfiguration;n.enabled=!0,n.credentialProvider=new a.Config.GuestCredentialProvider(d),n.networkProviderConfiguration=new a.Config.NetworkProviderConfiguration,n.networkProviderConfiguration.restConfig=new a.Config.ServerInfo,n.networkProviderConfiguration.restConfig.isSecure=c,n.networkProviderConfiguration.restConfig.hostName=m[0],n.networkProviderConfiguration.restConfig.port=m[1],this._startCallGwProvider(b,n,!1,k).then(function(){this._startNewCall(e,f,g,h,i,j,k,l,b),l.resolve()}.bind(this),function(a){l.reject(a)})},c.prototype._startNewCall=function(a,b,c,d,e,f,g,h,i){this._createCPCall(a,void 0,void 0,g,i).startCall(e,f,b,c,d),h.resolve()},c.prototype._createCPCall=function(b,c,d,e,f){var g=a.Base.Utils.isDefined(f)?f:this._configCallGwProvider,h=new a.Providers.Call.CPCall(b,this,g,e);return h.callId=c,h.incomingCallInfo=d,h},c.prototype.updateVideoResolution=function(a,c){var d=this._cpCalls[a.getCallId()];if(d){var e=this.getMediaServiceFactory().getMediaServices().getVideoInterface().getSelectedDevice(),f=this.getMediaServiceFactory().getMediaServices().getAudioInterface().getInputInterface().getSelectedDevice();return d.updateVideoResolution(f,e,c)}return b.Deferred().reject().promise()},c.prototype.updateDevices=function(a,c){var d=this._cpCalls[a.getCallId()];if(d){var e=this.getMediaServiceFactory().getMediaServices().getVideoInterface().getSelectedDevice(),f=this.getMediaServiceFactory().getMediaServices().getAudioInterface().getInputInterface().getSelectedDevice();return d.updateDevice(f,e,c,this._videoResolution)}return b.Deferred().reject().promise()},c.prototype.stopCall=function(c,d){var e=b.Deferred(),f=this._cpCalls[c.getCallId()];return f?(f.end(d),e.resolve()):e.reject(new a.Services.Call.CallException(a.Services.Call.CallError.CALL_NOT_FOUND)),e.promise()},c.prototype.accept=function(c,d,e){var f=b.Deferred(),g=this._cpCalls[c.getCallId()];return g?(g.acceptCall(d,e),f.resolve()):f.reject(new a.Services.Call.CallException(a.Services.Call.CallError.CALL_NOT_FOUND)),f.promise()},c.prototype.acceptSendVideo=function(c,d,e){var f=this._cpCalls[c.getCallId()];if(f){var g,h=f.call.getVideoChannels();return h.length>0?(h[0]._setRequestedDirection(a.Providers.Call.Utils.getVideoDirection(e)),g=h[0]):(g=this._createVideoChannel_VideoMode(e),f.call.getVideoChannels().push(g)),this.triggerVideoChannelUpdate(f.call),f.acceptSendVideo(d,g)}return b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.CALL_NOT_FOUND)).promise()},c.prototype.denySendVideo=function(c){var d=b.Deferred(),e=this._cpCalls[c.getCallId()];return e?(e.denySendVideo(),d.resolve()):d.reject(new a.Services.Call.CallException(a.Services.Call.CallError.CALL_NOT_FOUND)),d.promise()},c.prototype.registerIncomingOrRemoteCall=function(a){var b=this._cpCalls[a.getCallId()];b&&(b.call=a,this.registerCall(a.getCallId(),a,b))},c.prototype.getCalls=function(c){if(a.Base.Utils.isDefined(c)){return this._csgwProviderFactory.getCSGCallsProvider(c).getCalls()}return b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.NOT_FOUND)).promise()},c.prototype.getClients=function(c){if(a.Base.Utils.isDefined(c)){return this._csgwProviderFactory.getCSGCallsProvider(c).getClients()}return b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.NOT_FOUND)).promise()},c.prototype.getCall=function(c,d){if(a.Base.Utils.isDefined(d)){return this._csgwProviderFactory.getCSGCallsProvider(d).getCall(c)}return b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.NOT_FOUND)).promise()},c.prototype.getClient=function(c,d){if(a.Base.Utils.isDefined(d)){return this._csgwProviderFactory.getCSGCallsProvider(d).getClient(c)}return b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.NOT_FOUND)).promise()},c.prototype.lookupCall=function(a){return this._cpCalls.hasOwnProperty(a)?this._cpCalls[a].call:void 0},c.prototype.muteAudio=function(c){var d=b.Deferred(),e=this._cpCalls[c.getCallId()];if(e){if(e.muteAudio(),c.isConference()&&c.getConference()._isAvailable){var f=c.getConference();f._sendLocalMuteEvent(f._selfParticipantId,!0)}d.resolve()}else d.reject(new a.Services.Call.CallException(a.Services.Call.CallError.CALL_NOT_FOUND));return d.promise()},c.prototype.unmuteAudio=function(c){var d=b.Deferred(),e=this._cpCalls[c.getCallId()];if(e){if(e.unmuteAudio(),c.isConference()&&c.getConference()._isAvailable){var f=c.getConference();f._sendLocalMuteEvent(f._selfParticipantId,!1)}d.resolve()}else d.reject(new a.Services.Call.CallException(a.Services.Call.CallError.CALL_NOT_FOUND));return d.promise()},c.prototype.muteSpeaker=function(c){var d=b.Deferred(),e=this._cpCalls[c.getCallId()];return e?(e.muteSpeaker(),d.resolve()):d.reject(new a.Services.Call.CallException(a.Services.Call.CallError.CALL_NOT_FOUND)),d.promise()},c.prototype.unmuteSpeaker=function(c){var d=b.Deferred(),e=this._cpCalls[c.getCallId()];return e?(e.unmuteSpeaker(),d.resolve()):d.reject(new a.Services.Call.CallException(a.Services.Call.CallError.CALL_NOT_FOUND)),d.promise()},c.prototype.hold=function(c){var d=this._cpCalls[c.getCallId()];if(d)return d.hold();b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.CALL_NOT_FOUND))},c.prototype.unhold=function(c){var d=this._cpCalls[c.getCallId()];return d?d.unhold():b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.CALL_NOT_FOUND))},c.prototype.transfer=function(c,d){var e=this._cpCalls[c.getCallId()];return e?e.transfer(d):b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.CALL_NOT_FOUND))},c.prototype.attendedTransfer=function(c,d){var e=this._cpCalls[c.getCallId()];return e?e.attendedTransfer(d.getCallId()):b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.CALL_NOT_FOUND))},c.prototype.join=function(c,d){var e=this._cpCalls[c.getCallId()];return e?e.join(d):b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.CALL_NOT_FOUND))},c.prototype.sendDTMF=function(c,d){var e=b.Deferred(),f=this._cpCalls[c.getCallId()];return a.Base.Utils.isDefined(f)?(f.sendDTMF(d),e.resolve()):e.reject(new a.Services.Call.CallException(a.Services.Call.CallError.CALL_NOT_FOUND)),e.promise()},c.prototype.setVideoMode=function(c,d,e){var f=this._cpCalls[c.getCallId()];if(0===c.getVideoChannels().length){var g=this._createVideoChannel_VideoMode(d);c._videoChannels.push(g)}return a.Base.Utils.isDefined(f)&&c.getState()!==a.Services.Call.CallStates.IDLE&&c.getState()!==a.Services.Call.CallStates.ALERTING&&c.getState()!==a.Services.Call.CallStates.IGNORED?f.updateVideoMode(d,e):(this.triggerVideoChannelUpdate(c),b.Deferred().resolve())},c.prototype.addParticipantFromCall=function(c,d){var e=this._cpCalls[c];if(a.Base.Utils.isDefined(e)){if(e.call.getConference().getAddParticipantFromCallCapability(d).isAllowed){var f=d.getCallId();return this._consultConferencePromises[f]=b.Deferred(),e.addParticipantFromCall(d),this._consultConferencePromises[f]}return b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.CAPABILITY_NOT_ALLOWED))}return b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.CALL_NOT_FOUND))},c.prototype.getCallStatistics=function(c){var d=this._cpCalls[c.getCallId()];return a.Base.Utils.isDefined(d)?d.getCallStatistics():b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.CALL_NOT_FOUND)).promise()},c.prototype._triggerEndCalls=function(){for(var a in this._cpCalls)if(this._cpCalls.hasOwnProperty(a)){var b=this._cpCalls[a];b.stopAllStreams(),this._triggerAsyncEndCall(b.call)}},c.prototype._triggerAsyncEndCall=function(a){setTimeout(function(){this.triggerCallEnded(a)}.bind(this),0)},c.prototype.getMediaServiceFactory=function(){return this._mediaServiceFactory},c.prototype.startRinging=function(c){var d=b.Deferred(),e=this._cpCalls[c.getCallId()];return a.Base.Utils.isDefined(e)?(e.startRinging(),d.resolve()):d.reject(new a.Services.Call.CallException(a.Services.Call.CallError.CALL_NOT_FOUND)),d.promise()},c.prototype.acceptAnswerCallRequest=function(b){return this._acceptCallRequest(b,a.Providers.Call.CallProvider.Constants.ANSWER_CALL_REQUESTED)},c.prototype.acceptUpdateCallRequest=function(b,c){return this._acceptCallRequest(b,a.Providers.Call.CallProvider.Constants.UPDATE_CALL_REQUESTED,c)},c.prototype.acceptTerminateCallRequest=function(b){return this._acceptCallRequest(b,a.Providers.Call.CallProvider.Constants.TERMINATE_CALL_REQUESTED)},c.prototype.acceptMakeCallRequest=function(b){return this._acceptCallRequest(b,a.Providers.Call.CallProvider.Constants.MAKE_CALL_REQUESTED)},c.prototype._acceptCallRequest=function(c,d,e){var f=b.Deferred(),g=this._cpCalls[c.getCallId()];return a.Base.Utils.isDefined(g)?g.acceptCallRequest(f,d,e):f.reject(new a.Services.Call.CallException(a.Services.Call.CallError.CALL_NOT_FOUND)),f.promise()},c.prototype.rejectAnswerCallRequest=function(b){return this._rejectCallRequest(b,a.Providers.Call.CallProvider.Constants.ANSWER_CALL_REQUESTED)},c.prototype.rejectUpdateCallRequest=function(b,c){return this._rejectCallRequest(b,a.Providers.Call.CallProvider.Constants.UPDATE_CALL_REQUESTED)},c.prototype.rejectTerminateCallRequest=function(b){
return this._rejectCallRequest(b,a.Providers.Call.CallProvider.Constants.TERMINATE_CALL_REQUESTED)},c.prototype.rejectMakeCallRequest=function(b){return this._rejectCallRequest(b,a.Providers.Call.CallProvider.Constants.MAKE_CALL_REQUESTED)},c.prototype._rejectCallRequest=function(c,d){var e=b.Deferred(),f=this._cpCalls[c.getCallId()];return a.Base.Utils.isDefined(f)?f.rejectCallRequest(e,d):e.reject(new a.Services.Call.CallException(a.Services.Call.CallError.CALL_NOT_FOUND)),e.promise()},c.prototype.getOfferSDP=function(a,b,c,d,e){var f=this._cpCalls[a];f?f.getOfferSDP(b,c,d,e):this._sdpMediaOfferNotifications[a]={action:b,audioStream:c,videoStreams:d,videoBandwidth:e}},c.prototype.getQueuedMediaOfferNotification=function(a){var b=this._sdpMediaOfferNotifications[a];return b&&delete this._sdpMediaOfferNotifications[a],b},c.prototype.offerSDP=function(a,b,c,d,e,f){var g=this._cpCalls[a];g?g.offerSDP(c,b,d,e,f):this._sdpMediaOfferNotifications[a]={action:b,audioStream:d,videoStreams:e,offer:c}},c.prototype.callRinging=function(b,c,d,e,f,g,h,i,j){var k=this._cpCalls[b];k?(k.call._isEarlyMedia&&!h&&this.stopEarlyMedia(k.call),k.callRinging(c,d,e,f,g,h,i,j)):a.Base.Logger.warn(a.Base.LoggerTags.CALL_PROVIDER,"Call not found: "+b)},c.prototype.answerSDP=function(b,c,d,e,f){var g=this._cpCalls[b];g?g.answerSDP(d,c,e,f):a.Base.Logger.warn(a.Base.LoggerTags.CALL_PROVIDER,"Call not found: "+b)},c.prototype.answerSdpAck=function(b,c,d,e){var f=this._cpCalls[b];f?f.answerSdpAck(c,d,e):a.Base.Logger.warn(a.Base.LoggerTags.CALL_PROVIDER,"Call not found: "+b)},c.prototype.callEstablished=function(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s=this._cpCalls[b];if(s)a.Base.Utils.isDefined(p)?s.callEstablished(c,d,j,k,l,m,n,f,p,q,r):s.callEstablished(c,d,j,k,l,m,n,f);else{if(!f)return void a.Base.Logger.warn(a.Base.LoggerTags.CALL_PROVIDER,"Established call is not found",b);var t=this._mediaServiceFactory.getMediaServicesService().getUserMedia().adjustVideoResolution(o,this._videoResolution)||this._videoResolution,u={remoteAddress:c,remoteDisplayName:d,isAuraAsserted:i,isPrivate:g,alertType:h,audioStream:j,videoStreams:k,videoResolution:t};s=this._createCPCall(null,b,u,t),this._cpCalls[b]=s,this.triggerRemoteCallCreated(b,c,d,i,g,this._isVideoCall(k),h,e)}},c.prototype.callEndedRemotely=function(b,c){var d=this._cpCalls[b];d?d.callEndedRemotely(c):a.Base.Logger.info(a.Base.LoggerTags.CALL_PROVIDER,"Call not found: "+b)},c.prototype.callStateFailure=function(a){var b=this._cpCalls[a];b&&b.callStateFailure()},c.prototype.callFailure=function(a,b,c,d,e){var f=this._cpCalls[a];f&&f.callFailure(b,c,d,e)},c.prototype.stopEarlyMedia=function(b){var c=this._cpCalls[b];if(c){var d=this.getMediaServiceFactory().getAudioOutputInterfaceService().getAudioOutput();c.stopEarlyMedia(d)}else a.Base.Logger.warn(a.Base.LoggerTags.CALL_PROVIDER,"Call not found: "+b)},c.prototype.triggerCallStarted=function(b){this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.CALL_STARTED,[b])},c.prototype.triggerCallRinging=function(b,c){var d=!!a.Base.Utils.isDefined(c)&&c;this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.CALL_RINGING,[b,d])},c.prototype.triggerCallEstablished=function(b,c,d,e,f,g,h,i){this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.CALL_ESTABLISHED,[b,c,f,g,h,i]),c&&this.triggerConferenceEscalation(b,d,e)},c.prototype.triggerCallEstablishing=function(b){this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.CALL_ESTABLISHING,[b])},c.prototype.triggerRemoteStreamAdded=function(b,c){this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.REMOTE_STREAM_ADDED,[b,c])},c.prototype.triggerCallEnded=function(b,c,d){this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.CALL_ENDED,[b,c,d])},c.prototype.triggerRemoteCallCreated=function(b,c,d,e,f,g,h,i){this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.REMOTE_CALL_CREATED,[b,c,d,e,f,g,h,i])},c.prototype.triggerIncomingCall=function(b,c,d,e,f,g,h,i,j,k,l){this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.INCOMING_CALL,[b,c,d,e,f,g,h,i,j,k,l])},c.prototype.triggerIncomingAddVideoRequest=function(b,c){this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.INCOMING_ADD_VIDEO_REQUEST,[b,c])},c.prototype.triggerIncomingAddVideoAccepted=function(b){this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.INCOMING_ADD_VIDEO_ACCEPTED,[b])},c.prototype.triggerIncomingAddVideoDenied=function(b){this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.INCOMING_ADD_VIDEO_DENIED,[b])},c.prototype.triggerIncomingAddVideoTimedout=function(b){this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.INCOMING_ADD_VIDEO_TIMEDOUT,[b])},c.prototype.triggerVideoChannelUpdate=function(b){this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.VIDEO_CHANNEL_UPDATE,[b])},c.prototype.triggerConferenceEscalation=function(b,c,d){this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.CONFERENCE_ESCALATION,[b,c,d])},c.prototype.triggerVideoEscalationRejected=function(b){this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.VIDEO_ESCALATION_REJECTED,[b])},c.prototype.triggerCallFailure=function(b,c,d,e,f){var g=this._cpCalls[b];g&&this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[g.call,c,d,e,f])},c.prototype.triggerCallServiceUnavailable=function(b){this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.CALL_SERVICE_UNAVAILABLE,[b])},c.prototype.triggerRemoteHold=function(b){this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.INCOMING_HOLD,[b])},c.prototype.triggerRemoteUnhold=function(b){this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.INCOMING_UNHOLD,[b])},c.prototype.triggerRemoteAddressChanged=function(b,c,d){this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.REMOTE_ADDRESS_CHANGED,[b,c,d])},c.prototype.registerCall=function(b,c,d){a.Base.Logger.info(a.Base.LoggerTags.CALL_PROVIDER,"register call: "+b),c._setCallId(b),this._cpCalls[b]=d},c.prototype.unRegisterCall=function(b){b&&(a.Base.Logger.info(a.Base.LoggerTags.CALL_PROVIDER,"unregister call: "+b.getCallId()),delete this._cpCalls[b.getCallId()])},c.prototype.isVideoConfigurationEnabled=function(){return this._config.callUserConfiguration.videoEnabled},c.prototype._callRingingHandler=function(b,c,d,e,f,g,h,i,j){a.Base.Logger.info(a.Base.LoggerTags.CALL_PROVIDER,"Received Call Ringing"),this.callRinging(b,c,d,e,f,g,h,i,j)},c.prototype._callEstablishedHandler=function(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){a.Base.Logger.debug(a.Base.LoggerTags.CALL_PROVIDER,"Received Call Established"),this.callEstablished(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r)},c.prototype._createMediaRequestHandler=function(b,c,d){a.Base.Logger.info(a.Base.LoggerTags.CALL_PROVIDER,"Received Create Media Request"),this.getOfferSDP(b,void 0,void 0,c,d)},c.prototype._remoteCallEndedHandler=function(b,c){var d="Received Remote Call Ended";c&&(d=d+": ["+c.getProtocol()+","+c.getCause()+","+c.getText()+"]"),a.Base.Logger.info(a.Base.LoggerTags.CALL_PROVIDER,d),this.callEndedRemotely(b,c)},c.prototype._incomingCallHandler=function(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=this._mediaServiceFactory.getMediaServicesService().getUserMedia().adjustVideoResolution(m,this._videoResolution)||this._videoResolution;a.Base.Logger.debug(a.Base.LoggerTags.CALL_PROVIDER,"Received Incoming Call");var r={remoteAddress:c,remoteDisplayName:d,isAuraAsserted:e,isPrivate:f,alertType:g,sdp:i,audioStream:j,videoStreams:k},s=this._createCPCall(null,b,r,q);this._cpCalls[b]=s,this.triggerIncomingCall(b,c,d,e,f,this._isVideoCall(k),g,l,n,o,p)},c.prototype._callFailureHandler=function(b,c,d,e,f){a.Base.Logger.info(a.Base.LoggerTags.CALL_PROVIDER,"Received Call Failure: ["+c+":"+d+":"+e+":"+f+"]"),this.callFailure(b,c,d,e,f)},c.prototype._callStateFailureHandler=function(b,c,d,e,f){a.Base.Logger.info(a.Base.LoggerTags.CALL_PROVIDER,"Received Call State Failure: ["+c+":"+d+":"+e+":"+f+"]"),this.callStateFailure(b)},c.prototype._networkFailureHandler=function(b,c,d){a.Base.Logger.info(a.Base.LoggerTags.CALL_PROVIDER,"Received Network Failure: ["+b+":"+c+":"+d+"]");var e=!1;for(var f in this._cpCalls)if(this._cpCalls.hasOwnProperty(f)){var g=this._cpCalls[f];g&&g.call&&g._callGatewayProvider&&g._callGatewayProvider._host===b&&(this.triggerCallServiceUnavailable(g.call),this._callsAnalyticsService.sendUnavailableEvent(a.Services.Analytics.AnalyticsErrorCode.NETWORK_ERROR),e=!0)}e||(this.triggerCallServiceUnavailable(),this._callsAnalyticsService.sendUnavailableEvent(a.Services.Analytics.AnalyticsErrorCode.NO_CALL_WAS_CREATED_ERROR))},c.prototype._networkAvailabilityHandler=function(b){a.Base.Logger.info(a.Base.LoggerTags.CALL_PROVIDER,"Received Network Availability"),this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.CALL_SERVICE_AVAILABLE,[]),this.getCalls(b).then(function(c){c.forEach(function(c){var d=this._cpCalls[c.callId];d&&d._callGatewayProvider&&d._callGatewayProvider._host===b&&this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.CALL_SERVICE_AVAILABLE,[d.call])}.bind(this))}.bind(this),function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to get list of active calls from server",b)}.bind(this))},c.prototype._updateTransferStatusHandler=function(b,c){if(a.Base.Logger.info(a.Base.LoggerTags.CALL_PROVIDER,"Received Transfer Status Update: "+c),this._cpCalls.hasOwnProperty(b)){var d=this._cpCalls[b];d._transferPromise.notify(c),c===a.Providers.Call.CallProvider.Constants.TRANSFER_STATUS_DONE?d.transferCompleted():c===a.Providers.Call.CallProvider.Constants.TRANSFER_STATUS_FAILED&&d.transferFailed()}},c.prototype._updateConsultConferenceStatusHandler=function(b,c){a.Base.Logger.info(a.Base.LoggerTags.CALL_PROVIDER,"Received Consult Conference Status Update: "+c),this._consultConferencePromises.hasOwnProperty(b)&&(this._consultConferencePromises[b].notify(c),c===a.Providers.Call.CallProvider.Constants.CONSULT_CONFERENCE_STATUS_DONE?(this._consultConferencePromises[b].resolve(),delete this._consultConferencePromises[b]):(c===a.Providers.Call.CallProvider.CONSULT_CONFERENCE_STATUS_FAILED||c.indexOf(a.Providers.Call.CallProvider.Constants.ERROR)>-1)&&(a.Base.Logger.warn(a.Base.LoggerTags.CALL_PROVIDER,"Failed to add "+b+" to Consult Conference: "+c),this._consultConferencePromises[b].reject(c),delete this._consultConferencePromises[b]))},c.prototype._updateCallDataHandler=function(b,c,d,e,f,g){if(a.Base.Logger.info(a.Base.LoggerTags.CALL_PROVIDER,"Received Call Data Update: ["+b+":"+c+":"+d+":"+f+":"+g+"]"),this._cpCalls.hasOwnProperty(b)){var h=this._cpCalls[b];a.Providers.Call.Utils.updateAndTriggerRemoteAddressChangedIfNeeded(this,h.call,c,d);var i=h.call.isConference(),j=i?h.call._conference._getType():"unknown",k=h.call.isConference()&&!h.call.getConference()._isConferenceStarted();a.Base.Logger.debug(a.Base.LoggerTags.CALL_PROVIDER,(e?"Conference":"Non-Conference")+" Data Update: [Existing conference call? "+i+"; Is conference not started? "+k+"; Conference type="+j+"; uucpUrl="+f+"; webCollabUrl="+g+"]"),e&&(!h.call.isConference()||h.call.isConference()&&!h.call.getConference()._isConferenceStarted()||f||g)&&this.triggerConferenceEscalation(h.call,f,g)}},c.prototype._iceConfigUpdatesHandler=function(a){if(a&&a.length>0){this._rtcConfiguration={iceServers:[{urls:""}]},this._rtcConfiguration.iceServers[0].urls="stun:"+a[0];for(var b=1;b<a.length;b++)this._rtcConfiguration.iceServers[0].urls+=",stun:"+a[b]}},c.prototype._videoLicenseUpdatedHandler=function(b){this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.VIDEO_LICENSE_UPDATED,[b])},c.prototype._createVideoChannel_VideoMode=function(b){var c=new a.Services.Call.VideoChannel;return c._setChannelId(this._mediaServiceFactory.getVideoInterfaceService().createVideoChannel()),c._setRequestedDirection(a.Providers.Call.Utils.getVideoDirection(b)),c},c.prototype.createVideoChannel_MediaDirection=function(b){var c=new a.Services.Call.VideoChannel;return c._setChannelId(this._mediaServiceFactory.getVideoInterfaceService().createVideoChannel()),c._setRequestedDirection(b),c},c.prototype.hasVideoDevices=function(){return this._mediaServiceFactory.getVideoInterface().getAvailableDevices().length>0},c.prototype.hasNonBlockingVideoDevices=function(){return this._mediaServiceFactory.getVideoInterface().getAvailableDevices().filter(function(a){return""!==a._label}).length>0},c.prototype._isVideoCall=function(b){return a.Base.Utils.isDefined(b)&&b.length>0&&b[0].enabled&&b[0].direction!==a.Services.Call.MediaDirection.INACTIVE},c.prototype._ringbackToneURLsChangedHandler=function(b){this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.RINGBACK_TONE_URLS_CHANGED,[b])},c.prototype._isBrowserSupported=function(){var b=a.Base.Utils.getBrowserType();return b===a.Base.BrowserType.CHROME||b===a.Base.BrowserType.CHROME_EXTENSION||b===a.Base.BrowserType.FIREFOX||b===a.Base.BrowserType.FIREFOX_EXTENSION},c.prototype._answerCallRequestedHandler=function(b,c){if(this._cpCalls.hasOwnProperty(b)){var d=this._cpCalls[b];d.setCallRequestedTransactionalId(a.Providers.Call.CallProvider.Constants.ANSWER_CALL_REQUESTED,c),this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.ANSWER_CALL_REQUESTED,[d.call])}},c.prototype._terminateCallRequestedHandler=function(b,c){if(this._cpCalls.hasOwnProperty(b)){var d=this._cpCalls[b];d.setCallRequestedTransactionalId(a.Providers.Call.CallProvider.Constants.TERMINATE_CALL_REQUESTED,c),this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.TERMINATE_CALL_REQUESTED,[d.call])}},c.prototype._updateCallRequestedHandler=function(b,c,d){if(this._cpCalls.hasOwnProperty(b)){var e=this._cpCalls[b];e.setCallRequestedTransactionalId(a.Providers.Call.CallProvider.Constants.UPDATE_CALL_REQUESTED,c),this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.UPDATE_CALL_REQUESTED,[e.call,d])}},c.prototype._makeCallRequestedHandler=function(b,c,d,e,f,g){var h=this._createCPCall(null,b);this._cpCalls[b]=h,h.setCallRequestedTransactionalId(a.Providers.Call.CallProvider.Constants.MAKE_CALL_REQUESTED,d),this.trigger(a.Providers.Interfaces.CallProviderCallbackIds.MAKE_CALL_REQUESTED,[b,c,e,f,g])},a.Providers.Call.CallProvider=c}(window.AvayaClientServices=window.AvayaClientServices||{},window.jQuery=window.jQuery||{}),function(a){"use strict";var b={DISABLE_STATE:"DISABLE",ENABLE_STATE:"ENABLE",ERROR:"ERROR",ADD_VIDEO:"ADD_VIDEO",UPDATE_VIDEO:"UPDATE_VIDEO",REMOVE_VIDEO:"REMOVE_VIDEO",HOLD:"HOLD",INCOMING_UNHOLD:"INCOMING_UNHOLD",UNHOLD:"UNHOLD",VIDEO_TRACK:"video",AUDIO_TRACK:"audio",ADD_PARTICIPANT_ACTION:"ADD_PARTICIPANT",ADD_VIDEO_ACTION:"ADD_VIDEO",HOLD_ACTION:"HOLD",UNHOLD_ACTION:"UNHOLD",INCOMING_ADD_VIDEO_ACTION:"INCOMING_ADD_VIDEO",INCOMING_REMOVE_VIDEO_ACTION:"INCOMING_REMOVE_VIDEO",INCOMING_UPDATE_VIDEO_ACTION:"INCOMING_UPDATE_VIDEO",INCOMING_HOLD_ACTION:"INCOMING_HOLD",INCOMING_UNHOLD_ACTION:"INCOMING_UNHOLD",TRANSFER_ACTION:"TRANSFER",TRANSFER_STATUS_DONE:"DONE",TRANSFER_STATUS_FAILED:"FAILED",CONSULT_CONFERENCE_STATUS_DONE:"DONE",CONSULT_CONFERENCE_STATUS_FAILED:"FAILED",END_CALL_BY_REMOTE:"remote",END_CALL_NORMAL:"normal",END_CALL_DENY_WITH_REASON:"denyWithReason",INITIAL_MEDIA:"INITIAL_MEDIA",DEFAULT_CALL_GW_PROVIDER:"DefaultCallGWProvider",ANSWER_CALL_REQUESTED:"AnswerCallRequested",MAKE_CALL_REQUESTED:"MakeCallRequested",TERMINATE_CALL_REQUESTED:"TerminateCallRequested",UPDATE_CALL_REQUESTED:"UpdateCallRequested"};a.Providers.Call.CallProvider.Constants=b}(AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";var b=a.Providers.Call.States={};b.INITIAL=new a.Base.SimpleFsm.SimpleFsmState("INITIAL"),b.STARTING=new a.Base.SimpleFsm.SimpleFsmState("STARTING"),b.ALERTING=new a.Base.SimpleFsm.SimpleFsmState("ALERTING"),b.ACTIVE=new a.Base.SimpleFsm.SimpleFsmState("ACTIVE"),b.ACTIVE_RENEGOTIATE=new a.Base.SimpleFsm.SimpleFsmState("ACTIVE_RENEGOTIATE"),b.FAILED=new a.Base.SimpleFsm.SimpleFsmState("FAILED"),b.ENDING=new a.Base.SimpleFsm.SimpleFsmState("ENDING"),b.ENDED=new a.Base.SimpleFsm.SimpleFsmState("ENDED")}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";a.Providers.Call.Utils={updateVideoSdp:function(b,c){switch(b.direction){case a.Services.Call.MediaDirection.SEND_ONLY:return a.Base.SDPUtil.updateVideoSdpSendOnly(c);case a.Services.Call.MediaDirection.SEND_RECV:return a.Base.SDPUtil.updateVideoSdpSendRecv(c);case a.Services.Call.MediaDirection.RECV_ONLY:return a.Base.SDPUtil.updateVideoSdpRecvOnly(c);default:return a.Base.SDPUtil.updateVideoSdpInactive(c)}},updateAudioSdp:function(b,c){switch(b.direction){case a.Services.Call.MediaDirection.SEND_ONLY:return a.Base.SDPUtil.updateAudioSdpSendOnly(c);case a.Services.Call.MediaDirection.SEND_RECV:return a.Base.SDPUtil.updateAudioSdpSendRecv(c);case a.Services.Call.MediaDirection.RECV_ONLY:return a.Base.SDPUtil.updateAudioSdpRecvOnly(c);default:return a.Base.SDPUtil.updateAudioSdpInactive(c)}},updateAndTriggerRemoteAddressChangedIfNeeded:function(b,c,d,e){var f=a.Base.Utils.isDefined(e)&&c.getRemoteDisplayName()!==e;(a.Base.Utils.isDefined(d)&&c.getRemoteAddress()!==d||f)&&b.triggerRemoteAddressChanged(c,d,e)},getVideoDirection:function(b){switch(b){case a.Services.Call.VideoMode.SEND_RECEIVE:return a.Services.Call.MediaDirection.SEND_RECV;case a.Services.Call.VideoMode.SEND_ONLY:return a.Services.Call.MediaDirection.SEND_ONLY;case a.Services.Call.VideoMode.RECEIVE_ONLY:return a.Services.Call.MediaDirection.RECV_ONLY;case a.Services.Call.VideoMode.INACTIVE:return a.Services.Call.MediaDirection.INACTIVE;case a.Services.Call.VideoMode.DISABLE:return a.Services.Call.MediaDirection.DISABLE;default:return a.Services.Call.MediaDirection.UNDEFINED}},getVideoMode:function(b){switch(b){case a.Services.Call.MediaDirection.SEND_RECV:return a.Services.Call.VideoMode.SEND_RECEIVE;case a.Services.Call.MediaDirection.SEND_ONLY:return a.Services.Call.VideoMode.SEND_ONLY;case a.Services.Call.MediaDirection.RECV_ONLY:return a.Services.Call.VideoMode.RECEIVE_ONLY;case a.Services.Call.MediaDirection.INACTIVE:return a.Services.Call.VideoMode.INACTIVE;default:return a.Services.Call.VideoMode.DISABLE}}}}(AvayaClientServices),function(a){"use strict";function b(a,b,c){this._protocol=a,this._cause=b,this._text=c}b.prototype={getProtocol:function(){return this._protocol},getCause:function(){return this._cause},getText:function(){return this._text},_setCause:function(a){this._cause=a},_setProtocol:function(a){this._protocol=a}},a.Providers.Call.CallReason=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b,c,d,e){this._callGatewayProvider=d,this._callProvider=c,this.call=b,this.localStream=null,this.remoteStream=null,this.remote=!1,this.callId=null,this.incomingCallInfo={},this.incomingVideoRequestTimer=void 0,this.mediaTransactionDfd=void 0,this._mediaTransactionInitialEvent=void 0,this.audioStream=null,this.videoStreams=[],this._videoChannelId=void 0,this._audioDevice=void 0,this._videoDevice=void 0,this._isFirefoxBrowser=this._checkIfBrowserIsFirefox(),this._rtConnection=c._rtcConnectionProviderFactory.create(c._rtcConfiguration),this._transferPromise=void 0,this._joinRemotePromise=void 0,this._isEarlyMedia=!1,this._videoResolution=e,this._maxVideoResolution=e,this._queuedActiveRenegotiateEvent=void 0,this._queuedRemoteCallEstablishedEvent=void 0,this._3pccRequestTransactionMap={},this.isNewAudioVideoRequiredForMidCallWithMediaAdaptation=!1,this._getOfferSDPEventInMultipleHandler=new a.Providers.Call.GetOfferSDPEventInMultipleHandler,this._offerSDPEventInMultipleHandler=new a.Providers.Call.OfferSDPEventInMultipleHandler,this._OfferSDPFirefoxMidcallEventInMultipleHandler=new a.Providers.Call.OfferSDPFirefoxMidcallEventInMultipleHandler,this._escalateVideoGetOfferEventInActiveRenegotiateHandler=new a.Providers.Call.EscalateVideoGetOfferEventInActiveRenegotiateHandler,this._escalateVideoOfferEventInActiveRenegotiateHandler=new a.Providers.Call.EscalateVideoOfferEventInActiveRenegotiateHandler,this._fsm=new a.Base.SimpleFsm.SimpleFsm,this._fsm.registerHandler(a.Providers.Call.States.INITIAL,a.Providers.Call.StartCallEvent,a.Providers.Call.StartCallEventInInitialHandler),this._fsm.registerHandler(a.Providers.Call.States.INITIAL,a.Providers.Call.AcceptCallEvent,a.Providers.Call.AcceptCallEventInInitialHandler),this._fsm.registerHandler(a.Providers.Call.States.INITIAL,a.Providers.Call.EndCallEvent,a.Providers.Call.EndCallEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.INITIAL,a.Providers.Call.JoinRemoteCallEvent,a.Providers.Call.JoinRemoteCallEventInInitialHandler),this._fsm.registerHandler(a.Providers.Call.States.INITIAL,a.Providers.Call.RevertStateEvent,a.Providers.Call.RevertStateEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.INITIAL,a.Providers.Call.CallFailureEvent,a.Providers.Call.CallFailureEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.INITIAL,a.Providers.Call.AcceptCallRequestEvent,a.Providers.Call.AcceptCallRequestEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.INITIAL,a.Providers.Call.RejectCallRequestEvent,a.Providers.Call.RejectCallRequestEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.INITIAL,a.Providers.Call.StartRingingEvent,a.Providers.Call.StartRingingEventInInitialHandler),this._fsm.registerHandler(a.Providers.Call.States.STARTING,a.Providers.Call.StartCallResponseEvent,a.Providers.Call.StartCallResponseEventInStartingHandler),this._fsm.registerHandler(a.Providers.Call.States.STARTING,a.Providers.Call.GetOfferSDPEvent,a.Providers.Call.GetOfferSDPEventInStartingHandler),this._fsm.registerHandler(a.Providers.Call.States.STARTING,a.Providers.Call.OfferSDPEvent,a.Providers.Call.OfferSDPEventInStartingHandler),this._fsm.registerHandler(a.Providers.Call.States.STARTING,a.Providers.Call.CallRingingEvent,a.Providers.Call.CallRingingEventInStartingHandler),this._fsm.registerHandler(a.Providers.Call.States.STARTING,a.Providers.Call.AnswerSDPEvent,a.Providers.Call.AnswerSDPEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.STARTING,a.Providers.Call.MuteAudioEvent,a.Providers.Call.MuteAudioEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.STARTING,a.Providers.Call.UnmuteAudioEvent,a.Providers.Call.UnmuteAudioEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.STARTING,a.Providers.Call.OnAddStreamEvent,a.Providers.Call.OnAddStreamEventPreActiveHandler),this._fsm.registerHandler(a.Providers.Call.States.STARTING,a.Providers.Call.CallEstablishedEvent,a.Providers.Call.CallEstablishedEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.STARTING,a.Providers.Call.EndCallEvent,a.Providers.Call.EndCallEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.STARTING,a.Providers.Call.DeviceRetrievalFailedEvent,a.Providers.Call.DevicesFailureHandler),this._fsm.registerHandler(a.Providers.Call.States.STARTING,a.Providers.Call.UpdateLocalStreamEvent,a.Providers.Call.UpdateLocalStreamHandler),this._fsm.registerHandler(a.Providers.Call.States.STARTING,a.Providers.Call.CallFailureEvent,a.Providers.Call.CallFailureEventInMultipleHandler),this._fsm.registerNoOpHandler(a.Providers.Call.States.STARTING,a.Providers.Call.CallStateFailureEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ALERTING,a.Providers.Call.CallRingingEvent),this._fsm.registerHandler(a.Providers.Call.States.ALERTING,a.Providers.Call.AnswerSDPEvent,a.Providers.Call.AnswerSDPEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.ALERTING,a.Providers.Call.MuteAudioEvent,a.Providers.Call.MuteAudioEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.ALERTING,a.Providers.Call.UnmuteAudioEvent,a.Providers.Call.UnmuteAudioEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.ALERTING,a.Providers.Call.OnAddStreamEvent,a.Providers.Call.OnAddStreamEventPreActiveHandler),this._fsm.registerHandler(a.Providers.Call.States.ALERTING,a.Providers.Call.CallEstablishedEvent,a.Providers.Call.CallEstablishedEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.ALERTING,a.Providers.Call.EndCallEvent,a.Providers.Call.EndCallEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.ALERTING,a.Providers.Call.SendDTMFEvent,a.Providers.Call.SendDTMFEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.ALERTING,a.Providers.Call.GetOfferSDPEvent,a.Providers.Call.GetOfferSDPEventInStartingHandler),this._fsm.registerHandler(a.Providers.Call.States.ALERTING,a.Providers.Call.OfferSDPEvent,a.Providers.Call.OfferSDPEventInStartingHandler),this._fsm.registerHandler(a.Providers.Call.States.ALERTING,a.Providers.Call.CallFailureEvent,a.Providers.Call.CallFailureEventInMultipleHandler),this._fsm.registerNoOpHandler(a.Providers.Call.States.ALERTING,a.Providers.Call.CallStateFailureEvent),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.CallEstablishedEvent,a.Providers.Call.CallEstablishedEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.IncomingAddVideoEvent,a.Providers.Call.IncomingAddVideoEventInActiveHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.IncomingRemoveVideoEvent,a.Providers.Call.IncomingRemoveVideoEventInActiveHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.IncomingAddVideoTimedoutEvent,a.Providers.Call.IncomingAddVideoTimedoutEventInActiveHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.AcceptSendVideoEvent,a.Providers.Call.AcceptSendVideoEventInActiveHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.DenySendVideoEvent,a.Providers.Call.DenySendVideoEventInActiveHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.MuteAudioEvent,a.Providers.Call.MuteAudioEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.UnmuteAudioEvent,a.Providers.Call.UnmuteAudioEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.MuteSpeakerEvent,a.Providers.Call.MuteSpeakerEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.UnmuteSpeakerEvent,a.Providers.Call.UnmuteSpeakerEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.BlockCameraEvent,a.Providers.Call.BlockCameraEventInActiveHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.UnBlockCameraEvent,a.Providers.Call.UnBlockCameraEventInActiveHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.EscalateVideoEvent,a.Providers.Call.EscalateVideoEventInActiveHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.DeEscalateVideoEvent,a.Providers.Call.DeEscalateVideoEventInActiveHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.GetOfferSDPEvent,this._getOfferSDPEventInMultipleHandler.handleEvent.bind(this._getOfferSDPEventInMultipleHandler)),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.OfferSDPEvent,this._offerSDPEventInMultipleHandler.handleEvent.bind(this._offerSDPEventInMultipleHandler)),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.OfferSDPFirefoxMidcallEvent,this._OfferSDPFirefoxMidcallEventInMultipleHandler.handleEvent.bind(this._OfferSDPFirefoxMidcallEventInMultipleHandler)),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.SendDTMFEvent,a.Providers.Call.SendDTMFEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.OnAddStreamEvent,a.Providers.Call.OnAddStreamEventInActiveHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.OnAddRemoteTrackEvent,a.Providers.Call.OnAddRemoteTrackEventInActiveHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.OnRemoveRemoteTrackEvent,a.Providers.Call.OnRemoveRemoteTrackEventInActiveHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.EndCallEvent,a.Providers.Call.EndCallEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.DeviceRetrievalFailedEvent,a.Providers.Call.DevicesFailureHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.UpdateRemoteVideoEvent,a.Providers.Call.UpdateRemoteVideoEventInActiveHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.HoldEvent,a.Providers.Call.HoldEventInActiveHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.UnHoldEvent,a.Providers.Call.UnHoldEventInActiveHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.UpdateLocalStreamEvent,a.Providers.Call.UpdateLocalStreamHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.AttendedTransferEvent,a.Providers.Call.AttendedTransferEventInActiveHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.TransferEvent,a.Providers.Call.TransferEventInActiveHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.CallRingingEvent,a.Providers.Call.CallRingingEventInActiveHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.EscalateVideoRejectedEvent,this._offerSDPEventInMultipleHandler.handleEvent.bind(this._offerSDPEventInMultipleHandler)),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.AddParticipantFromExistingCallEvent,a.Providers.Call.AddParticipantFromExistingCallEventInActiveHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.IncomingGenericOfferSDPEvent,a.Providers.Call.IncomingGenericOfferSDPEventInActive),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.CallFailureEvent,a.Providers.Call.CallFailureEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.EscalateVideoOfferEvent,this._escalateVideoOfferEventInActiveRenegotiateHandler.handleEvent.bind(this._escalateVideoOfferEventInActiveRenegotiateHandler)),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.AcceptCallRequestEvent,a.Providers.Call.AcceptCallRequestEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.RejectCallRequestEvent,a.Providers.Call.RejectCallRequestEventInMultipleHandler),this._fsm.registerNoOpHandler(a.Providers.Call.States.ACTIVE,a.Providers.Call.CallStateFailureEvent),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE_RENEGOTIATE,a.Providers.Call.CallEstablishedEvent,a.Providers.Call.CallEstablishedEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE_RENEGOTIATE,a.Providers.Call.GetOfferSDPEvent,this._getOfferSDPEventInMultipleHandler.handleEvent.bind(this._getOfferSDPEventInMultipleHandler)),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE_RENEGOTIATE,a.Providers.Call.OfferSDPEvent,this._offerSDPEventInMultipleHandler.handleEvent.bind(this._offerSDPEventInMultipleHandler)),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE_RENEGOTIATE,a.Providers.Call.OfferSDPFirefoxMidcallEvent,this._OfferSDPFirefoxMidcallEventInMultipleHandler.handleEvent.bind(this._OfferSDPFirefoxMidcallEventInMultipleHandler)),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE_RENEGOTIATE,a.Providers.Call.AnswerSDPEvent,a.Providers.Call.AnswerSDPEventInActiveRenegotiateHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE_RENEGOTIATE,a.Providers.Call.AnswerSdpAckEvent,a.Providers.Call.AnswerSdpAckEventInActiveRenegotiateHandler),
this._fsm.registerHandler(a.Providers.Call.States.ACTIVE_RENEGOTIATE,a.Providers.Call.MuteAudioEvent,a.Providers.Call.MuteAudioEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE_RENEGOTIATE,a.Providers.Call.UnmuteAudioEvent,a.Providers.Call.UnmuteAudioEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE_RENEGOTIATE,a.Providers.Call.MuteSpeakerEvent,a.Providers.Call.MuteSpeakerEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE_RENEGOTIATE,a.Providers.Call.UnmuteSpeakerEvent,a.Providers.Call.UnmuteSpeakerEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE_RENEGOTIATE,a.Providers.Call.EscalateVideoGetOfferEvent,this._escalateVideoGetOfferEventInActiveRenegotiateHandler.handleEvent.bind(this._escalateVideoGetOfferEventInActiveRenegotiateHandler)),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE_RENEGOTIATE,a.Providers.Call.EscalateVideoOfferEvent,this._escalateVideoOfferEventInActiveRenegotiateHandler.handleEvent.bind(this._escalateVideoOfferEventInActiveRenegotiateHandler)),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE_RENEGOTIATE,a.Providers.Call.EscalateVideoAnswerEvent,a.Providers.Call.EscalateVideoAnswerEventInActiveRenegotiateHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE_RENEGOTIATE,a.Providers.Call.EscalateVideoRejectedEvent,a.Providers.Call.EscalateVideoRejectedEventInActiveRenegotiateHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE_RENEGOTIATE,a.Providers.Call.RevertStateEvent,a.Providers.Call.RevertStateEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE_RENEGOTIATE,a.Providers.Call.OnAddStreamEvent,a.Providers.Call.OnAddStreamEventInActiveHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE_RENEGOTIATE,a.Providers.Call.EndCallEvent,a.Providers.Call.EndCallEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE_RENEGOTIATE,a.Providers.Call.DeviceRetrievalFailedEvent,a.Providers.Call.DevicesFailureHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE_RENEGOTIATE,a.Providers.Call.OnRemoveRemoteTrackEvent,a.Providers.Call.OnRemoveRemoteTrackEventInActiveHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE_RENEGOTIATE,a.Providers.Call.CallStateFailureEvent,a.Providers.Call.CallFailureEventInActiveRenegotiateHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE_RENEGOTIATE,a.Providers.Call.CallFailureEvent,a.Providers.Call.CallFailureEventInActiveRenegotiateHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE_RENEGOTIATE,a.Providers.Call.IncomingGenericOfferSDPEvent,a.Providers.Call.IncomingGenericOfferSDPEventInActiveRenegotiate),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE_RENEGOTIATE,a.Providers.Call.AcceptCallRequestEvent,a.Providers.Call.AcceptCallRequestEventInMultipleHandler),this._fsm.registerHandler(a.Providers.Call.States.ACTIVE_RENEGOTIATE,a.Providers.Call.RejectCallRequestEvent,a.Providers.Call.RejectCallRequestEventInMultipleHandler),this._fsm.registerNoOpHandler(a.Providers.Call.States.ACTIVE_RENEGOTIATE,a.Providers.Call.UpdateLocalStreamEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ACTIVE_RENEGOTIATE,a.Providers.Call.OnAddRemoteTrackEvent),this._fsm.registerHandler(a.Providers.Call.States.ENDING,a.Providers.Call.EndCallEvent,a.Providers.Call.EndCallResponseEventInEndingHandler),this._fsm.registerHandler(a.Providers.Call.States.ENDING,a.Providers.Call.EndCallResponseEvent,a.Providers.Call.EndCallResponseEventInEndingHandler),this._fsm.registerHandler(a.Providers.Call.States.ENDING,a.Providers.Call.CallEstablishedEvent,a.Providers.Call.IncomingCallEstablishedEventInEndingHandler),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDING,a.Providers.Call.StartCallResponseEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDING,a.Providers.Call.GetOfferSDPEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDING,a.Providers.Call.OfferSDPEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDING,a.Providers.Call.OfferSDPFirefoxMidcallEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDING,a.Providers.Call.CallRingingEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDING,a.Providers.Call.AnswerSDPEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDING,a.Providers.Call.MuteAudioEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDING,a.Providers.Call.UnmuteAudioEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDING,a.Providers.Call.MuteSpeakerEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDING,a.Providers.Call.UnmuteSpeakerEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDING,a.Providers.Call.BlockCameraEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDING,a.Providers.Call.UnBlockCameraEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDING,a.Providers.Call.EscalateVideoEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDING,a.Providers.Call.DeEscalateVideoEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDING,a.Providers.Call.RevertStateEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDING,a.Providers.Call.OnAddStreamEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDING,a.Providers.Call.HoldEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDING,a.Providers.Call.UnHoldEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDING,a.Providers.Call.IncomingGenericOfferSDPEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDING,a.Providers.Call.CallStateFailureEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDING,a.Providers.Call.CallFailureEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDING,a.Providers.Call.AcceptCallRequestEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDING,a.Providers.Call.RejectCallRequestEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDED,a.Providers.Call.EndCallResponseEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDED,a.Providers.Call.EndCallEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDED,a.Providers.Call.StartCallResponseEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDED,a.Providers.Call.GetOfferSDPEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDED,a.Providers.Call.OfferSDPEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDED,a.Providers.Call.OfferSDPFirefoxMidcallEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDED,a.Providers.Call.CallRingingEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDED,a.Providers.Call.AnswerSDPEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDED,a.Providers.Call.MuteAudioEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDED,a.Providers.Call.UnmuteAudioEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDED,a.Providers.Call.MuteSpeakerEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDED,a.Providers.Call.UnmuteSpeakerEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDED,a.Providers.Call.CallEstablishedEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDED,a.Providers.Call.BlockCameraEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDED,a.Providers.Call.UnBlockCameraEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDED,a.Providers.Call.EscalateVideoEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDED,a.Providers.Call.DeEscalateVideoEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDED,a.Providers.Call.RevertStateEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDED,a.Providers.Call.OnAddStreamEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDED,a.Providers.Call.HoldEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDED,a.Providers.Call.UnHoldEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDED,a.Providers.Call.IncomingGenericOfferSDPEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDED,a.Providers.Call.CallStateFailureEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDED,a.Providers.Call.CallFailureEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDED,a.Providers.Call.AcceptCallRequestEvent),this._fsm.registerNoOpHandler(a.Providers.Call.States.ENDED,a.Providers.Call.RejectCallRequestEvent),this._fsm.start(a.Providers.Call.States.INITIAL),a.Base.Logger.debug(a.Base.LoggerTags.CALL_PROVIDER,"Initialized CPCall")}b.prototype={},b.prototype.prepareEvent=function(a){return a.data||(a.data={}),a.data.cpCall=this,a.data.callProvider=this._callProvider,a},b.prototype.handleEvent=function(a){this.prepareEvent(a),this._fsm.handleEvent(a)},b.prototype.revertFsmState=function(b){var c=new a.Providers.Call.RevertStateEvent;c.data={state:b},this.handleEvent(c)},b.prototype.startCall=function(b,c,d,e,f){this._audioDevice=b,this._videoDevice=c,e=e||!1,f=f||!1;var g=new a.Providers.Call.StartCallEvent;g.data={remoteAddress:this.call.getRemoteAddress(),audioDevice:b,videoDevice:c,video:d,videoResolution:this._videoResolution,webCollab:e,uccp:f},this.handleEvent(g)},b.prototype.getOfferSDP=function(b,c,d,e,f,g){var h;switch(b){case a.Providers.Call.CallProvider.Constants.ADD_VIDEO_ACTION:h=new a.Providers.Call.EscalateVideoGetOfferEvent;break;default:h=new a.Providers.Call.GetOfferSDPEvent}var i=this.adjustVideoResolution(b,d,e);h.data={action:b,audioStream:c,videoStreams:d,audioDevice:f,videoDevice:g,videoResolution:i},this.handleEvent(h)},b.prototype.offerSDP=function(b,c,d,e,f){var g,h={offer:b,action:c,audioStream:d,videoStreams:e,audioDevice:this._callProvider.getMediaServiceFactory().getAudioInterface().getInputInterface().getSelectedDevice(),videoDevice:this._callProvider.getMediaServiceFactory().getVideoInterface().getSelectedDevice()};switch(a.Base.Utils.isDefined(this.mediaTransactionDfd)&&this.mediaTransactionDfd.state()!==a.Base.DeferredStates.PENDING&&this.call.getState()===a.Services.Call.CallStates.ESTABLISHED&&this.call._setState(a.Services.Call.CallStates.FAR_END_RENEGOTIATING),c){case a.Providers.Call.CallProvider.Constants.ADD_VIDEO_ACTION:g=0===e.length||!1===e[0].enabled?new a.Providers.Call.OfferSDPEvent(h):new a.Providers.Call.EscalateVideoOfferEvent(h);break;case a.Providers.Call.CallProvider.Constants.INCOMING_ADD_VIDEO_ACTION:case a.Providers.Call.CallProvider.Constants.INCOMING_REMOVE_VIDEO_ACTION:case a.Providers.Call.CallProvider.Constants.INCOMING_HOLD_ACTION:case a.Providers.Call.CallProvider.Constants.INCOMING_UNHOLD_ACTION:case a.Providers.Call.CallProvider.Constants.INCOMING_UPDATE_VIDEO_ACTION:g=new a.Providers.Call.IncomingGenericOfferSDPEvent(h);break;default:this.isNewAudioVideoRequiredForMidCallWithMediaAdaptation?(this.isNewAudioVideoRequiredForMidCallWithMediaAdaptation=!1,g=new a.Providers.Call.OfferSDPFirefoxMidcallEvent(h)):g=new a.Providers.Call.OfferSDPEvent(h)}var i=this.adjustVideoResolution(c,e,f);h.videoResolution=i,this.handleEvent(g)},b.prototype.callRinging=function(b,c,d,e,f,g,h,i){var j=new a.Providers.Call.CallRingingEvent;j.data={address:b,displayName:c,isAuraAsserted:d,isPrivate:e,alertType:f,earlyMedia:g,audioStream:h,videoStreams:i},this.handleEvent(j)},b.prototype.answerSDP=function(b,c,d,e){var f;switch(c){case a.Providers.Call.CallProvider.Constants.ADD_VIDEO_ACTION:f=new a.Providers.Call.EscalateVideoAnswerEvent;break;default:f=new a.Providers.Call.AnswerSDPEvent}f.data={answer:b,action:c,audioStream:d,videoStreams:e},this.handleEvent(f)},b.prototype.answerSdpAck=function(b,c,d){var e;switch(b){case a.Providers.Call.CallProvider.Constants.ADD_VIDEO_ACTION:e=0===d.length||!1===d[0].enabled?new a.Providers.Call.EscalateVideoRejectedEvent:new a.Providers.Call.AnswerSdpAckEvent;break;default:e=new a.Providers.Call.AnswerSdpAckEvent}e.data={action:b,audioStream:c,videoStreams:d},this.handleEvent(e)},b.prototype.callEstablished=function(b,c,d,e,f,g,h,i,j,k,l){var m=new a.Providers.Call.CallEstablishedEvent;m.data={address:b,displayName:c,audioStream:d,videoStreams:e,isConf:f,isRemote:i},f&&(m.data.uccpUrl=g,m.data.webCollabUrl=h),j&&(m.data.ucid=j,m.data.parentUcid=k,m.data.contextId=l),this.handleEvent(m)},b.prototype.muteAudio=function(){var b=new a.Providers.Call.MuteAudioEvent;this.handleEvent(b)},b.prototype.unmuteAudio=function(){var b=new a.Providers.Call.UnmuteAudioEvent;this.handleEvent(b)},b.prototype.muteSpeaker=function(){var b=new a.Providers.Call.MuteSpeakerEvent;this.handleEvent(b)},b.prototype.unmuteSpeaker=function(){var b=new a.Providers.Call.UnmuteSpeakerEvent;this.handleEvent(b)},b.prototype.end=function(b){a.Base.Logger.debug(a.Base.LoggerTags.CALL_PROVIDER,"Local call ending: "+b);var c=new a.Providers.Call.EndCallEvent;c.data={remote:!1,denialReason:b},this.handleEvent(c)},b.prototype.callEndedRemotely=function(b){var c=new a.Providers.Call.EndCallEvent;c.data={remote:!0,callReason:b},this.handleEvent(c)},b.prototype.incomingCall=function(){var b=new a.Providers.Call.IncomingCallEvent;this.handleEvent(b)},b.prototype.acceptCall=function(b,c){this._audioDevice=b,this._videoDevice=c;var d=new a.Providers.Call.AcceptCallEvent;d.data={audioDevice:b};var e=this.call.getVideoChannels();e.length>0&&(d.data.videoDevice=c,d.data.videoChannel=e[0],d.data.videoResolution=this.getVideoResolution()),this.handleEvent(d)},b.prototype.acceptSendVideo=function(b,c){this.mediaTransactionDfd=$.Deferred(),this._videoDevice=b;var d=new a.Providers.Call.AcceptSendVideoEvent;return d.data={videoChannel:c,videoDevice:b,videoResolution:this.getVideoResolution()},this._mediaTransactionInitialEvent=d,this.handleEvent(d),this.mediaTransactionDfd.promise()},b.prototype.denySendVideo=function(){var b=new a.Providers.Call.DenySendVideoEvent;this.handleEvent(b)},b.prototype.callFailed=function(b,c,d){var e=new a.Providers.Call.EndCallEvent;e.data={remote:!1,reason:d},this.handleEvent(e)},b.prototype.callStateFailure=function(){var b=new a.Providers.Call.CallStateFailureEvent;this.handleEvent(b)},b.prototype.callFailure=function(b,c,d,e){var f={errorCode:b,protocolType:c,protocolErrorCode:d,failureReason:e},g=new a.Providers.Call.CallFailureEvent(f);this.handleEvent(g)},b.prototype.blockCamera=function(){this.mediaTransactionDfd=$.Deferred();var b=new a.Providers.Call.BlockCameraEvent;return this._mediaTransactionInitialEvent=b,this.handleEvent(b),this.mediaTransactionDfd.promise()},b.prototype.unBlockCamera=function(b){this.mediaTransactionDfd=$.Deferred(),this._isFirefoxBrowser&&(this.isNewAudioVideoRequiredForMidCallWithMediaAdaptation=!0);var c=new a.Providers.Call.UnBlockCameraEvent;return c.data={videoDevice:b,videoResolution:this.getVideoResolution()},this._mediaTransactionInitialEvent=c,this.handleEvent(c),this.mediaTransactionDfd.promise()},b.prototype.updateRemoteVideo=function(){this.mediaTransactionDfd=$.Deferred();var b=new a.Providers.Call.UpdateRemoteVideoEvent;return this._mediaTransactionInitialEvent=b,this.handleEvent(b),this.mediaTransactionDfd.promise()},b.prototype.updateVideoResolution=function(b,c,d){this.mediaTransactionDfd=$.Deferred();var e=new a.Providers.Call.UpdateLocalStreamEvent;e.data={audioDevice:b,videoDevice:c,videoResolutionChanged:!0};var f=!1;return d?d.getMinBandwidth()<this._videoResolution.getMinBandwidth()||d.getMinBandwidth()>this._videoResolution.getMinBandwidth()&&d.getMinBandwidth()<this._maxVideoResolution.getMinBandwidth()?(this._videoResolution=d,e.data.videoResolution=d):d.getMinBandwidth()>this._maxVideoResolution.getMinBandwidth()&&this._videoResolution.getMinBandwidth()!==this._maxVideoResolution.getMinBandwidth()?(this._videoResolution=this._maxVideoResolution,e.data.videoResolution=this._maxVideoResolution):f=!0:e.data.videoResolution=this._videoResolution,f?(a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to update local stream to: "+d.getMinBandwidth()),this.mediaTransactionDfd.reject(new a.Services.Call.CallException(a.Services.Call.CallError.FAILED)).promise()):(this._mediaTransactionInitialEvent=e,this.handleEvent(e),this.mediaTransactionDfd.promise())},b.prototype.updateDevice=function(b,c,d,e){this.mediaTransactionDfd=$.Deferred();var f=new a.Providers.Call.UpdateLocalStreamEvent;return f.data={audioDevice:b,videoDevice:c,selectedDevice:d,videoResolution:e,videoResolutionChanged:!1},a.Base.Utils.isDefined(d)?(this._mediaTransactionInitialEvent=f,this.handleEvent(f),this.mediaTransactionDfd.promise()):(a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"No device selected"),this.mediaTransactionDfd.reject(new a.Services.Call.CallException(a.Services.Call.CallError.FAILED)).promise())},b.prototype.escalateVideo=function(b){this.mediaTransactionDfd=$.Deferred();var c=new a.Providers.Call.EscalateVideoEvent;return c.data={videoDevice:b,videoResolution:this.getVideoResolution()},this._mediaTransactionInitialEvent=c,this.handleEvent(c),this.mediaTransactionDfd.promise()},b.prototype.deEscalateVideo=function(){this.mediaTransactionDfd=$.Deferred();var b=new a.Providers.Call.DeEscalateVideoEvent;return this._mediaTransactionInitialEvent=b,this.handleEvent(b),this.mediaTransactionDfd.promise()},b.prototype.resolveMediaTransaction=function(){setTimeout(function(){this.mediaTransactionDfd.resolve()}.bind(this),0)},b.prototype.sendDTMF=function(b){var c=new a.Providers.Call.SendDTMFEvent;c.data={dtmf:b},this.handleEvent(c)},b.prototype.incomingVideoRequestTimedout=function(){var b=new a.Providers.Call.IncomingAddVideoTimedoutEvent;this.handleEvent(b)},b.prototype.deviceRetrievalFailure=function(b){var c=new a.Providers.Call.DeviceRetrievalFailedEvent,d=a.Base.Utils.isDefined(b)?b:a.Services.Call.CallStates.FAILED;c.data={nextState:d},this.handleEvent(c)},b.prototype.hold=function(){this.mediaTransactionDfd=$.Deferred();var b=new a.Providers.Call.HoldEvent;return this._mediaTransactionInitialEvent=b,this.handleEvent(b),this.mediaTransactionDfd.promise()},b.prototype.unhold=function(){this.mediaTransactionDfd=$.Deferred();var b=new a.Providers.Call.UnHoldEvent;return b.data={videoResolution:this.getVideoResolution()},this._mediaTransactionInitialEvent=b,this.handleEvent(b),this.mediaTransactionDfd.promise()},b.prototype.transfer=function(b){this._transferPromise=$.Deferred();var c=new a.Providers.Call.TransferEvent;return c.data={targetRemoteAddress:b},this.handleEvent(c),this._transferPromise.promise()},b.prototype.attendedTransfer=function(b){this._transferPromise=$.Deferred();var c=new a.Providers.Call.AttendedTransferEvent;return c.data={targetCallId:b},this.handleEvent(c),this._transferPromise.promise()},b.prototype.addParticipantFromCall=function(b){var c=new a.Providers.Call.AddParticipantFromExistingCallEvent;c.data={participantCallId:b.getCallId()},this.handleEvent(c)},b.prototype.join=function(b){this._joinRemotePromise=$.Deferred();var c=new a.Providers.Call.JoinRemoteCallEvent;return c.data={audioDevice:b,videoResolution:this._videoResolution},this.handleEvent(c),this._joinRemotePromise.promise()},b.prototype.startRinging=function(){var b=new a.Providers.Call.StartRingingEvent;this.handleEvent(b)},b.prototype.acceptCallRequest=function(b,c){var d=new a.Providers.Call.AcceptCallRequestEvent;d.data={deferred:b,requestedType:c},this.handleEvent(d)},b.prototype.rejectCallRequest=function(b,c){var d=new a.Providers.Call.RejectAnswerCallRequestEvent;d.data={deferred:b,requestedType:c},this.handleEvent(d)},b.prototype.updateAudioVideoStreamsDirection=function(a,b,c){this.updateAudioStreamDirection(a),this.updateVideoStreamsDirection(b,c)},b.prototype.updateAudioStreamDirection=function(b){if(b)switch(b.direction){case a.Services.Call.MediaDirection.SEND_ONLY:this.audioStream.direction=a.Services.Call.MediaDirection.RECV_ONLY;break;case a.Services.Call.MediaDirection.RECV_ONLY:this.audioStream.direction=a.Services.Call.MediaDirection.SEND_ONLY;break;default:this.audioStream.direction=b.direction}},b.prototype.updateVideoStreamsDirection=function(b,c){if(b)for(var d=0;d<this.videoStreams.length;d++)if(b[d])if(b[d].enabled)switch(b[d].direction){case a.Services.Call.MediaDirection.SEND_ONLY:this.videoStreams[d].direction=a.Services.Call.MediaDirection.RECV_ONLY;break;case a.Services.Call.MediaDirection.RECV_ONLY:this.videoStreams[d].direction=a.Services.Call.MediaDirection.SEND_ONLY;break;case a.Services.Call.MediaDirection.SEND_RECV:!a.Base.Utils.isDefined(c)||c!==a.Providers.Call.CallProvider.Constants.INCOMING_UNHOLD_ACTION&&c!==a.Providers.Call.CallProvider.Constants.INCOMING_UPDATE_VIDEO_ACTION?this.videoStreams[d].direction=b[d].direction:this.videoStreams[d].direction=this.call._videoChannels[d].getRequestedDirection();break;default:this.videoStreams[d].direction=b[d].direction}else this.videoStreams[d].direction=a.Services.Call.MediaDirection.DISABLE},b.prototype.updateVideoChannelDirection=function(b){if(b)for(var c=this.call.getVideoChannels(),d=0;d<c.length;d++)if(b[d])if(b[d].enabled)switch(b[d].direction){case a.Services.Call.MediaDirection.SEND_ONLY:c[d]._setNegotiatedDirection(a.Services.Call.MediaDirection.RECV_ONLY);break;case a.Services.Call.MediaDirection.RECV_ONLY:c[d]._setNegotiatedDirection(a.Services.Call.MediaDirection.SEND_ONLY);break;default:c[d]._setNegotiatedDirection(b[d].direction)}else c[d]._setNegotiatedDirection(a.Services.Call.MediaDirection.DISABLE)},b.prototype.setAVStreams=function(a,b){this.audioStream=a,this.videoStreams=b},b.prototype.removeLocalVideoTracks=function(){this.localStream&&(this._callProvider.getMediaServiceFactory().getMediaServicesService().removeLocalVideoTracks(this.getVideoChannelId()),this.setAVStreams(this.getAudioStream(),[]))},b.prototype.getAudioStream=function(){return this.audioStream},b.prototype.getVideoStreams=function(){return this.videoStreams},b.prototype.stopAllStreams=function(){this._callProvider.getMediaServiceFactory().getAudioOutputInterfaceService().getAudioOutput().stopPlayingAudioStream(this.remoteStream),this._rtConnection&&this._rtConnection.stopAllStreams()},b.prototype.getVideoChannelId=function(){return this._videoChannelId},b.prototype.setVideoChannelId=function(b){this._videoChannelId!==b&&a.Base.Utils.isDefined(this._videoChannelId)&&this._callProvider.getMediaServiceFactory().getVideoInterfaceService().removeMediaStreams(this._videoChannelId),this._videoChannelId=b},b.prototype.updateVideoMode=function(b,c){var d;if(!this._callProvider.hasNonBlockingVideoDevices()&&b!==a.Services.Call.VideoMode.DISABLE)return $.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.CAMERA_NOT_FOUND));var e=a.Providers.Call.Utils.getVideoDirection(b);if(0===this.videoStreams.length)this.call._videoChannels[0]._setRequestedDirection(e),d=this.escalateVideo(c);else{if(b===a.Services.Call.VideoMode.INACTIVE)return $.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.UNHANDLED_VIDEO_DIRECTION));var f=this.videoStreams[0].direction;switch(this.videoStreams[0].direction=e,this.call._videoChannels[0]._setRequestedDirection(e),b){case a.Services.Call.VideoMode.SEND_RECEIVE:d=f===a.Services.Call.MediaDirection.SEND_ONLY?this.updateRemoteVideo():this.unBlockCamera(c);break;case a.Services.Call.VideoMode.SEND_ONLY:f===a.Services.Call.MediaDirection.SEND_RECV?d=this.updateRemoteVideo():f===a.Services.Call.MediaDirection.RECV_ONLY?(this.videoStreams[0].direction=a.Services.Call.MediaDirection.INACTIVE,d=this.updateRemoteVideo()):d=this.unBlockCamera(c);break;case a.Services.Call.VideoMode.RECEIVE_ONLY:if(f===a.Services.Call.MediaDirection.SEND_ONLY)d=this.deEscalateVideo();else{if(f===a.Services.Call.MediaDirection.INACTIVE&&!this._rtConnection.hasVideo(this.localStream))return this.escalateVideo(c);d=this.blockCamera()}break;case a.Services.Call.VideoMode.DISABLE:d=this.deEscalateVideo();break;default:return a.Base.Logger.info(a.Base.LoggerTags.CALL_PROVIDER,"Unsupported video mode: "+b),$.Deferred().reject()}}return d},b.prototype.notifyCallServiceOfMediaChanges=function(b){for(var c=this.call.getVideoChannels(),d=0;d<this.videoStreams.length;d++)this.videoStreams[d].direction!==a.Services.Call.MediaDirection.INACTIVE&&this.videoStreams[d].direction!==a.Services.Call.MediaDirection.DISABLE?(this.setVideoChannelId(c[d].getChannelId()),this._callProvider.getMediaServiceFactory().getVideoInterfaceService().setRemoteMediaStream(this.call.getVideoChannels()[0].getChannelId(),this.remoteStream),c[d]._setNegotiatedDirection(this.videoStreams[d].direction),this._callProvider.triggerVideoChannelUpdate(this.call,c[d])):(c[d]._setNegotiatedDirection(a.Services.Call.MediaDirection.INACTIVE),c[d]._setVideoDisabledReason(a.Services.Call.VideoChannelDisabledReason.DISABLED_BY_REMOTE_USER),this._callProvider.triggerVideoChannelUpdate(this.call))},b.prototype.transferCompleted=function(){a.Base.Utils.isDefined(this._transferPromise)&&this._transferPromise.resolve()},b.prototype.transferFailed=function(){a.Base.Utils.isDefined(this._transferPromise)&&this._transferPromise.reject()},b.prototype._checkIfBrowserIsFirefox=function(){var b=a.Base.Utils.getBrowserType();return b===a.Base.BrowserType.FIREFOX||b===a.Base.BrowserType.FIREFOX_EXTENSION},b.prototype.getCallStatistics=function(){var b=$.Deferred();if(a.Base.Utils.isDefined(this._rtConnection)&&null!==this._rtConnection&&a.Base.Utils.isDefined(this._rtConnection._pc))switch(a.Base.Utils.getBrowserType()){case a.Base.BrowserType.CHROME:case a.Base.BrowserType.CHROME_EXTENSION:this._rtConnection._pc.getStats(function(a){this._checkCallStatisticReport(a,b)}.bind(this));break;case a.Base.BrowserType.FIREFOX:this._rtConnection._pc.getStats(null).then(function(a){this._checkCallStatisticReport(a,b)}.bind(this),function(){b.reject(new a.Services.Call.CallException(a.Services.Call.CallError.STATISTICS_UNAVAILABLE))});break;default:b.reject(new a.Services.Call.CallException(a.Services.Call.CallError.STATISTICS_UNAVAILABLE))}else b.reject(new a.Services.Call.CallException(a.Services.Call.CallError.STATISTICS_UNAVAILABLE));return b.promise()},b.prototype._checkCallStatisticReport=function(b,c){b?c.resolve(b):c.reject(new a.Services.Call.CallException(a.Services.Call.CallError.STATISTICS_UNAVAILABLE))},b.prototype.stopEarlyMedia=function(a){this._isEarlyMedia&&this.remoteStream&&a.isPlaying(this.remoteStream)&&(this._rtConnection.disableRemoteStreams(),a.stopPlayingAudioStream(this.remoteStream))},b.prototype.getVideoResolution=function(){return this._videoResolution},b.prototype._updateVideoResolution=function(a){this._videoResolution=a},b.prototype.popQueuedActiveRenegotiateEvent=function(){var a=this._queuedActiveRenegotiateEvent;return this._queuedActiveRenegotiateEvent=void 0,a},b.prototype.setQueuedActiveRenegotiateEvent=function(a){this._queuedActiveRenegotiateEvent=a},b.prototype.popQueuedRemoteCallEstablishedEvent=function(){var a=this._queuedRemoteCallEstablishedEvent;return this._queuedRemoteCallEstablishedEvent=void 0,a},b.prototype.setQueuedRemoteCallEstablishedEvent=function(a){this._queuedRemoteCallEstablishedEvent=a},b.prototype.getMediaTransactionInitialEvent=function(){return this._mediaTransactionInitialEvent},b.prototype.setMediaTransactionInitialEvent=function(a){this._mediaTransactionInitialEvent=a},b.prototype.adjustVideoResolution=function(b,c,d){var e=this._callProvider.getMediaServiceFactory().getMediaServicesService().getUserMedia().adjustVideoResolution(d,this._videoResolution)||this._videoResolution;if(c&&c[0]){var f=c[0].maxHeight,g=c[0].maxWidth;e=this._callProvider.getMediaServiceFactory().getMediaServicesService().getUserMedia().adjustVideoResolutionForDimensions(f,g,e)}return e.getMinBandwidth()<this._maxVideoResolution.getMinBandwidth()&&b!==a.Providers.Call.CallProvider.Constants.UPDATE_VIDEO&&(this._maxVideoResolution=e),e},b.prototype.setCallRequestedTransactionalId=function(a,b){this._3pccRequestTransactionMap[a]=b},b.prototype.getCallRequestedTransactionalId=function(a){return this._3pccRequestTransactionMap[a]},a.Providers.Call.CPCall=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";a.Providers.Call.CPUtils={createLocalMediaStream:function(b,c,d,e,f,g,h,i){a.Base.Logger.debug(a.Base.LoggerTags.CALL_PROVIDER,"The video resolution of the localStream has to be changed due to bandwidth management.");var j=b?b.getDeviceId():void 0,k=this.getVideoOptions(d.call.getVideoChannels(),c);return d._rtConnection.stopStream(d.localStream),e.getMediaServicesService().createLocalMediaStream(!0,k.enable,j,k.videoDeviceId,k.videoChannelId,f).then(function(b){var c=b.stream;b.videoResolution&&d._updateVideoResolution(b.videoResolution);var e=d.getAudioStream(),f=[];return c.getTracks().forEach(function(b){if(b.kind===a.Providers.Call.CallProvider.Constants.VIDEO_TRACK){var c=d.getVideoStreams()[0],e=c?c.direction:a.Services.Call.MediaDirection.INACTIVE;f.push(new a.Providers.Interfaces.VideoStream(b.id,e))}}),d.setAVStreams(e,f),d._rtConnection.removeStream(d.localStream),d.localStream=c,d._rtConnection.addStream(d.localStream),d.call.isAudioMuted()&&d._rtConnection.disableLocalAudioStreams(),g.call(void 0,d,i),b.videoResolution},function(a){h.call(void 0,d,a)})},updateVideoResolutionFirefox:function(b,c,d,e,f,g){a.Base.Logger.debug("The video resolution of the localStream has to be changed due to bandwidth management.");var h=e.localStream.getVideoTracks()[0];h?c.getMediaServicesService().getUserMedia().updateStreamUsingApplyConstraints(h,d,e,b.getDeviceId()).always(function(){f.call(void 0,e)}):g.call(void 0,e,"Missing video track")},updateDevicesFirefox:function(b,c,d,e,f,g,h){var i,j=!1,k=!1,l={videoDeviceId:void 0,videoChannelId:void 0};return c&&(j=!0,i=void 0,l=this.getVideoOptions(d.call.getVideoChannels(),c),a.Base.Logger.debug("Changing to new video device: "+c.getLabel())),b&&(k=!0,i=b.getDeviceId(),d._rtConnection.removeLocalAudioTrack(),a.Base.Logger.debug("Changing to new audio device: "+b.getLabel())),e.getMediaServicesService().createLocalMediaStream(k,j,i,l.videoDeviceId,l.videoChannelId,f).then(function(e){var f=e.stream;f.getTracks().forEach(function(b){b.kind===a.Providers.Call.CallProvider.Constants.VIDEO_TRACK?d._rtConnection.replaceLocalVideoTrack(b):d._rtConnection.addTrack(b,f)}),j&&(d._videoDevice=c),k&&(d._audioDevice=b,d.call.isAudioMuted()&&d._rtConnection.disableLocalAudioStreams()),g.call(void 0,d)},function(a){h.call(void 0,d,a)})},getVideoOptions:function(b,c){var d,e,f=!1;if(a.Base.Utils.isDefined(b))for(var g=0;g<b.length;g++)b[g].getRequestedDirection()!==a.Services.Call.MediaDirection.INACTIVE&&(f=!0,d=b[g].getChannelId(),c&&(e=c.getDeviceId()));return{enable:f,videoChannelId:d,videoDeviceId:e}}}}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b,c),this.data=c}a.Providers.Call.CallFsmEvent=b}(AvayaClientServices),function(a){"use strict";function b(){this.cpCall=void 0,this.callProvider=void 0}a.Providers.Call.CallFsmEventData=b}(AvayaClientServices),function(a){"use strict";function b(){a.Providers.Call.CallFsmEvent.call(this),this.audioDevice=void 0,this.videoDevice=void 0}b.prototype={},a.Providers.Call.UpdateLocalStreamEventData=b}(AvayaClientServices),function(a){"use strict";function b(){this.event=void 0}b.prototype={handleEvent:function(a){throw new Error("Cannot call abstract method")}},a.Providers.Call.AbstractEventHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c,d,e=b.data.cpCall,f=b.data.callProvider,g=e._callGatewayProvider,h=b.data.videoChannel,i=!1,j=b.data.audioDevice?b.data.audioDevice.getDeviceId():void 0;return a.Base.Utils.isDefined(h)&&h.getRequestedDirection()!==a.Services.Call.MediaDirection.INACTIVE&&(i=!0,d=h.getChannelId(),b.data.videoDevice&&(c=b.data.videoDevice.getDeviceId())),f.triggerCallEstablishing(e.call),
f.getMediaServiceFactory().getMediaServicesService().createLocalMediaStream(!0,i,j,c,d,b.data.videoResolution).then(function(b){var c=b.stream;b.videoResolution&&e._updateVideoResolution(b.videoResolution),a.Base.Logger.debug(a.Base.LoggerTags.CALL_PROVIDER,"getUserMedia success");var d=null,j=[];if(c.getTracks().forEach(function(b){if("audio"===b.kind)d=new a.Providers.Interfaces.AudioStream(b.id,a.Services.Call.MediaDirection.SEND_RECV);else if("video"===b.kind){var c=a.Services.Call.MediaDirection.SEND_RECV;if(e.incomingCallInfo.videoStreams&&e.incomingCallInfo.videoStreams.length>0)switch(e.incomingCallInfo.videoStreams[0].direction){case a.Services.Call.MediaDirection.SEND_ONLY:c=a.Services.Call.MediaDirection.RECV_ONLY;break;case a.Services.Call.MediaDirection.RECV_ONLY:c=a.Services.Call.MediaDirection.SEND_ONLY;break;default:c=e.incomingCallInfo.videoStreams[0].direction}j.push(new a.Providers.Interfaces.VideoStream(b.id,c))}}),null===d)return a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"No microphone is available"),void f.trigger(a.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[e.call,a.Services.Call.CallError.MICROPHONE_NOT_FOUND]);if(i&&0===j.length&&e.incomingCallInfo.videoStreams&&e.incomingCallInfo.videoStreams.length>0){var k=h.getRequestedDirection();e.incomingCallInfo.videoStreams[0].direction!==a.Services.Call.MediaDirection.INACTIVE&&e.incomingCallInfo.videoStreams[0].direction!==a.Services.Call.MediaDirection.RECV_ONLY||(k=a.Services.Call.MediaDirection.INACTIVE),j.push(new a.Providers.Interfaces.VideoStream(1,k))}e.setAVStreams(d,j),e.localStream=c;var l=e._rtConnection;l.addStream(e.localStream),e._rtConnection.disableLocalStreams(),l.onAddStream=function(b){e.handleEvent(new a.Providers.Call.OnAddStreamEvent({newStream:b}))},l.createAnswer(e.incomingCallInfo.sdp,function(b){g.acceptCall(e.callId,b.type,b.sdp,e.getAudioStream(),e.getVideoStreams()).fail(function(){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to send accept call",error),f.trigger(a.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[e.call,a.Services.Call.CallError.SEND_ERROR])})},function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Error while creating answer",b),f.trigger(a.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[e.call,a.Services.Call.CallError.INTERNAL_ERROR])},function(b){return 0===j.length?a.Base.SDPUtil.rejectMedia(b,"m=video"):b})},function(b){var c="Error while retrieving local stream: "+JSON.stringify(b);a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,c),b.getError&&b.getError()===a.Services.Call.CallError.DEVICES_NOT_FOUND?e.callFailure(a.Services.Call.CallError.DEVICES_NOT_FOUND):f.trigger(a.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[e.call,a.Services.Call.CallError.MEDIA_CREATION_FAILURE])}),{nextState:a.Providers.Call.States.ALERTING}}a.Providers.Call.AcceptCallEventInInitialHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(a){var b=a.data.cpCall,c=b._callGatewayProvider,d=a.data.deferred;c.acceptCallRequest(b.callId,b.getCallRequestedTransactionalId(a.data.requestedType),a.data.action).done(function(){d.resolve()},function(a){d.reject(a)})}a.Providers.Call.AcceptCallRequestEventInMultipleHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c=b.data.cpCall,d=b.data.callProvider,e=c._callGatewayProvider,f=c.call.getVideoChannels();if(clearTimeout(c.incomingVideoRequestTimer),d.isVideoConfigurationEnabled()&&d.hasVideoDevices()){var g,h=f[0].getChannelId();return a.Base.Utils.isDefined(b.data.videoDevice)&&(g=b.data.videoDevice.getDeviceId()),d.getMediaServiceFactory().getMediaServicesService().addVideoTracksToLocalStream(g,h,c.localStream,b.data.videoResolution).then(function(b){a.Base.Logger.debug(a.Base.LoggerTags.CALL_PROVIDER,"getUserMedia success");var d=c.getAudioStream(),f=[],g=b.getVideoTracks(),h=c.incomingCallInfo;g[0].enabled=!0,c._rtConnection.addTrack(g[0],c.localStream);for(var i=0;i<h.videoStreams.length;i++){var j;switch(h.videoStreams[i].direction){case a.Services.Call.MediaDirection.SEND_ONLY:j=a.Services.Call.MediaDirection.RECV_ONLY;break;case a.Services.Call.MediaDirection.RECV_ONLY:j=a.Services.Call.MediaDirection.SEND_ONLY;break;default:j=h.videoStreams[i].direction}var k=g.filter(function(a){return!0===a.enabled})[i].id;f.push(new a.Providers.Interfaces.VideoStream(k,j))}c.setAVStreams(d,f),c.notifyCallServiceOfMediaChanges(),e.updateVideo(c.callId,c.getAudioStream(),c.getVideoStreams()).then(function(){},function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to update remote video: "+b),c.mediaTransactionDfd.reject(new a.Services.Call.CallException(a.Services.Call.CallError.SEND_ERROR)),c.revertFsmState(a.Providers.Call.States.ACTIVE)})},function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to add video to local media stream: "+b),c.mediaTransactionDfd.reject(new a.Services.Call.CallException(a.Services.Call.CallError.MEDIA_CREATION_FAILURE)),c.revertFsmState(a.Providers.Call.States.ACTIVE)}),{nextState:a.Providers.Call.States.ACTIVE_RENEGOTIATE}}a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to accept send video - no video configured"),c.mediaTransactionDfd.reject(new a.Services.Call.CallException(a.Services.Call.CallError.VIDEO_DENIED))}a.Providers.Call.AcceptSendVideoEventInActiveHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(a){var b=a.data.cpCall,c=a.data.callProvider;b._callGatewayProvider.addParticipantFromCall(b.callId,a.data.participantCallId,b.getAudioStream(),b.getVideoStreams()).then(function(){},function(d){c._updateConsultConferenceStatusHandler(a.data.participantCallId,"ERROR: "+d.errorMsg,b.callId)})}a.Providers.Call.AddParticipantFromExistingCallEventInActiveHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c=b.data.cpCall,d=c._rtConnection;return c.updateAudioVideoStreamsDirection(b.data.audioStream,b.data.videoStreams),c.getVideoStreams(),c.notifyCallServiceOfMediaChanges(),a.Base.Logger.debug(a.Base.LoggerTags.CALL_PROVIDER,"Answer SDP received =>\n "+b.data.answer),d.receiveAnswer(b.data.answer,function(){b.data.action===a.Providers.Call.CallProvider.Constants.REMOVE_VIDEO&&c.removeLocalVideoTracks()},function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Error receiving answer SDP: "+b),c.mediaTransactionDfd.reject(new a.Services.Call.CallException(a.Services.Call.CallError.INTERNAL_ERROR))}),c.resolveMediaTransaction(),{nextState:a.Providers.Call.States.ACTIVE,nextEvent:c.popQueuedActiveRenegotiateEvent()}}a.Providers.Call.AnswerSDPEventInActiveRenegotiateHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c=b.data.cpCall,d=c._callGatewayProvider,e=c._rtConnection;a.Base.Logger.debug(a.Base.LoggerTags.CALL_PROVIDER,"Answer SDP received =>\n "+b.data.answer),e.receiveAnswer(b.data.answer,function(){d.answerSDPResponse(c.callId,c.getAudioStream(),c.getVideoStreams())},function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Error receiving answer SDP: "+b)})}a.Providers.Call.AnswerSDPEventInMultipleHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c=b.data.cpCall,d=b.data.callProvider;c._rtConnection.enableRemoteStreams(),c.call.isAudioMuted()||b.data.action===a.Providers.Call.CallProvider.Constants.HOLD||c._rtConnection.enableLocalAudioStreams();var e=c.getVideoStreams(),f=b.data.videoStreams,g=c.call.getVideoChannels();if(b.data.action===a.Providers.Call.CallProvider.Constants.REMOVE_VIDEO)c.removeLocalVideoTracks(),f[0].direction!==a.Services.Call.MediaDirection.INACTIVE&&f[0].state!==a.Providers.Call.CallProvider.Constants.DISABLE_STATE||(g.length>0&&(g[0]._setNegotiatedDirection(a.Services.Call.MediaDirection.INACTIVE),g[0]._setVideoDisabledReason(a.Services.Call.VideoChannelDisabledReason.DISABLED_BY_LOCAL_USER)),d.triggerVideoChannelUpdate(c.call));else{c.updateVideoStreamsDirection(f),c.updateVideoChannelDirection(f);for(var h=0;h<e.length;h++){if(e[h].direction===a.Services.Call.MediaDirection.INACTIVE||e[h].direction===a.Services.Call.MediaDirection.DISABLE)g[h]._setNegotiatedDirection(e[h].direction),g[h]._setVideoDisabledReason(a.Services.Call.VideoChannelDisabledReason.DISABLED_BY_LOCAL_USER),d.triggerVideoChannelUpdate(c.call);else{c.setVideoChannelId(g[h].getChannelId());var i=g[h].getNegotiatedDirection();i!==a.Services.Call.MediaDirection.SEND_RECV&&i!==a.Services.Call.MediaDirection.SEND_ONLY||b.data.action===a.Providers.Call.CallProvider.Constants.HOLD||c._rtConnection.enableLocalVideoStreams(),c._rtConnection.hasVideo(c.remoteStream)?d.getMediaServiceFactory().getVideoInterfaceService().setRemoteMediaStream(g[h].getChannelId(),c.remoteStream):d.getMediaServiceFactory().getVideoInterfaceService().removeRemoteMediaStream(g[h].getChannelId()),d.triggerVideoChannelUpdate(c.call)}break}}return c.resolveMediaTransaction(),{nextState:a.Providers.Call.States.ACTIVE,nextEvent:c.popQueuedActiveRenegotiateEvent()}}a.Providers.Call.AnswerSdpAckEventInActiveRenegotiateHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c=b.data.cpCall;c._callGatewayProvider.attendedTransfer(c.callId,b.data.targetCallId,c.getAudioStream(),c.getVideoStreams()).then(function(){},function(b){c._transferPromise.reject(new a.Services.Call.CallException(b.errorCode,b.protocolType,b.protocolErrorCode,b.errorMsg))})}a.Providers.Call.AttendedTransferEventInActiveHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c=b.data.cpCall,d=c._callGatewayProvider;return c._rtConnection.disableLocalVideoStreams(),d.blockUnBlockCamera(c.callId,c.getAudioStream(),c.getVideoStreams()).then(function(){},function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to block camera: "+b),c.mediaTransactionDfd.reject(new a.Services.Call.CallException(a.Services.Call.CallError.SEND_ERROR)),c.revertFsmState(a.Providers.Call.States.ACTIVE)}),{nextState:a.Providers.Call.States.ACTIVE_RENEGOTIATE}}a.Providers.Call.BlockCameraEventInActiveHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c=b.data.cpCall,d=b.data.callProvider;c.remoteStream&&c._rtConnection.enableRemoteStreams(),c.updateAudioStreamDirection(b.data.audioStream),c.call.isAudioMuted()||c.call.getState()===a.Services.Call.CallStates.HELD||c._rtConnection.enableLocalAudioStreams();var e=c.getVideoStreams(),f=b.data.videoStreams,g=c.call.getVideoChannels();if(f&&f.length>0){c.updateVideoChannelDirection(f),c.updateVideoStreamsDirection(f);for(var h=0;h<e.length;h++)if(e[h].direction!==a.Services.Call.MediaDirection.INACTIVE){c.setVideoChannelId(g[0].getChannelId()),e[h].direction!==a.Services.Call.MediaDirection.INACTIVE&&e[h].enabled?(e[h].direction!==a.Services.Call.MediaDirection.RECV_ONLY&&c.call.getState()!==a.Services.Call.CallStates.HELD&&c._rtConnection.enableLocalVideoStreams(),c._rtConnection.hasVideo(c.remoteStream)&&d.getMediaServiceFactory().getVideoInterfaceService().setRemoteMediaStream(g[h].getChannelId(),c.remoteStream)):c.removeLocalVideoTracks(),d.triggerVideoChannelUpdate(c.call,g[h]);break}}var i=d.getMediaServiceFactory().getAudioOutputInterfaceService().getAudioOutput();return c.remoteStream&&!i.playAudioStream(c.remoteStream,c.call.isSpeakerMuted())&&a.Base.Logger.info(a.Base.LoggerTags.CALL_PROVIDER,"No Audio Tracks Found. Could not play remote audio."),a.Providers.Call.Utils.updateAndTriggerRemoteAddressChangedIfNeeded(d,c.call,b.data.address,b.data.displayName),d.triggerCallEstablished(c.call,b.data.isConf,b.data.uccpUrl,b.data.webCollabUrl,b.data.isRemote,b.data.ucid,b.data.parentUcid,b.data.contextId),{nextState:a.Providers.Call.States.ACTIVE}}a.Providers.Call.CallEstablishedEventInMultipleHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c=b.data.cpCall,d=c.getAudioStream(),e=c.getVideoStreams();switch(c.getMediaTransactionInitialEvent().stringValue){case a.Providers.Call.EscalateVideoEvent.stringValue:c.removeLocalVideoTracks();break;case a.Providers.Call.DeEscalateVideoEvent.stringValue:case a.Providers.Call.BlockCameraEvent.stringValue:c._rtConnection.enableLocalVideoStreams();break;case a.Providers.Call.UnBlockCameraEvent.stringValue:c._rtConnection.disableLocalVideoStreams();break;case a.Providers.Call.HoldEvent.stringValue:c._rtConnection.enableLocalStreams(),d.direction=a.Services.Call.MediaDirection.SEND_RECV;for(var f=0;f<e.length;f++)c.call.getVideoChannels()[f]&&(e[f].direction=c.call.getVideoChannels()[f].getNegotiatedDirection());c.setAVStreams(d,e);break;case a.Providers.Call.UnHoldEvent.stringValue:c._rtConnection.disableLocalStreams(),d.direction=a.Services.Call.MediaDirection.SEND_ONLY;for(var g=0;g<e.length;g++)e[g].direction=a.Services.Call.MediaDirection.INACTIVE}return b.data.errorCode===a.Services.Call.CallError.MEDIA_PRESERVED&&c&&c.call&&(b.data.callProvider.triggerCallServiceUnavailable(c.call),b.data.callProvider._callsAnalyticsService.sendUnavailableEvent(a.Services.Analytics.AnalyticsErrorCode.MEDIA_PRESERVED_ERROR)),c.mediaTransactionDfd&&c.mediaTransactionDfd.reject(new a.Services.Call.CallException(a.Services.Call.CallError.CALL_STATE_MISMATCH)),{nextState:a.Providers.Call.States.ACTIVE,nextEvent:c.popQueuedActiveRenegotiateEvent()}}a.Providers.Call.CallFailureEventInActiveRenegotiateHandler=b}(AvayaClientServices),function(a){"use strict";function b(a){var b=a.data.cpCall;a.data.callProvider.triggerCallFailure(b.callId,a.data.errorCode,a.data.protocolType,a.data.protocolErrorCode,a.data.failureReason)}a.Providers.Call.CallFailureEventInMultipleHandler=b}(AvayaClientServices),function(a){"use strict";function b(b){var c=b.data.cpCall,d=b.data.callProvider;a.Providers.Call.Utils.updateAndTriggerRemoteAddressChangedIfNeeded(d,c.call,b.data.address,b.data.displayName),c.call._isPrivateCallerID=!!a.Base.Utils.isDefined(b.data.isPrivate)&&b.data.isPrivate,c.call._isAuraAsserted=!!a.Base.Utils.isDefined(b.data.isAuraAsserted)&&b.data.isAuraAsserted,d.triggerCallRinging(c.call,b.data.earlyMedia)}a.Providers.Call.CallRingingEventInActiveHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c=b.data.cpCall,d=b.data.callProvider,e=c._rtConnection,f=d.getMediaServiceFactory().getAudioOutputInterfaceService().getAudioOutput();return a.Providers.Call.Utils.updateAndTriggerRemoteAddressChangedIfNeeded(d,c.call,b.data.address,b.data.displayName),c.call._isPrivateCallerID=!!a.Base.Utils.isDefined(b.data.isPrivate)&&b.data.isPrivate,c.call._isAuraAsserted=!!a.Base.Utils.isDefined(b.data.isAuraAsserted)&&b.data.isAuraAsserted,d.triggerCallRinging(c.call,b.data.earlyMedia),a.Base.Utils.isDefined(b.data.earlyMedia)&&(c._isEarlyMedia=b.data.earlyMedia,c._isEarlyMedia&&c.remoteStream&&!f.isPlaying(c.remoteStream)&&(e.enableRemoteStreams(),c.call.isAudioMuted()||e.enableLocalAudioStreams(),f.playAudioStream(c.remoteStream,c.call.isSpeakerMuted())||a.Base.Logger.info(a.Base.LoggerTags.CALL_PROVIDER,"No Audio Tracks Found. Could not play remote audio."))),{nextState:a.Providers.Call.States.ALERTING}}a.Providers.Call.CallRingingEventInStartingHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c=b.data.cpCall,d=b.data.callProvider,e=c._callGatewayProvider,f=c.call.getVideoChannels();c._rtConnection.disableLocalVideoStreams();for(var g=c.getVideoStreams(),h=0;h<g.length;h++)g[h].direction=a.Services.Call.MediaDirection.INACTIVE,g[h].enabled=!1,d.triggerVideoChannelUpdate(c.call,f[h]);return e.deEscalateVideo(c.callId,c.getAudioStream(),g).then(function(){},function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to deescalate video: "+b),c.mediaTransactionDfd.reject(new a.Services.Call.CallException(a.Services.Call.CallError.SEND_ERROR)),c.revertFsmState(a.Providers.Call.States.ACTIVE)}),{nextState:a.Providers.Call.States.ACTIVE_RENEGOTIATE}}a.Providers.Call.DeEscalateVideoEventInActiveHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(a){var b=a.data.cpCall,c=a.data.callProvider;clearTimeout(b.incomingVideoRequestTimer),c.triggerIncomingAddVideoDenied(b.call)}a.Providers.Call.DenySendVideoEventInActiveHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c=b.data.cpCall;return b.data.callProvider.trigger(a.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[c.call,a.Services.Call.CallError.DEVICES_NOT_FOUND]),{nextState:b.data.nextState}}a.Providers.Call.DevicesFailureHandler=b}(AvayaClientServices),function(a){"use strict";function b(b){var c=b.data.cpCall,d=c._callGatewayProvider,e=new a.Providers.Call.EndCallResponseEvent;return e.data={},c.stopAllStreams(),c.setVideoChannelId(void 0),e.data.remote=b.data.remote,b.data.remote?(e.data.callReason=b.data.callReason,{nextState:a.Providers.Call.States.ENDING,nextEvent:c.prepareEvent(e)}):(d.endCall(c.callId,b.data.denialReason).then(function(){c.handleEvent(e)},function(a){c.handleEvent(e)}),{nextState:a.Providers.Call.States.ENDING})}a.Providers.Call.EndCallEventInMultipleHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{});!function(a){"use strict";function b(b){var c=b.data.cpCall,d=b.data.callProvider,e=c.popQueuedRemoteCallEstablishedEvent();if(c.localStream=null,c.remoteStream=null,c._rtConnection&&(c._rtConnection.close(),c._rtConnection=null),d.triggerCallEnded(c.call,b.data.remote,b.data.callReason),d.unRegisterCall(c.call),e){var f=e.data.cpCall,g=f.call;d.callEstablished(g.getCallId(),g.getRemoteAddress(),g.getRemoteDisplayName(),g.getSubject(),e.data.isRemote,g.isCallerIdentityPrivate(),g.getAlertType(),g._isAuraAsserted,f.getAudioStream(),f.getVideoStreams())}return{nextState:a.Providers.Call.States.ENDED}}a.Providers.Call.EndCallResponseEventInEndingHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c=b.data.cpCall,d=c._rtConnection;return c.updateVideoStreamsDirection(b.data.videoStreams),c.getVideoStreams(),c.notifyCallServiceOfMediaChanges(),a.Base.Logger.debug(a.Base.LoggerTags.CALL_PROVIDER,"Answer SDP received =>\n "+b.data.answer),d.receiveAnswer(b.data.answer,function(){},function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Video escalation failed while receiving answer SDP: "+b),c.mediaTransactionDfd.reject(new a.Services.Call.CallException(a.Services.Call.CallError.INTERNAL_ERROR))}),c.resolveMediaTransaction(),{nextState:a.Providers.Call.States.ACTIVE,nextEvent:c.popQueuedActiveRenegotiateEvent()}}a.Providers.Call.EscalateVideoAnswerEventInActiveRenegotiateHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c,d=b.data.cpCall,e=b.data.callProvider,f=d._callGatewayProvider,g=d.call.getVideoChannels(),h=g[0].getChannelId();return a.Base.Utils.isDefined(b.data.videoDevice)&&(c=b.data.videoDevice.getDeviceId()),d.setVideoChannelId(g[0].getChannelId()),e.getMediaServiceFactory().getMediaServicesService().addVideoTracksToLocalStream(c,h,d.localStream,b.data.videoResolution).then(function(b){a.Base.Logger.debug(a.Base.LoggerTags.CALL_PROVIDER,"getUserMedia success");var c=d.getAudioStream(),e=[];b.getTracks().forEach(function(b){if(b.kind===a.Providers.Call.CallProvider.Constants.VIDEO_TRACK){var c=g[0].getRequestedDirection();e.push(new a.Providers.Interfaces.VideoStream(b.id,c))}}),d.setAVStreams(c,e),f.escalateVideo(d.callId,d.getAudioStream(),d.getVideoStreams()).then(function(){},function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to escalate video: "+b),d.mediaTransactionDfd.reject(new a.Services.Call.CallException(a.Services.Call.CallError.SEND_ERROR)),d.removeLocalVideoTracks(),d.revertFsmState(a.Providers.Call.States.ACTIVE)})},function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to get local media streams for call. "+b),g[0]._negotiatedDirection=a.Services.Call.MediaDirection.INACTIVE,d.mediaTransactionDfd.reject(new a.Services.Call.CallException(a.Services.Call.CallError.MEDIA_CREATION_FAILURE)),d.deviceRetrievalFailure(a.Providers.Call.States.ACTIVE)}),{nextState:a.Providers.Call.States.ACTIVE_RENEGOTIATE}}a.Providers.Call.EscalateVideoEventInActiveHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(){a.Providers.Call.GetOfferSDPEventInMultipleHandler.call(this)}b.prototype=Object.create(a.Providers.Call.AbstractEventHandler.prototype),b.prototype.handleEvent=function(b){a.Providers.Call.GetOfferSDPEventInMultipleHandler.prototype.handleEvent.apply(this,[b])},b.prototype.handleError=function(b){var c=this.event.data.cpCall,d=this.event.data.callProvider,e=c.call.getVideoChannels();c.removeLocalVideoTracks(),e[0]._setNegotiatedDirection(a.Services.Call.MediaDirection.DISABLE),e[0]._setVideoDisabledReason(a.Services.Call.VideoChannelDisabledReason.DISABLED_BY_LOCAL_USER),d.triggerVideoChannelUpdate(c.call),c.mediaTransactionDfd.reject(b),c.revertFsmState(a.Providers.Call.States.ACTIVE)},a.Providers.Call.EscalateVideoGetOfferEventInActiveRenegotiateHandler=b}(AvayaClientServices),function(a){"use strict";function b(){a.Providers.Call.OfferSDPEventInMultipleHandler.call(this)}b.prototype=Object.create(a.Providers.Call.AbstractEventHandler.prototype),b.prototype.handleEvent=function(b){a.Providers.Call.OfferSDPEventInMultipleHandler.prototype.handleEvent.apply(this,[b])},b.prototype.handleError=function(b){var c=this.event.data.cpCall,d=c.call.getVideoChannels();c.removeLocalVideoTracks(),d[0]._setNegotiatedDirection(a.Services.Call.MediaDirection.DISABLE),d[0]._setVideoDisabledReason(a.Services.Call.VideoChannelDisabledReason.DISABLED_BY_LOCAL_USER),c.mediaTransactionDfd.reject(b),c.revertFsmState(a.Providers.Call.States.ACTIVE)},a.Providers.Call.EscalateVideoOfferEventInActiveRenegotiateHandler=b}(AvayaClientServices),function(a){"use strict";function b(b){var c=b.data.cpCall,d=b.data.callProvider,e=c.call.getVideoChannels();return c.removeLocalVideoTracks(),e[0]._setNegotiatedDirection(a.Services.Call.MediaDirection.DISABLE),e[0]._setVideoDisabledReason(a.Services.Call.VideoChannelDisabledReason.DISABLED_BY_REMOTE_USER),d.triggerVideoChannelUpdate(c.call),c.mediaTransactionDfd.reject(new a.Services.Call.CallException(a.Services.Call.CallError.VIDEO_DENIED)),{nextState:a.Providers.Call.States.ACTIVE,nextEvent:c.popQueuedActiveRenegotiateEvent()}}a.Providers.Call.EscalateVideoRejectedEventInActiveRenegotiateHandler=b}(AvayaClientServices),function(a){"use strict";function b(){a.Providers.Call.AbstractEventHandler.call(this)}b.prototype=Object.create(a.Providers.Call.AbstractEventHandler.prototype),b.prototype.handleEvent=function(b){this.event=b;var c=b.data.callProvider,d=b.data.cpCall,e=d._callGatewayProvider,f=d._rtConnection;switch(f.onAddStream=function(c){d.handleEvent(new a.Providers.Call.OnAddStreamEvent({newStream:c,action:b.data.action}))},b.data.action){case a.Providers.Call.CallProvider.Constants.INCOMING_HOLD_ACTION:c.triggerRemoteHold(d.call);break;case a.Providers.Call.CallProvider.Constants.INCOMING_UNHOLD_ACTION:c.triggerRemoteUnhold(d.call)}var g=d.getVideoStreams(),h=(d.getAudioStream(),g.length>0);f.createOffer(function(c){e.offerSDPResponse(d.callId,c,b.data.action,d.getAudioStream(),d.getVideoStreams()).then(function(){},function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Error while sending offer: "+b),this.handleError(new a.Services.Call.CallException(a.Services.Call.CallError.SEND_ERROR))}.bind(this))}.bind(this),function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Error while creating offer: "+b),this.handleError(new a.Services.Call.CallException(a.Services.Call.CallError.INTERNAL_ERROR))}.bind(this),function(b){if(g.length>0){var c=a.Providers.Call.Utils.updateVideoSdp(g[0],b);return d.call.getState()===a.Services.Call.CallStates.HOLDING||d.call.getState()===a.Services.Call.CallStates.HELD||d.call.isHeldRemotely()||(c=a.Base.SDPUtil.updateAudioSdpSendRecv(c)),c}return b},h)},b.prototype.handleError=function(a){this.event.data.cpCall.mediaTransactionDfd.reject(a)},a.Providers.Call.GetOfferSDPEventInMultipleHandler=b}(AvayaClientServices),function(a){"use strict";function b(b){var e=b.data.cpCall;null!==e.localStream&&e._rtConnection.hasVideo(e.localStream)&&b.data.videoResolution&&b.data.videoResolution.getWidth()!==e._videoResolution.getWidth()&&b.data.videoResolution.getHeight()!==e._videoResolution.getHeight()?a.Providers.Call.CPUtils.createLocalMediaStream(b.data.audioDevice,b.data.videoDevice,e,b.data.callProvider.getMediaServiceFactory(),b.data.videoResolution,c,d,b):c(e)}function c(b){var c=b._callGatewayProvider,d=b._rtConnection;d.onAddStream=function(c){b.handleEvent(new a.Providers.Call.OnAddStreamEvent({newStream:c}))};var e=b.getVideoStreams(),f=e.length>0;d.createOffer(function(d){c.getOfferSDPResponse(b.callId,d,b.getAudioStream(),b.getVideoStreams()).fail(function(){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to send get offer response",error),callProvider.trigger(a.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[b.call,a.Services.Call.CallError.SEND_ERROR])})},function(c){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Error while creating offer",c),callProvider.trigger(a.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[b.call,a.Services.Call.CallError.INTERNAL_ERROR])},function(b){return e.length>0?a.Providers.Call.Utils.updateVideoSdp(e[0],b):b},f)}function d(b){b.deviceRetrievalFailure(a.Providers.Call.States.ACTIVE)}a.Providers.Call.GetOfferSDPEventInStartingHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c=b.data.cpCall,d=c._callGatewayProvider;c._rtConnection.disableLocalStreams();var e=c.getAudioStream(),f=c.getVideoStreams();e.direction=a.Services.Call.MediaDirection.SEND_ONLY;for(var g=0;g<f.length;g++)f[g].direction=a.Services.Call.MediaDirection.INACTIVE;return c.setAVStreams(e,f),d.holdCall(c.callId,c.getAudioStream(),c.getVideoStreams()).then(function(){},function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to hold: "+b),c.mediaTransactionDfd.reject(new a.Services.Call.CallException(a.Services.Call.CallError.SEND_ERROR)),c.revertFsmState(a.Providers.Call.States.ACTIVE)}),{nextState:a.Providers.Call.States.ACTIVE_RENEGOTIATE}}a.Providers.Call.HoldEventInActiveHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){function c(){var c=e.createVideoChannel_MediaDirection(b.data.videoStreams[0].direction);c._setNegotiatedDirection(a.Services.Call.MediaDirection.RECV_ONLY),d.call._videoChannels[0]=c,e.getMediaServiceFactory().getVideoInterfaceService().setRemoteMediaStream(c.getChannelId(),d.remoteStream),e.triggerVideoChannelUpdate(d.call)}var d=b.data.cpCall,e=b.data.callProvider,f=d._callGatewayProvider,g=d._rtConnection,h=e._config.callUserConfiguration.incomingVideoRequestTimeout,i=e.isVideoConfigurationEnabled();a.Base.Utils.isDefined(h)||(h=a.Config.CallUserConfiguration.DefaultValues.INCOMING_VIDEO_REQUEST_TIMEOUT);var j=d.getAudioStream(),k=[];i&&(k.push(new a.Providers.Interfaces.VideoStream(0,a.Services.Call.MediaDirection.RECV_ONLY)),d.setAVStreams(j,k),c()),g.createAnswer(b.data.offer,function(a){f.offerSDPResponse(d.callId,a,b.data.action,j,k).then(function(){i&&(d.incomingCallInfo={offer:b.data.offer,audioStream:b.data.audioStream,videoStreams:b.data.videoStreams,action:b.data.action},d.incomingVideoRequestTimer=setTimeout(function(){d.incomingVideoRequestTimedout()},h),e.triggerIncomingAddVideoRequest(d.call))})},function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"IncomingAddVideo error while creating answer: "+b)},function(b){return k.length>0?a.Providers.Call.Utils.updateVideoSdp(k[0],b):a.Base.SDPUtil.rejectMedia(b,"m=video")})}a.Providers.Call.IncomingAddVideoEventInActiveHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c=b.data.cpCall,d=b.data.callProvider;a.Base.Logger.info(a.Base.LoggerTags.CALL_PROVIDER,"Timed out waiting for incoming add video request to be accepted"),d.triggerIncomingAddVideoTimedout(c.call)}a.Providers.Call.IncomingAddVideoTimedoutEventInActiveHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(a){var b=a.data.cpCall;a.data.isRemote&&b.setQueuedRemoteCallEstablishedEvent(a)}a.Providers.Call.IncomingCallEstablishedEventInEndingHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c;switch(b.data.action){case a.Providers.Call.CallProvider.Constants.INCOMING_ADD_VIDEO_ACTION:c=new a.Providers.Call.IncomingAddVideoEvent(b.data);break;case a.Providers.Call.CallProvider.Constants.INCOMING_REMOVE_VIDEO_ACTION:c=new a.Providers.Call.IncomingRemoveVideoEvent(b.data);break;default:c=new a.Providers.Call.OfferSDPEvent(b.data)}return{nextState:void 0,nextEvent:c}}a.Providers.Call.IncomingGenericOfferSDPEventInActive=b}(AvayaClientServices),function(a){"use strict";function b(b){var c=b.data.cpCall;return a.Base.Logger.debug(a.Base.LoggerTags.CALL_PROVIDER,"Received incoming offer event while in ACTIVE_RENEGOTIATE. Queuing for later processing."),c.setQueuedActiveRenegotiateEvent(b),{nextState:void 0,nextEvent:void 0}}a.Providers.Call.IncomingGenericOfferSDPEventInActiveRenegotiate=b}(AvayaClientServices),function(a){"use strict";function b(b){var c=b.data.cpCall,d=b.data.callProvider,e=c._callGatewayProvider,f=c._rtConnection,g=c.call.getVideoChannels();f.disableLocalVideoStreams(),f.disableRemoteVideoStreams();for(var h=c.getVideoStreams(),i=0;i<h.length;i++)h[i].direction=a.Services.Call.MediaDirection.INACTIVE,h[i].enabled=!1,g[i]._setNegotiatedDirection(h[i].direction);c.setAVStreams(c.getAudioStream(),h),c.removeLocalVideoTracks(),g[0]._setNegotiatedDirection(a.Services.Call.MediaDirection.DISABLE),g[0]._setVideoDisabledReason(a.Services.Call.VideoChannelDisabledReason.DISABLED_BY_REMOTE_USER),d.triggerVideoChannelUpdate(c.call);var j=function(){c.call.getState()===a.Services.Call.CallStates.FAR_END_RENEGOTIATING&&c.call._setState(a.Services.Call.CallStates.ESTABLISHED)};f.createAnswer(b.data.offer,function(f){e.offerSDPResponse(c.callId,f,b.data.action,c.getAudioStream(),c.getVideoStreams()).then(function(){j()}.bind(this),function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to send offer response",b),d.trigger(a.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[c.call,a.Services.Call.CallError.SEND_ERROR]),j()}.bind(this))},function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Error while creating answer",b),d.trigger(a.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[c.call,a.Services.Call.CallError.INTERNAL_ERROR]),j()})}a.Providers.Call.IncomingRemoveVideoEventInActiveHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c=b.data.cpCall,d=b.data.callProvider,e=c._callGatewayProvider,f=b.data.audioDevice?b.data.audioDevice.getDeviceId():void 0;d.getMediaServiceFactory().getMediaServicesService().createLocalMediaStream(!0,!1,f).then(function(b){var d=b.stream;c.localStream=d,c._rtConnection.addStream(c.localStream),c._rtConnection.disableLocalStreams();var f=null;d.getTracks().forEach(function(b){
"audio"===b.kind&&(f=new a.Providers.Interfaces.AudioStream(b.id,a.Services.Call.MediaDirection.SEND_RECV))}),c.setAVStreams(f,[]),e.joinRemoteCall(c.callId,c.getAudioStream(),c.getVideoStreams()).then(function(){c._joinRemotePromise.resolve(),c.revertFsmState(a.Providers.Call.States.ACTIVE)},function(b){a.Base.Logger.info(a.Base.LoggerTags.CALL_PROVIDER,"Failed to join to remote call: "+c.callId),c._joinRemotePromise.reject(new a.Services.Call.CallException(b.errorCode,b.protocolType,b.protocolErrorCode,b.errorMsg))})},function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to get local media streams to join remote call. "+b),c._joinRemotePromise.reject(new a.Services.Call.CallException(a.Services.Call.CallError.MEDIA_CREATION_FAILURE)),c.handleEvent(new a.Providers.Call.DeviceRetrievalFailedEvent)})}a.Providers.Call.JoinRemoteCallEventInInitialHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(a){var b=a.data.cpCall;b.localStream&&b._rtConnection.disableLocalAudioStreams()}a.Providers.Call.MuteAudioEventInMultipleHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(a){var b=a.data.cpCall,c=a.data.callProvider;if(b.remoteStream){c.getMediaServiceFactory().getAudioOutputInterfaceService().getAudioOutput().muteStream(b.remoteStream)}}a.Providers.Call.MuteSpeakerEventInMultipleHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(){a.Providers.Call.AbstractEventHandler.call(this)}b.prototype=Object.create(a.Providers.Call.AbstractEventHandler.prototype),b.prototype.handleEvent=function(c){this.event=c;var d=c.data.cpCall,e=c.data.callProvider;c.data.videoResolution&&d._videoResolution.getWidth()>c.data.videoResolution.getWidth()||d._videoResolution.getHeight()>c.data.videoResolution.getHeight()?a.Providers.Call.CPUtils.createLocalMediaStream(c.data.audioDevice,c.data.videoDevice,d,e.getMediaServiceFactory(),c.data.videoResolution,b.prototype.offerSDP.bind(this),b.prototype.errorHandler.bind(this),c):b.prototype.offerSDP.call(this,d,c)},b.prototype.handleError=function(a){this.event.data.cpCall.mediaTransactionDfd.reject(a)},b.prototype.errorHandler=function(c){this.handleError(new a.Services.Call.CallException(a.Services.Call.CallError.MEDIA_CREATION_FAILURE)),b.prototype.resetFarEndRenegotiateStateIfNeeded(this,c)},b.prototype.resetFarEndRenegotiateStateIfNeeded=function(b){b.call.getState()===a.Services.Call.CallStates.FAR_END_RENEGOTIATING&&b.call._setState(a.Services.Call.CallStates.ESTABLISHED)},b.prototype.offerSDP=function(c,d){var e=d.data.callProvider,f=c._callGatewayProvider,g=c._rtConnection;g.onAddStream=function(b){c.handleEvent(new a.Providers.Call.OnAddStreamEvent({newStream:b,action:d.data.action}))},c.updateAudioVideoStreamsDirection(d.data.audioStream,d.data.videoStreams,d.data.action);var h=c.getVideoStreams();switch(c.notifyCallServiceOfMediaChanges(d.data.action),d.data.action){case a.Providers.Call.CallProvider.Constants.INCOMING_HOLD_ACTION:e.triggerRemoteHold(c.call);break;case a.Providers.Call.CallProvider.Constants.INCOMING_UNHOLD_ACTION:e.triggerRemoteUnhold(c.call)}g.createAnswer(d.data.offer,function(e){f.offerSDPResponse(c.callId,e,d.data.action,c.getAudioStream(),c.getVideoStreams()).then(function(){b.prototype.resetFarEndRenegotiateStateIfNeeded.call(this,c)}.bind(this),function(d){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"OfferSDPEventInMultipleHandler ERROR while sending answer: "+d),this.handleError(new a.Services.Call.CallException(a.Services.Call.CallError.SEND_ERROR)),b.prototype.resetFarEndRenegotiateStateIfNeeded.call(this,c)}.bind(this))}.bind(this),function(d){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"OfferSDPEventInMultipleHandler ERROR while creating answer: "+d),this.handleError(new a.Services.Call.CallException(a.Services.Call.CallError.INTERNAL_ERROR)),b.prototype.resetFarEndRenegotiateStateIfNeeded.call(this,c)}.bind(this),function(b){return b=h.length>0?a.Providers.Call.Utils.updateVideoSdp(h[0],b):a.Base.SDPUtil.rejectMedia(b,"m=video"),c.call.getState()===a.Services.Call.CallStates.HOLDING||c.call.getState()===a.Services.Call.CallStates.HELD||c.call.isHeldRemotely()||(b=a.Base.SDPUtil.updateAudioSdpSendRecv(b)),b})},a.Providers.Call.OfferSDPEventInMultipleHandler=b}(AvayaClientServices),function(a){"use strict";function b(b){var e=b.data.cpCall;null!==e.localStream&&e._rtConnection.hasVideo(e.localStream)&&b.data.videoResolution&&b.data.videoResolution.getWidth()!==e._videoResolution.getWidth()&&b.data.videoResolution.getHeight()!==e._videoResolution.getHeight()?a.Providers.Call.CPUtils.createLocalMediaStream(b.data.audioDevice,b.data.videoDevice,e,b.data.callProvider.getMediaServiceFactory(),b.data.videoResolution,c,d,b):c(e,b)}function c(b,c){var d=b._callGatewayProvider,e=c.data.callProvider,f=b._rtConnection;f.onAddStream=function(c){b.handleEvent(new a.Providers.Call.OnAddStreamEvent({newStream:c}))},f.createAnswer(c.data.offer,function(f){d.offerSDPResponse(b.callId,f,c.data.action,b.getAudioStream(),b.getVideoStreams()).fail(function(c){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to send offer response",c),e.trigger(a.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[b.call,a.Services.Call.CallError.SEND_ERROR])})},function(c){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Error while creating offer",c),e.trigger(a.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[b.call,a.Services.Call.CallError.INTERNAL_ERROR])})}function d(b){b.revertFsmState(a.Providers.Call.States.ACTIVE)}a.Providers.Call.OfferSDPEventInStartingHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(){a.Providers.Call.AbstractEventHandler.call(this)}b.prototype=Object.create(a.Providers.Call.AbstractEventHandler.prototype),b.prototype.handleEvent=function(b){this.event=b;var c=b.data.cpCall,d=b.data.callProvider,e=c._callGatewayProvider,f=a.Base.Utils.isDefined(c._audioDevice)?c._audioDevice.getDeviceId():void 0,g=a.Base.Utils.isDefined(c._videoDevice)?c._videoDevice.getDeviceId():void 0;c.updateAudioVideoStreamsDirection(b.data.audioStream,b.data.videoStreams,b.data.action);var h=c.getVideoStreams(),i=c.getAudioStream();c._rtConnection.removeStream(c.localStream),d.getMediaServiceFactory().getMediaServicesService().createLocalMediaStream(!0,!0,f,g,c.getVideoChannelId(),b.data.videoResolution).then(function(d){var f=d.stream;d.videoResolution&&c._updateVideoResolution(d.videoResolution),c._rtConnection.addStream(f),c.localStream=f,c._rtConnection.createAnswer(b.data.offer,function(d){e.offerSDPResponse(c.callId,d,b.data.action,i,h).then(function(){c.notifyCallServiceOfMediaChanges(b.data.action)}.bind(this),function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"OfferSDPFirefoxMidcallEventInMultipleHandler  ERROR while sending answer: "+b),this.handleError(new a.Services.Call.CallException(a.Services.Call.CallError.SEND_ERROR))}.bind(this))}.bind(this),function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"OfferSDPFirefoxMidcallEventInMultipleHandler  ERROR while creating answer: "+b),this.handleError(new a.Services.Call.CallException(a.Services.Call.CallError.INTERNAL_ERROR))}.bind(this),function(b){return h.length>0?a.Providers.Call.Utils.updateVideoSdp(h[0],b):a.Base.SDPUtil.rejectMedia(b,"m=video")})}.bind(this),function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"OfferSDPFirefoxMidcallEventInMultipleHandler  ERROR: "+b),c.mediaTransactionDfd.reject(new a.Services.Call.CallException(a.Services.Call.CallError.MEDIA_CREATION_FAILURE)),c.deviceRetrievalFailure(a.Providers.Call.States.ACTIVE)}.bind(this))},b.prototype.handleError=function(a){this.event.data.cpCall.mediaTransactionDfd.reject(a)},a.Providers.Call.OfferSDPFirefoxMidcallEventInMultipleHandler=b}(AvayaClientServices),function(a){"use strict";function b(b){var c=b.data.cpCall,d=b.data.callProvider;if(a.Base.Logger.debug(a.Base.LoggerTags.CALL_PROVIDER,">>> Add new remote track: "+b.data.newTrack.kind+" id: "+b.data.newTrack.id),b.data.newTrack.kind===a.Providers.Call.CallProvider.Constants.VIDEO_TRACK){var e=c.call.getVideoChannels();e.length>0&&(c._rtConnection.enableVideoTrack(c.remoteStream,b.data.newTrack),d.getMediaServiceFactory().getVideoInterfaceService().setRemoteMediaStream(e[0].getChannelId(),c.remoteStream),d.triggerVideoChannelUpdate(c.call))}else{var f=d.getMediaServiceFactory().getAudioOutputInterfaceService().getAudioOutput();c.remoteStream&&!f.playAudioStream(c.remoteStream,c.call.isSpeakerMuted())&&a.Base.Logger.info(a.Base.LoggerTags.CALL_PROVIDER,"No Audio Tracks Found. Could not replay remote audio.")}}a.Providers.Call.OnAddRemoteTrackEventInActiveHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c=b.data.cpCall,d=b.data.callProvider,e=null===c.remoteStream;c.remoteStream=b.data.newStream,e&&(c.remoteStream.onaddtrack=function(b){c.handleEvent(new a.Providers.Call.OnAddRemoteTrackEvent({newTrack:b.track}))},c.remoteStream.onremovetrack=function(b){c.handleEvent(new a.Providers.Call.OnRemoveRemoteTrackEvent({newTrack:b.track}))}),c._rtConnection.enableRemoteStreams();var f=d.getMediaServiceFactory().getAudioOutputInterfaceService().getAudioOutput();f.stopPlayingAudioStream(c.remoteStream),f.playAudioStream(c.remoteStream,c.call.isSpeakerMuted()),a.Base.Utils.isDefined(b.data.action)&&b.data.action===a.Providers.Call.CallProvider.Constants.UNHOLD&&(c.call.isAudioMuted()?c._rtConnection.enableLocalVideoStreams():c._rtConnection.enableLocalStreams(),c.notifyCallServiceOfMediaChanges(b.data.action))}a.Providers.Call.OnAddStreamEventInActiveHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c=b.data.cpCall,d=c._rtConnection,e=b.data.callProvider,f=e.getMediaServiceFactory().getAudioOutputInterfaceService().getAudioOutput(),g=null===c.remoteStream;c.remoteStream=b.data.newStream,c._isEarlyMedia&&!f.isPlaying(c.remoteStream)?(d.enableRemoteStreams(),c.call.isAudioMuted()||d.enableLocalAudioStreams(),f.playAudioStream(c.remoteStream,c.call.isSpeakerMuted())||a.Base.Logger.info(a.Base.LoggerTags.CALL_PROVIDER,"No Audio Tracks Found.  Could not play remote audio.")):d.disableRemoteStreams(),g&&(c.remoteStream.onaddtrack=function(b){c.handleEvent(new a.Providers.Call.OnAddRemoteTrackEvent({newTrack:b.track}))},c.remoteStream.onremovetrack=function(b){c.handleEvent(new a.Providers.Call.OnRemoveRemoteTrackEvent({newTrack:b.track}))})}a.Providers.Call.OnAddStreamEventPreActiveHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c=b.data.cpCall,d=b.data.callProvider;if(a.Base.Logger.debug(a.Base.LoggerTags.CALL_PROVIDER,">>> Removed remote track: "+b.data.newTrack.kind+" id: "+b.data.newTrack.id),b.data.newTrack.kind===a.Providers.Call.CallProvider.Constants.AUDIO_TRACK){d.getMediaServiceFactory().getAudioOutputInterfaceService().getAudioOutput().stopPlayingAudioStream(c.remoteStream,!1)}}a.Providers.Call.OnRemoveRemoteTrackEventInActiveHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(a){var b=a.data.cpCall,c=b._callGatewayProvider,d=a.data.deferred;c.rejectCallRequest(b.callId,b.getCallRequestedTransactionalId(a.data.requestedType),a.data.action).then(function(){d.resolve()},function(a){d.reject(a)})}a.Providers.Call.RejectCallRequestEventInMultipleHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(a){return{nextState:a.data.state}}a.Providers.Call.RevertStateEventInMultipleHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(a){a.data.cpCall._rtConnection.sendDTMF(a.data.dtmf)}a.Providers.Call.SendDTMFEventInMultipleHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c,d,e=b.data.cpCall,f=b.data.callProvider,g=e._callGatewayProvider,h=e.call.getVideoChannels(),i=!1,j=!1,k=b.data.audioDevice?b.data.audioDevice.getDeviceId():void 0;if(a.Base.Utils.isDefined(h))for(var l=0;l<h.length;l++)h[l].getRequestedDirection()===a.Services.Call.MediaDirection.SEND_ONLY||h[l].getRequestedDirection()===a.Services.Call.MediaDirection.SEND_RECV?(i=!0,b.data.videoDevice&&(c=b.data.videoDevice.getDeviceId())):h[l].getRequestedDirection()===a.Services.Call.MediaDirection.RECV_ONLY&&(j=!0),h[l].getRequestedDirection()!==a.Services.Call.MediaDirection.INACTIVE&&(d=h[l].getChannelId());return f.getMediaServiceFactory().getMediaServicesService().createLocalMediaStream(!0,i,k,c,d,b.data.videoResolution).then(function(c){var d=c.stream;c.videoResolution&&e._updateVideoResolution(c.videoResolution),a.Base.Logger.debug(a.Base.LoggerTags.CALL_PROVIDER,"getUserMedia success");var k=0,l=null,m=[];if(d.getTracks().forEach(function(b){if("audio"===b.kind)l=new a.Providers.Interfaces.AudioStream(b.id,a.Services.Call.MediaDirection.SEND_RECV);else if("video"===b.kind){var c=a.Services.Call.MediaDirection.SEND_RECV;k<h.length&&(c=h[k].getRequestedDirection(),k++),m.push(new a.Providers.Interfaces.VideoStream(b.id,c))}}),null===l)return a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"No microphone is available"),void f.trigger(a.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[e.call,a.Services.Call.CallError.MICROPHONE_NOT_FOUND]);if(0===m.length)if(i)if(h[0].getRequestedDirection()===a.Services.Call.MediaDirection.SEND_RECV)h[0]._setRequestedDirection(a.Services.Call.MediaDirection.RECV_ONLY),a.Base.Logger.warn(a.Base.LoggerTags.CALL_PROVIDER,"Camera is blocked - update SEND_RECV video direction to RECV_ONLY"),m.push(new a.Providers.Interfaces.VideoStream("recvOnlyVideoStreamId",a.Services.Call.MediaDirection.RECV_ONLY));else{if(h[0].getRequestedDirection()!==a.Services.Call.MediaDirection.SEND_ONLY){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to get video media streams for call."),e._rtConnection.stopStream(d);var n=new a.Providers.Call.DeviceRetrievalFailedEvent;return void e.handleEvent(n)}h[0]._setRequestedDirection(a.Services.Call.MediaDirection.INACTIVE),a.Base.Logger.warn(a.Base.LoggerTags.CALL_PROVIDER,"Camera is blocked - update SEND_ONLY video direction to INACTIVE")}else j&&m.push(new a.Providers.Interfaces.VideoStream("recvOnlyVideoStreamId",a.Services.Call.MediaDirection.RECV_ONLY));e.setAVStreams(l,m),e.localStream=d,e._rtConnection.addStream(e.localStream),e._rtConnection.disableLocalStreams(),g.startCall(b.data.remoteAddress,e.call.getSubject(),e.call._callCreationInfo,b.data.video,b.data.webCollab,e.getAudioStream(),e.getVideoStreams(),b.data.uccp,e.call.getCallId()).then(function(c){a.Base.Logger.debug(a.Base.LoggerTags.CALL_PROVIDER,"callGateway startCallResponse: "+JSON.stringify(c));var d=new a.Providers.Call.StartCallResponseEvent;d.data={},d.data.callId=c.callId,d.data.videoResolution=b.data.videoResolution,d.data.audioDevice=b.data.audioDevice,d.data.videoDevice=b.data.videoDevice,e.handleEvent(d)},function(b){f.trigger(a.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[e.call,b.errorCode,b.protocolType,b.protocolErrorCode,b.errorMsg])})},function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to get local media streams for call. "+b);var c=new a.Providers.Call.DeviceRetrievalFailedEvent;e.handleEvent(c)}),{nextState:a.Providers.Call.States.STARTING}}a.Providers.Call.StartCallEventInInitialHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c=b.data.cpCall,d=b.data.callProvider,e=b.data.callId;c.callId=e,d.registerCall(e,c.call,c),d.triggerCallStarted(c.call);var f=d.getQueuedMediaOfferNotification(e);f&&(a.Base.Utils.isDefined(f.offer)?c.offerSDP(f.offer,f.action,f.audioStream,f.videoStreams):c.getOfferSDP(f.action,f.audioStream,f.videoStreams,f.videoBandwidth,b.data.audioDevice,b.data.videoDevice))}a.Providers.Call.StartCallResponseEventInStartingHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(a){var b=a.data.cpCall;b._callGatewayProvider.startRinging(b.callId)}a.Providers.Call.StartRingingEventInInitialHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c=b.data.cpCall;c._callGatewayProvider.transfer(c.callId,b.data.targetRemoteAddress,c.getAudioStream(),c.getVideoStreams()).then(function(){},function(b){c._transferPromise.reject(new a.Services.Call.CallException(b.errorCode,b.protocolType,b.protocolErrorCode,b.errorMsg))})}a.Providers.Call.TransferEventInActiveHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c=b.data.cpCall,d=c._callGatewayProvider;if(c.localStream.getVideoTracks().length>0)c._rtConnection.enableLocalVideoStreams(),d.blockUnBlockCamera(c.callId,c.getAudioStream(),c.getVideoStreams()).then(function(){},function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to unblock camera: "+b),c.mediaTransactionDfd.reject(new a.Services.Call.CallException(a.Services.Call.CallError.SEND_ERROR)),c.revertFsmState(a.Providers.Call.States.ACTIVE)});else{var e=b.data.callProvider,f=c.call.getVideoChannels(),g=a.Base.Utils.isDefined(b.data.videoDevice)?b.data.videoDevice:void 0,h=f[0].getChannelId();c.setVideoChannelId(f[0].getChannelId()),e.getMediaServiceFactory().getMediaServicesService().addVideoTracksToLocalStream(g,h,c.localStream,b.data.videoResolution).then(function(b){a.Base.Logger.debug(a.Base.LoggerTags.CALL_PROVIDER,"getUserMedia success");var e=c.getAudioStream(),f=[];b.getTracks().forEach(function(b){if(b.kind===a.Providers.Call.CallProvider.Constants.VIDEO_TRACK){var c=a.Services.Call.MediaDirection.SEND_RECV;f.push(new a.Providers.Interfaces.VideoStream(b.id,c))}}),c.setAVStreams(e,f),d.blockUnBlockCamera(c.callId,c.getAudioStream(),c.getVideoStreams()).then(function(){},function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to unblock camera: "+b),c.mediaTransactionDfd.reject(new a.Services.Call.CallException(a.Services.Call.CallError.SEND_ERROR)),c.revertFsmState(a.Providers.Call.States.ACTIVE)})},function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to get local media streams for call. "+b),c.mediaTransactionDfd.reject(new a.Services.Call.CallException(a.Services.Call.CallError.MEDIA_CREATION_FAILURE)),c.deviceRetrievalFailure(a.Providers.Call.States.ACTIVE)})}return{nextState:a.Providers.Call.States.ACTIVE_RENEGOTIATE}}a.Providers.Call.UnBlockCameraEventInActiveHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c=b.data.cpCall,d=c._callGatewayProvider,e=c.call.getVideoChannels();c.call.isAudioMuted()?c._rtConnection.enableLocalVideoStreams():0===e.length||e[0].getRequestedDirection()!==a.Services.Call.MediaDirection.SEND_RECV&&e[0].getRequestedDirection()!==a.Services.Call.MediaDirection.SEND_ONLY?c._rtConnection.enableLocalAudioStreams():c._rtConnection.enableLocalStreams();var f=c.getAudioStream(),g=c.getVideoStreams();f.direction=a.Services.Call.MediaDirection.SEND_RECV;for(var h=0;h<g.length;h++)g[h].direction=e[h].getRequestedDirection();return c.setAVStreams(f,g),d.unholdCall(c.callId,c.getAudioStream(),c.getVideoStreams()).then(function(){},function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to unhold: "+b),c.mediaTransactionDfd.reject(new a.Services.Call.CallException(a.Services.Call.CallError.SEND_ERROR)),c.revertFsmState(a.Providers.Call.States.ACTIVE)}),{nextState:a.Providers.Call.States.ACTIVE_RENEGOTIATE}}a.Providers.Call.UnHoldEventInActiveHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(a){var b=a.data.cpCall;b.localStream&&b._rtConnection.enableLocalAudioStreams()}a.Providers.Call.UnmuteAudioEventInMultipleHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(a){var b=a.data.cpCall,c=a.data.callProvider;if(b.remoteStream){c.getMediaServiceFactory().getAudioOutputInterfaceService().getAudioOutput().unmuteStream(b.remoteStream)}}a.Providers.Call.UnmuteSpeakerEventInMultipleHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c=b.data.cpCall,d=function(){a.Base.Logger.debug("Sending UPDATE_VIDEO request for new local stream"),c._callGatewayProvider.updateVideo(c.callId,c.getAudioStream(),c.getVideoStreams()).then(function(){c.mediaTransactionDfd.resolve(c.getVideoResolution()),a.Base.Utils.isDefined(b.data.videoResolutionChanged)||c.revertFsmState(a.Providers.Call.States.ACTIVE)},function(b){a.Base.Logger.error("Failed to update local stream: "+c.getVideoResolution()),c.mediaTransactionDfd.reject(new a.Services.Call.CallException(a.Services.Call.CallError.SEND_ERROR)),c.revertFsmState(a.Providers.Call.States.ACTIVE)})},e=function(){a.Base.Logger.error("Create local media error: "+c.getVideoResolution()),c.mediaTransactionDfd.reject(new a.Services.Call.CallException(a.Services.Call.CallError.MEDIA_CREATION_FAILURE)),c.revertFsmState(a.Providers.Call.States.ACTIVE)};if(null!==c.localStream){if(c._isFirefoxBrowser)if(b.data.videoResolutionChanged)a.Providers.Call.CPUtils.createLocalMediaStream(b.data.audioDevice,b.data.videoDevice,c,b.data.callProvider.getMediaServiceFactory(),b.data.videoResolution,d,e);else{var f,g;b.data.selectedDevice._kind===a.Base.MediaTypes.VIDEO_INPUT?g=b.data.selectedDevice:f=b.data.selectedDevice,a.Providers.Call.CPUtils.updateDevicesFirefox(f,g,c,b.data.callProvider.getMediaServiceFactory(),b.data.videoResolution,d,e)}else a.Providers.Call.CPUtils.createLocalMediaStream(b.data.audioDevice,b.data.videoDevice,c,b.data.callProvider.getMediaServiceFactory(),b.data.videoResolution,d,e);return{nextState:a.Providers.Call.States.ACTIVE_RENEGOTIATE}}d(c)}a.Providers.Call.UpdateLocalStreamHandler=b}(AvayaClientServices),function(a){"use strict";function b(b){var c=b.data.cpCall;return c._callGatewayProvider.updateVideo(c.callId,c.getAudioStream(),c.getVideoStreams()).then(function(){},function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to update remote video: "+b),c.mediaTransactionDfd.reject(new a.Services.Call.CallException(a.Services.Call.CallError.SEND_ERROR)),c.revertFsmState(a.Providers.Call.States.ACTIVE)}),{nextState:a.Providers.Call.States.ACTIVE_RENEGOTIATE}}a.Providers.Call.UpdateRemoteVideoEventInActiveHandler=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b,c,d){a.Base.Observable.call(this),this._networkProvider=b,this._config={},this._notificationProvider=c,this._notificationParser=d}b.prototype=Object.create(a.Base.Observable.prototype),b.prototype.init=function(b){return this._config=b,this._networkProvider.onMessage=function(a){},this._networkProvider.onError=function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_GATEWAY_PROVIDER,b)},this._networkProvider.init(this._config),this._notificationProvider.onMessage=function(b){var c;c=b.data&&b.type!==a.Base.ProvidersEventTypes.PING?JSON.parse(b.data):b;var d,e;try{d=JSON.parse(c.message),e=this._notificationParser.parse(d),e=e||d}catch(f){e=c}e.type?this.trigger("call."+e.type,[e]):this.trigger("call.message",[e])}.bind(this),this._notificationProvider.onError=function(b){a.Base.Logger.error(a.Base.LoggerTags.CALL_GATEWAY_PROVIDER,b)},this._notificationProvider.init(this._config),this},b.prototype.startCall=function(b){var c={sendType:"POST",urlSuffix:"/restgateway/calls",dataType:"json",headers:{Accept:"application/json","Content-Type":"application/json"}},d=JSON.stringify({remoteAddress:b});return this._networkProvider.send(d,c).then(function(b){return new a.Providers.CallGateway.StartCallData(b.callHref,b.callId)})},b.prototype.endCall=function(a){var b={sendType:"DELETE",urlSuffix:"/restgateway/calls/"+a,dataType:"text",headers:{Accept:"application/json","Content-Type":"application/json"}};return this._networkProvider.send(null,b)},b.prototype.acceptCall=function(a,b){var c={sendType:"POST",urlSuffix:"/restgateway/calls/"+a+"/connections/"+b,dataType:"json",headers:{Accept:"application/json","Content-Type":"application/json;"}};return this._networkProvider.send(null,c)},b.prototype.holdCall=function(a,b){var c={sendType:"POST",urlSuffix:"/restgateway/calls/"+a+"/connections/"+b+"/hold",dataType:"text",headers:{Accept:"application/json","Content-Type":"application/json;"}};return this._networkProvider.send(null,c)},b.prototype.unholdCall=function(a,b){var c={sendType:"POST",urlSuffix:"/restgateway/calls/"+a+"/connections/"+b+"/unhold",dataType:"text",headers:{Accept:"application/json","Content-Type":"application/json;"}};return this._networkProvider.send(null,c)},a.Providers.CallGateway.CallGatewayProvider=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(a,b,c,d,e,f,g,h,i,j){this.type="active",this.callEvent="ACTIVE",this.originalCallingParticipant=a,this.originalCalledParticipant=b,this.participants=c,this.callId=d,this.ucId=e,this.callHref=f,this.connectionId=g,this.connectionHref=h,this.address=i,this.operations=j}a.Providers.CallGateway.ActiveCallMessage=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(a,b,c,d,e,f,g,h,i,j,k){this.type="alerting",this.callEvent="ALERTING",this.originalCallingParticipant=a,this.originalCalledParticipant=b,this.participants=c,this.callId=d,this.ucId=e,this.callHref=f,this.connectionId=g,this.connectionHref=h,this.address=i,this.operations=j,this.alertingParticipant=k}a.Providers.CallGateway.AlertingCallMessage=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(a,b,c,d,e,f,g,h,i,j,k){this.type="answered",this.callEvent="ANSWERED",this.originalCallingParticipant=a,this.originalCalledParticipant=b,this.participants=c,this.callId=d,this.ucId=e,this.callHref=f,this.connectionId=g,this.connectionHref=h,this.address=i,this.operations=j,this.answeringParticipant=k}a.Providers.CallGateway.AnsweredCallMessage=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(a,b,c,d,e,f,g,h){this.type="failed",this.callEvent="FAILED",this.originalCallingParticipant=a,this.originalCalledParticipant=b,this.participants=c,this.callId=d,this.ucId=e,this.callHref=f,this.address=g,this.reason=h}a.Providers.CallGateway.FailedCallMessage=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(a,b,c,d,e,f,g,h,i,j){this.type="held",this.callEvent="HELD",this.originalCallingParticipant=a,this.originalCalledParticipant=b,this.participants=c,this.callId=d,this.ucId=e,this.callHref=f,this.connectionId=g,this.connectionHref=h,this.address=i,this.operations=j}a.Providers.CallGateway.HeldCallMessage=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(a,b,c,d,e){this.type="participantDropped",this.callEvent="PARTICIPANTDROPPED",this.participants=a,this.callId=b,this.callHref=c,this.address=d,this.droppingParticipant=e}a.Providers.CallGateway.ParticipantDroppedCallMessage=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(a,b){this.callId=b,this.callHref=a}a.Providers.CallGateway.StartCallData=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(a,b,c){this.type="subscription",this.callEvent="SUBSCRIPTION",this.status=a,this.subscriptionId=b,this.additionalProperties=c}a.Providers.CallGateway.SubscriptionCallMessage=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(a,b,c,d,e,f,g,h,i,j){this.type="unheld",this.callEvent="UNHELD",this.originalCallingParticipant=a,this.originalCalledParticipant=b,this.participants=c,this.callId=d,this.ucId=e,this.callHref=f,this.connectionId=g,this.connectionHref=h,this.address=i,this.operations=j}a.Providers.CallGateway.UnheldCallMessage=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(){}b.prototype={parse:function(a){throw new Error("Method not implemented!")}},a.Providers.CallGateway.AbstractParser=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.CallGateway.AbstractParser.prototype),b.prototype.parse=function(b){return new a.Providers.CallGateway.ActiveCallMessage(b.originalCallingParticipant,b.originalCalledParticipant,b.participants,b.callId,b.ucId,b.callHref,b.connectionId,b.connectionHref,b.address,b.operations)},a.Providers.CallGateway.ActiveCallMessageParser=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.CallGateway.AbstractParser.prototype),b.prototype.parse=function(b){return new a.Providers.CallGateway.AlertingCallMessage(b.originalCallingParticipant,b.originalCalledParticipant,b.participants,b.callId,b.ucId,b.callHref,b.connectionId,b.connectionHref,b.address,b.operations,b.alertingParticipant)},a.Providers.CallGateway.AlertingCallMessageParser=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.CallGateway.AbstractParser.prototype),b.prototype.parse=function(b){return new a.Providers.CallGateway.AnsweredCallMessage(b.originalCallingParticipant,b.originalCalledParticipant,b.participants,b.callId,b.ucId,b.callHref,b.connectionId,b.connectionHref,b.address,b.operations,b.answeringParticipant)},a.Providers.CallGateway.AnsweredCallMessageParser=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(){this._parsers=[]}b.prototype={register:function(a,b){this._parsers[a]=b},unregister:function(a){this._parsers[a]=void 0},parse:function(a){return a.callEvent?this._delegateParser(a.callEvent,a):a.subscriptionId?this._delegateParser("subscription",a):a},_delegateParser:function(b,c){if(void 0!==this._parsers[b])return this._parsers[b].parse(c);a.Base.Logger.error(a.Base.LoggerTags.CALL_GATEWAY_PROVIDER,"No parser specified!",b)}},a.Providers.CallGateway.CallNotificationParser=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.CallGateway.AbstractParser.prototype),b.prototype.parse=function(b){return new a.Providers.CallGateway.FailedCallMessage(b.originalCallingParticipant,b.originalCalledParticipant,b.participants,b.callId,b.ucId,b.callHref,b.address,b.reason)},a.Providers.CallGateway.FailedCallMessageParser=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.CallGateway.AbstractParser.prototype),b.prototype.parse=function(b){return new a.Providers.CallGateway.HeldCallMessage(b.originalCallingParticipant,b.originalCalledParticipant,b.participants,b.callId,b.ucId,b.callHref,b.connectionId,b.connectionHref,b.address,b.operations)},a.Providers.CallGateway.HeldCallMessageParser=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.CallGateway.AbstractParser.prototype),b.prototype.parse=function(b){return new a.Providers.CallGateway.ParticipantDroppedCallMessage(b.participants,b.callId,b.callHref,b.address,b.droppingParticipant)},a.Providers.CallGateway.ParticipantDroppedCallMessageParser=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.CallGateway.AbstractParser.prototype),
b.prototype.parse=function(b){return new a.Providers.CallGateway.SubscriptionCallMessage(b.status,b.subscriptionId,b.additionalProperties)},a.Providers.CallGateway.SubscriptionCallMessageParser=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.CallGateway.AbstractParser.prototype),b.prototype.parse=function(b){return new a.Providers.CallGateway.UnheldCallMessage(b.originalCallingParticipant,b.originalCalledParticipant,b.participants,b.callId,b.ucId,b.callHref,b.connectionId,b.connectionHref,b.address,b.operations)},a.Providers.CallGateway.UnheldCallMessageParser=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(){this._csgCallsProviderMap={},this._csgProviderMap={},this._csgPresenceProvider=void 0,this._messageBuilder=new a.Providers.CallServiceGateway.CallServiceGatewayProviderMessageBuilder}b.prototype={getCSGCallsProvider:function(b){return this._csgCallsProviderMap.hasOwnProperty(b)||(this._csgCallsProviderMap[b]=new a.Providers.CallServiceGateway.CSGCallsProvider(this._getCSGProvider(b),this._messageBuilder,b)),this._csgCallsProviderMap[b]},getCSGCallsProviderAsArray:function(){var a=[];for(var b in this._csgCallsProviderMap)this._csgCallsProviderMap.hasOwnProperty(b)&&a.push(this._csgCallsProviderMap[b]);return a},getCSGPresenceProvider:function(b){return this._csgPresenceProvider||(this._csgPresenceProvider=new a.Providers.CallServiceGateway.CSGPresenceProvider(this._getCSGProvider(b),this._messageBuilder)),this._csgPresenceProvider},_getCSGProvider:function(b){if(!this._csgProviderMap.hasOwnProperty(b)){var c=[a.Providers.CallServiceGateway.CSGNotificationEventType.CAS_NOTIFICATION,a.Providers.CallServiceGateway.CSGNotificationEventType.PING],d=new a.Base.SSEProvider(c),e=new a.Base.RESTProvider,f=new a.Base.SSEIntegrationProvider(e,d),g=new a.Base.WebSocketProvider,h=new a.Base.NetworkProvider(g,f),i=new a.Base.NetworkProvider(new a.Base.RESTProvider),j=new a.Base.PollingRESTProvider,k=new a.Base.PollingRESTProvider;this._csgProviderMap[b]=new a.Providers.CallServiceGateway.CSGProvider(this._messageBuilder,i,h,j,k)}return this._csgProviderMap[b]}},a.Providers.CallServiceGateway.CallServiceGatewayProviderFactory=b}(AvayaClientServices),function(a){"use strict";function b(a){this._credentials=a,this._requestCounter=0}var c={CSA_RESOURCE:"application/vnd.avaya.csa.resources.v1+json",CSA_SERVICES:"application/vnd.avaya.csa.services.v1+json",CSA_ERROR:"application/vnd.avaya.csa.error.v1+json",CSA_CONFIGURATION:"application/vnd.avaya.csa.configuration.v1+json",CSA_CALL:"application/vnd.avaya.csa.call.v1+json",CSA_CALLS:"application/vnd.avaya.csa.calls.v1+json",CSA_CLIENT:"application/vnd.avaya.csa.client.v1+json",CSA_CLIENTS:"application/vnd.avaya.csa.clients.v1+json",CSA_CALL_ACTION:"application/vnd.avaya.csa.callaction.v1+json",CSA_CALL_PREFERENCE:"application/vnd.avaya.csa.callpreferences.v1+json",CSA_PRESENCE_CONTAINER:"application/vnd.avaya.presence-im.container.v1+json",CSA_PRESENCE_PUBLICATION:"application/vnd.avaya.presence.presence-pub.v1+json",CSA_PRESENCE_RESOURCE_LIST:"application/vnd.avaya.csa.resourcelist.v1+json"};b.prototype={buildStartCallOptions:function(b){return{urlSuffix:"",url:b,sendType:a.Providers.CallServiceGateway.Constants.HTTP_POST,dataType:a.Providers.CallServiceGateway.Constants.JSON_DATA_TYPE,crossDomain:!0,authentication:{type:a.Providers.CallServiceGateway.Constants.BASIC_AUTHENTICATION,username:this._credentials.username,password:this._credentials.password},headers:{Accept:c.CSA_CALL,"Content-Type":c.CSA_CALL_PREFERENCE,Authorization:a.Providers.CallServiceGateway.Constants.BASIC_AUTHORIZATION_WITH_SPACE+this._getBasicCredentials()}}},buildActivateServiceOptions:function(b){return{urlSuffix:"",url:b,sendType:a.Providers.CallServiceGateway.Constants.HTTP_POST,crossDomain:!0,authentication:{type:a.Providers.CallServiceGateway.Constants.BASIC_AUTHENTICATION,username:this._credentials.username,password:this._credentials.password},headers:{Accept:c.CSA_SERVICES,"Content-Type":c.CSA_SERVICES,Authorization:a.Providers.CallServiceGateway.Constants.BASIC_AUTHORIZATION_WITH_SPACE+this._getBasicCredentials()}}},buildActivateServiceData:function(b,c,d,e){var f={action:a.Providers.CallServiceGateway.CallActionType.ACTIVATE,service:b,extendedData:{mode:a.Providers.CallServiceGateway.Constants.COMPUTER,mediaServiceType:a.Providers.CallServiceGateway.Constants.WEBRTC,recoveryToken:a.Base.Utils.isDefined(e)?e:null,register:!!c}};return d&&(f.videoBandwidth=d.getMinBandwidth()),f},buildDeactivateServiceOptions:function(b){return{urlSuffix:"",url:b,sendType:a.Providers.CallServiceGateway.Constants.HTTP_POST,crossDomain:!0,authentication:{type:a.Providers.CallServiceGateway.Constants.BASIC_AUTHENTICATION,username:this._credentials.username,password:this._credentials.password},headers:{Accept:c.CSA_SERVICES,"Content-Type":c.CSA_SERVICES,Authorization:a.Providers.CallServiceGateway.Constants.BASIC_AUTHORIZATION_WITH_SPACE+this._getBasicCredentials()}}},buildDeactivateServiceData:function(b){return{action:a.Providers.CallServiceGateway.CallActionType.DEACTIVATE,service:b,extendedData:{mode:a.Providers.CallServiceGateway.Constants.COMPUTER,mediaServiceType:a.Providers.CallServiceGateway.Constants.WEBRTC,recoveryToken:null,register:!1}}},buildResourceDiscoveryOptions:function(b){return{urlSuffix:a.Providers.CallServiceGateway.Constants.CSA_RESOURCE_PATH,sendType:a.Providers.CallServiceGateway.Constants.HTTP_GET,dataType:a.Providers.CallServiceGateway.Constants.JSON_DATA_TYPE,crossDomain:!0,authentication:{type:a.Providers.CallServiceGateway.Constants.BASIC_AUTHENTICATION,username:this._credentials.username,password:this._credentials.password},headers:{Accept:[c.CSA_RESOURCE,c.CSA_ERROR].join(", "),Authorization:a.Providers.CallServiceGateway.Constants.BASIC_AUTHORIZATION_WITH_SPACE+this._getBasicCredentials()}}},buildResourceDiscoveryData:function(a){var b={};return a&&(b.existingclientid=a),this._credentials.isGuest&&(b.name=this._credentials.displayName),b},buildUpdateCallOptions:function(b,d){return{urlSuffix:"",url:b+"/"+d,sendType:a.Providers.CallServiceGateway.Constants.HTTP_POST,dataType:a.Providers.CallServiceGateway.Constants.TEXT_DATA_TYPE,crossDomain:!0,authentication:{type:a.Providers.CallServiceGateway.Constants.BASIC_AUTHENTICATION,username:this._credentials.username,password:this._credentials.password},headers:{"Content-Type":c.CSA_CALL_ACTION,Authorization:a.Providers.CallServiceGateway.Constants.BASIC_AUTHORIZATION_WITH_SPACE+this._getBasicCredentials()}}},buildGetCallsOptions:function(b){return{urlSuffix:"",url:b,sendType:a.Providers.CallServiceGateway.Constants.HTTP_GET,dataType:a.Providers.CallServiceGateway.Constants.JSON_DATA_TYPE,crossDomain:!0,authentication:{type:a.Providers.CallServiceGateway.Constants.BASIC_AUTHENTICATION,username:this._credentials.username,password:this._credentials.password},headers:{Accept:[c.CSA_CALLS,c.CSA_ERROR].join(", "),Authorization:a.Providers.CallServiceGateway.Constants.BASIC_AUTHORIZATION_WITH_SPACE+this._getBasicCredentials()}}},buildGetCallOptions:function(b,d){return{urlSuffix:"",url:b+"/"+d,sendType:a.Providers.CallServiceGateway.Constants.HTTP_GET,dataType:a.Providers.CallServiceGateway.Constants.JSON_DATA_TYPE,crossDomain:!0,authentication:{type:a.Providers.CallServiceGateway.Constants.BASIC_AUTHENTICATION,username:this._credentials.username,password:this._credentials.password},headers:{Accept:[c.CSA_CALL,c.CSA_ERROR].join(", "),Authorization:a.Providers.CallServiceGateway.Constants.BASIC_AUTHORIZATION_WITH_SPACE+this._getBasicCredentials()}}},buildGetClientsOptions:function(b){return{urlSuffix:"",url:b,sendType:a.Providers.CallServiceGateway.Constants.HTTP_GET,dataType:a.Providers.CallServiceGateway.Constants.JSON_DATA_TYPE,crossDomain:!0,authentication:{type:a.Providers.CallServiceGateway.Constants.BASIC_AUTHENTICATION,username:this._credentials.username,password:this._credentials.password},headers:{Accept:[c.CSA_CLIENTS,c.CSA_ERROR].join(", "),Authorization:a.Providers.CallServiceGateway.Constants.BASIC_AUTHORIZATION_WITH_SPACE+this._getBasicCredentials()}}},buildGetClientOptions:function(b,d){return{urlSuffix:"",url:b+"/"+d,sendType:a.Providers.CallServiceGateway.Constants.HTTP_GET,dataType:a.Providers.CallServiceGateway.Constants.JSON_DATA_TYPE,crossDomain:!0,authentication:{type:a.Providers.CallServiceGateway.Constants.BASIC_AUTHENTICATION,username:this._credentials.username,password:this._credentials.password},headers:{Accept:[c.CSA_CLIENT,c.CSA_ERROR].join(", "),Authorization:a.Providers.CallServiceGateway.Constants.BASIC_AUTHORIZATION_WITH_SPACE+this._getBasicCredentials()}}},buildKeepAliveOptions:function(){return{crossDomain:!0,authentication:{type:a.Providers.CallServiceGateway.Constants.BASIC_AUTHENTICATION,username:this._credentials.username,password:this._credentials.password}}},buildDeleteSessionOptions:function(b){return{urlSuffix:"",url:b,sendType:a.Providers.CallServiceGateway.Constants.HTTP_DELETE,crossDomain:!0,authentication:{type:a.Providers.CallServiceGateway.Constants.BASIC_AUTHENTICATION,username:this._credentials.username,password:this._credentials.password},headers:{Authorization:a.Providers.CallServiceGateway.Constants.BASIC_AUTHORIZATION_WITH_SPACE+this._getBasicCredentials()}}},buildSubscribeRequest:function(b,c){return{subscribe:{requestId:this._generateRequestId(),resources:[{application:a.Providers.CallServiceGateway.Constants.CSA_APPLICATION,service:b,resource:c}],version:a.Providers.CallServiceGateway.Constants.CSA_VERSION_1}}},buildUnsubscribeRequest:function(b,c){return{unsubscribe:{requestId:this._generateRequestId(),resources:[{application:a.Providers.CallServiceGateway.Constants.CSA_APPLICATION,service:b,resource:c}],version:a.Providers.CallServiceGateway.Constants.CSA_VERSION_1}}},buildNotificationsOptions:function(){return{dataType:"JSON",headers:{"Content-Type":"application/json"}}},buildProcessMediaOfferResponseNotification:function(b,d,e,f,g,h,i){var j={action:e,actionDetails:{targetCallId:null,participants:null,sdpType:f.toUpperCase(),sdp:g,audioChannel:a.Base.Utils.isDefined(h)?h:null,videoChannels:a.Base.Utils.isDefined(i)?i:null,conferenceData:null}};return{notify:{requestId:this._generateRequestId(),notifications:[{application:a.Providers.CallServiceGateway.Constants.CSA_APPLICATION,service:a.Providers.CallServiceGateway.Constants.TELEPHONY_SERVICE,version:a.Providers.CallServiceGateway.Constants.CSA_VERSION_1,resource:b,contents:{callId:d,messageType:a.Providers.CallServiceGateway.Constants.PROCESS_MEDIA_RESPONSE,messageDataType:c.CSA_CALL_ACTION,messageData:JSON.stringify(j)}}]}}},buildProcessMediaAnswerResponseNotification:function(b,c,d,e){return{notify:{requestId:this._generateRequestId(),notifications:[{application:a.Providers.CallServiceGateway.Constants.CSA_APPLICATION,service:a.Providers.CallServiceGateway.Constants.TELEPHONY_SERVICE,version:a.Providers.CallServiceGateway.Constants.CSA_VERSION_1,resource:b,contents:{callId:c,messageType:a.Providers.CallServiceGateway.Constants.PROCESS_MEDIA_RESPONSE,messageDataType:null,messageData:null}}]}}},buildCreateMediaResponseNotification:function(b,d,e,f,g,h){var i={action:null,actionDetails:{targetCallId:null,participants:null,sdpType:e.toUpperCase(),sdp:f,audioChannel:a.Base.Utils.isDefined(g)?g:null,videoChannels:a.Base.Utils.isDefined(h)?h:null,conferenceData:null}};return{notify:{requestId:this._generateRequestId(),notifications:[{application:a.Providers.CallServiceGateway.Constants.CSA_APPLICATION,service:a.Providers.CallServiceGateway.Constants.TELEPHONY_SERVICE,version:a.Providers.CallServiceGateway.Constants.CSA_VERSION_1,resource:b,contents:{callId:d,messageType:a.Providers.CallServiceGateway.Constants.CREATE_MEDIA_RESPONSE,messageDataType:c.CSA_CALL_ACTION,messageData:JSON.stringify(i)}}]}}},buildUpdateMediaRequestNotification:function(b,d,e,f,g){var h={action:e,actionDetails:{targetCallId:null,participants:null,sdpType:null,sdp:null,audioChannel:a.Base.Utils.isDefined(f)?f:null,videoChannels:a.Base.Utils.isDefined(g)?g:null,conferenceData:null}};return{notify:{requestId:this._generateRequestId(),notifications:[{application:a.Providers.CallServiceGateway.Constants.CSA_APPLICATION,service:a.Providers.CallServiceGateway.Constants.TELEPHONY_SERVICE,version:a.Providers.CallServiceGateway.Constants.CSA_VERSION_1,resource:b,contents:{callId:d,messageType:a.Providers.CallServiceGateway.Constants.PROCESS_MEDIA_REQUEST,messageDataType:c.CSA_CALL_ACTION,messageData:JSON.stringify(h)}}]}}},buildGetConfigurationOptions:function(a){return{url:a,sendType:"GET",dataType:"JSON",headers:{Accept:[c.CSA_CONFIGURATION,c.CSA_ERROR].join(", ")}}},buildAcceptCallResponse:function(b,c,d){return{notify:{requestId:a.Base.Utils.isDefined(d)&&null!==d?d:this._generateRequestId(),notifications:[{application:a.Providers.CallServiceGateway.Constants.CSA_APPLICATION,service:a.Providers.CallServiceGateway.Constants.TELEPHONY_SERVICE,version:a.Providers.CallServiceGateway.Constants.CSA_VERSION_1,resource:b,contents:{callId:c,messageType:a.Providers.CallServiceGateway.Constants.ACCEPT_CALL_RESPONSE,messageDataType:null,messageData:null}}]}}},buildRejectCallResponse:function(b,c,d){return{notify:{requestId:a.Base.Utils.isDefined(d)&&null!==d?d:this._generateRequestId(),notifications:[{application:a.Providers.CallServiceGateway.Constants.CSA_APPLICATION,service:a.Providers.CallServiceGateway.Constants.TELEPHONY_SERVICE,version:a.Providers.CallServiceGateway.Constants.CSA_VERSION_1,resource:b,contents:{callId:c,messageType:a.Providers.CallServiceGateway.Constants.REJECT_CALL_RESPONSE,messageDataType:null,messageData:null}}]}}},buildCreatePubSubContainerOptions:function(b){return{url:b,sendType:a.Providers.CallServiceGateway.Constants.HTTP_POST,dataType:a.Providers.CallServiceGateway.Constants.TEXT_DATA_TYPE,headers:{Accept:[c.CSA_PRESENCE_CONTAINER,c.CSA_ERROR].join(", "),"Content-Type":c.CSA_PRESENCE_CONTAINER}}},buildDeletePubSubContainerOptions:function(b){return{url:b,sendType:a.Providers.CallServiceGateway.Constants.HTTP_DELETE,headers:{Accept:c.CSA_ERROR}}},buildCreateOrExtendPubSubContainerData:function(a,b,c){if(!a||b||c)return JSON.stringify({pubSubContainer:{additionalResources:{presencePublication:b?{}:void 0,presenceSubscriptions:c?[{}]:void 0}}})},buildPublishPresenceOptions:function(a){return{url:a,sendType:"PUT",headers:{Accept:[c.CSA_ERROR,c.CSA_PRESENCE_PUBLICATION].join(", "),"Content-Type":c.CSA_PRESENCE_PUBLICATION}}},buildDeleteManualPresenceOptions:function(a){return{url:a,sendType:"DELETE",headers:{Accept:c.CSA_ERROR}}},buildPublishManualPresenceData:function(b,c){var d={presencePublication:{}};return b===a.Providers.CallServiceGateway.Constants.MANUAL_STATE?d.presencePublication.manualState={stateEnum:a.Providers.CallServiceGateway.Utils.convertPresenceStateToCSGPresenceState(c)}:b===a.Providers.CallServiceGateway.Constants.MODE?d.presencePublication.mode={modeEnum:a.Providers.CallServiceGateway.Utils.convertPresenceModeToCSGPresenceMode(c)}:b===a.Providers.CallServiceGateway.Constants.NOTE&&(d.presencePublication.note={content:c}),JSON.stringify(d)},buildPublishAutoPresenceData:function(b){var c=[],d=b.getEnterpriseIMState(),e=b.getEnterpriseIMContact(),f=b.getVideoState(),g=b.getVideoContact(),h=b.getPhoneState(),i=b.getPhoneContact(),j=a.Services.Presence.PresenceState;return f&&f!==j.PRESENCE_STATE_UNSPECIFIED&&c.push({channel:"video",contact:g,stateEnum:a.Providers.CallServiceGateway.Utils.convertPresenceStateToCSGPresenceState(f),subType:a.Providers.CallServiceGateway.Constants.AVAYA_COMMUNICATOR}),d&&d!==j.PRESENCE_STATE_UNSPECIFIED&&c.push({channel:"im",contact:e,stateEnum:a.Providers.CallServiceGateway.Utils.convertPresenceStateToCSGPresenceState(d),subType:a.Providers.CallServiceGateway.Constants.AVAYA_COMMUNICATOR}),h&&h!==j.PRESENCE_STATE_UNSPECIFIED&&c.push({channel:"phone",contact:i,stateEnum:a.Providers.CallServiceGateway.Utils.convertPresenceStateToCSGPresenceState(h),subType:a.Providers.CallServiceGateway.Constants.AVAYA_COMMUNICATOR}),JSON.stringify({presencePublication:{channelPresence:c}})},buildPresenceSubscriptionData:function(a,b){var c=[];return b.forEach(function(a){c.push({userIdentity:{userId:a}})}),JSON.stringify({resourceList:{listDefaults:{action:a,aclConfirmHandling:"prompt",docType:"full"},presentities:c}})},buildPresenceSubscriptionOptions:function(a){return{url:a,sendType:"POST",dataType:"JSON",headers:{Accept:[c.CSA_ERROR,c.CSA_PRESENCE_RESOURCE_LIST].join(", "),"Content-Type":c.CSA_PRESENCE_RESOURCE_LIST}}},updateCredentials:function(a){this._credentials=a},_getBasicCredentials:function(){return btoa(decodeURI(this._credentials.username+":"+this._credentials.password))},_generateRequestId:function(){return"jscsdk.csg.req-"+this._requestCounter++},_isFirefoxBrowser:function(){var b=a.Base.Utils.getBrowserType();return b===a.Base.BrowserType.FIREFOX||b===a.Base.BrowserType.FIREFOX_EXTENSION}},a.Providers.CallServiceGateway.CallServiceGatewayProviderMessageBuilder=b}(AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";var b={CAS_NOTIFICATION:"CASNotification",PING:"Ping"};a.Providers.CallServiceGateway.CSGNotificationEventType=b}(AvayaClientServices),function(a){"use strict";var b={RINGBACK:"ringback",INTERCEPT:"intercept",REORDER:"reorder",FASTBUSY:"fastBusy"};a.Providers.CallServiceGateway.CSGToneType=b}(AvayaClientServices),function(a){"use strict";var b={ACCEPT_AUDIO:"ACCEPT_AUDIO",ACCEPT_VIDEO:"ACCEPT_VIDEO",ACTIVATE:"ACTIVATE",ADD_PARTICIPANT:"ADD_PARTICIPANT",ADD_VIDEO:"ADD_VIDEO",ANSWER:"ANSWER",DEACTIVATE:"DEACTIVATE",DENY_AUDIO:"DENY_AUDIO",DENY_VIDEO:"DENY_VIDEO",END:"END",HOLD:"HOLD",INCOMING_ADD_VIDEO:"INCOMING_ADD_VIDEO",JOIN:"JOIN",REMOVE_VIDEO:"REMOVE_VIDEO",REMOTE_VIDEO_REMOVED_ACK:"REMOTE_VIDEO_REMOVED_ACK",RINGING:"RINGING",TRANSFER:"TRANSFER",UNHOLD:"UNHOLD",UPDATE_VIDEO:"UPDATE_VIDEO"};a.Providers.CallServiceGateway.CallActionType=b}(AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";var b={TELEPHONY_SERVICE:"telephony",CSA_APPLICATION:"CSA",CREATE_MEDIA_RESPONSE:"createMediaResponse",PROCESS_MEDIA_REQUEST:"processMediaRequest",PROCESS_MEDIA_RESPONSE:"processMediaResponse",ACCEPT_CALL_RESPONSE:"acceptCallResponse",REJECT_CALL_RESPONSE:"rejectCallResponse",BASIC_AUTHENTICATION:"Basic",BASIC_AUTHORIZATION_WITH_SPACE:"Basic ",HTTP_POST:"POST",HTTP_GET:"GET",HTTP_DELETE:"DELETE",JSON_DATA_TYPE:"json",TEXT_DATA_TYPE:"text",CSA_RESOURCE_PATH:"/csa/resources/tenants/default",CSA_VERSION_1:"1",COMPUTER:"COMPUTER",CALLS:"CALLS",PRESENCE:"PRESENCE",WEBRTC:"WEBRTC",STANDARD:"STANDARD",SEND_ONLY:"SEND_ONLY",RECV_ONLY:"RECEIVE_ONLY",SEND_RECV:"SEND_RECEIVE",INACTIVE:"INACTIVE",ENABLE:"ENABLE",DISABLE:"DISABLE",SDP_TYPE_ANSWER:"answer",SDP_TYPE_OFFER:"offer",CALL_STATE_FAILURE_ERROR_CODE:4220072,CALL_DOES_NOT_EXISTS:4040009,SVC_PRESENCE:"presence",MANUAL_STATE:"manualState",STATE:"state",MODE:"mode",NOTE:"note",SUBSCRIPTION_ADD:"add",SUBSCRIPTION_REMOVE:"remove",STATUS_ACTIVE:"active",AVAYA_COMMUNICATOR:"AVAYA_COMMUNICATOR",RESOURCE_DISCOVERY_USERNAME_MISMATCH:"Mismatch username",MWI_ON:"ON",MWI_OFF:"OFF"};a.Providers.CallServiceGateway.Constants=b}(AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";var b={Users:"users",Clients:"clients",Calls:"calls",Services:"services",KeepAlive:"keepalive",SessionManagement:"sessionManagement",Websocket:"websocket",SSE:"sse",iViewToken:"iviewtoken",RestSessionMgmt:"RestSessionMgmt",ClientKeepAlive:"ClientKeepAlive",ClientTerminate:"ClientTerminate",Configuration:"configuration",PresenceSubscriptions:"presence-subscriptions",PresencePublications:"presence-publications",CreatePresenceContainer:"CreatePresenceContainer",PublishPresenceState:"PublishPresenceState",PublishPresenceMode:"PublishPresenceMode",PublishPresenceNote:"PublishPresenceNote",DeletePresenceState:"DeletePresenceState",DeletePresenceMode:"DeletePresenceMode",DeletePresenceNote:"DeletePresenceNote"};a.Providers.CallServiceGateway.ResourceType=b}(AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";var b=a.Providers.CallServiceGateway.Constants;a.Providers.CallServiceGateway.Utils={convertToAudioChannel:function(a){var c=null;return a&&(c={channelId:a.id},c.state=a.enabled?b.ENABLE:b.DISABLE,c.direction=this.convertToChannelDirection(a.direction)),c},convertToVideoChannels:function(a){var c=[];return a&&a.forEach(function(a){if(a){var d={channelId:a.id};d.state=a.enabled?b.ENABLE:b.DISABLE,d.direction=this.convertToChannelDirection(a.direction),c.push(d)}}.bind(this)),c},convertToChannelDirection:function(c){switch(c){case a.Services.Call.MediaDirection.SEND_ONLY:return b.SEND_ONLY;case a.Services.Call.MediaDirection.RECV_ONLY:return b.RECV_ONLY;case a.Services.Call.MediaDirection.SEND_RECV:return b.SEND_RECV;default:return b.INACTIVE}},convertToAudioStream:function(a){var c=null;return a&&(c={id:a.channelId},c.enabled=a.state===b.ENABLE,c.direction=this.convertToMediaDirection(a.direction)),c},convertToVideoStreams:function(a){var c=[];return a&&a.forEach(function(a){if(a){var d={id:a.channelId};d.enabled=a.state===b.ENABLE,d.direction=this.convertToMediaDirection(a.direction),d.maxHeight=a.maxHeight,d.maxWidth=a.maxWidth,c.push(d)}}.bind(this)),c},convertToMediaDirection:function(c){switch(c){case b.SEND_ONLY:return a.Services.Call.MediaDirection.SEND_ONLY;case b.RECV_ONLY:return a.Services.Call.MediaDirection.RECV_ONLY;case b.SEND_RECV:return a.Services.Call.MediaDirection.SEND_RECV;default:return a.Services.Call.MediaDirection.INACTIVE}},convertAlertType:function(b){switch(b){case"ALERT_TYPE_UNSPECIFIED":return a.Services.Call.AlertType.UNSPECIFIED;case"ALERT_TYPE_NONE":return a.Services.Call.AlertType.NONE;case"ALERT_TYPE_INTERNAL":return a.Services.Call.AlertType.INTERNAL;case"ALERT_TYPE_EXTERNAL":return a.Services.Call.AlertType.EXTERNAL;case"ALERT_TYPE_PRIORITY":return a.Services.Call.AlertType.PRIORITY;case"ALERT_TYPE_INTERCOM":return a.Services.Call.AlertType.INTERCOM;case"ALERT_TYPE_AUTO_CALLBACK":return a.Services.Call.AlertType.AUTO_CALLBACK;case"ALERT_TYPE_HOLD_RECALL":return a.Services.Call.AlertType.HOLD_RECALL;case"ALERT_TYPE_DIRECT_AGENT_CALL_INTERNAL":return a.Services.Call.AlertType.DIRECT_AGENT_CALL_INTERNAL;case"ALERT_TYPE_DIRECT_AGENT_CALL_EXTERNAL":return a.Services.Call.AlertType.DIRECT_AGENT_CALL_EXTERNAL;case"ALERT_TYPE_DIRECT_AGENT_CALL_PRIORITY":return a.Services.Call.AlertType.DIRECT_AGENT_CALL_PRIORITY;case"ALERT_TYPE_AUTOMATIC_CALL_DISTRIBUTION_INTERNAL":return a.Services.Call.AlertType.AUTOMATIC_CALL_DISTRIBUTION_INTERNAL;case"ALERT_TYPE_AUTOMATIC_CALL_DISTRIBUTION_EXTERNAL":return a.Services.Call.AlertType.AUTOMATIC_CALL_DISTRIBUTION_EXTERNAL;default:return a.Base.Logger.info(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Unhandled alert type: "+b),a.Services.Call.AlertType.UNSPECIFIED}},convertErrorCode:function(b){switch(b){case 4010001:return a.Services.Call.CallError.NOT_AUTHORIZED;case 4010003:return a.Services.Call.CallError.UNAUTHORIZED;case 4040009:return a.Services.Call.CallError.NOT_FOUND;case 4220072:return a.Services.Call.CallError.CALL_STATE_MISMATCH;case 4220078:return a.Services.Call.CallError.MEDIA_PRESERVED;case 5000010:return a.Services.Call.CallError.USER_NOT_FOUND;case 5000022:return a.Services.Call.CallError.BUSY;default:return a.Services.Call.CallError.INTERNAL_ERROR}},convertPresenceStateToCSGPresenceState:function(b){switch(b){case a.Services.Presence.PresenceState.PRESENCE_STATE_AVAILABLE:return a.Providers.CallServiceGateway.CSGPresenceState.AVAILABLE;case a.Services.Presence.PresenceState.PRESENCE_STATE_AWAY:return a.Providers.CallServiceGateway.CSGPresenceState.AWAY;case a.Services.Presence.PresenceState.PRESENCE_STATE_BUSY:return a.Providers.CallServiceGateway.CSGPresenceState.BUSY;case a.Services.Presence.PresenceState.PRESENCE_STATE_DO_NOT_DISTURB:return a.Providers.CallServiceGateway.CSGPresenceState.DO_NOT_DISTURB;case a.Services.Presence.PresenceState.PRESENCE_STATE_OFFLINE:return a.Providers.CallServiceGateway.CSGPresenceState.OFFLINE;case a.Services.Presence.PresenceState.PRESENCE_STATE_ON_A_CALL:return a.Providers.CallServiceGateway.CSGPresenceState.ON_A_CALL;case a.Services.Presence.PresenceState.PRESENCE_STATE_OUT_OF_OFFICE:return a.Providers.CallServiceGateway.CSGPresenceState.OUT_OF_OFFICE;default:return}},convertCSGPresenceStateToPresenceState:function(b){switch(b){case a.Providers.CallServiceGateway.CSGPresenceState.AVAILABLE:return a.Services.Presence.PresenceState.PRESENCE_STATE_AVAILABLE;case a.Providers.CallServiceGateway.CSGPresenceState.AWAY:return a.Services.Presence.PresenceState.PRESENCE_STATE_AWAY;case a.Providers.CallServiceGateway.CSGPresenceState.BUSY:return a.Services.Presence.PresenceState.PRESENCE_STATE_BUSY;case a.Providers.CallServiceGateway.CSGPresenceState.DO_NOT_DISTURB:return a.Services.Presence.PresenceState.PRESENCE_STATE_DO_NOT_DISTURB;case a.Providers.CallServiceGateway.CSGPresenceState.OFFLINE:return a.Services.Presence.PresenceState.PRESENCE_STATE_OFFLINE;case a.Providers.CallServiceGateway.CSGPresenceState.ON_A_CALL:return a.Services.Presence.PresenceState.PRESENCE_STATE_ON_A_CALL;case a.Providers.CallServiceGateway.CSGPresenceState.OUT_OF_OFFICE:return a.Services.Presence.PresenceState.PRESENCE_STATE_OUT_OF_OFFICE;default:return a.Services.Presence.PresenceState.PRESENCE_STATE_UNSPECIFIED}},convertPresenceModeToCSGPresenceMode:function(b){switch(b){case a.Services.Presence.PresenceLocationMode.PRESENCE_LOCATION_MODE_HOME:return a.Providers.CallServiceGateway.CSGPresenceMode.HOME;case a.Services.Presence.PresenceLocationMode.PRESENCE_LOCATION_MODE_MOBILE:return a.Providers.CallServiceGateway.CSGPresenceMode.MOBILE;case a.Services.Presence.PresenceLocationMode.PRESENCE_LOCATION_MODE_OFFICE:return a.Providers.CallServiceGateway.CSGPresenceMode.OFFICE;case a.Services.Presence.PresenceLocationMode.PRESENCE_LOCATION_MODE_TRAVELING:return a.Providers.CallServiceGateway.CSGPresenceMode.TRAVELING;default:return}},convertCSGPresenceModeToPresenceMode:function(b){switch(b){case a.Providers.CallServiceGateway.CSGPresenceMode.HOME:return a.Services.Presence.PresenceLocationMode.PRESENCE_LOCATION_MODE_HOME;case a.Providers.CallServiceGateway.CSGPresenceMode.MOBILE:return a.Services.Presence.PresenceLocationMode.PRESENCE_LOCATION_MODE_MOBILE;case a.Providers.CallServiceGateway.CSGPresenceMode.OFFICE:return a.Services.Presence.PresenceLocationMode.PRESENCE_LOCATION_MODE_OFFICE;case a.Providers.CallServiceGateway.CSGPresenceMode.TRAVELING:return a.Services.Presence.PresenceLocationMode.PRESENCE_LOCATION_MODE_TRAVELING;default:return a.Services.Presence.PresenceLocationMode.PRESENCE_LOCATION_MODE_UNSPECIFIED}}}}(AvayaClientServices),function(a){"use strict";function b(){this.type=a.Providers.CallServiceGateway.CallMessageTypes.UNDEFINED}a.Providers.CallServiceGateway.AbstractCallMessage=b}(AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";var b={UNDEFINED:"Undefined",SUBSCRIPTION:"Subscription",USER_CLIENTS:"UserClients",PROCESS_MEDIA_REQUEST:"ProcessMediaRequest"};a.Providers.CallServiceGateway.CallMessageTypes=b}(AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(){this.vmnumber=void 0}b.prototype={},a.Providers.CallServiceGateway.ConfigurationMessage=b}(AvayaClientServices),function(a){"use strict";function b(){this.expires=void 0,this.containerResources={container:{get:{method:void 0,href:void 0},updateOrExtend:{method:void 0,href:void 0},delete:{method:void 0,href:void 0}}},this.additionalResources={presencePublication:{replace:{method:void 0,href:void 0}},presenceSubscriptions:[{update:{method:void 0,href:void 0},replace:{method:void 0,href:void 0}}]}}b.prototype={},a.Providers.CallServiceGateway.CSGPresenceContainer=b}(AvayaClientServices),function(a){"use strict";function b(){this.presenceDoc={userIdentity:{userId:void 0}},this.presenceSummary={stateEnum:void 0},this.manualState={stateEnum:void 0},this.mode={modeEnum:void 0},this.note={content:void 0},this.channelPresence=[]}b.prototype={},a.Providers.CallServiceGateway.CSGPresenceDocument=b}(AvayaClientServices),function(a){"use strict";var b={AVAILABLE:"AVAILABLE",BUSY:"BUSY",DO_NOT_DISTURB:"DO_NOT_DISTURB",ON_A_CALL:"ON_A_CALL",AWAY:"AWAY",OUT_OF_OFFICE:"OUT_OF_OFFICE",OFFLINE:"OFFLINE"};a.Providers.CallServiceGateway.CSGPresenceState=b;var c={OFFICE:"OFFICE",HOME:"HOME",MOBILE:"MOBILE",TRAVELING:"TRAVELING"};a.Providers.CallServiceGateway.CSGPresenceMode=c}(AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(){this.applications=[],this.capabilities=[],this.commandURL=void 0,this.sessionManagement={href:void 0,timeout:void 0}}b.prototype={},a.Providers.CallServiceGateway.NotificationResources=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.CallServiceGateway.AbstractCallMessage.call(this),this.type=a.Providers.CallServiceGateway.CallMessageTypes.PROCESS_MEDIA_REQUEST,this.callId=b,this.sdp=c}b.prototype=Object.create(a.Providers.CallServiceGateway.AbstractCallMessage.prototype),a.Providers.CallServiceGateway.ProcessMediaRequestMessage=b}(AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){a.Providers.CallServiceGateway.AbstractCallMessage.call(this),this.type=a.Providers.CallServiceGateway.CallMessageTypes.CALLINFO,this.registrationId=b,this.href=void 0,this.mode="Computer"}b.prototype=Object.create(a.Providers.CallServiceGateway.AbstractCallMessage.prototype),a.Providers.CallServiceGateway.RegistrationInfoMessage=b}(AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(){this.resources={avayaRequestTimeout:{maximum:void 0,minimum:void 0,recommended:void 0},capabilities:[],clientId:void 0,notificationService:{websocket:{href:void 0},sse:{href:void 0}},resources:[],sessionManagement:{href:void 0,timeout:void 0,username:void 0},clientManagement:{timeout:void 0}}}b.prototype={},a.Providers.CallServiceGateway.RestResources=b}(AvayaClientServices),function(a){"use strict";function b(b){a.Providers.CallServiceGateway.AbstractCallMessage.call(this),this.type=a.Providers.CallServiceGateway.CallMessageTypes.SUBSCRIPTION,this.isSubscribed=!1,this.subscriptionId=b,this.application=void 0,this.service=void 0,this.resource=void 0}b.prototype=Object.create(a.Providers.CallServiceGateway.AbstractCallMessage.prototype),a.Providers.CallServiceGateway.SubscriptionCallMessage=b}(AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(a){this.clientId=a,this.version=void 0,this.endpointLabel=void 0,this.productName=void 0}a.Providers.CallServiceGateway.UserClient=b}(AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(){a.Providers.CallServiceGateway.AbstractCallMessage.call(this),this.type=a.Providers.CallServiceGateway.CallMessageTypes.USER_CLIENTS,this._clients=[]}b.prototype=Object.create(a.Providers.CallServiceGateway.AbstractCallMessage.prototype),b.prototype.add=function(a){this._clients.push(a)},b.prototype.getClients=function(){return _clients},a.Providers.CallServiceGateway.UserClientsMessage=b}(AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";var b={ANSWER_CALL_REQUEST:"csgwprovider.answerCallRequest",CREATE_MEDIA_REQUEST:"csgwprovider.createMediaRequest",CALL_ENDED:"csgwprovider.call.ended",CALL_ESTABLISHED:"csgwprovider.call.established",CALL_FAILURE:"csgwprovider.call.failure",CALL_HELD:"csgwprovider.call.held",CALL_INCOMING:"csgwprovider.call.incoming",CALL_RINGING:"csgwprovider.call.ringing",CALL_STATE_FAILURE:"csgwprovider.call.stateFailure",CALL_UNHELD:"csgwprovider.call.unheld",ICE_CONFIG_UPDATES:"csgwprovider.ice.config.updates",IVIEW_TOKEN_UPDATE:"csgwprovider.iviewTokenUpdate",
MAKE_CALL_REQUEST:"csgwprovider.makeCallRequeset",NETWORK_PROVIDER_IS_AVAILABLE:"csgwprovider.network.available",NETWORK_PROVIDER_IS_UNAVAILABLE:"csgwprovider.network.unavailable",PROCESS_ANSWER_REQUEST:"csgwprovider.processAnswerRequest",RINGBACK_TONE_URLS_CHANGED:"csgwprovider.ringbackToneUrlsChanged",TERMINATE_CALL_REQUEST:"csgwprovider.terminateCallRequest",UPDATE_TRANSFER_STATUS:"csgwprovider.update.transferStatus",UPDATE_CALL_DATA:"csgwprovider.update.callData",UPDATE_CALL_REQUEST:"csgwprovider.update.callRequest",UPDATE_CONSULT_CONFERENCE_STATUS:"csgwprovider.update.consultConferenceStatus",VIDEO_LICENSE_UPDATED:"csgwprovider.videoLicenceUpdated"};a.Providers.CallServiceGateway.ObservableEvents=b}(AvayaClientServices=window.AvayaClientServices||{}),function(a,b){"use strict";function c(){}c.prototype={parse:function(b){var c=new a.Providers.Interfaces.Call;return c.callId=b.callId,c}},a.Providers.CallServiceGateway.CallInfoParser=c}(AvayaClientServices,jQuery),function(a){"use strict";function b(a){this._callInfoParser=a}b.prototype={parse:function(a){for(var b=[],c=0;c<a.calls.length;c++)b.push(this._callInfoParser.parse(a.calls[c]));return b}},a.Providers.CallServiceGateway.ClientCallsParser=b}(AvayaClientServices),function(a,b){"use strict";function c(){}c.prototype={parse:function(c){return b.extend(new a.Providers.CallServiceGateway.ConfigurationMessage,c)}},a.Providers.CallServiceGateway.ConfigurationParser=c}(AvayaClientServices,jQuery),function(a){"use strict";function b(a){this._provider=a}b.prototype={parse:function(b){var c,d,e,f=a.Base.Utils.isDefined(b.messageData)?JSON.parse(b.messageData):void 0;switch(b.messageType){case a.Providers.CallServiceGateway.NotificationType.CallFailure:var g=a.Base.Utils.queryJSONObject(f,"error[0].errorCode"),h=a.Providers.CallServiceGateway.Utils.convertErrorCode(g),i=a.Base.Utils.queryJSONObject(f,"error[0].displayMsg");g===a.Providers.CallServiceGateway.Constants.CALL_STATE_FAILURE_ERROR_CODE?this._provider.trigger(a.Providers.CallServiceGateway.ObservableEvents.CALL_STATE_FAILURE,[b.callId,h,a.Services.Call.CallProtocolType.APPLICATION,g,i]):this._provider.trigger(a.Providers.CallServiceGateway.ObservableEvents.CALL_FAILURE,[b.callId,h,a.Services.Call.CallProtocolType.APPLICATION,g,i]);break;case a.Providers.CallServiceGateway.NotificationType.IncomingCall:c=a.Base.Utils.queryJSONObject(f,"actionDetails.userToUserData.UCID"),d=a.Base.Utils.queryJSONObject(f,"actionDetails.userToUserData.parentUCID"),e=a.Base.Utils.queryJSONObject(f,"actionDetails.userToUserData.contextId"),a.Base.Utils.isDefined(c)||this._provider.startRinging(b.callId),this._provider.trigger(a.Providers.CallServiceGateway.ObservableEvents.CALL_INCOMING,[b.callId,f.actionDetails.participants[0].remoteAddress,f.actionDetails.participants[0].remoteDisplayName,f.actionDetails.avayaAsserted,f.actionDetails.private,a.Providers.CallServiceGateway.Utils.convertAlertType(f.actionDetails.alertType),f.actionDetails.sdpType,f.actionDetails.sdp,a.Providers.CallServiceGateway.Utils.convertToAudioStream(f.actionDetails.audioChannel),a.Providers.CallServiceGateway.Utils.convertToVideoStreams(f.actionDetails.videoChannels),f.actionDetails.subject,f.actionDetails.videoBandwidth,c,d,e]);break;case a.Providers.CallServiceGateway.NotificationType.CallRinging:var j=!1,k=a.Base.Utils.queryJSONObject(b,"alertingTypeEarlyMedia");a.Base.Utils.isDefined(k)&&("boolean"==typeof k?j=k:"string"==typeof k&&(j="true"===k.toLowerCase())),this._provider.trigger(a.Providers.CallServiceGateway.ObservableEvents.CALL_RINGING,[b.callId,f.actionDetails.participants[0].remoteAddress,f.actionDetails.participants[0].remoteDisplayName,f.actionDetails.avayaAsserted,f.actionDetails.private,a.Providers.CallServiceGateway.Utils.convertAlertType(f.actionDetails.alertType),j,a.Providers.CallServiceGateway.Utils.convertToAudioStream(f.actionDetails.audioChannel),a.Providers.CallServiceGateway.Utils.convertToVideoStreams(f.actionDetails.videoChannels)]);break;case a.Providers.CallServiceGateway.NotificationType.CallEstablished:var l,m,n=a.Base.Utils.queryJSONObject(f,"actionDetails.conferenceData.conference");n&&(l=f.actionDetails.conferenceData.uccpUrl,m=f.actionDetails.conferenceData.webCollaborationUrl),c=a.Base.Utils.queryJSONObject(f,"actionDetails.userToUserData.UCID"),d=a.Base.Utils.queryJSONObject(f,"actionDetails.userToUserData.parentUCID"),e=a.Base.Utils.queryJSONObject(f,"actionDetails.userToUserData.contextId");var o=[b.callId,f.actionDetails.participants[0].remoteAddress,f.actionDetails.participants[0].remoteDisplayName,f.actionDetails.subject,f.actionDetails.remote,f.actionDetails.private,f.actionDetails.alertType,f.actionDetails.avayaAsserted,a.Providers.CallServiceGateway.Utils.convertToAudioStream(f.actionDetails.audioChannel),a.Providers.CallServiceGateway.Utils.convertToVideoStreams(f.actionDetails.videoChannels),n,l,m,f.actionDetails.videoBandwidth,c,d,e];this._provider.trigger(a.Providers.CallServiceGateway.ObservableEvents.CALL_ESTABLISHED,o);break;case a.Providers.CallServiceGateway.NotificationType.CallHeld:this._provider.trigger(a.Providers.CallServiceGateway.ObservableEvents.CALL_HELD,[b.callId]);break;case a.Providers.CallServiceGateway.NotificationType.CallUnheld:this._provider.trigger(a.Providers.CallServiceGateway.ObservableEvents.CALL_UNHELD,[b.callId]);break;case a.Providers.CallServiceGateway.NotificationType.CallEnded:var p=!1;if(b.endCallReason)try{var q=JSON.parse(b.endCallReason);if(q){var r=new a.Providers.Call.CallReason(q.reasonProtocol,q.reasonCode,q.reasonText);this._provider.trigger(a.Providers.CallServiceGateway.ObservableEvents.CALL_ENDED,[b.callId,r]),p=!0}}catch(y){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to parse end call reason: "+b.endCallReason)}p||this._provider.trigger(a.Providers.CallServiceGateway.ObservableEvents.CALL_ENDED,[b.callId]);break;case a.Providers.CallServiceGateway.NotificationType.CreateMediaRequest:this._provider.trigger(a.Providers.CallServiceGateway.ObservableEvents.CREATE_MEDIA_REQUEST,[b.callId,a.Providers.CallServiceGateway.Utils.convertToVideoStreams(f.actionDetails.videoChannels),f.actionDetails.videoBandwidth]);break;case a.Providers.CallServiceGateway.NotificationType.ProcessMediaRequest:this.processMediaRequestHandler(b.callId,f.action,f.actionDetails.sdpType,f.actionDetails.sdp,a.Providers.CallServiceGateway.Utils.convertToAudioStream(f.actionDetails.audioChannel),a.Providers.CallServiceGateway.Utils.convertToVideoStreams(f.actionDetails.videoChannels),f.actionDetails.videoBandwidth);break;case a.Providers.CallServiceGateway.NotificationType.ProcessMediaResponse:this.processMediaResponseHandler(b.callId,f.action,f.actionDetails.sdpType,f.actionDetails.sdp,a.Providers.CallServiceGateway.Utils.convertToAudioStream(f.actionDetails.audioChannel),a.Providers.CallServiceGateway.Utils.convertToVideoStreams(f.actionDetails.videoChannels));break;case a.Providers.CallServiceGateway.NotificationType.UpdateTransferStatus:this._provider.trigger(a.Providers.CallServiceGateway.ObservableEvents.UPDATE_TRANSFER_STATUS,[b.callId,b.transferStatus]);break;case a.Providers.CallServiceGateway.NotificationType.UpdateCallData:var s,t,u=f.actionDetails.participants[0],v=a.Base.Utils.queryJSONObject(f,"actionDetails.conferenceData.conference"),w=!1;a.Base.Utils.isDefined(v)&&("boolean"==typeof v?w=v:"string"==typeof v&&(w="true"===v.toLowerCase()),s=f.actionDetails.conferenceData.uccpUrl,t=f.actionDetails.conferenceData.webCollaborationUrl),this._provider.trigger(a.Providers.CallServiceGateway.ObservableEvents.UPDATE_CALL_DATA,[b.callId,u.remoteAddress,u.remoteDisplayName,w,s,t]);break;case a.Providers.CallServiceGateway.NotificationType.MWIStatusChanged:var x=b.status;x===a.Providers.CallServiceGateway.Constants.MWI_OFF||x===a.Providers.CallServiceGateway.Constants.MWI_ON?this._provider.trigger(a.Providers.Interfaces.VoiceMessagingProviderCallbackIds.MWI_STATUS_CHANGED,[x===a.Providers.CallServiceGateway.Constants.MWI_ON]):a.Base.Logger.warn(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Received MWIStatusChanged notification in invalid format");break;case a.Providers.CallServiceGateway.NotificationType.EndpointConfigurationUpdate:this._provider.trigger(a.Providers.Interfaces.VoiceMessagingProviderCallbackIds.VOICEMAIL_NUMBER_CHANGED,[b.voiceMailNumber]),b.IPVideoEnable&&this._provider.trigger(a.Providers.CallServiceGateway.ObservableEvents.VIDEO_LICENSE_UPDATED,["true"===b.IPVideoEnable]);break;case a.Providers.CallServiceGateway.NotificationType.AddParticipantStatus:this._provider.trigger(a.Providers.CallServiceGateway.ObservableEvents.UPDATE_CONSULT_CONFERENCE_STATUS,[b.callId,b.status]);break;case a.Providers.CallServiceGateway.NotificationType.AnswerCallRequest:this._provider.trigger(a.Providers.CallServiceGateway.ObservableEvents.ANSWER_CALL_REQUEST,[b.callId,b.requestId]);break;case a.Providers.CallServiceGateway.NotificationType.TerminateCallRequest:this._provider.trigger(a.Providers.CallServiceGateway.ObservableEvents.TERMINATE_CALL_REQUEST,[b.callId,b.requestId]);break;case a.Providers.CallServiceGateway.NotificationType.UpdateCallRequest:this._provider.trigger(a.Providers.CallServiceGateway.ObservableEvents.UPDATE_CALL_REQUEST,[b.callId,b.requestId,b.callactiontype]);break;case a.Providers.CallServiceGateway.NotificationType.MakeCallRequest:c=a.Base.Utils.queryJSONObject(f,"actionDetails.userToUserData.UCID"),d=a.Base.Utils.queryJSONObject(f,"actionDetails.userToUserData.parentUCID"),e=a.Base.Utils.queryJSONObject(f,"actionDetails.userToUserData.contextId"),this._provider.trigger(a.Providers.CallServiceGateway.ObservableEvents.MAKE_CALL_REQUEST,[b.callId,b.dialToAddress,b.requestId,c,d,e]);break;default:a.Base.Logger.info(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Ignoring telephony notification: [Id:"+b.callId+",Type:"+b.messageType+"]")}},processMediaRequestHandler:function(b,c,d,e,f,g,h){a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Received Process Media Request: ["+c+","+d+"]"),d&&d.toLowerCase()===a.Providers.CallServiceGateway.Constants.SDP_TYPE_ANSWER?this._provider.getCallProvider().answerSDP(b,c,e,f,g):e?this._provider.getCallProvider().offerSDP(b,c,e,f,g,h):this._provider.getCallProvider().getOfferSDP(b,c,f,g)},processMediaResponseHandler:function(b,c,d,e,f,g){a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Received Process Media Response: "+d),a.Base.Utils.isDefined(e)&&null!==e?d&&d.toLowerCase()===a.Providers.CallServiceGateway.Constants.SDP_TYPE_ANSWER?this._provider.getCallProvider().answerSDP(b,c,e,f,g):a.Base.Logger.info(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Unhandled SDP from process media response for ["+c+","+d+"]"):this._provider.getCallProvider().answerSdpAck(b,c,f,g)}},a.Providers.CallServiceGateway.NotificationParser=b}(AvayaClientServices),function(a){"use strict";var b={CreateMediaRequest:"createMediaRequest",ProcessMediaRequest:"processMediaRequest",ProcessMediaResponse:"processMediaResponse",IncomingCall:"callIncoming",CallRinging:"callRinging",CallEstablished:"callEstablished",CallEnded:"callEnded",CallFailure:"callFailure",CallHeld:"onCallRemoteHeld",CallUnheld:"onCallRemoteUnheld",UpdateTransferStatus:"updateTransferStatus",UpdateCallData:"updateCallData",MWIStatusChanged:"MWIStatusChanged",EndpointConfigurationUpdate:"EndpointConfigurationUpdate",AddParticipantStatus:"addParticipantStatus",AnswerCallRequest:"answerCallRequest",AnswerCallResponse:"answerCallResponse",TerminateCallRequest:"terminateCallRequest",UpdateCallRequest:"updateCallRequest",MakeCallRequest:"makeCallRequest"};a.Providers.CallServiceGateway.NotificationType=b}(AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(){}b.prototype={parse:function(b){for(var c=new a.Providers.CallServiceGateway.UserClientsMessage,d=0;d<b.clients.length;d++){var e=this.parseClient(b.clients[d]);c.add(e)}return c},parseClient:function(b){var c=new a.Providers.CallServiceGateway.UserClient(b.clientId);return c.version=b.version,c.endpointLabel=b.endpointLabel,c.productName=b.productName,c}},a.Providers.CallServiceGateway.UserClientsParser=b}(AvayaClientServices),function(a){"use strict";function b(a){this._serverManager=a,this._queue=[],this._intervals=[],this._run=!1,this._minimalInterval=100,this._lastIntervalsToConsiderCount=10,this._maxBytesPerSecond=38400,this._bytesSentLastSecond=0,this._queueSize=0,this._sendTimeout=void 0}a.Providers.ContentSharing.BandwidthManager=b,a.Providers.ContentSharing.BandwidthManager.prototype={start:function(a){this._interval=a.captureInterval,this._maxBytesPerSecond=a.maxBytesPerSecond;for(var b=0;b<this._lastIntervalsToConsiderCount;b++)this._intervals.push(a.captureInterval);this._serverManager.onBandwidthAvailable=function(){this._process()}.bind(this),this._serverManager.start(a)},stop:function(){var a=$.Deferred();return this._queue=[],this._queueSize=0,this._serverManager.stop(),clearTimeout(this._sendTimeout),a.resolve(),a.promise()},addToQueue:function(a){if(a._keyFrame){this._lostSize=0,this._queue.forEach(function(a){this._lostSize+=a.byteLength}.bind(this));var b=(this._bytesSentLastSecond+this._lostSize)/this._maxBytesPerSecond;this._intervals.push(Math.floor(this._interval*b)),this._determineInterval(),this._queue=[],this._queue.push(a)}else this._queue.push(a);this._queueSize=this._queue.reduce(function(a,b){return a+b.byteLength},0),this._run||(this._run=!0,this._process())},getQueueDelay:function(){return this._queueSize/this._maxBytesPerSecond},onIntervalChanged:function(a){},_determineInterval:function(){for(var a=0,b=this._intervals.length-this._lastIntervalsToConsiderCount;b<this._intervals.length;b++)a+=this._intervals[b];var c=a/this._lastIntervalsToConsiderCount;c<this._minimalInterval&&(c=this._minimalInterval),this._interval=Math.floor(c),this.onIntervalChanged(this._interval)},_process:function(){a.Base.Logger.debug(a.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Current screen sharing queue size: "+this._queueSize+" bytes.");var b=this._queue.shift();if(!b)return void(this._run=!1);this._serverManager.canSend(b.byteLength)?(a.Base.Logger.debug(a.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Sending "+b.byteLength+" bytes from screen sharing queue."),this._send(b),this._process()):this._queue.unshift(b)},_send:function(a){this._serverManager.send(a),this._bytesSentLastSecond+=a.getByteLength(),this._sendTimeout=setTimeout(function(){this._bytesSentLastSecond-=a.getByteLength()}.bind(this),1e3)}}}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={createStartTag:function(b,c,d){var e=new a.Providers.WCS.ScreenSharingStartTag;return e.isKeyFrame=b,e.width=c,e.height=d,e.creationTime=Date.now(),e},createBlockTag:function(b){var c=new a.Providers.WCS.ScreenSharingBlockTag;c.x=b._x,c.y=b._y,c.width=b._width,c.height=b._height,c.imageType=b._type||a.Providers.WCS.ScreenSharingImageTypes.JPEG;var d=this._getImageData(b,b._type);return c.length=d.length,c.data=d,c},createEndTag:function(){return new a.Providers.WCS.ScreenSharingEndTag},_getImageData:function(b,c){var d=document.createElement("canvas");d.width=b._width,d.height=b._height,d.getContext("2d").putImageData(b._imgData,0,0);var e=c===a.Providers.WCS.ScreenSharingImageTypes.JPEG?"jpeg":"png",f=d.toDataURL("image/"+e,.3);return this._getImageBuffer(f)},_getImageBuffer:function(a){for(var b=a.split(","),c=atob(b[1]),d=c.length,e=new Uint8Array(d);d--;)e[d]=c.charCodeAt(d);return e}},a.Providers.ContentSharing.ContentSharingTagBuilder=b}(AvayaClientServices),function(a,b,c){"use strict";function d(b){this._pingTimer=void 0,this._pingTime=0,this._pongTime=0,this._pingInterval=500,this._requestBuilder=b,this._installedExtensionType=a.Providers.ContentSharing.InstalledExtensionType.INVALID,this._onMediaAvailableCallbacks=c.Callbacks(),this._onCapabilityChangeCallbacks=c.Callbacks(),this._onMediaCancelledCallbacks=c.Callbacks(),this._listenerFunction=void 0}var e={SCREEN_SHARING:"SCREEN_SHARING",PONG:"PONG",START:"START",CHROME:"Chrome",FIREFOX:"Firefox",MESSAGE:"message",CANCELED:"CANCELED"},f=2e3;a.Providers.ContentSharing.ExtensionNetworkProvider=d,a.Providers.ContentSharing.ExtensionNetworkProvider.prototype={start:function(){this._startWindowEventListener(),this._startPingTask()},send:function(a){b.postMessage(a,"*")},stop:function(){this._stopPingTimer(),this._removeWindowEventListener()},addOnMediaAvailableCallback:function(a){this._onMediaAvailableCallbacks.add(a)},removeOnMediaAvailableCallback:function(a){this._onMediaAvailableCallbacks.remove(a)},addOnMediaCancelledCallback:function(a){this._onMediaCancelledCallbacks.add(a)},removeOnMediaCancelledCallback:function(a){this._onMediaCancelledCallbacks.remove(a)},addOnCapabilityChange:function(a){this._onCapabilityChangeCallbacks.add(a)},removeOnCapabilityChange:function(a){this._onCapabilityChangeCallbacks.remove(a)},getInstalledExtensionType:function(){return this._installedExtensionType},_stopPingTimer:function(){this._pingTimer&&b.clearTimeout(this._pingTimer)},_startWindowEventListener:function(){this._listenerFunction=function(c){if(c.source===b&&c.data.type)if(c.data.type===e.START)this._onMediaAvailableCallbacks.fire(c);else if(c.data.type===e.CANCELED)this._onMediaCancelledCallbacks.fire(c);else if(c.data.type===e.PONG&&c.data.app===e.SCREEN_SHARING){this._pongTime=Date.now();var d=this._installedExtensionType;c.data.extension===e.CHROME?this._installedExtensionType=a.Providers.ContentSharing.InstalledExtensionType.CHROME:c.data.extension===e.FIREFOX&&(this._installedExtensionType=a.Providers.ContentSharing.InstalledExtensionType.FIREFOX),d!==a.Providers.ContentSharing.InstalledExtensionType.CHROME&&d!==a.Providers.ContentSharing.InstalledExtensionType.FIREFOX&&(this._onCapabilityChangeCallbacks.fire(this._installedExtensionType,!0),this._pingInterval=f)}}.bind(this),b.addEventListener(e.MESSAGE,this._listenerFunction,!1),this._pingTime=Date.now(),this.send(this._requestBuilder.createPingRequest()),a.Base.Logger.debug(a.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Started receiving pings from extension")},_removeWindowEventListener:function(){b.removeEventListener(e.MESSAGE,this._listenerFunction,!1),a.Base.Logger.debug(a.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Stopped receiving pings from extension")},_startPingTask:function(){this._pingTimer=b.setTimeout(function(){if(0===this._pongTime&&this._installedExtensionType===a.Providers.ContentSharing.InstalledExtensionType.INVALID)this._installedExtensionType=a.Providers.ContentSharing.InstalledExtensionType.NOT_INSTALLED,this._onCapabilityChangeCallbacks.fire(this._installedExtensionType,!1),this._pingInterval=this._pingInterval>=f?f:Math.max(f,2*this._pingInterval);else if(this._pingTime-this._pongTime>this._pingInterval&&(this._installedExtensionType===a.Providers.ContentSharing.InstalledExtensionType.CHROME||this._installedExtensionType===a.Providers.ContentSharing.InstalledExtensionType.FIREFOX)){var b=this._installedExtensionType;this._installedExtensionType=a.Providers.ContentSharing.InstalledExtensionType.NOT_INSTALLED,this._onCapabilityChangeCallbacks.fire(b,!1)}this._pingTime=Date.now(),this.send(this._requestBuilder.createPingRequest()),this._startPingTask()}.bind(this),this._pingInterval)}}}(AvayaClientServices,window,jQuery),function(a){"use strict";function b(){}var c={SCREEN_SHARING_PAGE:"SCREEN_SHARING_PAGE"},d={STOP:"STOP",START:"START",PING:"PING"};b.prototype={createStartSharingRequest:function(a){return{type:c.SCREEN_SHARING_PAGE,text:d.START,capture:a}},createStopSharingRequest:function(a){return{type:c.SCREEN_SHARING_PAGE,text:d.STOP,mediaSourceId:a}},createPingRequest:function(){return{type:c.SCREEN_SHARING_PAGE,text:d.PING}}},a.Providers.ContentSharing.ExtensionRequestBuilder=b}(AvayaClientServices),function(a){"use strict";function b(a){this._blocks=[],this.byteLength=0,this._keyFrame=a}b.prototype={addBlock:function(a){this._blocks.push(a),this.byteLength+=a.byteLength},getBlocks:function(){return this._blocks},getByteLength:function(){return this.byteLength}},a.Providers.ContentSharing.FrameBlocks=b}(AvayaClientServices),function(a){"use strict";var b={CHROME:"Chrome",FIREFOX:"Firefox",NOT_INSTALLED:"Not Installed",INVALID:"Invalid"};a.Providers.ContentSharing.InstalledExtensionType=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d,e,f,g,h,i){this._x=b,this._y=c,this._row=d,this._column=e,this._height=g,this._width=f,this._imgData=h,this._previousBase64=void 0,this._blocks=i||[],this._type=a.Providers.WCS.ScreenSharingImageTypes.JPEG}a.Providers.ContentSharing.ScreenBlock=b}(AvayaClientServices),function(a){"use strict";function b(b){a.Base.Observable.call(this),this._config=void 0,this._video=void 0,this._videoTrack=void 0,this._screenScraper=b,this._capturingTimeout=void 0,this._delayInterval=void 0,this._doNotCapture=!1,this._processTimes=[],this._scale=1}b.prototype=Object.create(a.Base.Observable.prototype),a.Providers.ContentSharing.ScreenCapturer=b,b.prototype.start=function(b,c,d){var e=$.Deferred();return this._manuallyStopped=!1,this._doNotCapture=!1,this._config=c,this._doNotCapture=!1,this._worker=new Worker(this._config.contentSharingWorkerPath),this._worker.postMessage({type:a.Providers.ContentSharing.ScreenCapturerWorkerEvents.INITIALIZE,browser:d,config:c}),this._worker.onerror=function(a){b.getVideoTracks()[0].stop(),e.reject(a)},this._worker.onmessage=function(a){this._handleWorkerMessage(a,e,b)}.bind(this),e.promise()},b.prototype._handleWorkerMessage=function(b,c,d){switch(b.data.type){case a.Providers.ContentSharing.ScreenCapturerWorkerEvents.CHANGED_BLOCKS:this._handleChangedBlocksMessage(b.data);break;case a.Providers.ContentSharing.ScreenCapturerWorkerEvents.WORKER_STARTED:this._handleWorkerStartedMessage(b.data,c,d);break;default:a.Base.Logger.warn(a.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Unknown message data type received: {0}",b.data.type)}},b.prototype._calculateScale=function(a,b,c,d){var e=1,f=1;return a>c&&(e=c/a),b>d&&(f=d/b),Math.min(e,f)},b.prototype._handleChangedBlocksMessage=function(b){!this._doNotCapture&&b.data.length>0&&(this._processTimes.unshift(b.meta.processingTime),this.trigger(a.Providers.ContentSharing.ScreenCapturerEvents.BLOCKS_CHANGED,[b.data,b.meta.keyFrame])),this._capturingTimeout=setTimeout(function(){this._capture()}.bind(this),this._config.captureInterval)},b.prototype._handleWorkerStartedMessage=function(b,c,d){this._videoTrack=d.getVideoTracks()[0],this._videoTrack.onended=function(){this._manuallyStopped||this.trigger(a.Providers.ContentSharing.ScreenCapturerEvents.WINDOW_CLOSED,[])}.bind(this),this._video=window.document.createElement("video"),this._video.setAttribute("hidden","true"),void 0!==this._video.mozSrcObject?this._video.mozSrcObject=d:this._video.src=window.URL&&window.URL.createObjectURL(d)||d,this._video.play(),this._capture(),c.resolve()},b.prototype._getAverageProcessingTime=function(){return 100===this._processTimes.length&&this._processTimes.pop(),this._processTimes.reduce(function(a,b){return a+b/this._processTimes.length}.bind(this),0)},b.prototype.stop=function(){var a=$.Deferred();return this._removeListeners(),this._video&&this._video.srcObject&&this._video.srcObject.stop(),this._video=void 0,this._videoTrack&&(this._manuallyStopped=!0,this._videoTrack.stop(),this._videoTrack=void 0),this._processTimes=[],this._worker&&this._worker.terminate(),clearTimeout(this._capturingTimeout),clearTimeout(this._delayInterval),a.resolve(),a.promise()},b.prototype.pause=function(){var a=$.Deferred(),b=!0;return this._video&&!this._video.paused&&(b=!1,this._video.pause()),clearTimeout(this._capturingTimeout),clearTimeout(this._delayInterval),a.resolve(b),a.promise()},b.prototype.getWidth=function(){return this._scale*this._video.videoWidth},b.prototype.getHeight=function(){return this._scale*this._video.videoHeight},b.prototype.resume=function(){var a=$.Deferred(),b=!1;return this._video&&this._video.paused&&(b=!0,this._video.play(),this._capture(!0)),a.resolve(b),a.promise()},b.prototype.delayCapturing=function(b){this._delayInterval||(clearTimeout(this._capturingTimeout),this._doNotCapture=!0,this._delayInterval=setTimeout(function(){a.Base.Logger.debug(a.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Resuming screen capturing after delay."),this._doNotCapture=!1,this._capture(),this._delayInterval=void 0}.bind(this),b-this._getAverageProcessingTime()))},b.prototype._capture=function(b){if(!this._doNotCapture&&this._videoTrack&&"ended"!==this._videoTrack.readyState&&!this._video.paused)if(this._video.videoWidth){var c=window.document.createElement("canvas");this._scale=this._calculateScale(this._video.videoHeight,this._video.videoWidth,this._config.maxHeight,this._config.maxWidth);var d=+(this._scale*this._video.videoWidth).toFixed(0),e=+(this._scale*this._video.videoHeight).toFixed(0);c.width=d,c.height=e;var f=c.getContext("2d");1!==this._scale&&(a.Base.Logger.info(a.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Resolution of shared content is too high. Scaling down from  "+this._video.videoWidth+"x"+this._video.videoHeight+" to "+d+"x"+e),f.scale(this._scale,this._scale)),f.drawImage(this._video,0,0);var g=f.getImageData(0,0,d,e).data;this._worker.postMessage({type:a.Providers.ContentSharing.ScreenCapturerWorkerEvents.SEND_IMAGE_DATA,imgData:g,config:this._config,width:d,height:e,forceKeyFrame:b},[g.buffer])}else this._capturingTimeout=setTimeout(function(){this._capturingTimeout=void 0,this._capture()}.bind(this),this._config.captureInterval)},b.prototype.setServerCapabilities=function(a){this._config=$.extend({},this._config,a)}}(AvayaClientServices),function(a){"use strict";function b(){this.captureInterval=100,this.losslessColorLimit=32,this.blockSize=64,this.framesPerKeyFrame=100,this.maxBytesPerSecond=38400,this.maxWidth=1920,this.maxHeight=1080}a.Providers.ContentSharing.ScreenCapturerConfig=b}(AvayaClientServices),function(a){"use strict";var b={BLOCKS_CHANGED:"blocks_changed",KEY_FRAME:"key_frame",WINDOW_CLOSED:"window_changed"};a.Providers.ContentSharing.ScreenCapturerEvents=b}(AvayaClientServices),function(a){"use strict";var b={INITIALIZE:"initialize",CHANGED_BLOCKS:"changedBlocksMessage",SEND_IMAGE_DATA:"wholeImgData",WORKER_STARTED:"workerStarted"};a.Providers.ContentSharing.ScreenCapturerWorkerEvents=b}(AvayaClientServices),function(a){"use strict";function b(){this._previousBlocks=[],this._blockWidth=64,this._blockHeight=64,this._previousBase64=void 0,this._captureKeyFrame=!1}a.Providers.ContentSharing.ScreenScraper=b,a.Providers.ContentSharing.ScreenScraper.prototype={getChangedBlocks:function(a,b,c){if(!a.videoWidth)return[];this._blockWidth=b,this._blockHeight=b;var d=window.document.createElement("canvas");d.width=a.videoWidth,d.height=a.videoHeight;var e=d.getContext("2d");e.drawImage(a,0,0);var f=this._determineChangedBlocks(a,e);return f.length>0&&(f=this._mergeBlocks(f),f=this._determineTypes(f,c)),f},_determineTypes:function(b,c){return b.forEach(function(b){var d=this._getColorsCount(b._imgData);b._type=d>c?a.Providers.WCS.ScreenSharingImageTypes.JPEG:a.Providers.WCS.ScreenSharingImageTypes.PNG}.bind(this)),b},_mergeBlocks:function(a){return a=this._sortByColumn(a),a=this._mergeByColumn(a),a=this._sortByRow(a),a=this._mergeByRow(a),a.map(this._createMergedBlock)},_createMergedBlock:function(b){var c=document.createElement("canvas");c.width=b._width,c.height=b._height;var d=c.getContext("2d");b._blocks.forEach(function(a){d.putImageData(a._imgData,a._x-b._x,a._y-b._y)});var e=d.getImageData(0,0,b._width,b._height);return new a.Providers.ContentSharing.ScreenBlock(b._x,b._y,b._row,b._column,b._width,b._height,e)},_determineChangedBlocks:function(b,c){var d=[],e=[],f=Math.ceil(b.videoHeight/this._blockHeight);if(!this._imageChanged(b,c))return d;for(var g=0;g<b.videoWidth;g+=this._blockWidth)for(var h=g/this._blockWidth,i=g+this._blockWidth>b.videoWidth?b.videoWidth-g:this._blockWidth,j=0;j<b.videoHeight;j+=this._blockHeight){var k=j+this._blockHeight>b.videoHeight?b.videoHeight-j:this._blockHeight,l=c.getImageData(g,j,i,k),m=new a.Providers.ContentSharing.ScreenBlock(g,j,j/this._blockHeight,h,i,k,l);if(m._previousBase64=this._getBase64Image(m._imgData),this._previousBlocks.length>0&&!this._captureKeyFrame){var n=m._column*f+m._row,o=this._previousBlocks[n];o&&o._previousBase64===m._previousBase64||(o._previousBase64=void 0,e.push(m))}else e.push(m);d.push(m)}return this._captureKeyFrame&&(this._captureKeyFrame=!1),this._previousBlocks=d,e},_imageChanged:function(a,b){var c=!0,d=b.getImageData(0,0,a.videoWidth,a.videoHeight),e=this._getBase64Image(d);return e!==this._previousBase64||this._captureKeyFrame?this._previousBase64=e:c=!1,c},_getColorsCount:function(a){var b,c={},d=new Uint32Array(a.data.buffer),e=0,f=d.length;for(b=0;b<f;b++){var g=""+(16777215&d[b]);c[g]||(c[g]=0,e++),c[g]++}return e},_getBase64Image:function(a){var b=document.createElement("canvas");return b.width=a.width,b.height=a.height,b.getContext("2d").putImageData(a,0,0),b.toDataURL("image/png").replace(/^data:image\/(png|jpg);base64,/,"")},_mergeByColumn:function(a){return this._merge(a,this._compareBlocksByColumn,function(a,b){a._height+=b._height})},_mergeByRow:function(a){return this._merge(a,this._compareBlocksByRow,function(a,b){a._width+=b._width})},_merge:function(a,b,c){for(var d=[],e=this._copyBlock(a[0]),f=1;f<a.length;f++)b(e,a[f])?(a[f]._blocks.length>0?this._copyBlocks(a,f,e):e._blocks.push(a[f]),c(e,a[f])):(d.push(e),e=this._copyBlock(a[f]));return d.push(e),d},_copyBlocks:function(a,b,c){a[b]._blocks.forEach(function(a){c._blocks.push(a)})},_copyBlock:function(b){var c;return 0===b._blocks.length?(c=new a.Providers.ContentSharing.ScreenBlock(b._x,b._y,b._row,b._column,b._width,b._height),c._blocks.push(b)):c=b,c},_sortByColumn:function(a){return a.sort(function(a,b){return a._column===b._column?a._row-b._row:a._column-b._column})},_sortByRow:function(a){return a.sort(function(a,b){return a._row===b._row?a._column-b._column:a._row-b._row})},_compareBlocksByColumn:function(a,b){return a._x===b._x&&a._width===b._width&&(a._y+a._height===b._y||b._y+b._height===a._y)},_compareBlocksByRow:function(a,b){return a._y===b._y&&a._height===b._height&&(a._x+a._width===b._x||b._x+b._width===a._x)}}}(AvayaClientServices),function(a){"use strict";function b(b,c){this._collaborationProvider=b,this._extensionNetworkProvider=new a.Providers.ContentSharing.ExtensionNetworkProvider(new a.Providers.ContentSharing.ExtensionRequestBuilder),this._screenCapturer=new a.Providers.ContentSharing.ScreenCapturer(new a.Providers.ContentSharing.ScreenScraper),this._extensionRequestBuilder=new a.Providers.ContentSharing.ExtensionRequestBuilder,this._contentSharingTagBuilder=new a.Providers.ContentSharing.ContentSharingTagBuilder;var d=new a.Providers.ContentSharing.ServerManager(b.sendMessage.bind(b),b.getBufferedAmount.bind(b));c.registerServer(d),this._bandwidthManager=new a.Providers.ContentSharing.BandwidthManager(d),this._screenSharingTagEncoder=new a.Providers.WCS.ScreenSharingTagEncoder}b.prototype={getScreenSharingProvider:function(b){return navigator.webkitGetUserMedia&&window.chrome?new a.Providers.ContentSharing.ChromeScreenSharingProvider(this._collaborationProvider,this._screenCapturer,this._contentSharingTagBuilder,this._bandwidthManager,this._screenSharingTagEncoder,b,this._extensionNetworkProvider,this._extensionRequestBuilder):new a.Providers.ContentSharing.FirefoxScreenSharingProvider(this._collaborationProvider,this._screenCapturer,this._contentSharingTagBuilder,this._bandwidthManager,this._screenSharingTagEncoder,b)}},a.Providers.ContentSharing.ScreenSharingProviderFactory=b}(AvayaClientServices),function(a){"use strict";function b(a,b){this._sentData=0,this._sentDataSum=0,this._maxBytesPerSecond=5e4,
this._sendingFunction=a,this._monitoringFunction=b,this._history=[{buffered:0,bufferedSum:0,sent:0,sentSum:0}],this._observationInterval=5,this._onStop=function(){}}b.prototype={start:function(a){this._maxBytesPerSecond=a.maxBytesPerSecond,this._interval=setInterval(function(){var a=this._history[this._history.length-1],b={buffered:this._monitoringFunction()-a.bufferedSum,bufferedSum:this._monitoringFunction(),sent:this._sentDataSum-a.sentSum,sentSum:this._sentDataSum};this._history.push(b)}.bind(this),1e3*this._observationInterval)},getHistory:function(){return this._history},stop:function(){this._onStop(),clearInterval(this._interval)},send:function(a){this._sentDataSum+=a.getByteLength(),this._sentData+=a.getByteLength();var b=a.getByteLength()/this._maxBytesPerSecond*1e3;a.getBlocks().forEach(function(a){this._sendingFunction(a)}.bind(this)),setTimeout(function(){this._sentData-=a.getByteLength(),this.onBandwidthAvailable()}.bind(this),b)},canSend:function(a){return 0===this._sentData||a+this._sentData<=this._maxBytesPerSecond},onBandwidthAvailable:function(){}},a.Providers.ContentSharing.ServerManager=b}(AvayaClientServices),function(a){"use strict";function b(b){a.Base.Observable.call(this),this._networkProvider=b}b.prototype=Object.create(a.Base.Observable.prototype),b.prototype.init=function(a){this._networkProvider.init(a)},b.prototype.login=function(a){return this._networkProvider.send({loginId:a.username,password:a.password},{sendType:"GET"}).then(function(a){return this.trigger("focus.login.success",[a]),a}.bind(this),function(a){this.trigger("focus.login.error",[a])}.bind(this))},a.Providers.Focus.FocusProvider=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(){a.Base.Observable.call(this)}b.prototype=Object.create(a.Base.Observable.prototype),b.prototype.start=function(){},b.prototype.stop=function(){},a.Providers.Interfaces.AbstractProvider=b}(AvayaClientServices),function(a){"use strict";function b(){this.callId=void 0}b.prototype={},a.Providers.Interfaces.Call=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d){this.type=b,this.id=c,this.enabled=d!==a.Services.Call.MediaDirection.INACTIVE,this.direction=d}a.Providers.Interfaces.AbstractStream=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b,c){a.Providers.Interfaces.AbstractStream.call(this,"audio",b,c)}b.prototype=Object.create(a.Providers.Interfaces.AbstractStream.prototype),a.Providers.Interfaces.AudioStream=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(){a.Providers.Interfaces.AbstractProvider.call(this)}b.prototype=Object.create(a.Providers.Interfaces.AbstractProvider.prototype),b.prototype.accept=function(a,b,c,d){},b.prototype.setVideoMode=function(a,b,c){},b.prototype.ignore=function(){},b.prototype.deny=function(){},b.prototype.hold=function(a){},b.prototype.unhold=function(a){},b.prototype.sendDigits=function(){},b.prototype.getRemoteAddress=function(){},b.prototype.getAccessCode=function(){},b.prototype.getSessionDetails=function(){},b.prototype.isConference=function(){},b.prototype.isIncoming=function(){},b.prototype.canAutoAnswer=function(){},b.prototype.isRemote=function(){},b.prototype.isServiceAvailable=function(){},b.prototype.isCallerIdentityPrivate=function(){},b.prototype.getAlertType=function(){},b.prototype.getSubject=function(){},b.prototype.getState=function(){},b.prototype.join=function(){},b.prototype.addCall=function(a){},b.prototype.addParticipant=function(a){},b.prototype.muteAudio=function(a){},b.prototype.unmuteAudio=function(a){},b.prototype.muteSpeaker=function(a){},b.prototype.unmuteSpeaker=function(a){},b.prototype.updateDevices=function(a,b,c){},a.Providers.Interfaces.CallProvider=b}(AvayaClientServices),function(a){"use strict";var b={ANSWER_CALL_REQUESTED:"answerCallRequested",CALL_STARTED:"callStarted",CALL_RINGING:"callRinging",CALL_ESTABLISHED:"callEstablished",CALL_ESTABLISHING:"callEstablishing",CALL_ENDED:"callEnded",CALL_FAILURE:"callFailure",CALL_SERVICE_AVAILABLE:"callServiceAvailable",CALL_SERVICE_UNAVAILABLE:"callServiceUnavailable",CONFERENCE_ESCALATION:"conferenceEscalation",INCOMING_CALL:"incomingCall",INCOMING_ADD_VIDEO_REQUEST:"incomingAddVideoRequest",INCOMING_ADD_VIDEO_ACCEPTED:"incomingAddVideoAccepted",INCOMING_ADD_VIDEO_DENIED:"incomingAddVideoDenied",INCOMING_ADD_VIDEO_TIMEDOUT:"incomingAddVideoTimedout",INCOMING_HOLD:"incomingHold",INCOMING_UNHOLD:"incomingUnhold",MAKE_CALL_REQUESTED:"makeCallRequested",REMOTE_ADDRESS_CHANGED:"remoteAddressChanged",REMOTE_CALL_CREATED:"remoteCallCreated",TERMINATE_CALL_REQUESTED:"terminateCallRequested",UPDATE_CALL_REQUESTED:"updateCallRequested",VIDEO_CHANNEL_UPDATE:"videoChannelUpdate",VIDEO_ESCALATION_REJECTED:"videoEscalationRejected",VIDEO_LICENSE_UPDATED:"VIDEO_LICENSE_UPDATED",RINGBACK_TONE_URLS_CHANGED:"RINGBACK_TONE_URLS_CHANGED"};a.Providers.Interfaces.CallProviderCallbackIds=b}(AvayaClientServices),function(a){"use strict";var b={INCOMING_CALL:"incomingCall",MAKE_CALL_REQUESTED:"makeCallRequested"};a.Providers.Interfaces.CallServiceCallbackIds=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d,e){a.Providers.Interfaces.AbstractStream.call(this,"video",b,c),this.maxHeight=d,this.maxWidth=e}b.prototype=Object.create(a.Providers.Interfaces.AbstractStream.prototype),a.Providers.Interfaces.VideoStream=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(){a.Base.Observable.call(this)}b.prototype=Object.create(a.Base.Observable.prototype),b.prototype.start=function(){},b.prototype.stop=function(){},b.prototype.startWhiteboard=function(a){},b.prototype.endWhiteboard=function(a){},b.prototype.addWhiteboardSurface=function(){},b.prototype.removeWhiteboardSurface=function(a){},b.prototype.observeCollaboration=function(){},b.prototype.addCircle=function(){},b.prototype.addShape=function(){},b.prototype.startDrawShape=function(){},b.prototype.discoverResources=function(a){},b.prototype.liveDrawShape=function(){},b.prototype.endDrawShape=function(){},b.prototype.addText=function(){},b.prototype.getReceivingBitrate=function(){},b.prototype.startScreenSharing=function(){},b.prototype.stopScreenSharing=function(){},b.prototype.pauseScreenSharing=function(){},b.prototype.sendMessage=function(a){},b.prototype.sendLiveEvent=function(a){},b.prototype.removeShape=function(a,b){},b.prototype.clearContent=function(a){},b.prototype.getParticipants=function(){},b.prototype.pause=function(){},b.prototype.resume=function(){},b.prototype.isOpened=function(){},b.prototype.isFeatureAvailable=function(a){},b.prototype.getServerCapabilities=function(){},a.Providers.Interfaces.CollaborationProvider=b}(AvayaClientServices),function(a){"use strict";var b={SERVER_CAPABILITIES:"server_capabilities"};a.Providers.Interfaces.CollaborationProviderCallbackIds=b}(AvayaClientServices),function(a){"use strict";var b={NETWORK_PROVIDER_IS_UNAVAILABLE:"NETWORK_PROVIDER_IS_UNAVAILABLE",NETWORK_PROVIDER_IS_AVAILABLE:"NETWORK_PROVIDER_IS_AVAILABLE"};a.Providers.Interfaces.ConferenceCallbackIds=b}(AvayaClientServices),function(a){"use strict";function b(){a.Providers.Interfaces.AbstractProvider.call(this)}b.prototype=Object.create(a.Providers.Interfaces.AbstractProvider.prototype),b.prototype.sendHandshake=function(a){},b.prototype.subscribeMeetingInfo=function(a){},b.prototype.subscribeRoster=function(a){},b.prototype.subscribeActiveTalker=function(a){},b.prototype.subscribePermissions=function(a){},b.prototype.subscribeSlider=function(a){},b.prototype.subscribeMeetingNote=function(a){},b.prototype.subscribeWebCollab=function(a){},b.prototype.subscribeAvailableLayouts=function(a){},b.prototype.getCurrentVideoLayout=function(a){},b.prototype.setAsLecturer=function(a,b){},b.prototype.disconnectParticipant=function(a,b){},b.prototype.terminateConference=function(a){},b.prototype.requestToBecomeModerator=function(a,b){},b.prototype.signIn=function(a,b){},b.prototype.videoPin=function(a,b,c,d,e,f){},b.prototype.extendMeeting=function(a,b){},b.prototype.addParticipant=function(a,b){},b.prototype.cancelDialoutParticipant=function(a,b){},b.prototype.unsetAsLecturer=function(a){},b.prototype.controlRemoteCamera=function(a,b,c){},b.prototype.muteUnmute=function(a,b,c,d){},b.prototype.sendChatMessage=function(a,b,c){},b.prototype.muteUnmuteAll=function(a,b){},b.prototype.raiseLowerHand=function(a,b){},b.prototype.moderatorLowerHand=function(a,b,c){},b.prototype.sendModeratorAdmissionRequest=function(a){},b.prototype.sendAdmissionRequest=function(a,b){},a.Providers.Interfaces.ConferenceDataProvider=b}(AvayaClientServices),function(a){"use strict";function b(){a.Providers.Interfaces.AbstractProvider.call(this)}b.prototype=Object.create(a.Providers.Interfaces.AbstractProvider.prototype),b.prototype.start=function(a){},b.prototype.observeConference=function(a){},b.prototype.disconnectParticipant=function(a){},b.prototype.setAsLecturer=function(a){},b.prototype.setLocked=function(a){},b.prototype.setVideoLayoutTextOverlay=function(a){},b.prototype.setVideoLayoutSelfSee=function(a){},b.prototype.setVideoLayout=function(a){},b.prototype.terminateConference=function(){},b.prototype.removeLastParticipant=function(){},b.prototype.requestToBecomeModerator=function(a){},b.prototype.signIn=function(a){},b.prototype.videoPin=function(a,b,c,d,e){},b.prototype.extendMeeting=function(a){},b.prototype.addParticipant=function(a){},b.prototype.addParticipantFromCall=function(a){},b.prototype.cancelDialoutParticipant=function(a){},b.prototype.startRecording=function(a,b,c){},b.prototype.stopRecording=function(a){},b.prototype.pauseRecording=function(a){},b.prototype.resumeRecording=function(a){},b.prototype.unsetAsLecturer=function(){},b.prototype.controlRemoteCamera=function(a,b){},b.prototype.muteUnmute=function(a,b,c){},b.prototype.sendChatMessage=function(a,b){},b.prototype.muteUnmuteAll=function(a){},b.prototype.raiseLowerHand=function(a){},b.prototype.moderatorLowerHand=function(a,b){},b.prototype.getDialInInfo=function(){},a.Providers.Interfaces.ConferenceProvider=b}(AvayaClientServices),function(a){"use strict";function b(){a.Providers.Interfaces.AbstractProvider.call(this)}b.prototype=Object.create(a.Providers.Interfaces.AbstractProvider.prototype),b.prototype.start=function(a,b){},b.prototype.stop=function(){},b.prototype.getProviderType=function(){},b.prototype.createContactForAdd=function(){},b.prototype.addContact=function(a){},b.prototype.updateContact=function(a){},b.prototype.deleteContact=function(a){},b.prototype.retrieveAllContacts=function(){},b.prototype.getContactsChanges=function(){},b.prototype.getAddContactCapability=function(){},b.prototype.getUpdateContactCapability=function(){},b.prototype.getDeleteContactCapability=function(){},b.prototype.getExtendedContactDetailsCapability=function(){},a.Providers.Interfaces.ContactsProvider=b}(AvayaClientServices),function(a){"use strict";var b={CONTACT_ADDED:"contact_added",CONTACT_UPDATED:"contact_updated",CONTACT_DELETED:"contact_deleted",CAPABILITIES_CHANGED:"capabilities_changed"};a.Providers.Interfaces.ContactsProviderCallbackIds=b}(AvayaClientServices),function(a){"use strict";function b(){a.Providers.Interfaces.AbstractProvider.call(this)}b.prototype=Object.create(a.Providers.Interfaces.AbstractProvider.prototype),b.prototype.start=function(a){},b.prototype.stop=function(){},b.prototype.getProviderType=function(){},b.prototype.startDirectorySearch=function(a){},b.prototype.startResolvingContacts=function(a,b){},b.prototype.stopDirectorySearch=function(a){},b.prototype.getNetworkSearchContactCapability=function(){},b.prototype.getNetworkResolveContactsCapability=function(){},b.prototype.getNetworkSearchTerminalCapability=function(){},b.prototype.getSelfContact=function(){},a.Providers.Interfaces.DirectorySearchProvider=b}(AvayaClientServices),function(a){"use strict";var b={CAPABILITIES_CHANGED:"capabilities_changed"};a.Providers.Interfaces.DirectorySearchProviderCallbackIds=b}(AvayaClientServices),function(a){"use strict";function b(){a.Providers.Interfaces.AbstractProvider.call(this)}b.prototype=Object.create(a.Providers.Interfaces.AbstractProvider.prototype),b.prototype.start=function(a){},b.prototype.logout=function(){},b.prototype.getRoutableDomains=function(){},b.prototype.getConversations=function(a){},b.prototype.getConversationIds=function(a){},b.prototype.getConversationsByQuery=function(a){},b.prototype.discoverResources=function(){},b.prototype.getResources=function(){},b.prototype.validateUsers=function(a){},b.prototype.getParticipants=function(a,b){},b.prototype.sendMessage=function(a,b){},b.prototype.sendMessageWithAttachments=function(a,b,c){},b.prototype.leaveConversation=function(a){},b.prototype.markAllAsRead=function(a){},b.prototype.changeSubject=function(a){},b.prototype.markAsReadBatch=function(a){},b.prototype.getMessages=function(a,b,c,d,e){},b.prototype.reportTyping=function(){},b.prototype.observeConversations=function(){},b.prototype.callEscalationEvent=function(a,b){},b.prototype.setLastAccessTime=function(a,b){},b.prototype.addParticipantsToConversation=function(a,b){},b.prototype.close=function(a){},b.prototype.isStarted=function(){},b.prototype.getMaxImageSize=function(){},b.prototype.getMaxVideoSize=function(){},b.prototype.getMaxAudioSize=function(){},b.prototype.getMaxTextLength=function(){},b.prototype.getMaxGenericAttachmentSize=function(){},a.Providers.Interfaces.MessagingProvider=b}(AvayaClientServices),function(a){"use strict";var b={CONVERSATIONS_UPDATE:"conversations.update"};a.Providers.Interfaces.MessagingProviderHandlers=b}(AvayaClientServices),function(a){"use strict";function b(){a.Providers.Interfaces.AbstractProvider.call(this)}b.prototype=Object.create(a.Providers.Interfaces.AbstractProvider.prototype),b.prototype.start=function(a){},b.prototype.stop=function(){},b.prototype.subscribeForPresence=function(a){},b.prototype.unsubscribeFromPresence=function(a){},b.prototype.unsubscribeFromAllAddressesPresence=function(){},b.prototype.publishManualState=function(a){},b.prototype.publishLocationMode=function(a){},b.prototype.publishNote=function(a){},b.prototype.publishAutomaticPresence=function(a){},a.Providers.Interfaces.PresenceProvider=b}(AvayaClientServices),function(a){"use strict";var b={PRESENCE_NOTIFICATION:"PRESENCE_NOTIFICATION"};a.Providers.Interfaces.PresenceProviderCallbackIds=b}(AvayaClientServices),function(a){"use strict";function b(){a.Providers.Interfaces.AbstractProvider.call(this)}b.prototype=Object.create(a.Providers.Interfaces.AbstractProvider.prototype),b.prototype.getVoicemailNumber=function(){},b.prototype.isServiceAvailable=function(){},a.Providers.Interfaces.VoiceMessagingProvider=b}(AvayaClientServices),function(a){"use strict";var b={VOICEMAIL_NUMBER_CHANGED:"VOICEMAIL_NUMBER_CHANGED",MWI_STATUS_CHANGED:"MWI_STATUS_CHANGED"};a.Providers.Interfaces.VoiceMessagingProviderCallbackIds=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype.updateMeetingInfo=function(b,c){var d,e=b._activeParticipants.length>0;if(c.meetingName&&c.meetingName!==b._subject&&(b._subject=c.meetingName,b._onConferenceSubjectChangedCallbacks.fire(b,c.meetingName)),c.lecturerId&&"none"!==c.lecturerId!==b._isLectureModeActive&&(b._isLectureModeActive="none"!==c.lecturerId,b._onConferenceLectureModeStatusChangedCallbacks.fire(b,b._isLectureModeActive)),c.lecturerId&&c.lecturerId!==b._lecturerId)if(e){var f=b._activeParticipants.filter(function(a){return a._participantId===b._lecturerId})[0];f&&(f._lecturer=!1,f._onParticipantUnsetAsLecturerCallbacks.fire(f)),b._lecturerId=c.lecturerId,d=b._activeParticipants.filter(function(a){return a._participantId===b._lecturerId})[0],d&&(d._lecturer=!0,d._onParticipantSetAsLecturerCallbacks.fire(d))}else b._lecturerId=c.lecturerId;if(c.recorderAvailable&&c.recorderAvailable!==b._recorderStatus&&(b._recorderStatus=c.recorderAvailable),c.recording&&c.recording!==b._recordingStatus&&(b._recordingStatus=c.recording,b._onConferenceRecordingStatusChangedCallbacks.fire(b,b._recordingStatus)),!c.locked&&!1!==c.locked||c.locked===b._isLocked||(b._isLocked=c.locked,b._onConferenceLockStatusChangedCallbacks.fire(b,b._isLocked)),c.media&&"video"===c.media!==b._isVideoAllowed&&(b._isVideoAllowed="video"===c.media,b._onConferenceVideoStatusChangedCallbacks.fire(b,b._isVideoAllowed)),c.presenterId&&"none"!==c.presenterId!==b._isApplicationSharingActive&&(b._isApplicationSharingActive="none"!==c.presenterId,b._onConferencePresentationModeStatusChangedCallbacks.fire(b,b._isApplicationSharingActive)),c.presenterId&&c.presenterId!==b._presenterId)if(e){var g=b._activeParticipants.filter(function(a){return a._participantId===b._presenterId})[0];g&&(g._presenter=!1,g._onParticipantUnsetAsPresenterCallbacks.fire(g)),b._presenterId=c.presenterId,d=b._activeParticipants.filter(function(a){return a._participantId===b._presenterId})[0],d&&(d._presenter=!0,d._onParticipantSetAsPresenterCallbacks.fire(d))}else b._presenterId=c.presenterId;c.encrypted&&c.encrypted!==b._encryptionStatus&&(b._encryptionStatus=c.encrypted,b._onConferenceEncryptionStatusChangedCallbacks.fire(b,b._encryptionStatus)),void 0!==c.streaming&&c.streaming!==b._isStreamingActive&&(b._isStreamingActive=c.streaming,b._onConferenceStreamingStatusChangedCallbacks.fire(b,b._isStreamingActive)),c.terminationTime&&c.terminationTime!==b._terminationTime&&(b._terminationTime=c.terminationTime,b._onConferenceMeetingTerminationTimeChangedCallbacks.fire(b,b._terminationTime)),void 0!==c.moderatorPinNeeded&&c.moderatorPinNeeded!==b._isPasscodeRequiredToBecomeModerator&&(b._isPasscodeRequiredToBecomeModerator=c.moderatorPinNeeded),c.mediaStatus&&c.mediaStatus!==b._mediaStatus&&(b._mediaStatus?c.mediaStatus===a.Services.Conference.MediaStatus.MUTE_ALL_AUDIO?(b._mediaStatus=c.mediaStatus,b._onConferenceAllParticipantsMutedCallbacks.fire(b)):c.mediaStatus===a.Services.Conference.MediaStatus.ACTIVE&&b._mediaStatus===a.Services.Conference.MediaStatus.MUTE_ALL_AUDIO?(b._mediaStatus=c.mediaStatus,b._onConferenceAllParticipantsUnmutedCallbacks.fire(b)):c.mediaStatus===a.Services.Conference.MediaStatus.ACTIVE&&b._mediaStatus===a.Services.Conference.MediaStatus.WAITING_ROOM?(b._mediaStatus=c.mediaStatus,b._onConferenceStartingCallbacks.fire(b,b._mediaStatus)):b._mediaStatus=c.mediaStatus:(b._mediaStatus=c.mediaStatus,b._mediaStatus===a.Services.Conference.MediaStatus.WAITING_ROOM&&b._onConferenceWaitingToStartCallbacks.fire(b,b._mediaStatus)))},b.prototype.updateRoster=function(a,b){var c=[],d={},e=!1;b.participants.forEach(function(b){d=this._buildActiveParticipant(b,a),(e=a._activeParticipants.filter(function(a){return a._participantId===d._participantId}).length>0)||(d._participantId===a._selfParticipantId&&(d._localUser=!0,a._selfParticipant=d,a.getInConferenceChat()._setSelfParticipant(d),d._isSelfParticipant=!0),c.push(d),a._activeParticipants.push(d))}.bind(this)),a._activeParticipants.forEach(function(a){a._recalculateAllCapabilities()}),a._conferenceService._updateMatchedContactsForConference(a),c.length>0&&a._onConferenceParticipantsAddedCallbacks.fire(a,c),a._isLectureModeActive&&(d=a._activeParticipants.filter(function(b){return b._participantId===a._lecturerId})[0])&&(d._lecturer=!0,d._onParticipantSetAsLecturerCallbacks.fire(d)),a._isApplicationSharingActive&&(d=a._activeParticipants.filter(function(b){return b._participantId===a._presenterId})[0])&&(d._presenter=!0,d._onParticipantSetAsPresenterCallbacks.fire(d))},b.prototype.updateSlider=function(a,b){},b.prototype.addActiveParticipant=function(a,b){if(a._activeParticipants.filter(function(a){return a._participantId===b.participantId}).length>0)this._buildActiveDialedOutParticipant(b,a);else{var c=this._buildActiveParticipant(b,a);c._participantId===a._selfParticipantId&&(c._localUser=!0,a._selfParticipant=c,a.getInConferenceChat()._setSelfParticipant(c),c._isSelfParticipant=!0),a._activeParticipants.push(c),a._onConferenceParticipantsAddedCallbacks.fire(a,[c]),a._conferenceService._updateMatchedContactsForParticipant(c),c._recalculateAllCapabilities()}},b.prototype.addDialoutParticipant=function(b,c,d){if(b._activeParticipants.filter(function(a){return a._participantId===c.participantId}).length>0)return!1;var e=new a.Services.Conference.ActiveParticipant(b._participantService,b);return e._participantId=c.participantId,e._displayName=d,b._activeParticipants.push(e),e._connectionStatus=a.Services.Conference.ParticipantConnectionStatus.CONNECTION_STATUS_CONNECTING,!0},b.prototype.updateDialoutParticipant=function(b,c,d){c._connectionStatus=a.Services.Conference.ParticipantConnectionStatus.CONNECTION_STATUS_CONNECTED,c._onParticipantConnectionStatusChangedCallbacks.fire(c,c._connectionStatus)},b.prototype.removeDialoutParticipant=function(b,c,d){var e=b._activeParticipants.filter(function(a){return a._participantId===c})[0];a.Base.Utils.isDefined(e)&&b._activeParticipants.splice(b._activeParticipants.indexOf(e),1)},b.prototype.addPendingParticipant=function(a,b){if(!(a._pendingParticipants.filter(function(a){return a._participantId===b.participantId}).length>0)){var c=this._buildPendingParticipant(b,a);a._pendingParticipants.push(c),a._conferenceService._updateMatchedContactsForParticipant(c),a._onConferencePendingParticipantCallbacks.fire(a,c)}},b.prototype.removePendingParticipant=function(b,c){var d=b._pendingParticipants.filter(function(a){return a._participantId===c.participantId||a._participantId===c._participantId})[0];if(a.Base.Utils.isDefined(d)){var e=b._pendingParticipants.indexOf(d);b._pendingParticipants.splice(e,1),b._onConferencePendingParticipantRemovedCallbacks.fire(b,d)}},b.prototype.pendingParticipantAccepted=function(a,b){a._onPendingParticipantAcceptedCallbacks.fire(a,b.anotherModerator),this.removePendingParticipant(a._conference,a)},b.prototype.pendingParticipantCancelled=function(b,c){var d=b._pendingParticipants.filter(function(a){return a._participantId===c.participantId})[0];a.Base.Utils.isDefined(d)&&(d._onPendingParticipantCancelledCallbacks.fire(d,c.reason,c.anotherModerator),this.removePendingParticipant(d._conference,d))},b.prototype.pendingParticipantDenied=function(a,b){a._onPendingParticipantDeniedCallbacks.fire(a,b.anotherModerator),this.removePendingParticipant(a._conference,a)},b.prototype.dropParticipant=function(b,c){var d=b._activeParticipants.filter(function(a){return a._participantId===c.participantId})[0],e=b._pendingParticipants.filter(function(a){return a._participantId===c.participantId})[0];if(a.Base.Utils.isDefined(d)){b._activeParticipants.splice(b._activeParticipants.indexOf(d),1);var f=this._buildDroppedParticipant(d,b);b._droppedParticipants.push(f),b._conferenceService._updateMatchedContactsForParticipant(f),b._onConferenceParticipantsRemovedCallbacks.fire(b,[d]),b._onConferenceDroppedParticipantAddedCallbacks.fire(b,f)}a.Base.Utils.isDefined(e)&&(b._pendingParticipants.splice(b._pendingParticipants.indexOf(e),1),b._onConferencePendingParticipantRemovedCallbacks.fire(b,e))},b.prototype.updateMeetingNote=function(a,b){},b.prototype.updateActiveTalker=function(b,c){var d;if(c.participantId!==b._activeTalkerId){var e=b._activeParticipants.filter(function(a){return a._participantId===b._activeTalkerId})[0];a.Base.Utils.isDefined(e)&&e._onParticipantActiveTalkerStatusChangedCallbacks.fire(e,!1),d=b._activeParticipants.filter(function(a){return a._participantId===c.participantId})[0],a.Base.Utils.isDefined(d)&&(b._activeTalkerId=c.participantId,b._onConferenceActiveTalkersChangedCallbacks.fire(b,d),d._lastSpokenTime=new Date,d._onParticipantActiveTalkerStatusChangedCallbacks.fire(d,!0))}b._activeTalkerId&&d&&(b._recentTalkersList=b.getRecentTalkers().filter(function(a){return a._participantId!==b._activeTalkerId}),b.getRecentTalkers().push(d),b.getRecentTalkers().length>a.Services.Conference.RecentTalkersConfiguration.SIZE&&(b._recentTalkersList=b.getRecentTalkers().slice(-a.Services.Conference.RecentTalkersConfiguration.SIZE)))},b.prototype.updateWebCollab=function(a,b){a._collaborationURI=b.webCollabUrl+"/viewer.php?token="+b.token+"&participantId="+b.participantId+"&meeting_id="+b.meeting_id+"&mode="+b.mode+"&login="+b.login,a._onConferenceCollaborationURIChangedCallbacks.fire(a,a._collaborationURI)},b.prototype.updatePermissions=function(b,c){a.Base.Utils.isDefined(c.dialout)&&c.dialout!==b._dialoutPermissions&&(b._dialoutPermissions=c.dialout),a.Base.Utils.isDefined(c.recording)&&c.recording!==b._recordingPermissions&&(b._recordingPermissions=c.recording),b._recalculateAllCapabilities()},b.prototype.updateAvailableLayouts=function(b,c){if(a.Base.Utils.isDefined(c.textOverlay)&&c.textOverlay!==b._isVideoParticipantNameDisplayChangeAllowed&&(b._isVideoParticipantNameDisplayChangeAllowed=c.textOverlay,b._recalculateAllCapabilities(),b._onConferenceDisplayParticipantNameOnVideoAllowedCallbacks.fire(b,b._isVideoParticipantNameDisplayChangeAllowed)),a.Base.Utils.isDefined(c.noSelfSee)&&c.noSelfSee!==b._isVideoSelfSeeChangeAllowed&&(b._isVideoSelfSeeChangeAllowed=c.noSelfSee,b._recalculateAllCapabilities(),b._onConferenceVideoSelfSeeAllowedCallbacks.fire(b,b._isVideoSelfSeeChangeAllowed)),a.Base.Utils.isDefined(c.videoPin)&&c.videoPin!==b._isVideoPinAllowed&&(b._isVideoPinAllowed=c.videoPin,b._recalculateAllCapabilities(),b._onConferenceVideoPinAllowedCallbacks.fire(b,b._isVideoPinAllowed)),a.Base.Utils.isDefined(c.geometries)){var d=b._supportedVideoLayouts.slice(0);b._supportedVideoLayouts=c.geometries.slice(0);var e=!1;if(d.length===b._supportedVideoLayouts.length){for(var f=0;f<d.length;f++)if(d[f]!==b._supportedVideoLayouts[f]){e=!0;break}}else e=!0;e&&(b._recalculateAllCapabilities(),b._onConferenceAvailableVideoLayoutsChangedCallbacks.fire(b,b._supportedVideoLayouts))}},b.prototype.updateCurrentLayout=function(b,c){if(a.Base.Utils.isDefined(c.textOverlay)&&c.textOverlay!==b._isVideoParticipantNameDisplayActive&&(b._isVideoParticipantNameDisplayActive=c.textOverlay,b._onConferenceDisplayVideoParticipantNameChangedCallbacks.fire(b,b._isVideoParticipantNameDisplayActive)),a.Base.Utils.isDefined(c.noSelfSee)){var d=b._isVideoSelfSeeActive;b._isVideoSelfSeeActive=!c.noSelfSee,b._isVideoSelfSeeActive!==d&&b._onConferenceVideoSelfSeeChangedCallbacks.fire(b,b._isVideoSelfSeeActive)}a.Base.Utils.isDefined(c.geometry)&&c.geometry!==b._currentVideoLayout&&(b._currentVideoLayout=c.geometry,b._onConferenceVideoLayoutChangedCallbacks.fire(b,b._currentVideoLayout))},b.prototype.addChatMessage=function(b,c){var d=b.getInConferenceChat(),e=b._activeParticipants.filter(function(a){return a._participantId===c.participantId})[0];if(c.participantId!==b._selfParticipantId){var f=new a.Services.Conference.ChatMessage(c.text,e,d._selfParticipant,c.type===a.Services.Conference.ChatType.PRIVATE);d._addMessage(f)}},b.prototype._buildActiveParticipant=function(b,c){var d=new a.Services.Conference.ActiveParticipant(c._participantService,c);return d._participantId=b.participantId,d._displayName=b.participantName,d._address=b.userId,d._userId=b.userId,d._joinTime=b.joinTime,d._sourceID=b.sourceID,d._status=b.status,d._handRaised=b.handRaised,d._role=b.role,d._feccRecvSupport=b.feccRecvSupport,d._audioFromParticipant=b.audioFromParticipant,d._audioToParticipant=b.audioToParticipant,d._videoFromParticipant=b.videoFromParticipant,d._videoToParticipant=b.videoToParticipant,d._contentFromParticipant=b.contentFromParticipant,d._contentToParticipant=b.contentToParticipant,d._canLecture=b.canLecture,d},b.prototype._buildDroppedParticipant=function(b,c){var d=new a.Services.Conference.DroppedParticipant(c._participantService,c);return d._participantId=b._participantId,d._userId=b._userId,d._displayName=b._displayName,d._address=b._address,d._localUser=!1,d._conference=b._conference,d._recalculateAllCapabilities(),d},b.prototype._buildPendingParticipant=function(b,c){var d=new a.Services.Conference.PendingParticipant(c._participantService,c);return d._participantId=b.participantId,d._userId=b.userId,d._displayName=b.participantName,d._address=b.userId,d._status=b.status,d._localUser=!1,d._conference=c,d._recalculateAllCapabilities(),d},b.prototype._buildActiveDialedOutParticipant=function(b,c){var d=c._activeParticipants.filter(function(a){return a._participantId===b.participantId})[0];return d._connectionStatus===a.Services.Conference.ParticipantConnectionStatus.CONNECTION_STATUS_CONNECTED&&(d._displayName=b.participantName,d._userId=b.userId,d._address=b.userId,d._joinTime=b.joinTime,d._sourceID=b.sourceID,d._status=b.status,d._handRaised=b.handRaised,d._role=b.role,d._feccRecvSupport=b.feccRecvSupport,d._audioFromParticipant=b.audioFromParticipant,d._audioToParticipant=b.audioToParticipant,d._videoFromParticipant=b.videoFromParticipant,d._videoToParticipant=b.videoToParticipant,d._contentFromParticipant=b.contentFromParticipant,d._contentToParticipant=b.contentToParticipant,d._canLecture=b.canLecture,c._onConferenceParticipantsAddedCallbacks.fire(c,[d]),d._recalculateAllCapabilities()),d},b.prototype.updateParticipant=function(b,c){var d=b._activeParticipants.filter(function(a){return a._participantId===c.participantId});a.Base.Utils.isDefined(d[0])&&(this._updateParticipantsData(b,d[0],c),b._conferenceService._updateMatchedContactsForParticipant(d[0]))},b.prototype._updateParticipantsData=function(b,c,d){if(a.Base.Utils.isDefined(d.audioFromParticipant)&&c._audioFromParticipant!==d.audioFromParticipant&&(c._audioFromParticipant=d.audioFromParticipant,c._isAudioMuted=d.audioFromParticipant!==a.Services.Conference.MediaFromParticipantStatus.ACTIVE,c._onParticipantAudioStatusChangedCallbacks.fire(c,c._audioFromParticipant),c._recalculateAllCapabilities()),a.Base.Utils.isDefined(d.videoFromParticipant)&&c._videoFromParticipant!==d.videoFromParticipant&&(c._videoFromParticipant=d.videoFromParticipant,c._isVideoBlocked=d.videoFromParticipant!==a.Services.Conference.MediaFromParticipantStatus.ACTIVE,c._onParticipantVideoStatusChangedCallbacks.fire(c,c._videoFromParticipant),c._recalculateAllCapabilities()),a.Base.Utils.isDefined(d.status)&&c._status!==d.status&&(c._status=d.status,c._onParticipantStatusChangedCallbacks.fire(c,c._status)),a.Base.Utils.isDefined(d.handRaised)&&c._handRaised!==d.handRaised&&(c._handRaised=d.handRaised,c.isLocalUser()&&(b._isHandRaised=d.handRaised),c._handRaised?c._onParticipantHandRaisedCallbacks.fire(c):c._onParticipantHandLoweredCallbacks.fire(c)),a.Base.Utils.isDefined(d.role)&&c._role!==d.role){var e=c._role;c._role=d.role,c._moderator=c._role===a.Services.Conference.ParticipantRole.MODERATOR,c._role===a.Services.Conference.ParticipantRole.MODERATOR?c._onParticipantSetAsModeratorCallbacks.fire(c):e===a.Services.Conference.ParticipantRole.MODERATOR&&c._role!==a.Services.Conference.ParticipantRole.MODERATOR&&c._onParticipantUnsetAsModeratorCallbacks.fire(c),b._recalculate()}a.Base.Utils.isDefined(d.canLecture)&&c._canLecture!==d.canLecture&&(c._canLecture=d.canLecture,c._recalculateAllCapabilities()),a.Base.Utils.isDefined(d.feccRecvSupport)&&c._feccRecvSupport!==d.feccRecvSupport&&(c._feccRecvSupport=d.feccRecvSupport),a.Base.Utils.isDefined(d.audioToParticipant)&&c._audioToParticipant!==d.audioToParticipant&&(c._audioToParticipant=d.audioToParticipant),a.Base.Utils.isDefined(d.videoToParticipant)&&c._videoToParticipant!==d.videoToParticipant&&(c._videoToParticipant=d.videoToParticipant),a.Base.Utils.isDefined(d.contentFromParticipant)&&c._contentFromParticipant!==d.contentFromParticipant&&(c._contentFromParticipant=d.contentFromParticipant,c._onParticipantCollaborationStatusChangedCallbacks.fire(c)),a.Base.Utils.isDefined(d.contentToParticipant)&&c._contentToParticipant!==d.contentToParticipant&&(c._contentToParticipant=d.contentToParticipant),a.Base.Utils.isDefined(d.userId)&&c._userId!==d.userId&&(c._userId=d.userId)},b.prototype.updateDialInInfo=function(a,b){
a._joinMeetingURI=b.webLink,a._streamingURI=b.streamingLink,a._dialInInformation=b.dialInInformation},b.prototype.recordingFailed=function(a,b){a._onConferenceRecordingFailedCallbacks.fire(a)},b.prototype.meetingTerminationInProgress=function(a,b){a._onConferenceMeetingTerminationInProgressCallbacks.fire(a,b.reason,b.userName)},b.prototype.handleDisconnectEvent=function(b,c){a.Base.Logger.info(a.Base.LoggerTags.SCOPIA_CONFERENCE_PROVIDER,"Conference received disconnect event. Reason: "+c.reason),b._conferenceService._isDisconnecting=!0,b._onConferenceConnectionEndedCallbacks.fire(b,c.reason),b.stop()},b.prototype.networkFailureHandler=function(a){a._isAvailable&&(a._isAvailable=!1,a._onConferenceServiceUnavailableCallbacks.fire(a)),a._recalculate()},b.prototype.networkAvailabilityHandler=function(a){a._isAvailable||(a._isAvailable=!0,a._onConferenceServiceAvailableCallbacks.fire(a)),a._recalculate()},a.Providers.Scopia.ScopiaConferenceBuilder=b}(AvayaClientServices),function(a,b){"use strict";function c(b,c){a.Providers.Interfaces.ConferenceProvider.call(this),this._dataProvider=b,this._conferenceBuilder=c,this._transaction={id:1},this._isAvailable=!1}c.prototype=Object.create(a.Providers.Interfaces.ConferenceProvider.prototype),c.prototype.start=function(c,d){if(this._isAvailable)return b.Deferred().resolve();var e=a.Base.Utils.queryJSONObject(d,"networkProviderConfiguration.webSocketConfig");return!1!==d.enabled&&a.Base.Utils.isDefined(e)?this._dataProvider.start(d,c).then(function(){return this._dataProvider.sendHandshake(this._transaction.id++)}.bind(this)).then(function(d){var e=b.Deferred();return c._selfParticipantId=d.participantId,c._admissionPermissionNeeded=d.admissionPermissionNeeded,c._admissionPasscodeNeeded=d.admissionPasscodeNeeded,d.admissionPermissionNeeded||d.admissionPasscodeNeeded?e.reject({name:a.Services.Conference.ConferenceStartStatus.ADMISSION_NEEDED,admissionPasscodeNeeded:d.admissionPasscodeNeeded,admissionPermissionNeeded:d.admissionPermissionNeeded,message:"Conference admission is needed"}):(this._startListenersAndSubscribes(c),this._isAvailable=!0,e.resolve()),e.promise()}.bind(this)):b.Deferred().reject({name:a.Services.Conference.ConferenceStartStatus.CONFERENCE_CONFIG_NOT_ENABLED,message:"Conference config is not enabled"})},c.prototype._startListenersAndSubscribes=function(b,c){return this.addConferenceEventListeners(b,c),this.observeConference(b),a.Base.Logger.info(a.Base.LoggerTags.SCOPIA_CONFERENCE_PROVIDER,"Conference service is started."),b},c.prototype.observeConference=function(a){this._dataProvider.getDialInInfo(this._transaction.id++).then(function(b){return this._conferenceBuilder.updateDialInInfo(a,b),b}.bind(this)),this._dataProvider.subscribeMeetingInfo(this._transaction.id++).then(function(b){return this._conferenceBuilder.updateMeetingInfo(a,b),a._recalculateAllCapabilities(),b}.bind(this)),this._dataProvider.subscribeRoster(this._transaction.id++).then(function(b){return this._conferenceBuilder.updateRoster(a,b),a._recalculateAllCapabilities(),b}.bind(this)),this._dataProvider.subscribeActiveTalker(this._transaction.id++).then(function(b){return this._conferenceBuilder.updateActiveTalker(a,b),b}.bind(this)),this._dataProvider.subscribeSlider(this._transaction.id++).then(function(b){return this._conferenceBuilder.updateSlider(a,b),b}.bind(this)),this._dataProvider.subscribeMeetingNote(this._transaction.id++).then(function(b){return this._conferenceBuilder.updateMeetingNote(a,b),b}.bind(this)),this._dataProvider.subscribeWebCollab(this._transaction.id++).then(function(b){return this._conferenceBuilder.updateWebCollab(a,b),b}.bind(this)),this._dataProvider.subscribeAvailableLayouts(this._transaction.id++).then(function(b){return this._conferenceBuilder.updateAvailableLayouts(a,b),b}.bind(this)),this._dataProvider.subscribePermissions(this._transaction.id++).then(function(b){return this._conferenceBuilder.updatePermissions(a,b),b}.bind(this)),this._dataProvider.getCurrentVideoLayout(this._transaction.id++).then(function(b){return this._conferenceBuilder.updateCurrentLayout(a,b),a._recalculateAllCapabilities(),b}.bind(this))},c.prototype.sendAdmissionRequest=function(b,c){return this._dataProvider.sendAdmissionRequest(this._transaction.id++,c).then(function(c){if(c.responseCode===a.Services.Conference.AdmissionResponseCode.SUCCESS)return b._isAvailable=!0,b._setConferenceStarted(!0),b._onConferenceServiceAvailableCallbacks.fire(b),this._isAvailable=!0,this._startListenersAndSubscribes(b)}.bind(this))},c.prototype.addConferenceEventListeners=function(b,c){if(!c){var d=this._dataProvider.getSelectedProvider();d.on(a.Providers.UCCP.UCCPMessageTypes.PARTICIPANT_JOINED_EVENT,function(a){this._conferenceBuilder.addActiveParticipant(b,a)}.bind(this)),d.on(a.Providers.UCCP.UCCPMessageTypes.PARTICIPANT_LEFT_EVENT,function(a){this._conferenceBuilder.dropParticipant(b,a)}.bind(this)),d.on(a.Providers.UCCP.UCCPMessageTypes.ACTIVE_TALKER_CHANGED_EVENT,function(a){this._conferenceBuilder.updateActiveTalker(b,a)}.bind(this)),d.on(a.Providers.UCCP.UCCPMessageTypes.DISCONNECT_EVENT,function(a){this._conferenceBuilder.handleDisconnectEvent(b,a)}.bind(this)),d.on(a.Providers.UCCP.UCCPMessageTypes.PERMISSIONS_CHANGED_EVENT,function(a){this._conferenceBuilder.updatePermissions(b,a)}.bind(this)),d.on(a.Providers.UCCP.UCCPMessageTypes.PARTICIPANT_INFO_CHANGED_EVENT,function(a){this._conferenceBuilder.updateParticipant(b,a)}.bind(this)),d.on(a.Providers.UCCP.UCCPMessageTypes.MEETING_INFO_CHANGED_EVENT,function(a){this._conferenceBuilder.updateMeetingInfo(b,a)}.bind(this)),d.on(a.Providers.UCCP.UCCPMessageTypes.AVAILABLE_LAYOUTS_CHANGED_EVENT,function(c){this._conferenceBuilder.updateAvailableLayouts(b,c),d.getCurrentVideoLayout(this._transaction.id++).then(function(a){this._conferenceBuilder.updateCurrentLayout(b,a)}.bind(this),function(b){a.Base.Logger.error(a.Base.LoggerTags.SCOPIA_CONFERENCE_PROVIDER,"Failed to retrieve current layout",b)})}.bind(this)),d.on(a.Providers.UCCP.UCCPMessageTypes.CURRENT_LAYOUT_CHANGED_EVENT,function(a){this._conferenceBuilder.updateCurrentLayout(b,a)}.bind(this)),d.on(a.Providers.UCCP.UCCPMessageTypes.MEETING_TERMINATION_IN_PROGRESS_EVENT,function(a){this._conferenceBuilder.meetingTerminationInProgress(b,a)}.bind(this)),d.on(a.Providers.UCCP.UCCPMessageTypes.MODERATOR_ADMISSION_EVENT,function(a){this._conferenceBuilder.addPendingParticipant(b,a)}.bind(this)),d.on(a.Providers.UCCP.UCCPMessageTypes.MODERATOR_ADMISSION_CANCELED_EVENT,function(a){this._conferenceBuilder.pendingParticipantCancelled(b,a),this._conferenceBuilder.removePendingParticipant(b,a)}.bind(this)),d.on(a.Providers.UCCP.UCCPMessageTypes.RECORDING_FAILED_EVENT,function(a){this._conferenceBuilder.recordingFailed(b,a)}.bind(this)),d.on(a.Providers.UCCP.UCCPMessageTypes.WEB_COLLAB_CHANGED_EVENT,function(a){this._conferenceBuilder.updateWebCollab(b,a)}.bind(this)),d.on(a.Providers.UCCP.UCCPMessageTypes.CHAT_EVENT,function(a){this._conferenceBuilder.addChatMessage(b,a)}.bind(this)),d.on(a.Providers.Interfaces.ConferenceCallbackIds.NETWORK_PROVIDER_IS_UNAVAILABLE,function(){this._conferenceBuilder.networkFailureHandler(b)}.bind(this)),d.on(a.Providers.Interfaces.ConferenceCallbackIds.NETWORK_PROVIDER_IS_AVAILABLE,function(){this._conferenceBuilder.networkAvailabilityHandler(b),this._resubscribe(b)}.bind(this))}},c.prototype.stop=function(){return this._isAvailable=!1,this._dataProvider.stop().then(function(){return b.Deferred().resolve().promise()},function(c){return a.Base.Logger.error(a.Base.LoggerTags.SCOPIA_CONFERENCE_PROVIDER,"failed to stop data provider: "+c),b.Deferred().reject().promise()})},c.prototype._resubscribe=function(c){return this._dataProvider.sendHandshake(this._transaction.id++).then(function(d){var e=b.Deferred();return c._selfParticipantId=d.participantId,c._admissionPermissionNeeded=d.admissionPermissionNeeded,c._admissionPasscodeNeeded=d.admissionPasscodeNeeded,d.admissionPermissionNeeded||d.admissionPasscodeNeeded?e.reject({name:a.Services.Conference.ConferenceStartStatus.ADMISSION_NEEDED,admissionPasscodeNeeded:d.admissionPasscodeNeeded,admissionPermissionNeeded:d.admissionPermissionNeeded,message:"Conference admission is needed"}):(this._startListenersAndSubscribes(c,!0),e.resolve()),e.promise()}.bind(this))},c.prototype.setAsLecturer=function(a){return this._dataProvider.setAsLecturer(this._transaction.id++,a)},c.prototype.setLocked=function(a){return this._dataProvider.setLocked(this._transaction.id++,a)},c.prototype.unsetAsLecturer=function(){return this._dataProvider.unsetAsLecturer(this._transaction.id++)},c.prototype.disconnectParticipant=function(a){return this._dataProvider.disconnectParticipant(this._transaction.id++,a)},c.prototype.startRecording=function(a,b,c){return this._dataProvider.startRecording(this._transaction.id++,b,c)},c.prototype.stopRecording=function(a){return this._dataProvider.stopRecording(this._transaction.id++)},c.prototype.pauseRecording=function(a){return this._dataProvider.pauseRecording(this._transaction.id++)},c.prototype.resumeRecording=function(a){return this._dataProvider.resumeRecording(this._transaction.id++)},c.prototype.muteUnmute=function(a,b,c){return this._dataProvider.muteUnmute(this._transaction.id++,a,b,c)},c.prototype.controlRemoteCamera=function(a,b){return this._dataProvider.controlRemoteCamera(this._transaction.id++,a,b)},c.prototype.muteUnmuteAll=function(a){return this._dataProvider.muteUnmuteAll(this._transaction.id++,a)},c.prototype.sendLocalMuteEvent=function(a,b){return this._dataProvider.sendLocalMuteEvent(this._transaction.id++,a,b)},c.prototype.sendDisconnectEvent=function(a){return this._isAvailable?this._dataProvider.sendDisconnectEvent(this._transaction.id++,a):b.Deferred().reject("Service unavailable")},c.prototype.setVideoLayout=function(a){return this._dataProvider.setVideoLayout(this._transaction.id++,a)},c.prototype.setVideoLayoutSelfSee=function(a){return this._dataProvider.setVideoLayoutSelfSee(this._transaction.id++,a)},c.prototype.setVideoLayoutTextOverlay=function(a){return this._dataProvider.setVideoLayoutTextOverlay(this._transaction.id++,a)},c.prototype.getCurrentVideoLayout=function(){return this._dataProvider.getCurrentVideoLayout(this._transaction.id++)},c.prototype.terminateConference=function(){return this._dataProvider.terminateConference(this._transaction.id++)},c.prototype.removeLastParticipant=function(){var c=b.Deferred();return a.Base.Logger.info(a.Base.LoggerTags.SCOPIA_CONFERENCE_PROVIDER,"removeLastParticipant method is not implemented"),c.reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"removeLastParticipant method is not implemented"}),c.promise()},c.prototype.requestToBecomeModerator=function(a){return this._dataProvider.requestToBecomeModerator(this._transaction.id++,a)},c.prototype.signIn=function(a){return this._dataProvider.signIn(this._transaction.id++,a)},c.prototype.videoPin=function(a,b,c,d,e){return this._dataProvider.videoPin(this._transaction.id++,a,b,c,d,e)},c.prototype.extendMeeting=function(a){return this._dataProvider.extendMeeting(this._transaction.id++,a)},c.prototype.addParticipantFromCall=function(c){var d=b.Deferred();return a.Base.Logger.info(a.Base.LoggerTags.SCOPIA_CONFERENCE_PROVIDER,"addParticipantFromCall method is not implemented"),d.reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"addParticipantFromCall method is not implemented"}),d.promise()},c.prototype.addParticipant=function(c,d){var e=b.Deferred();return this._dataProvider.addParticipant(this._transaction.id++,d).then(function(b){this._conferenceBuilder.addDialoutParticipant(c,b,d)&&e.notify(b),this._dataProvider.getSelectedProvider().on(a.Providers.UCCP.UCCPMessageTypes.DIALOUT_COMPLETED_EVENT,function(b){var d=c._activeParticipants.filter(function(a){return a._participantId===b.participantId})[0];a.Base.Utils.isDefined(d)?b.result===a.Services.Conference.DialoutStatus.CONNECT?(this._conferenceBuilder.updateDialoutParticipant(c,d,b),e.resolve(b)):(c._activeParticipants.splice(c._activeParticipants.indexOf(d),1),e.reject({name:"UCCPServerError",code:b.result,message:"UCCP server responded with "+b.result,type:a.Providers.UCCP.UCCPMessageTypes.DIALOUT_COMPLETED_EVENT})):a.Base.Logger.info(a.Base.LoggerTags.SCOPIA_CONFERENCE_PROVIDER,"Update dialout participant: unknown or canceled participant with participantId",b.participantId),this._dataProvider.getSelectedProvider().off(a.Providers.UCCP.UCCPMessageTypes.DIALOUT_COMPLETED_EVENT,this._dataProvider.getSelectedProvider()._listeners[a.Providers.UCCP.UCCPMessageTypes.DIALOUT_COMPLETED_EVENT][0])}.bind(this))}.bind(this),function(a){e.reject(a)}.bind(this)),e.promise()},c.prototype.cancelDialoutParticipant=function(a,c){var d=b.Deferred();return this._dataProvider.cancelDialoutParticipant(this._transaction.id++,c).then(function(b){this._conferenceBuilder.removeDialoutParticipant(a,c,b),d.resolve(b)}.bind(this),function(a){d.reject(a)}.bind(this)),d.promise()},c.prototype.sendChatMessage=function(a,b){return this._dataProvider.sendChatMessage(this._transaction.id++,a,b)},c.prototype.moderatorAdmission=function(b,c){return this._dataProvider.moderatorAdmission(this._transaction.id++,b.getParticipantId(),c).then(function(d){switch(c){case a.Services.Conference.ModeratorAdmissionActions.ADMIT:this._conferenceBuilder.pendingParticipantAccepted(b,d);break;case a.Services.Conference.ModeratorAdmissionActions.REJECT:this._conferenceBuilder.pendingParticipantDenied(b,d);break;default:a.Base.Logger.warn(a.Base.LoggerTags.SCOPIA_CONFERENCE_PROVIDER,"Unknown action value received: {0}",c)}return d}.bind(this))},c.prototype.raiseLowerHand=function(a){return this._dataProvider.raiseLowerHand(this._transaction.id++,a)},c.prototype.moderatorLowerHand=function(a,b){return this._dataProvider.moderatorLowerHand(this._transaction.id++,a,b)},c.prototype.getDialInInfo=function(){return this._dataProvider.getDialInInfo(this._transaction.id++)},c.prototype.recalculateAddParticipantFromCallCapability=function(a,b){},c.prototype.recalculateAddParticipantFromCallCapabilityByCallId=function(a,b){},a.Providers.Scopia.ScopiaConferenceProvider=c}(AvayaClientServices,jQuery),function(a){"use strict";function b(){}b.prototype={getScopiaConferenceProvider:function(b){if(a.Base.Utils.isDefined(b)&&b.enabled){var c=new a.Providers.UCCP.UCCPMessageBuilder,d=new a.Providers.UCCP.UCCPMessageParser;d.register(a.Providers.UCCP.UCCPMessageTypes.HANDSHAKE_RESPONSE,new a.Providers.UCCP.UCCPHandshakeResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_ROSTER_RESPONSE,new a.Providers.UCCP.UCCPSubscribeRosterResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_ACTIVE_TALKER_RESPONSE,new a.Providers.UCCP.UCCPSubscribeActiveTalkerResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_PERMISSIONS_RESPONSE,new a.Providers.UCCP.UCCPSubscribePermissionsResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_SLIDER_RESPONSE,new a.Providers.UCCP.UCCPSubscribeSliderResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_MEETING_NOTE_RESPONSE,new a.Providers.UCCP.UCCPSubscribeMeetingNoteResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_MEETING_INFO_RESPONSE,new a.Providers.UCCP.UCCPSubscribeMeetingInfoResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_WEB_COLLAB_RESPONSE,new a.Providers.UCCP.UCCPSubscribeWebCollabResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_AVAILABLE_LAYOUTS_RESPONSE,new a.Providers.UCCP.UCCPSubscribeAvailableLayoutsResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.PARTICIPANT_JOINED_EVENT,new a.Providers.UCCP.UCCPParticipantJoinedEventParser),d.register(a.Providers.UCCP.UCCPMessageTypes.PARTICIPANT_LEFT_EVENT,new a.Providers.UCCP.UCCPParticipantLeftEventParser),d.register(a.Providers.UCCP.UCCPMessageTypes.ACTIVE_TALKER_CHANGED_EVENT,new a.Providers.UCCP.UCCPActiveTalkerChangedEventParser),d.register(a.Providers.UCCP.UCCPMessageTypes.PERMISSIONS_CHANGED_EVENT,new a.Providers.UCCP.UCCPPermissionsChangedEventParser),d.register(a.Providers.UCCP.UCCPMessageTypes.MEETING_INFO_CHANGED_EVENT,new a.Providers.UCCP.UCCPMeetingInfoChangedEventParser),d.register(a.Providers.UCCP.UCCPMessageTypes.PARTICIPANT_INFO_CHANGED_EVENT,new a.Providers.UCCP.UCCPParticipantInfoChangedEventParser),d.register(a.Providers.UCCP.UCCPMessageTypes.LECTURE_MODE_START_RESPONSE,new a.Providers.UCCP.UCCPLectureModeStartResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.LECTURE_MODE_STOP_RESPONSE,new a.Providers.UCCP.UCCPLectureModeStopResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.MODERATOR_MUTE_RESPONSE,new a.Providers.UCCP.UCCPModeratorMuteResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.FECC_RESPONSE,new a.Providers.UCCP.UCCPFeccResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.MUTE_ALL_RESPONSE,new a.Providers.UCCP.UCCPMuteAllResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.DISCONNECT_PARTICIPANT_RESPONSE,new a.Providers.UCCP.UCCPDisconnectParticipantResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.DISCONNECT_EVENT,new a.Providers.UCCP.UCCPDisconnectEventParser),d.register(a.Providers.UCCP.UCCPMessageTypes.MODERATOR_MUTE_RESPONSE,new a.Providers.UCCP.UCCPModeratorMuteResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.MEETING_TERMINATION_IN_PROGRESS_EVENT,new a.Providers.UCCP.UCCPMeetingTerminationInProgressEventParser),d.register(a.Providers.UCCP.UCCPMessageTypes.TERMINATE_MEETING_RESPONSE,new a.Providers.UCCP.UCCPTerminateMeetingResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.DIAL_IN_INFO_RESPONSE,new a.Providers.UCCP.UCCPDialInInfoResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.DIALOUT_RESPONSE,new a.Providers.UCCP.UCCPDialoutResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.DIALOUT_COMPLETED_EVENT,new a.Providers.UCCP.UCCPDialoutCompletedEventParser),d.register(a.Providers.UCCP.UCCPMessageTypes.DIALOUT_CANCEL_RESPONSE,new a.Providers.UCCP.UCCPDialoutCancelResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.START_MODERATION_RESPONSE,new a.Providers.UCCP.UCCPStartModerationResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.UPDATE_CREDENTIALS_TOKEN_RESPONSE,new a.Providers.UCCP.UCCPUpdateCredentialsTokenResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.CHAT_RESPONSE,new a.Providers.UCCP.UCCPChatResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.CHAT_EVENT,new a.Providers.UCCP.UCCPChatEventParser),d.register(a.Providers.UCCP.UCCPMessageTypes.LOCK_MEETING_RESPONSE,new a.Providers.UCCP.UCCPLockMeetingResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.RECORDING_RESPONSE,new a.Providers.UCCP.UCCPRecordingResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.EXTEND_MEETING_RESPONSE,new a.Providers.UCCP.UCCPExtendMeetingResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.RECORDING_REQUEST,new a.Providers.UCCP.UCCPRecordingResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.CURRENT_LAYOUT_RESPONSE,new a.Providers.UCCP.UCCPCurrentLayoutResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.CHANGE_LAYOUT_GEOMETRY_RESPONSE,new a.Providers.UCCP.UCCPChangeLayoutGeometryResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.CHANGE_LAYOUT_OVERLAY_RESPONSE,new a.Providers.UCCP.UCCPChangeLayoutTextOverlayResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.CHANGE_LAYOUT_NO_SELF_SEE_RESPONSE,new a.Providers.UCCP.UCCPChangeLayoutNoSelfSeeResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.AVAILABLE_LAYOUTS_CHANGED_EVENT,new a.Providers.UCCP.UCCPAvailableLayoutsChangedEventParser),d.register(a.Providers.UCCP.UCCPMessageTypes.CURRENT_LAYOUT_CHANGED_EVENT,new a.Providers.UCCP.UCCPCurrentLayoutChangedEventParser),d.register(a.Providers.UCCP.UCCPMessageTypes.VIDEO_PIN_RESPONSE,new a.Providers.UCCP.UCCPVideoPinResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.RAISE_HAND_RESPONSE,new a.Providers.UCCP.UCCPRaiseHandResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.MODERATOR_LOWER_HAND_RESPONSE,new a.Providers.UCCP.UCCPModeratorLowerHandResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.ADMISSION_RESPONSE,new a.Providers.UCCP.UCCPAdmissionResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.MODERATOR_ADMISSION_RESPONSE,new a.Providers.UCCP.UCCPModeratorAdmissionResponseParser),d.register(a.Providers.UCCP.UCCPMessageTypes.MODERATOR_ADMISSION_EVENT,new a.Providers.UCCP.UCCPModeratorAdmissionEventParser),d.register(a.Providers.UCCP.UCCPMessageTypes.MODERATOR_ADMISSION_CANCELED_EVENT,new a.Providers.UCCP.UCCPModeratorAdmissionCanceledEventParser),d.register(a.Providers.UCCP.UCCPMessageTypes.RECORDING_FAILED_EVENT,new a.Providers.UCCP.UCCPRecordingFailedEventParser),d.register(a.Providers.UCCP.UCCPMessageTypes.WEB_COLLAB_CHANGED_EVENT,new a.Providers.UCCP.UCCPWebCollabChangedEventParser);var e=this._createUccpNetworkProvider(),f=new a.Providers.UCCP.UCCPProviderFactory(e,c,d),g=f.getUCCPProvider(),h=new a.Providers.Scopia.ScopiaConferenceBuilder;return new a.Providers.Scopia.ScopiaConferenceProvider(g,h)}},_createUccpNetworkProvider:function(){var b=new a.Base.TransactionalWebSocketProvider;return new a.Base.NetworkProvider(b)}},a.Providers.Scopia.ScopiaConferenceProviderFactory=b}(AvayaClientServices),function(a){"use strict";function b(a){this.protocolType="UCCP",this.name=a}a.Providers.UCCP.UCCPMessage=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.MODERATOR_ADMISSION_CANCELED_EVENT),this.participantId=b,this.reason=c,this.anotherModerator=d}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPModeratorAdmissionCanceledEvent=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.MODERATOR_ADMISSION_EVENT),this.participantId=b,this.participantName=c,this.userId=d}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPModeratorAdmissionEvent=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.MODERATOR_ADMISSION_RESPONSE),this.transId=b,this.responseCode=c,this.anotherModerator=d}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPModeratorAdmissionResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.MODERATOR_LOWER_HAND_RESPONSE),this.transId=b,this.responseCode=c}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPModeratorLowerHandResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d,e){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.MODERATOR_MUTE_RESPONSE),this.transId=b,this.responseCode=c,this.audioMute=d,this.videoMute=e}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPModeratorMuteResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.MUTE_ALL_RESPONSE),this.transId=b,this.responseCode=c}a.Providers.UCCP.UCCPMuteAllResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d,e,f,g,h,i,j,k,l,m,n,o){a.Providers.UCCP.UCCPMessage.call(this,"participantInfoChangedEvent"),this.participantId=c,this.participantName=b,this.status=d,this.handRaised=e,this.role=f,this.feccRecvSupport=g,this.audioFromParticipant=h,this.audioToParticipant=i,this.videoFromParticipant=j,this.videoToParticipant=k,this.contentFromParticipant=l,this.contentToParticipant=m,this.userId=n,this.canLecture=o}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPParticipantInfoChangedEvent=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){a.Providers.UCCP.UCCPMessage.call(this,"participantJoinedEvent"),this.participantId=b,this.participantName=c,this.userId=d,this.sourceID=e,this.status=f,this.handRaised=g,this.role=h,this.feccRecvSupport=i,this.audioFromParticipant=j,this.audioToParticipant=k,this.videoFromParticipant=l,this.videoToParticipant=m,this.contentFromParticipant=n,this.contentToParticipant=o,this.joinTime=p,this.canLecture=q}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPParticipantJoinedEvent=b}(AvayaClientServices),function(a){"use strict";function b(b){a.Providers.UCCP.UCCPMessage.call(this,"participantLeftEvent"),this.participantId=b}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPParticipantLeftEvent=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.PERMISSIONS_CHANGED_EVENT),this.dialout=b,this.recording=c}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPPermissionsChangedEvent=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.RAISE_HAND_RESPONSE),this.transId=b,this.responseCode=c}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPRaiseHandResponse=b}(AvayaClientServices),function(a){"use strict";function b(){a.Providers.UCCP.UCCPMessage.call(this,"recordingFailedEvent")}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPRecordingFailedEvent=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.UCCP.UCCPMessage.call(this,"recordingResponse"),this.transId=b,this.responseCode=c}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPRecordingResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.START_MODERATION_RESPONSE),this.transId=b,this.responseCode=c}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPStartModerationResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d){a.Providers.UCCP.UCCPMessage.call(this,"subscribeActiveTalkerResponse"),this.transId=b,this.responseCode=c,this.participantId=d}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPSubscribeActiveTalkerResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d,e,f,g){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_AVAILABLE_LAYOUTS_RESPONSE),this.transId=b,this.responseCode=c,this.textOverlay=d,this.noSelfSee=e,this.videoPin=f,this.geometries=g}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPSubscribeAvailableLayoutsResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){a.Providers.UCCP.UCCPMessage.call(this,"subscribeMeetingInfoResponse"),this.transId=b,this.responseCode=c,this.meetingId=d,this.meetingName=e,this.virtualRoomName=f,this.virtualRoomOwnerId=g,this.media=h,this.locked=i,this.mediaStatus=j,this.lecturerId=k,this.lecturerName=l,this.presenterId=m,this.presenterName=n,this.recording=o,this.streaming=p,this.encrypted=q,this.moderatorPinNeeded=r,this.slidesAvailable=s,this.recorderAvailable=t,this.terminationTime=u}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPSubscribeMeetingInfoResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d){a.Providers.UCCP.UCCPMessage.call(this,"subscribeMeetingNoteResponse"),this.transId=b,this.responseCode=c,this.notes=d}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPSubscribeMeetingNoteResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d,e){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_PERMISSIONS_RESPONSE),this.transId=b,this.responseCode=c,this.dialout=d,this.recording=e}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPSubscribePermissionsResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d,e){a.Providers.UCCP.UCCPMessage.call(this,"subscribeRosterResponse"),this.transId=b,this.responseCode=c,this.fragmentation=d,this.participants=e}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPSubscribeRosterResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d){a.Providers.UCCP.UCCPMessage.call(this,"subscribeSliderResponse"),this.transId=b,this.responseCode=c,this.slides=d}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPSubscribeSliderResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d,e,f,g,h,i,j){a.Providers.UCCP.UCCPMessage.call(this,"subscribeWebCollabResponse"),this.transId=b,this.responseCode=c,this.webCollabUrl=d,this.token=i,this.participantId=h,this.meeting_id=f,this.mode=g,this.login=e,this.gsid=j}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPSubscribeWebCollabResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.UCCP.UCCPMessage.call(this,"terminateMeetingResponse"),this.transId=b,this.responseCode=c}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPTerminateMeetingResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.UPDATE_CREDENTIALS_TOKEN_RESPONSE),this.transId=b,this.responseCode=c}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPUpdateCredentialsTokenResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.VIDEO_PIN_RESPONSE),this.transId=b,this.responseCode=c}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPVideoPinResponse=b}(AvayaClientServices),function(a){"use strict";function b(b){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.WEB_COLLAB_CHANGED_EVENT),this.webCollabUrl=b}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPWebCollabChangedEvent=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPActiveTalkerChangedEvent(b.params.participantId)}},a.Providers.UCCP.UCCPActiveTalkerChangedEventParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPAdmissionResponse(b.params.transId,b.params.responseCode)}},a.Providers.UCCP.UCCPAdmissionResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPAvailableLayoutsChangedEvent(b.params.textOverlay?"true"===b.params.textOverlay:void 0,b.params.noSelfSee?"true"===b.params.noSelfSee:void 0,b.params.videoPin?"true"===b.params.videoPin:void 0,b.params.geometries)}},a.Providers.UCCP.UCCPAvailableLayoutsChangedEventParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPChangeLayoutGeometryResponse(b.params.transId,b.params.responseCode)}},a.Providers.UCCP.UCCPChangeLayoutGeometryResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPChangeLayoutNoSelfSeeResponse(b.params.transId,b.params.responseCode)}},a.Providers.UCCP.UCCPChangeLayoutNoSelfSeeResponseParser=b
}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPChangeLayoutTextOverlayResponse(b.params.transId,b.params.responseCode)}},a.Providers.UCCP.UCCPChangeLayoutTextOverlayResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){var c="";return a.Base.Utils.isDefined(b.params.time)&&(c=b.params.time),new a.Providers.UCCP.UCCPChatEvent(b.params.participantId,b.params.type,c,b.params.text)}},a.Providers.UCCP.UCCPChatEventParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPChatResponse(b.params.transId,b.params.responseCode)}},a.Providers.UCCP.UCCPChatResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPCurrentLayoutChangedEvent(b.params.textOverlay?"true"===b.params.textOverlay:void 0,b.params.noSelfSee?"true"===b.params.noSelfSee:void 0,b.params.geometry)}},a.Providers.UCCP.UCCPCurrentLayoutChangedEventParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPCurrentLayoutResponse(b.params.transId,b.params.responseCode,"true"===b.params.textOverlay,"true"===b.params.noSelfSee,b.params.geometry)}},a.Providers.UCCP.UCCPCurrentLayoutResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPDialInInfoResponse(b.params.transId,b.params.responseCode,b.params.webLink,b.params.streamingLink,b.params.dialInInformation)}},a.Providers.UCCP.UCCPDialInInfoResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPDialoutCancelResponse(b.params.transId,b.params.responseCode)}},a.Providers.UCCP.UCCPDialoutCancelResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPDialoutCompletedEvent(b.params.participantId,b.params.result)}},a.Providers.UCCP.UCCPDialoutCompletedEventParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPDialoutResponse(b.params.transId,b.params.responseCode,b.params.participantId)}},a.Providers.UCCP.UCCPDialoutResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPDisconnectEvent(b.params.reason)}},a.Providers.UCCP.UCCPDisconnectEventParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPDisconnectParticipantResponse(b.params.transId,b.params.responseCode)}},a.Providers.UCCP.UCCPDisconnectParticipantResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(a){return new AvayaClientServices.Providers.UCCP.UCCPExtendMeetingResponse(a.params.transId,a.params.responseCode)}},a.Providers.UCCP.UCCPExtendMeetingResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPFeccResponse(b.params.transId,b.params.responseCode)}},a.Providers.UCCP.UCCPFeccResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){var c=b.params.currentTime?new Date(Date.parse(b.params.currentTime)):void 0;return new a.Providers.UCCP.UCCPHandshakeResponse(b.params.transId,b.params.responseCode,b.params.version,b.params.participantId,"true"===b.params.externalAdmissionNeeded,"true"===b.params.admissionPasscodeNeeded,"true"===b.params.admissionPermissionNeeded,b.params.commands,c)}},a.Providers.UCCP.UCCPHandshakeResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPLectureModeStartResponse(b.params.transId,b.params.responseCode)}},a.Providers.UCCP.UCCPLectureModeStartResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPLectureModeStopResponse(b.params.transId,b.params.responseCode)}},a.Providers.UCCP.UCCPLectureModeStopResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPLockMeetingResponse(b.params.transId,b.params.responseCode)}},a.Providers.UCCP.UCCPLockMeetingResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){var c=b.params.terminationTime?new Date(Date.parse(b.params.terminationTime)):void 0,d=b.params.locked?"true"===b.params.locked:void 0;return new a.Providers.UCCP.UCCPMeetingInfoChangedEvent(b.params.media,d,b.params.mediaStatus,b.params.lecturerId,b.params.lecturerName,b.params.presenterId,b.params.presenterName,b.params.recording,b.params.streaming?"enabled"===b.params.streaming:void 0,b.params.encrypted,"true"===b.params.slidesAvailable,c)}},a.Providers.UCCP.UCCPMeetingInfoChangedEventParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPMeetingTerminationInProgressEvent(b.params.reason,b.params.userName)}},a.Providers.UCCP.UCCPMeetingTerminationInProgressEventParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPModeratorAdmissionCanceledEvent(b.params.participantId,b.params.reason,b.params.anotherModerator)}},a.Providers.UCCP.UCCPModeratorAdmissionCanceledEventParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPModeratorAdmissionEvent(b.params.participantId,b.params.name,b.params.userId)}},a.Providers.UCCP.UCCPModeratorAdmissionEventParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPModeratorAdmissionResponse(b.params.transId,b.params.responseCode,b.params.anotherModerator)}},a.Providers.UCCP.UCCPModeratorAdmissionResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPModeratorLowerHandResponse(b.params.transId,b.params.responseCode)}},a.Providers.UCCP.UCCPModeratorLowerHandResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPModeratorMuteResponse(b.params.transId,b.params.responseCode,"true"===b.params.audioMute,"true"===b.params.videoMute)}},a.Providers.UCCP.UCCPModeratorMuteResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPMuteAllResponse(b.params.transId,b.params.responseCode)}},a.Providers.UCCP.UCCPMuteAllResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){var c,d,e;return a.Base.Utils.isDefined(b.params.handRaised)&&(c="true"===b.params.handRaised),a.Base.Utils.isDefined(b.params.feccRecvSupport)&&(d="true"===b.params.feccRecvSupport),a.Base.Utils.isDefined(b.params.canLecture)&&(e="true"===b.params.canLecture),new a.Providers.UCCP.UCCPParticipantInfoChangedEvent(b.params.name,b.params.participantId,b.params.status,c,b.params.role,d,b.params.audioFromParticipant,b.params.audioToParticipant,b.params.videoFromParticipant,b.params.videoToParticipant,b.params.contentFromParticipant,b.params.contentToParticipant,b.params.userId,e)}},a.Providers.UCCP.UCCPParticipantInfoChangedEventParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPParticipantJoinedEvent(b.params.participantId,b.params.name,b.params.userId,b.params.sourceID,b.params.status,"true"===b.params.handRaised,b.params.role,"true"===b.params.feccRecvSupport,b.params.audioFromParticipant,b.params.audioToParticipant,b.params.videoFromParticipant,b.params.videoToParticipant,b.params.contentFromParticipant,b.params.contentToParticipant,new Date(Date.parse(b.params.joinTime)),b.params.canLecture?"true"===b.params.canLecture:void 0)}},a.Providers.UCCP.UCCPParticipantJoinedEventParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPParticipantLeftEvent(b.params.participantId)}},a.Providers.UCCP.UCCPParticipantLeftEventParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPPermissionsChangedEvent(b.params.dialout,b.params.recording)}},a.Providers.UCCP.UCCPPermissionsChangedEventParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPRaiseHandResponse(b.params.transId,b.params.responseCode)}},a.Providers.UCCP.UCCPRaiseHandResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPRecordingFailedEvent}},a.Providers.UCCP.UCCPRecordingFailedEventParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPRecordingResponse(b.params.transId,b.params.responseCode)}},a.Providers.UCCP.UCCPRecordingResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPStartModerationResponse(b.params.transId,b.params.responseCode)}},a.Providers.UCCP.UCCPStartModerationResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPSubscribeActiveTalkerResponse(b.params.transId,b.params.responseCode,b.params.participantId)}},a.Providers.UCCP.UCCPSubscribeActiveTalkerResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPSubscribeAvailableLayoutsResponse(b.params.transId,b.params.responseCode,"true"===b.params.textOverlay,"true"===b.params.noSelfSee,"true"===b.params.videoPin,b.params.geometries)}},a.Providers.UCCP.UCCPSubscribeAvailableLayoutsResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){var c=new Date(Date.parse(b.params.terminationTime));return new a.Providers.UCCP.UCCPSubscribeMeetingInfoResponse(b.params.transId,b.params.responseCode,b.params.meetingId,b.params.meetingName,b.params.virtualRoomName,b.params.virtualRoomOwnerId,b.params.media,"true"===b.params.locked,b.params.mediaStatus,b.params.lecturerId,b.params.lecturerName,b.params.presenterId,b.params.presenterName,b.params.recording,"enabled"===b.params.streaming,b.params.encrypted,"true"===b.params.moderatorPinNeeded,"true"===b.params.slidesAvailable,b.params.recorderAvailable,c)}},a.Providers.UCCP.UCCPSubscribeMeetingInfoResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){var c=b.params.notes.map(function(a){return{participantId:a.participantId,participantDisplayName:a.participantDisplayName,noteId:a.noteId,text:a.text,time:new Date(Date.parse(a.time))}});return new a.Providers.UCCP.UCCPSubscribeMeetingNoteResponse(b.params.transId,b.params.responseCode,c)}},a.Providers.UCCP.UCCPSubscribeMeetingNoteResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPSubscribePermissionsResponse(b.params.transId,b.params.responseCode,b.params.dialout,b.params.recording)}},a.Providers.UCCP.UCCPSubscribePermissionsResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){var c=b.params.participants.map(function(a){return this._buildActiveParticipant(a)}.bind(this));return new a.Providers.UCCP.UCCPSubscribeRosterResponse(b.params.transId,b.params.responseCode,b.params.fragmentation,c)},_buildActiveParticipant:function(a){var b,c,d={},e=[],f="";return d.participantId=a.participantId,d.participantName=a.name,d.userId=a.userId,a.joinTime&&(b=new RegExp(/(\d{2}:\d{2}:\d{2})\s(\d{2})-(\d{2})-(\d{4})\s(-?\+?\d{4})/),c=new RegExp(/(\d{4}-\d{2}-\d{2})[a-zA-Z](\d{2}:\d{2}:\d{2})(-?\+?\d{2}:\d{2})/),b.test(a.joinTime)?(e=b.exec(a.joinTime),f=e[4]+"-"+e[3]+"-"+e[2]+" "+e[1]+" GMT"+e[5]):c.test(a.joinTime)&&(e=c.exec(a.joinTime),f=e[1]+" "+e[2]+" GMT"+e[3]),d.joinTime=new Date(Date.parse(f))),d.sourceID=a.sourceID,d.status=a.status,d.handRaised="true"===a.handRaised,d.role=a.role,d.feccRecvSupport="true"===a.feccRecvSupport,d.audioFromParticipant=a.audioFromParticipant,d.audioToParticipant=a.audioToParticipant,d.videoFromParticipant=a.videoFromParticipant,d.videoToParticipant=a.videoToParticipant,d.contentFromParticipant=a.contentFromParticipant,d.contentToParticipant=a.contentToParticipant,d.canLecture=a.canLecture?"true"===a.canLecture:void 0,d}},a.Providers.UCCP.UCCPSubscribeRosterResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPSubscribeSliderResponse(b.params.transId,b.params.responseCode,b.params.slides)}},a.Providers.UCCP.UCCPSubscribeSliderResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPSubscribeWebCollabResponse(b.params.transId,b.params.responseCode,b.params.webCollabUrl,b.params.login,b.params.meeting_id,b.params.mode,b.params.participantId,b.params.token,b.params.gsid)}},a.Providers.UCCP.UCCPSubscribeWebCollabResponseParser=b}(AvayaClientServices);!function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPTerminateMeetingResponse(b.params.transId,b.params.responseCode)}},a.Providers.UCCP.UCCPTerminateMeetingResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPUpdateCredentialsTokenResponse(b.params.transId,b.params.responseCode)}},a.Providers.UCCP.UCCPUpdateCredentialsTokenResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPVideoPinResponse(b.params.transId,b.params.responseCode)}},a.Providers.UCCP.UCCPVideoPinResponseParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UCCP.UCCPWebCollabChangedEvent(b.params.webCollabUrl)}},a.Providers.UCCP.UCCPWebCollabChangedEventParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={buildHandshakeRequest:function(b){var c=new Date,d=-c.getTimezoneOffset(),e=d>=0?"+":"-",f=c.getFullYear()+"-"+("0"+(c.getMonth()+1)).slice(-2)+"-"+("0"+c.getDate()).slice(-2)+"T"+("0"+c.getHours()).slice(-2)+":"+("0"+c.getMinutes()).slice(-2)+":"+("0"+c.getSeconds()).slice(-2)+e+("0"+parseInt(Math.abs(d/60))).slice(-2)+":"+("0"+Math.abs(d%60)).slice(-2),g={transId:b.toString(),version:"1.0",features:[{featureName:"passcode",version:"1.0"},{featureName:"knockOnTheDoorParticipant",version:"1.0"},{featureName:"knockOnTheDoorModerator",version:"1.0"}],currentTime:f};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.HANDSHAKE_REQUEST,g)},buildSubscribeMeetingInfoRequest:function(b){var c={transId:b.toString()};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_MEETING_INFO_REQUEST,c)},buildSubscribeSliderRequest:function(b){var c={transId:b.toString()};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_SLIDER_REQUEST,c)},buildSubscribeActiveTalkerRequest:function(b){var c={transId:b.toString()};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_ACTIVE_TALKER_REQUEST,c)},buildSubscribePermissionsRequest:function(b){var c={transId:b.toString()};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_PERMISSIONS_REQUEST,c)},buildSubscribeMeetingNoteRequest:function(b){var c={transId:b.toString()};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_MEETING_NOTE_REQUEST,c)},buildSubscribeRosterRequest:function(b){var c={transId:b.toString()};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_ROSTER_REQUEST,c)},buildSubscribeWebCollabRequest:function(b){var c={transId:b.toString()};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_WEB_COLLAB_REQUEST,c)},buildSubscribeAvailableLayoutsRequest:function(b){var c={transId:b.toString()};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_AVAILABLE_LAYOUTS_REQUEST,c)},buildSetAsLecturerRequest:function(b,c){var d={transId:b.toString(),participantId:c};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.LECTURE_MODE_START_REQUEST,d)},buildUnsetAsLecturerRequest:function(b){var c={transId:b.toString()};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.LECTURE_MODE_STOP_REQUEST,c)},buildMuteAllRequest:function(b,c){var d={transId:b.toString(),audioMute:c.toString()};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.MUTE_ALL_REQUEST,d)},buildModeratorMuteRequest:function(b,c,d,e){var f={transId:b.toString(),participantId:c,mediaType:d,mute:e.toString()};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.MODERATOR_MUTE_REQUEST,f)},buildFeccRequest:function(b,c,d){var e={transId:b.toString(),participantId:c,action:d.toString()};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.FECC_REQUEST,e)},buildDisconnectParticipantRequest:function(b,c){var d={transId:b.toString(),participantId:c};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.DISCONNECT_PARTICIPANT_REQUEST,d)},buildLocalMuteEvent:function(b,c,d){var e={transId:b.toString(),participantId:c,audioMute:d.toString(),videoMute:"false"};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.LOCAL_MUTE_EVENT,e)},buildDisconnectEvent:function(b,c){var d={transId:b.toString(),reason:c};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.DISCONNECT_EVENT,d)},buildTerminateMeetingRequest:function(b){var c={transId:b.toString()};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.TERMINATE_MEETING_REQUEST,c)},buildStartModerationRequest:function(b,c){var d={transId:b.toString()};return a.Base.Utils.isDefined(c)&&(d.pin=c),this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.START_MODERATION_REQUEST,d)},buildUpdateCredentialsTokenRequest:function(b,c){var d={transId:b.toString(),token:c};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.UPDATE_CREDENTIALS_TOKEN_REQUEST,d)},buildDialoutRequest:function(b,c){var d={transId:b.toString(),dialTo:c};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.DIALOUT_REQUEST,d)},buildCancelDialoutRequest:function(b,c){var d={transId:b.toString(),participantId:c};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.DIALOUT_CANCEL_REQUEST,d)},buildSendChatMessage:function(b,c,d){var e={transId:b.toString(),text:c.toString(),participantId:d||"public"};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.CHAT_REQUEST,e)},buildExtendMeetingRequest:function(b,c){var d={transId:b.toString(),additionalTimeInMinutes:c.toString()};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.EXTEND_MEETING_REQUEST,d)},buildLockMeetingRequest:function(b,c){var d={transId:b.toString(),lock:c.toString()};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.LOCK_MEETING_REQUEST,d)},buildCurrentLayoutRequest:function(b){var c={transId:b.toString()};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.CURRENT_LAYOUT_REQUEST,c)},buildChangeLayoutGeometryRequest:function(b,c){var d={transId:b.toString(),geometry:c};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.CHANGE_LAYOUT_GEOMETRY_REQUEST,d)},buildChangeLayoutTextOverlayRequest:function(b,c){var d={transId:b.toString(),textOverlay:c.toString()};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.CHANGE_LAYOUT_OVERLAY_REQUEST,d)},buildChangeLayoutNoSelfSeeRequest:function(b,c){var d={transId:b.toString(),enableNoSelfSee:c.toString()};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.CHANGE_LAYOUT_NO_SELF_SEE_REQUEST,d)},buildSetRecordingRequest:function(b,c,d,e){var f={transId:b.toString(),recording:c};return a.Base.Utils.isDefined(d)&&(f.name=d),a.Base.Utils.isDefined(e)&&(f.description=e),this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.RECORDING_REQUEST,f)},buildVideoPinRequest:function(b,c,d,e,f,g){var h={transId:b.toString(),destXCord:f.toString(),destYCord:g.toString()};return a.Base.Utils.isDefined(c)?h.sourceParticipantId=c:a.Base.Utils.isDefined(d)&&a.Base.Utils.isDefined(e)&&(h.sourceXCord=d.toString(),h.sourceYCord=e.toString()),this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.VIDEO_PIN_REQUEST,h)},buildRaiseHandRequest:function(b,c){var d={transId:b.toString(),action:c};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.RAISE_HAND_REQUEST,d)},buildModeratorLowerHandRequest:function(b,c,d){var e={transId:b.toString(),participantId:c.toString(),unmuteAudio:d.toString()};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.MODERATOR_LOWER_HAND_REQUEST,e)},buildAdmissionRequest:function(b,c){var d={transId:b.toString()};return a.Base.Utils.isDefined(c)&&(d.passcode=c),this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.ADMISSION_REQUEST,d)},buildModeratorAdmissionRequest:function(b,c,d){var e={transId:b.toString(),participantId:c,action:d};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.MODERATOR_ADMISSION_REQUEST,e)},buildDialInInfoRequest:function(b){var c={transId:b.toString()};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.DIAL_IN_INFO_REQUEST,c)},buildKeepaliveRequest:function(b){var c={transId:b.toString()};return this._wrapParams(a.Providers.UCCP.UCCPMessageTypes.KEEPALIVE_REQUEST,c)},_wrapParams:function(a,b){return{protocolType:"UCCP",name:a,params:b}}},a.Providers.UCCP.UCCPMessageBuilder=b}(AvayaClientServices),function(a){"use strict";function b(){this._parsers={}}b.prototype={parse:function(a){return this._parsers[a.name]?this._parsers[a.name].parse(a):a},register:function(a,b){this._parsers[a]=b}},a.Providers.UCCP.UCCPMessageParser=b}(AvayaClientServices),function(a){"use strict";var b={HANDSHAKE_REQUEST:"handshakeRequest",HANDSHAKE_RESPONSE:"handshakeResponse",SUBSCRIBE_MEETING_INFO_REQUEST:"subscribeMeetingInfoRequest",SUBSCRIBE_MEETING_INFO_RESPONSE:"subscribeMeetingInfoResponse",SUBSCRIBE_ROSTER_REQUEST:"subscribeRosterRequest",SUBSCRIBE_ROSTER_RESPONSE:"subscribeRosterResponse",SUBSCRIBE_ACTIVE_TALKER_REQUEST:"subscribeActiveTalkerRequest",SUBSCRIBE_ACTIVE_TALKER_RESPONSE:"subscribeActiveTalkerResponse",SUBSCRIBE_PERMISSIONS_REQUEST:"subscribePermissionsRequest",SUBSCRIBE_PERMISSIONS_RESPONSE:"subscribePermissionsResponse",SUBSCRIBE_SLIDER_REQUEST:"subscribeSliderRequest",SUBSCRIBE_SLIDER_RESPONSE:"subscribeSliderResponse",SUBSCRIBE_MEETING_NOTE_REQUEST:"subscribeMeetingNoteRequest",SUBSCRIBE_MEETING_NOTE_RESPONSE:"subscribeMeetingNoteResponse",SUBSCRIBE_WEB_COLLAB_REQUEST:"subscribeWebCollabRequest",SUBSCRIBE_WEB_COLLAB_RESPONSE:"subscribeWebCollabResponse",SUBSCRIBE_AVAILABLE_LAYOUTS_REQUEST:"subscribeAvailableLayoutsRequest",SUBSCRIBE_AVAILABLE_LAYOUTS_RESPONSE:"subscribeAvailableLayoutsResponse",START_MODERATION_REQUEST:"startModerationRequest",START_MODERATION_RESPONSE:"startModerationResponse",TERMINATE_MEETING_REQUEST:"terminateMeetingRequest",TERMINATE_MEETING_RESPONSE:"terminateMeetingResponse",DIRECTORY_LOOKUP_REQUEST:"directoryLookupRequest",DIRECTORY_LOOKUP_NOTE_RESPONSE:"directoryLookupResponse",DIAL_IN_INFO_REQUEST:"dialInInfoRequest",DIAL_IN_INFO_RESPONSE:"dialInInfoResponse",DIALOUT_REQUEST:"dialoutRequest",DIALOUT_RESPONSE:"dialoutResponse",DIALOUT_CANCEL_REQUEST:"dialoutCancelRequest",DIALOUT_CANCEL_RESPONSE:"dialoutCancelResponse",DISCONNECT_PARTICIPANT_REQUEST:"disconnectParticipantRequest",DISCONNECT_PARTICIPANT_RESPONSE:"disconnectParticipantResponse",LECTURE_MODE_START_REQUEST:"lectureModeStartRequest",LECTURE_MODE_START_RESPONSE:"lectureModeStartResponse",LECTURE_MODE_STOP_REQUEST:"lectureModeStopRequest",LECTURE_MODE_STOP_RESPONSE:"lectureModeStopResponse",RECORDING_REQUEST:"recordingRequest",RECORDING_RESPONSE:"recordingResponse",LOCK_MEETING_REQUEST:"lockMeetingRequest",LOCK_MEETING_RESPONSE:"lockMeetingResponse",EXTEND_MEETING_REQUEST:"extendMeetingRequest",EXTEND_MEETING_RESPONSE:"extendMeetingResponse",MUTE_ALL_REQUEST:"muteAllRequest",MUTE_ALL_RESPONSE:"muteAllResponse",MODERATOR_MUTE_REQUEST:"moderatorMuteRequest",MODERATOR_MUTE_RESPONSE:"moderatorMuteResponse",RAISE_HAND_REQUEST:"raiseHandRequest",RAISE_HAND_RESPONSE:"raiseHandResponse",MODERATOR_LOWER_HAND_REQUEST:"moderatorLowerHandRequest",MODERATOR_LOWER_HAND_RESPONSE:"moderatorLowerHandResponse",CURRENT_LAYOUT_REQUEST:"currentLayoutRequest",CURRENT_LAYOUT_RESPONSE:"currentLayoutResponse",CHANGE_LAYOUT_GEOMETRY_REQUEST:"changeLayoutGeometryRequest",CHANGE_LAYOUT_GEOMETRY_RESPONSE:"changeLayoutGeometryResponse",CHANGE_LAYOUT_NO_SELF_SEE_REQUEST:"changeLayoutNoSelfSeeRequest",CHANGE_LAYOUT_NO_SELF_SEE_RESPONSE:"changeLayoutNoSelfSeeResponse",VIDEO_PIN_REQUEST:"videoPinRequest",VIDEO_PIN_RESPONSE:"videoPinResponse",FECC_REQUEST:"feccRequest",FECC_RESPONSE:"feccResponse",CHANGE_LAYOUT_OVERLAY_REQUEST:"changeLayoutTextOverlayRequest",CHANGE_LAYOUT_OVERLAY_RESPONSE:"changeLayoutTextOverlayResponse",CHAT_REQUEST:"chatRequest",CHAT_RESPONSE:"chatResponse",ADD_MEETING_NOTE_REQUEST:"addMeetingNoteRequest",ADD_MEETING_NOTE_RESPONSE:"addMeetingNoteResponse",UPDATE_MEETING_NOTE_REQUEST:"updateMeetingNoteRequest",UPDATE_MEETING_NOTE_RESPONSE:"updateMeetingNoteResponse",DELETE_MEETING_NOTE_REQUEST:"deleteMeetingNoteRequest",DELETE_MEETING_NOTE_RESPONSE:"deleteMeetingNoteResponse",LOGGING_REQUEST:"loggingRequest",LOGGING_RESPONSE:"loggingResponse",ADMISSION_REQUEST:"admissionRequest",ADMISSION_RESPONSE:"admissionResponse",MODERATOR_ADMISSION_REQUEST:"moderatorAdmissionRequest",MODERATOR_ADMISSION_RESPONSE:"moderatorAdmissionResponse",MOBILE_LINK_ID_REQUEST:"mobileLinkIdRequest",MOBILE_LINK_ID_RESPONSE:"mobileLinkIdResponse",MOBILE_LINK_ROOM_SYSTEM_LIST_REQUEST:"mobileLinkRoomSystemListRequest",MOBILE_LINK_ROOM_SYSTEM_LIST_RESPONSE:"mobileLinkRoomSystemListResponse",MOBILE_LINK_CHOOSE_ROOM_SYSTEM_REQUEST:"mobileLinkChooseRoomSystemRequest",MOBILE_LINK_CHOOSE_ROOM_SYSTEM_RESPONSE:"mobileLinkChooseRoomSystemResponse",MOBILE_LINK_MANUAL_CHOOSE_ROOM_SYSTEM_REQUEST:"mobileLinkManualChooseRoomSystemRequest",MOBILE_LINK_MANUAL_CHOOSE_ROOM_SYSTEM_RESPONSE:"mobileLinkManualChooseRoomSystemResponse",MOBILE_LINK_DISCONNECT_REQUEST:"mobileLinkDisconnectRequest",MOBILE_LINK_DISCONNECT_RESPONSE:"mobileLinkDisconnectResponse",UPDATE_CREDENTIALS_TOKEN_REQUEST:"updateCredentialsTokenRequest",UPDATE_CREDENTIALS_TOKEN_RESPONSE:"updateCredentialsTokenResponse",UNSUBSCRIBE_MEETING_INFO_REQUEST:"unsubscribeMeetingInfoRequest",UNSUBSCRIBE_MEETING_INFO_RESPONSE:"unsubscribeMeetingInfoResponse",UNSUBSCRIBE_ROSTER_REQUEST:"unsubscribeRosterRequest",UNSUBSCRIBE_ROSTER_RESPONSE:"unsubscribeRosterResponse",UNSUBSCRIBE_SLIDER_REQUEST:"unsubscribeSliderRequest",UNSUBSCRIBE_SLIDER_RESPONSE:"unsubscribeSliderResponse",UNSUBSCRIBE_ACTIVE_TALKER_REQUEST:"unsubscribeActiveTalkerRequest",UNSUBSCRIBE_ACTIVE_TALKER_RESPONSE:"unsubscribeActiveTalkerResponse",UNSUBSCRIBE_PERMISSIONS_REQUEST:"unsubscribePermissionsRequest",UNSUBSCRIBE_PERMISSIONS_RESPONSE:"unsubscribePermissionsResponse",UNSUBSCRIBE_MEETING_NOTE_REQUEST:"unsubscribeMeetingNoteRequest",UNSUBSCRIBE_MEETING_NOTE_RESPONSE:"unsubscribeMeetingNoteResponse",UNSUBSCRIBE_WEB_COLLAB_REQUEST:"unsubscribeWebCollabRequest",UNSUBSCRIBE_WEB_COLLAB_RESPONSE:"unsubscribeWebCollabResponse",UNSUBSCRIBE_AVAILABLE_LAYOUTS_REQUEST:"unsubscribeAvailableLayoutsRequest",UNSUBSCRIBE_AVAILABLE_LAYOUTS_RESPONSE:"unsubscribeAvailableLayoutsResponse",KEEPALIVE_REQUEST:"keepaliveRequest",KEEPALIVE_RESPONSE:"keepaliveResponse",PARTICIPANT_JOINED_EVENT:"participantJoinedEvent",PARTICIPANT_LEFT_EVENT:"participantLeftEvent",ACTIVE_TALKER_CHANGED_EVENT:"activeTalkerChangedEvent",PERMISSIONS_CHANGED_EVENT:"permissionsChangedEvent",CHAT_EVENT:"chatEvent",MEETING_NOTE_ADDED_EVENT:"meetingNoteAddedEvent",MEETING_NOTE_UPDATED_EVENT:"meetingNoteUpdatedEvent",MEETING_NOTE_DELETED_EVENT:"meetingNoteDeletedEvent",LOGGING_EVENT:"loggingEvent",MEETING_INFO_CHANGED_EVENT:"meetingInfoChangedEvent",MEETING_TERMINATION_IN_PROGRESS_EVENT:"meetingTerminationInProgressEvent",NEW_SLIDE_EVENT:"newSlideEvent",PARTICIPANT_INFO_CHANGED_EVENT:"participantInfoChangedEvent",USER_MOVED_EVENT:"userMovedEvent",DIALOUT_COMPLETED_EVENT:"dialoutCompletedEvent",LOCAL_MUTE_EVENT:"localMuteEvent",AVAILABLE_LAYOUTS_CHANGED_EVENT:"availableLayoutsChangedEvent",CURRENT_LAYOUT_CHANGED_EVENT:"currentLayoutChangedEvent",RECORDING_FAILED_EVENT:"recordingFailedEvent",MODERATOR_ADMISSION_EVENT:"moderatorAdmissionEvent",MODERATOR_ADMISSION_CANCELED_EVENT:"moderatorAdmissionCanceledEvent",WEB_COLLAB_CHANGED_EVENT:"webCollabChangedEvent",DISCONNECT_EVENT:"disconnectEvent"};a.Providers.UCCP.UCCPMessageTypes=b}(AvayaClientServices),function(a,b){"use strict";function c(a,b,c){this._networkProvider=a,this._messageBuilder=b,this._messageParser=c,this._uccpProvider={}}c.prototype={getUCCPProvider:function(){if(b.isEmptyObject(this._uccpProvider)){var c=this._createUCCP1Provider();this._uccpProvider=new a.Providers.UCCP.UCCPProvider,this._uccpProvider.registerUCCPProvider(1,c)}return this._uccpProvider},_createUCCP1Provider:function(){return new a.Providers.UCCP.UCCP1Provider(this._networkProvider,this._messageBuilder,this._messageParser)}},a.Providers.UCCP.UCCPProviderFactory=c}(AvayaClientServices,jQuery),function(a){"use strict";function b(){}b.prototype={_validateTagLength:function(b,c){var d=0;switch(c){case a.Providers.WCS.WCSScreenSharingTagTypes.BLOCK_TAG:case a.Providers.WCS.WCSScreenSharingTagTypes.START_TAG:d=14;break;case a.Providers.WCS.WCSScreenSharingTagTypes.CURSOR_TAG:d=13;break;case a.Providers.WCS.WCSScreenSharingTagTypes.END_TAG:d=1}return b>=d||(a.Base.Logger.warn(a.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"Byte array size: {0} < Min Tag length: {1} Tag type: {2}",b,d,c),!1)},_get64bitNumber:function(a){var b=a.readBytes(8);return 4294967296*b.readUnsignedInt()+b.readUnsignedInt()}},a.Providers.WCS.AbstractBinaryParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.AbstractBinaryParser.prototype),b.prototype.parse=function(b){if(this._validateTagLength(b.length,a.Providers.WCS.WCSScreenSharingTagTypes.BLOCK_TAG)){var c=new a.Providers.WCS.ScreenSharingBlockTag;if(c.width=b.readShort(),c.height=b.readShort(),c.x=b.readShort(),c.y=b.readShort(),c.imageType=b.readByte(),c.length=b.readInt(),c.length===b.getBytesAvailable())c.data=b.readBytes(c.length);else{if(c.length+4!==b.getBytesAvailable())return void a.Base.Logger.error(a.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"Invalid type "+a.Providers.WCS.WCSScreenSharingTagTypes.BLOCK_TAG+". Tried to read: "+c.length+". BytesAvailable "+b.getBytesAvailable());b.readInt(),c.data=b.readBytes(c.length)}return c}},a.Providers.WCS.BlockTagBinaryParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.AbstractBinaryParser.prototype),b.prototype.parse=function(b){if(this._validateTagLength(b.length,a.Providers.WCS.WCSScreenSharingTagTypes.CURSOR_TAG)){var c=new a.Providers.WCS.ScreenSharingCursorTag;return c.x=b.readShort(),c.y=b.readShort(),c.creationTime=this._get64bitNumber(b),c}},a.Providers.WCS.CursorTagBinaryParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.AbstractBinaryParser.prototype),
b.prototype.parse=function(b){if(this._validateTagLength(b.length,a.Providers.WCS.WCSScreenSharingTagTypes.END_TAG))return new a.Providers.WCS.ScreenSharingEndTag},a.Providers.WCS.EndTagBinaryParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.AbstractBinaryParser.prototype),b.prototype.parse=function(b){if(this._validateTagLength(b.length,a.Providers.WCS.WCSScreenSharingTagTypes.START_TAG)){var c=new a.Providers.WCS.ScreenSharingStartTag;return c.isKeyFrame=Boolean(b.readByte()),c.width=b.readShort(),c.height=b.readShort(),c.creationTime=this._get64bitNumber(b),a.Base.Logger.debug(a.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"Start Tag [keyframe={0}]: {1}x{2}",c.isKeyFrame,c.width,c.height),c}},a.Providers.WCS.StartTagBinaryParser=b}(AvayaClientServices),function(a){"use strict";function b(a){this.type=a}a.Providers.WCS.AbstractEvent=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.WCS.AbstractEvent.call(this,b),c&&(this.from=c.from,this.fromname=c.fromname,this.eventId=c.eventId,this.senderId=c.senderId,this.senderName=c.senderName,this.time=c.time,this.useragent=c.useragent,this.wsConnectionId=c.wsConnectionId,this.data={})}b.prototype=Object.create(a.Providers.WCS.AbstractEvent),a.Providers.WCS.AbstractLiveEvent=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.ADD_NOTE),this.liveEventCommonData=b,this.data=c}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.AddNoteEvent=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d,e){this.noteType=a,this.text=b,this.meetingOwner=c,this.isPersonal=d,e&&(this.targetId=e)}b.prototype={},a.Providers.WCS.AddNoteEventData=b}(AvayaClientServices),function(a){"use strict";function b(b){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.ADD_WHITEBOARD),this.liveEventCommonData=b}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.AddWhiteboardEvent=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.ALLOW_PRESENTING),this.liveEventCommonData=b,this.data=c}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.AllowPresentingEvent=b}(AvayaClientServices),function(a){"use strict";function b(a,b){this.targetId=a,this.targetName=b}b.prototype={},a.Providers.WCS.AllowPresentingEventData=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.CLEAR_DRAWING),this.liveEventCommonData=b,this.data=c}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.ClearDrawingEvent=b}(AvayaClientServices),function(a){"use strict";function b(a,b){this.groupId=a,this.layerType=b}b.prototype={},a.Providers.WCS.ClearDrawingEventData=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.DELETE_NOTE),this.liveEventCommonData=b,this.data=c}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.DeleteNoteEvent=b}(AvayaClientServices),function(a){"use strict";function b(a){this.noteId=a}b.prototype={},a.Providers.WCS.DeleteNoteEventData=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.DELETE_SELECTION),this.liveEventCommonData=b,this.data=c}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.DeleteSelectionEvent=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d,e){this.groupId=a,this.layerType=b,this.shapeId=c,this.selectionX=d,this.selectionY=e}b.prototype={},a.Providers.WCS.DeleteSelectionEventData=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.DELETE_WHITEBOARD),this.liveEventCommonData=b,this.data=c}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.DeleteWhiteboardEvent=b}(AvayaClientServices),function(a){"use strict";function b(a){this.id=a}b.prototype={},a.Providers.WCS.DeleteWhiteboardEventData=b}(AvayaClientServices),function(a){"use strict";function b(b){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.REQUEST_CONTROL),this.liveEventCommonData=b}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.DenyControlEvent=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.DENY_PRESENTING),this.liveEventCommonData=b,this.data=c}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.DenyPresentingEvent=b}(AvayaClientServices),function(a){"use strict";function b(a,b){this.targetId=a,this.targetName=b}b.prototype={},a.Providers.WCS.DenyPresentingEventData=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.DRAW_CIRCLE),this.liveEventCommonData=b,this.data=c}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.DrawCircleEvent=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d,e,f,g,h,i,j,k,l){this.alpha=a,b&&(this.fillColor=b),c&&(this.color=c),k&&(this.filled=k),l&&(this.contour=l),this.groupId=d,this.layerType=e,this.width=f,this.x0=g,this.x1=h,this.y0=i,this.y1=j}b.prototype={},a.Providers.WCS.DrawCircleEventData=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.DRAW_SHAPE),this.liveEventCommonData=b,this.data=c}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.DrawShapeEvent=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d,e,f,g,h,i,j){a&&(this.alpha=a),b&&(this.fillColor=b),c&&(this.color=c),d&&(this.groupId=d),e&&(this.layerType=e),(f||0===f)&&(this.width=f),(g||0!==g.length)&&(this.l=g),(h||0!==h.length)&&(this.m=h),j&&(this.contour=j),i&&(this.filled=i)}b.prototype={},a.Providers.WCS.DrawShapeEventData=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.DRAW_TEXT),this.liveEventCommonData=b,this.data=c}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.DrawTextEvent=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d,e,f,g){this.fillColor=a,this.fontSize=b,this.groupId=c,this.layerType=d,this.text=e||"",this.x=f,this.y=g}b.prototype={},a.Providers.WCS.DrawTextEventData=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.EJECT_PARTICIPANT),this.liveEventCommonData=b,this.data=c}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.EjectParticipantEvent=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c){this.targetId=a,this.targetName=b,this.targetParticipantId=c}b.prototype={},a.Providers.WCS.EjectParticipantEventData=b}(AvayaClientServices),function(a){"use strict";function b(b){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.END_CONTROL),this.liveEventCommonData=b}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.EndControlEvent=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.END_DRAW_SHAPE),this.liveEventCommonData=b,this.data=c}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.EndDrawShapeEvent=b}(AvayaClientServices),function(a){"use strict";function b(a,b){this.groupId=a,this.layerType=b}b.prototype={},a.Providers.WCS.EndDrawShapeEventData=b}(AvayaClientServices),function(a){"use strict";function b(b){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.END_MEETING),this.liveEventCommonData=b}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.EndMeetingEvent=b}(AvayaClientServices),function(a){"use strict";function b(b){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.END_SCREEN_SHARING,b)}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.EndScreenSharingEvent=b}(AvayaClientServices),function(a){"use strict";function b(b){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.END_WHITEBOARD),this.liveEventCommonData=b}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.EndWhiteboardEvent=b}(AvayaClientServices),function(a){"use strict";function b(b){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.ERROR),this.data=b}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.ErrorEvent=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d){this.code=a,this.message=b,this.requestId=c,this.wsConnectionId=d}b.prototype={},a.Providers.WCS.ErrorEventData=b}(AvayaClientServices),function(a){"use strict";function b(b){a.Providers.WCS.AbstractEvent.call(this,a.Providers.WCS.WCSEventTypes.FRAME_REPORT),this.data=b}b.prototype=Object.create(a.Providers.WCS.AbstractEvent.prototype),a.Providers.WCS.FrameReportEvent=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d,e,f){this.droppedFrames=a,this.droppedFramesPercentageRounded=b,this.period=c,this.successfulFrames=d,this.timeEnd=e,this.timeStart=f}b.prototype={},a.Providers.WCS.FrameReportEventData=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.GRANT_CONTROL),this.liveEventCommonData=b,this.data=c}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.GrantControlEvent=b}(AvayaClientServices),function(a){"use strict";function b(a){this.osType=a}b.prototype={},a.Providers.WCS.GrantControlEventData=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d,e,f,g,h){this.attendeeId=a,this.clientVersion=b,this.privateChatSupported=c,this.startTime=d,this.userAgent=e,this.userIp=f,this.userName=g,this.wsConnectionId=h}b.prototype={},a.Providers.WCS.LiveAttendeeEventData=b}(AvayaClientServices),function(a){"use strict";function b(b){a.Providers.WCS.AbstractEvent.call(this,a.Providers.WCS.WCSEventTypes.LIVE_ATTENDEES),this.data=b}b.prototype=Object.create(a.Providers.WCS.AbstractEvent.prototype),a.Providers.WCS.LiveAttendeesEvent=b}(AvayaClientServices),function(a){"use strict";function b(b){a.Providers.WCS.AbstractEvent.call(this,a.Providers.WCS.WCSEventTypes.LIVE_CAPABILITIES),this.data=b}b.prototype=Object.create(a.Providers.WCS.AbstractEvent.prototype),a.Providers.WCS.LiveCapabilitiesEvent=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={},a.Providers.WCS.LiveCapabilitiesEventData=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d,e,f,g,h,i){this.from=a,this.fromname=b,this.eventId=c,this.senderId=d,this.senderName=e,this.time=f,this.type=g,this.useragent=h,this.wsConnectionId=i}a.Providers.WCS.LiveEventCommonData=b}(AvayaClientServices),function(a){"use strict";function b(b){a.Providers.WCS.AbstractEvent.call(this,a.Providers.WCS.WCSEventTypes.LIVE_SESSION),this.data=b}b.prototype=Object.create(a.Providers.WCS.AbstractEvent.prototype),a.Providers.WCS.LiveSessionEvent=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d,e,f,g){this.requestId=a,this.idleTimeout=b,this.serverTimeDiff=c,this.wsConnectionId=d,this.meeting=e,this.liveAttendee=f,this.features=g}b.prototype={},a.Providers.WCS.LiveSessionEventData=b}(AvayaClientServices),function(a){"use strict";function b(b){a.Providers.WCS.AbstractEvent.call(this,a.Providers.WCS.WCSEventTypes.LIVE_VIEWER),this.data=b}b.prototype=Object.create(a.Providers.WCS.AbstractEvent.prototype),a.Providers.WCS.LiveViewerEvent=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d,e,f,g,h,i,j,k,l,m){this.brandId=a,this.wcsVersion=b,this.websocketPath=c,this.websocketCacheSize=d,this.uploadSize=e,this.uploadMaxImageSize=f,this.uploadMaxImageResolution=g,this.uploadTypes=h,this.maxDuration=i,this.eventWaitTime=j,this.uploadMaxFile=k,this.themesLocation=l,this.internalUiControls=m}b.prototype={},a.Providers.WCS.LiveViewerEventData=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.MOVE_SELECTION),this.liveEventCommonData=b,this.data=c}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.MoveSelectionEvent=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d,e,f,g){this.groupId=a,this.layerType=b,this.shapeId=c,this.moveToX=d,this.moveToY=e,this.selectionX=f,this.selectionY=g}b.prototype={},a.Providers.WCS.MoveSelectionEventData=b}(AvayaClientServices),function(a){"use strict";function b(b){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.PAUSE_SCREEN_SHARING,b)}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.PauseScreenSharingEvent=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.SEND_DOCUMENT),this.liveEventCommonData=b,this.data=c}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.SendDocumentEvent=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c){this.filename=a,this.filesize=b,this.fileurl=c}b.prototype={},a.Providers.WCS.SendDocumentEventData=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.SEND_MESSAGE),this.liveEventCommonData=b,this.data=c}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.SendMessageEvent=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d){this.message=a,this.targetName=b,this.isPrivate=c,d&&(this.targetId=d)}b.prototype={},a.Providers.WCS.SendMessageEventData=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.SEND_SLIDE),this.liveEventCommonData=b,this.data=c}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.SendSlideEvent=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d,e,f,g,h){this.count=a,this.index=b,this.title=c,this.presentationId=d,this.slideUrl=e,this.slideBaseUrl=f,this.tocUrl=g,this.includeToc=h}b.prototype={},a.Providers.WCS.SendSlideEventData=b}(AvayaClientServices),function(a){"use strict";function b(b){a.Providers.WCS.AbstractEvent.call(this,a.Providers.WCS.WCSEventTypes.SERVER_CAPABILITIES),this.data=b}b.prototype=Object.create(a.Providers.WCS.AbstractEvent.prototype),a.Providers.WCS.ServerCapabilitiesEvent=b}(AvayaClientServices),function(a){"use strict";function b(a,b){this.maxHeight=a,this.maxWidth=b}b.prototype={},a.Providers.WCS.ServerCapabilitiesEventData=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.SET_NOTE),this.liveEventCommonData=b,this.data=c}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.SetNoteEvent=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d,e,f){this.noteId=a,this.noteType=b,this.text=c,this.attendeeId=d,this.isPersonal=e,f&&(this.targetId=f)}b.prototype={},a.Providers.WCS.SetNoteEventData=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.START_DRAW_SHAPE),this.liveEventCommonData=b,this.data=c}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.StartDrawShapeEvent=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d,e){this.alpha=a,this.color=b,this.groupId=c,this.layerType=d,this.width=e}a.Providers.WCS.StartDrawShapeEventData=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.START_MEETING),this.liveEventCommonData=b,this.data=c}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.StartMeetingEvent=b}(AvayaClientServices),function(a){"use strict";function b(a){this.userkey=a}b.prototype={},a.Providers.WCS.StartMeetingEventData=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.START_SCREEN_SHARING,b),this.data=c}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.StartScreenSharingEvent=b}(AvayaClientServices),function(a){"use strict";function b(a){this.transportVersion=a}b.prototype={},a.Providers.WCS.StartScreenSharingEventData=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.WCS.AbstractLiveEvent.call(this,a.Providers.WCS.WCSEventTypes.START_WHITEBOARD),this.liveEventCommonData=b,this.data=c}b.prototype=Object.create(a.Providers.WCS.AbstractLiveEvent.prototype),a.Providers.WCS.StartWhiteboardEvent=b}(AvayaClientServices),function(a){"use strict";function b(a){this.id=a}b.prototype={},a.Providers.WCS.StartWhiteboardEventData=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={parse:function(a){throw new Error("Method not implemented!")},colorHexToInt:function(a){return parseInt("0x".concat(a.slice(1))).toString()},stringToCamel:function(a){return a.replace(/(_[a-z])/g,function(a){return a.toUpperCase().replace("_","")})}},a.Providers.WCS.AbstractParser=b}(AvayaClientServices=AvayaClientServices||{}),function(a){"use strict";function b(){this._onMessageParsedCallbacks=$.Callbacks(),this.msgHeaderDetails={headerSize:8,msgSize:3,flagSize:1,lengthIndicatorSize:4,msgTxt:"msg",binaryFlagValue:128},this._activeMsg=void 0}b.prototype.parse=function(a){if(a instanceof ArrayBuffer){var b=a.byteLength;b>0&&this._extractDataFromMsg(0,a,b)}},b.prototype.addOnMessageParsedCallback=function(a){this._onMessageParsedCallbacks.add(a)},b.prototype.removeOnMessageParsedCallback=function(a){this._onMessageParsedCallbacks.remove(a)},b.prototype._parseToString=function(a){for(var b=new Uint8Array(a),c="",d=0;d<b.length;d++)c+=String.fromCharCode(b[d]);return c},b.prototype._extractDataFromMsg=function(a,b,c){if(a<c)if(c-this.msgHeaderDetails.headerSize>=this.msgHeaderDetails.headerSize+1)if(this._parseToString(b.slice(a,a+this.msgHeaderDetails.msgSize))===this.msgHeaderDetails.msgTxt){var d=this._getMessageLength(b.slice(a+this.msgHeaderDetails.msgSize+this.msgHeaderDetails.flagSize,a+this.msgHeaderDetails.headerSize)),e=b.slice(a+this.msgHeaderDetails.headerSize,a+this.msgHeaderDetails.headerSize+d),f=this._isMsgBinary(b.slice(a+this.msgHeaderDetails.msgSize,a+this.msgHeaderDetails.msgSize+this.msgHeaderDetails.flagSize));f||(e=this._parseToString(e)),d+this.msgHeaderDetails.headerSize+a<=c?(this._onMessageParsedCallbacks.fire({data:e}),this._extractDataFromMsg(d+this.msgHeaderDetails.headerSize+a,b,c)):this._activeMsg=b.slice(a,c)}else{var g=this._concatBuffers(this._activeMsg,b);this._extractDataFromMsg(0,g,g.byteLength)}else this._activeMsg=b.slice(a,c)},b.prototype._isMsgBinary=function(a){return 0===new Uint8Array(a)[0]},b.prototype._getMessageLength=function(a){for(var b=new Uint8Array(a),c=0,d=0;d<this.msgHeaderDetails.lengthIndicatorSize;++d)c+=b[d],d<this.msgHeaderDetails.lengthIndicatorSize-1&&(c<<=8);return c},b.prototype._concatBuffers=function(a,b){var c=new Uint8Array(a.byteLength+b.byteLength);return c.set(new Uint8Array(a),0),c.set(new Uint8Array(b),a.byteLength),c.buffer},a.Providers.WCS.CometParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.AbstractParser.prototype),b.prototype.parse=function(b){var c={};c.droppedFrames=a.Base.Utils.queryJSONObject(b,"dropped_frames[0]._text"),c.droppedFramesPercentageRounded=a.Base.Utils.queryJSONObject(b,"dropped_frames_percentage_rounded[0]._text"),c.period=a.Base.Utils.queryJSONObject(b,"period[0]._text"),c.successfulFrames=a.Base.Utils.queryJSONObject(b,"successful_frames[0]._text"),c.timeEnd=a.Base.Utils.queryJSONObject(b,"time_end[0]._text"),c.timeStart=a.Base.Utils.queryJSONObject(b,"time_start[0]._text");var d=new a.Providers.WCS.FrameReportEventData(c.droppedFrames,c.droppedFramesPercentageRounded,c.period,c.successfulFrames,c.timeEnd,c.timeStart);return new a.Providers.WCS.FrameReportEvent(d)},a.Providers.WCS.FrameReportParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.AbstractParser.prototype),b.prototype.parse=function(b){for(var c={liveAttendees:[]},d=0;d<b.live_attendee.length;d++){var e=a.Base.Utils.queryJSONObject(b.live_attendee[d],"attendee_id[0]._text"),f=a.Base.Utils.queryJSONObject(b.live_attendee[d],"client_version[0]._text"),g=a.Base.Utils.queryJSONObject(b.live_attendee[d],"private_chat_supported[0]._text"),h=a.Base.Utils.queryJSONObject(b.live_attendee[d],"start_time[0]._text"),i=a.Base.Utils.queryJSONObject(b.live_attendee[d],"user_agent[0]._text"),j=a.Base.Utils.queryJSONObject(b.live_attendee[d],"user_ip[0]._text"),k=a.Base.Utils.queryJSONObject(b.live_attendee[d],"user_name[0]._text"),l=a.Base.Utils.queryJSONObject(b.live_attendee[d],"ws_connection_id[0]._text");c.liveAttendees.push(new a.Providers.WCS.LiveAttendeeEventData(e,f,g,h,i,j,k,l))}return new a.Providers.WCS.LiveAttendeesEvent(c)},a.Providers.WCS.LiveAttendeesParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.AbstractParser.prototype),b.prototype.parse=function(b){var c=new a.Providers.WCS.LiveCapabilitiesEventData;return new a.Providers.WCS.LiveCapabilitiesEvent(c)},a.Providers.WCS.LiveCapabilitiesParser=b}(AvayaClientServices),function(a){"use strict";function b(){}var c={whiteboard:"whiteboard_",slide:"slide_"};b.prototype=Object.create(a.Providers.WCS.AbstractParser.prototype),b.prototype.stripCommonData=function(b){var c={};return $.each(b._attr,function(a,b){c[this.stringToCamel(a)]=b._value}.bind(this)),new a.Providers.WCS.LiveEventCommonData(c.from,c.fromname,c.id,c.senderId,c.senderName,c.time,c.type,c.useragent,c.wsConnectionId)},b.prototype.convertGroup=function(b){var d;if($.each(c,function(a,c){if(0===b.indexOf(c))return d={groupId:parseInt(b.split(c)[1]),layerType:a},!1}.bind(this)),d)return d;a.Base.Logger.error(a.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"Unknown group prefix type!")},a.Providers.WCS.LiveEventParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.AbstractParser.prototype),b.prototype.parse=function(b){var c={request_id:a.Base.Utils.queryJSONObject(b,"request_id[0]._text"),idle_timeout:a.Base.Utils.queryJSONObject(b,"idle_timeout[0]._text"),ws_connection_id:a.Base.Utils.queryJSONObject(b,"ws_connection_id[0]._text"),server_time_diff:a.Base.Utils.queryJSONObject(b,"server_time_diff[0]._text")},d={},e={attendeeId:a.Base.Utils.queryJSONObject(b,"attendee_id[0]._text"),userName:a.Base.Utils.queryJSONObject(b,"username[0]._text")},f={},g=new a.Providers.WCS.LiveSessionEventData(c.request_id,c.idle_timeout,c.ws_connection_id,c.server_time_diff,d,e,f);return new a.Providers.WCS.LiveSessionEvent(g)},a.Providers.WCS.LiveSessionParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.AbstractParser.prototype),b.prototype.parse=function(b){var c=new a.Providers.WCS.LiveViewerEventData(a.Base.Utils.queryJSONObject(b,"brand_id[0]._text"),a.Base.Utils.queryJSONObject(b,"wcs_version[0]._text"),a.Base.Utils.queryJSONObject(b,"websocket_path[0]._text"),+a.Base.Utils.queryJSONObject(b,"websocket_cache_size[0]._text"),+a.Base.Utils.queryJSONObject(b,"upload_size[0]._text"),+a.Base.Utils.queryJSONObject(b,"upload_max_image_size[0]._text"),+a.Base.Utils.queryJSONObject(b,"upload_max_image_resolution[0]._text"),a.Base.Utils.queryJSONObject(b,"upload_types[0]._text"),+a.Base.Utils.queryJSONObject(b,"max_duration[0]._text"),+a.Base.Utils.queryJSONObject(b,"event_wait_time[0]._text"),+a.Base.Utils.queryJSONObject(b,"upload_max_file[0]._text"),a.Base.Utils.queryJSONObject(b,"themes_location[0]._text"),"true"===a.Base.Utils.queryJSONObject(b,"internal_ui_controls[0]._text"));return new a.Providers.WCS.LiveViewerEvent(c)},a.Providers.WCS.LiveViewerParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){var c={};if(b.selection[0]._attr&&$.each(b.selection[0]._attr,function(a,b){c[this.stringToCamel(a)]=b._value}.bind(this)),c.group){var d=this.convertGroup(c.group);c.layerType=d.layerType,c.groupId=d.groupId,delete c.group}var e=new a.Providers.WCS.MoveSelectionEventData(c.groupId,c.layerType,c.id,c.moveToX,c.moveToY,c.selectionX,c.selectionY);return new a.Providers.WCS.MoveSelectionEvent(this.stripCommonData(b),e)},a.Providers.WCS.MoveSelectionParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){return new a.Providers.WCS.PauseScreenSharingEvent(this.stripCommonData(b))},a.Providers.WCS.PauseScreenSharingParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){var c={};c.filename=a.Base.Utils.queryJSONObject(b,"documentinfo[0]._attr.filename._value"),c.filesize=a.Base.Utils.queryJSONObject(b,"documentinfo[0]._attr.filesize._value"),c.fileurl=a.Base.Utils.queryJSONObject(b,"documentinfo[0]._attr.fileurl._value");var d=new a.Providers.WCS.SendDocumentEventData(c.filename,c.filesize,c.fileurl);return new a.Providers.WCS.SendDocumentEvent(this.stripCommonData(b),d)},a.Providers.WCS.SendDocumentParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){var c={};b.message&&(c.message=a.Base.Utils.queryJSONObject(b,"message[0]._text")),c.targetName=a.Base.Utils.queryJSONObject(b,"_attr.target_name._value"),b._attr.target_id?(c.targetId=a.Base.Utils.queryJSONObject(b,"_attr.target_id._value"),c.private=!0):c.private=!1;var d=new a.Providers.WCS.SendMessageEventData(c.message,c.targetName,c.private,c.targetId);return new a.Providers.WCS.SendMessageEvent(this.stripCommonData(b),d)},a.Providers.WCS.SendMessageParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){var c={},d=a.Base.Utils.queryJSONObject(b,"slide[0]._attr");c.count=d.count._value,c.index=d.index._value,c.title=d.title._value,c.presentationId=d.presentationid._value,c.slideUrl=d.slideurl._value,c.slideBaseUrl=d.slideurl._value,c.tocUrl=d.toc._value,c.includeToc="true"===d.includetoc._value;var e=new a.Providers.WCS.SendSlideEventData(c.count,c.index,c.title,c.presentationId,c.slideUrl,c.slideBaseUrl,c.tocUrl,c.includeToc);return new a.Providers.WCS.SendSlideEvent(this.stripCommonData(b),e)},a.Providers.WCS.SendSlideParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.AbstractParser.prototype),b.prototype.parse=function(b){var c=a.Base.Utils.queryJSONObject(b,"server_capabilities[0].max_frame_height[0]._text"),d=a.Base.Utils.queryJSONObject(b,"server_capabilities[0].max_frame_width[0]._text"),e=new a.Providers.WCS.ServerCapabilitiesEventData(c,d);return new a.Providers.WCS.ServerCapabilitiesEvent(e)},a.Providers.WCS.ServerCapabilitiesParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){var c={};b.note&&(c.type=a.Base.Utils.queryJSONObject(b,"note[0]._attr.type._value"),c.text=a.Base.Utils.queryJSONObject(b,"note[0]._text"),c.noteId=a.Base.Utils.queryJSONObject(b,"note[0]._attr.event_id._value"),c.attendeeId=a.Base.Utils.queryJSONObject(b,"note[0]._attr.attende_id._value")),b._attr.target_id?(c.targetId=a.Base.Utils.queryJSONObject(b,"_attr.target_id._value"),c.personal=!0):c.personal=!1;var d=new a.Providers.WCS.SetNoteEventData(c.noteId,c.type,c.text,c.attendeeId,c.personal,c.targetId);return new a.Providers.WCS.SetNoteEvent(this.stripCommonData(b),d)},a.Providers.WCS.SetNoteParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){var c={};if(b.lines[0]._attr&&$.each(b.lines[0]._attr,function(a,b){c[this.stringToCamel(a)]=b._value}.bind(this)),a.Base.Utils.isDefined(c.color)&&(c.color=a.Base.Utils.colorIntToHex(c.color)),c.group){var d=this.convertGroup(c.group);c.layerType=d.layerType,c.groupId=d.groupId,delete c.group}var e=new a.Providers.WCS.StartDrawShapeEventData(c.alpha,c.color,c.groupId,c.layerType,c.width);return new a.Providers.WCS.StartDrawShapeEvent(this.stripCommonData(b),e)},a.Providers.WCS.StartDrawShapeParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){var c="173621",d=new a.Providers.WCS.StartMeetingEventData(c);return new a.Providers.WCS.StartMeetingEvent(this.stripCommonData(b),d)},a.Providers.WCS.StartMeetingParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){var c=a.Base.Utils.queryJSONObject(b,"transport_version[0]._text"),d=new a.Providers.WCS.StartScreenSharingEventData(c);return new a.Providers.WCS.StartScreenSharingEvent(this.stripCommonData(b),d)},a.Providers.WCS.StartScreenSharingParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){var c=a.Base.Utils.queryJSONObject(b,"whiteboard[0]._attr.index._value"),d=new a.Providers.WCS.StartWhiteboardEventData(c);return new a.Providers.WCS.StartWhiteboardEvent(this.stripCommonData(b),d)},a.Providers.WCS.StartWhiteboardParser=b}(AvayaClientServices),function(a){"use strict";function b(a){this._position=0,this._buffer=a,this.length=this._buffer.byteLength}b.prototype={getBuffer:function(){return this._buffer},setPosition:function(a){this._position=a},getPosition:function(){return this._position},getBytesAvailable:function(){return this._buffer.byteLength-this._position},readBytes:function(b){var c=new a.Providers.WCS.ByteArray(this._buffer.slice(this._position,this._position+b));return this._position+=b,c},readByte:function(){var a=new Int8Array(this._buffer.slice(this._position,this._position+1));return this._position++,a[0]},readUnsignedInt:function(){var a=new DataView(this._buffer.slice(this._position,this._position+4));return this._position+=4,a.getUint32(0)},readShort:function(){var a=new DataView(this._buffer.slice(this._position,this._position+2));return this._position+=2,a.getInt16(0)},readInt:function(){var a=new DataView(this._buffer.slice(this._position,this._position+4));return this._position+=4,a.getInt32(0)}},a.Providers.WCS.ByteArray=b}(AvayaClientServices),function(a){"use strict";function b(){this._bitmapElements=[],this.width=0,this.height=0,
this.isKeyFrame=!1}b.prototype={setStartTag:function(a){return this.width=a.width,this.height=a.height,this.isKeyFrame=a.isKeyFrame,this},addBitmapElement:function(a){return this._bitmapElements.push(a),this}},a.Providers.WCS.Frame=b}(AvayaClientServices),function(a){"use strict";function b(a){this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height,this.bitmapData=a.data.getBuffer(),this.imageType=a.imageType}b.prototype={},a.Providers.WCS.FrameBitmapLoader=b}(AvayaClientServices),function(a){"use strict";function b(){this._frame=void 0}b.prototype={processTag:function(b,c){switch(b.type){case a.Providers.WCS.WCSScreenSharingTagTypes.START_TAG:this._startFrame(b);break;case a.Providers.WCS.WCSScreenSharingTagTypes.BLOCK_TAG:this._addBinaryBlock(b);break;case a.Providers.WCS.WCSScreenSharingTagTypes.END_TAG:this._endFrame(c);break;default:a.Base.Logger.warn(a.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"Unknown tag type received: {0}",b.type)}},_startFrame:function(b){a.Base.Logger.debug(a.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"Add start Tag"),this._frame=new a.Providers.WCS.Frame,this._frame.setStartTag(b)},_addBinaryBlock:function(b){if(this._frame&&b.data.length>0){var c=new a.Providers.WCS.FrameBitmapLoader(b);this._frame.addBitmapElement(c)}},_endFrame:function(b){this._frame?(a.Base.Logger.debug(a.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"Add End Tag - end Frame",this._frame._bitmapElements.length),b(this._frame),this._frame=void 0):a.Base.Logger.debug(a.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"There was no Start Tag for this End Tag")}},a.Providers.WCS.FrameBuilder=b}(AvayaClientServices),function(a){"use strict";var b={JPEG:0,PNG:1};a.Providers.WCS.ScreenSharingImageTypes=b}(AvayaClientServices),function(a){"use strict";var b={INTRA_FRAME:0,KEY_FRAME:1};a.Providers.WCS.ScreenSharingKeyFrameTypes=b}(AvayaClientServices),function(a){"use strict";function b(){}a.Providers.WCS.ScreenSharingTagEncoder=b,a.Providers.WCS.ScreenSharingTagEncoder.prototype={encodeTag:function(b){switch(b.type){case a.Providers.WCS.WCSScreenSharingTagTypes.START_TAG:return this._encodeStartFrame(b);case a.Providers.WCS.WCSScreenSharingTagTypes.BLOCK_TAG:return this._encodeBinaryBlock(b);case a.Providers.WCS.WCSScreenSharingTagTypes.END_TAG:return this._encodeEndFrame();default:a.Base.Logger.warn(a.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"Unknown tag type received: {0}",b.type)}},_encodeStartFrame:function(b){var c=new ArrayBuffer(14),d=new DataView(c);d.setInt8(0,a.Providers.WCS.WCSScreenSharingTagTypes.START_TAG),d.setInt8(1,b.isKeyFrame?a.Providers.WCS.ScreenSharingKeyFrameTypes.KEY_FRAME:a.Providers.WCS.ScreenSharingKeyFrameTypes.INTRA_FRAME),d.setInt16(2,b.width),d.setInt16(4,b.height);for(var e=this._getCurrentTimeStamp(b.creationTime),f=0;f<e.length;f++)d.setInt8(6+f,e[f]);return c},_encodeBinaryBlock:function(b){var c=new ArrayBuffer(18+b.data.length),d=new Uint8Array(c),e=new DataView(c);return e.setInt8(0,a.Providers.WCS.WCSScreenSharingTagTypes.BLOCK_TAG),e.setInt16(1,b.width),e.setInt16(3,b.height),e.setInt16(5,b.x),e.setInt16(7,b.y),e.setInt8(9,b.imageType),0===b.length?e.setInt32(10,b.data.length):e.setInt32(10,b.length),e.setInt32(14,0),d.set(b.data,18),c},_encodeEndFrame:function(){var b=new ArrayBuffer(1);return new DataView(b).setInt8(0,a.Providers.WCS.WCSScreenSharingTagTypes.END_TAG),b},_getCurrentTimeStamp:function(a){var b=this._longToByteArray(a);return b.reverse(),b},_longToByteArray:function(a){for(var b=[0,0,0,0,0,0,0,0],c=0;c<b.length;c++){var d=255&a;b[c]=d,a=(a-d)/256}return b}}}(AvayaClientServices),function(a){"use strict";var b={START_TAG:0,BLOCK_TAG:1,CURSOR_TAG:2,END_TAG:3};a.Providers.WCS.WCSScreenSharingTagTypes=b}(AvayaClientServices),function(a){"use strict";function b(a){this.type=a}a.Providers.WCS.WCSSharingTag=b}(AvayaClientServices),function(a){"use strict";function b(){this._parsers={}}b.prototype={parse:function(b){var c;if(b.byteLength>0){var d=new a.Providers.WCS.ByteArray(b),e=d.readByte(),f=e>>4,g=15&e;this._parsers[f]&&this._parsers[f][g]&&(c=this._parsers[f][g].parse(d))}else a.Base.Logger.warn(a.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"Buffer length = 0. Parse process skipped.");return c},registerParser:function(a,b,c){this._parsers[a]||(this._parsers[a]={}),this._parsers[a][b]=c}},a.Providers.WCS.WCSBinaryParser=b}(AvayaClientServices),function(a){"use strict";function b(a){this._frameBuilder=a,this._lastPoint=void 0,this._timeout=void 0}b.prototype={updateFrame:function(b,c){this._frameBuilder.processTag(c,function(c){var d=c._bitmapElements.map(function(b){return new a.Services.Collaboration.Bitmap(b.x,b.y,b.width,b.height,b.imageType,b.bitmapData)}),e=new a.Services.Collaboration.Frame(c.width,c.height,d,c.isKeyFrame);e.isKeyFrame()?b._contentSharing._onFrameReceivedCallbacks.fire(b._contentSharing,e):b._contentSharing._onFrameChangedCallbacks.fire(b._contentSharing,e)}.bind(this))},updateCursor:function(b,c){this._lastPoint=new a.Services.Collaboration.Point(c.x,c.y),this._timeout||(this._timeout=setTimeout(function(){b._contentSharing._onCursorReceivedCallbacks.fire(b._contentSharing,this._lastPoint),this._timeout=void 0}.bind(this),100))},startScreenSharing:function(b,c){var d=this._getParticipant(b,c);b._contentSharing._contentSharingService._sharingState=a.Services.Collaboration.ContentSharingState.SHARING,!0===b._contentSharing._isPaused?(b._contentSharing._isPaused=!1,b._contentSharing._onContentSharingResumedCallbacks.fire(b._contentSharing,d)):b._contentSharing._onContentSharingStartedCallbacks.fire(b._contentSharing,d)},pauseScreenSharing:function(b,c){b._contentSharing._isPaused=!0;var d=this._getParticipant(b,c);b._contentSharing._contentSharingService._sharingState=a.Services.Collaboration.ContentSharingState.PAUSED,b._contentSharing._onContentSharingPausedCallbacks.fire(b._contentSharing,d)},endScreenSharing:function(b,c){var d=this._getParticipant(b,c);b._contentSharing._isPaused=!1,b._contentSharing._contentSharingService._sharingState=a.Services.Collaboration.ContentSharingState.NOT_SHARING,b._contentSharing._onContentSharingEndedCallbacks.fire(b._contentSharing,d)},frameReport:function(a,b){a._contentSharing._onFrameReportReceivedCallbacks.fire(a._contentSharing,b)},_getParticipant:function(b,c){var d=b._participants.filter(function(a){return a.getParticipantId()===c.senderId})[0];return d||(d=new a.Services.Collaboration.Participant(c.senderId,c.senderName),b._participants.push(d)),d}},a.Providers.WCS.WCSContentSharingHandler=b}(AvayaClientServices),function(a){"use strict";var b={START_WHITEBOARD:"StartWhiteboard",ADD_WHITEBOARD:"AddWhiteboard",DELETE_WHITEBOARD:"DeleteWhiteboard",START_DRAW_SHAPE:"StartDrawShape",DRAW_SHAPE:"DrawShape",END_DRAW_SHAPE:"EndDrawShape",DRAW_CIRCLE:"DrawCircle",DRAW_TEXT:"DrawText",MOVE_SELECTION:"MoveSelection",DELETE_SELECTION:"DeleteSelection",CLEAR_DRAWING:"ClearDrawing",END_WHITEBOARD:"EndWhiteboard",SEND_SLIDE:"SendSlide",END_PRESENTATION:"EndPresentation",SEND_MESSAGE:"SendMessage",ADD_NOTE:"AddNote",SET_NOTE:"SetNote",DELETE_NOTE:"DeleteNote",START_SCREEN_SHARING:"StartScreenSharing",PAUSE_SCREEN_SHARING:"PauseScreenSharing",END_SCREEN_SHARING:"EndScreenSharing",REQUEST_CONTROL:"RequestControl",GRANT_CONTROL:"GrantControl",START_CONTROL:"StartControl",DECLINE_CONTROL:"DeclineControl",DENY_CONTROL:"DenyControl",SEND_DOCUMENT:"SendDocument",END_CONTROL:"EndControl",ALLOW_PRESENTING:"AllowPresenting",DENY_PRESENTING:"DenyPresenting",EJECT_PARTICIPANT:"EjectParticipant",START_MEETING:"StartMeeting",END_MEETING:"EndMeeting",DRAW_CURSOR:"DrawCursor",DRAW_FRAME:"DrawFrame",LIVE_VIEWER:"LiveViewer",FRAME_REPORT:"FrameReport",ERROR:"Error",LIVE_SESSION:"LiveSession",LIVE_ATTENDEES:"LiveAttendees",LIVE_ATTENDEE:"LiveAttendee",LIVE_CAPABILITIES:"LiveCapabilities",SERVER_CAPABILITIES:"ServerCapabilities"};a.Providers.WCS.WCSEventTypes=b}(AvayaClientServices),function(a,b){"use strict";function c(){this.parsers=[]}c.prototype={register:function(a,b){this.parsers[a]=b},unregister:function(a){this.parsers[a]=void 0},parse:function(c){var d;"string"==typeof c?d=b.parseString(c):"object"==typeof c&&(d=c);var e,f=d.response[0],g=[];if(f.error){e=a.Providers.WCS.WCSEventTypes.ERROR;var h=f.error[0];return g.push(this.delegateParser(e,h)),g}if(f.live_events)return f.live_events[0]&&f.live_events[0].event&&$.each(f.live_events[0].event,function(a,b){e=b._attr.type._value;var c=this.delegateParser(e,b);void 0!==c&&g.push(c)}.bind(this)),g;if(f.live_event||f.live_ping)return[];if(f.live_session)return e=a.Providers.WCS.WCSEventTypes.LIVE_SESSION,g.push(this.delegateParser(e,f.live_session[0])),g;if(f.frame_report)return e=a.Providers.WCS.WCSEventTypes.FRAME_REPORT,g.push(this.delegateParser(e,f.frame_report[0])),g;if(f.live_viewer)return e=a.Providers.WCS.WCSEventTypes.LIVE_VIEWER,g.push(this.delegateParser(e,f.live_viewer[0])),g;if(f.live_capabilities)return e=a.Providers.WCS.WCSEventTypes.LIVE_CAPABILITIES,g.push(this.delegateParser(e,f.live_capabilities[0])),g;if(f.live_attendees)return e=a.Providers.WCS.WCSEventTypes.LIVE_ATTENDEES,g.push(this.delegateParser(e,f.live_attendees[0])),g;throw new Error("No parser specified!")},delegateParser:function(b,c){if(void 0!==this.parsers[b])return this.parsers[b].parse(c);a.Base.Logger.error(a.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"No parser specified!",b)}},a.Providers.WCS.WCSEventsParser=c}(AvayaClientServices,xmlToJSON),function(a){"use strict";function b(){this._config=void 0,this._participant=void 0,this._meetingId=void 0}b.prototype={buildDrawCircleMessage:function(b,c,d,e,f){var g=this._buildDrawCircleEventData(b,c);return this._decorateRequest(a.Providers.WCS.WCSEventTypes.DRAW_CIRCLE,d,e,f,g)},buildResourceDiscoveryMessage:function(a,b,c,d,e){return{mode:a,meeting_id:b,participant_id:c,username:d,token:e}},buildMoveSelectionMessage:function(b,c,d,e,f,g,h){var i=this._buildMoveSelectionEventData(b,c,d,e);return this._decorateRequest(a.Providers.WCS.WCSEventTypes.MOVE_SELECTION,f,g,h,i)},buildDrawShapeMessage:function(b,c,d,e,f){var g=this._buildDrawShapeEventData(b,c);return this._decorateRequest(a.Providers.WCS.WCSEventTypes.DRAW_SHAPE,d,e,f,g)},buildLiveDrawShapeMessage:function(b,c,d,e,f){var g=this._buildLiveDrawShapeEventData(b,c);return this._decorateRequest(a.Providers.WCS.WCSEventTypes.DRAW_SHAPE,d,e,f,g)},buildFirstPointLiveDrawShapeMessage:function(b,c,d,e){var f=this._buildFirstPointLiveDrawShapeEventData(b);return this._decorateRequest(a.Providers.WCS.WCSEventTypes.DRAW_SHAPE,c,d,e,f)},buildStartDrawShapeMessage:function(b,c,d,e,f){var g=this._buildStartDrawShapeEventData(b,c);return this._decorateRequest(a.Providers.WCS.WCSEventTypes.START_DRAW_SHAPE,d,e,f,g)},buildEndDrawShapeMessage:function(b,c,d,e,f){var g=this._buildEndDrawShapeEventData(b,c);return this._decorateRequest(a.Providers.WCS.WCSEventTypes.END_DRAW_SHAPE,d,e,f,g)},buildDrawTextMessage:function(b,c,d,e,f){var g=this._buildDrawTextEventData(b,c);return this._decorateRequest(a.Providers.WCS.WCSEventTypes.DRAW_TEXT,d,e,f,g)},buildAddWhiteboardMessage:function(b,c,d){return this._decorateRequest(a.Providers.WCS.WCSEventTypes.ADD_WHITEBOARD,b,c,d)},buildEndWhiteboardMessage:function(b,c,d){return this._decorateRequest(a.Providers.WCS.WCSEventTypes.END_WHITEBOARD,b,c,d)},buildRemoveWhiteboardMessage:function(b,c,d,e){var f='<whiteboard index="'+b+'"/>';return this._decorateRequest(a.Providers.WCS.WCSEventTypes.DELETE_WHITEBOARD,c,d,e,f)},buildStartWhiteboardMessage:function(b,c,d,e){var f='<whiteboard index="';return a.Base.Utils.isDefined(e)&&(f+=e),f+='"/>',this._decorateRequest(a.Providers.WCS.WCSEventTypes.START_WHITEBOARD,b,c,d,f)},buildLiveEventMessage:function(a,b,c,d){return this._decorateRequest(a,b,c,d)},buildStartScreenSharingMessage:function(b,c,d){return this._decorateRequest(a.Providers.WCS.WCSEventTypes.START_SCREEN_SHARING,b,c,d,"<transport_version>1</transport_version>")},buildStopScreenSharingMessage:function(b,c,d){return this._decorateRequest(a.Providers.WCS.WCSEventTypes.END_SCREEN_SHARING,b,c,d)},buildPauseScreenSharingMessage:function(b,c,d){return this._decorateRequest(a.Providers.WCS.WCSEventTypes.PAUSE_SCREEN_SHARING,b,c,d)},buildClearContentMessage:function(b,c,d,e){var f='<selection group="whiteboard_'+b+'"/>';return this._decorateRequest(a.Providers.WCS.WCSEventTypes.CLEAR_DRAWING,c,d,e,f)},buildGetParticipantsMessage:function(b){return"live_attendees?rc_only="+!!b+"&request_id="+a.Base.Utils.makeId(32,"abcdefgijklmnopqrstuvwxyz0123456789")},_buildMoveSelectionEventData:function(a,b,c,d){var e=a.getTranslation();return'<selection group="whiteboard_'+b+'" id="'+a.getId()+'" moveToX="'+e.getX()+'" moveToY="'+e.getY()+'" selectionX="'+c+'" selectionY="'+d+'"/>'},buildDeleteSelectionMessage:function(b,c,d,e,f,g,h){var i=this._buildDeleteSelectionEventData(b,c,d,e);return this._decorateRequest(a.Providers.WCS.WCSEventTypes.DELETE_SELECTION,f,g,h,i)},buildPauseMessage:function(){return"live_capabilities?sharing_reception=false&request_id="+a.Base.Utils.makeId(32,"0123456789abcdef")},buildResumeMessage:function(){return"live_capabilities?sharing_reception=true&request_id="+a.Base.Utils.makeId(32,"0123456789abcdef")},_buildDeleteSelectionEventData:function(a,b,c,d){return'<selection group="whiteboard_'+b+'" id="'+a._id+'" selectionX="'+c+'" selectionY="'+d+'"/>'},_buildDrawCircleEventData:function(a,b){var c='<circle alpha="'+a.getAlpha()+'" group="whiteboard_'+b+'" x0="'+a.getTopLeft().getX()+'" x1="'+a.getBottomRight().getX()+'" y0="'+a.getTopLeft().getY()+'" y1="'+a.getBottomRight().getY()+'"';return a.isFilled()?c+=' fillColor="'+a.getColor()+'"':c+=' color="'+a.getColor()+'"',c=c+' width="'+a.getWidth()+'" />'},_buildDrawShapeEventData:function(a,b){var c='<lines group="whiteboard_'+b+'" alpha="'+a.getAlpha()+'" width="'+a.getWidth()+'"';a.isFilled()?c+=' fillColor="'+a.getColor()+'"':c+=' color="'+a.getColor()+'"',c+=">";var d=0,e=a.getPoints();for(d;d<e.length;d++){var f=e[d];f.isMove?c+='<m x="'+f.point.getX()+'" y="'+f.point.getY()+'"/>':c+='<l x="'+f.point.getX()+'" y="'+f.point.getY()+'"/>'}return c+="</lines>"},_buildFirstPointLiveDrawShapeEventData:function(a){return'<m x="'+a.getX()+'" y="'+a.getY()+'"/>'},_buildLiveDrawShapeEventData:function(a,b){var c="",d=0;for(a[0].isMove&&(d=1,c+='<m x="'+a[0].point.getX()+'" y="'+a[0].point.getY()+'"/>'),c+='<lines group="whiteboard_'+b+'">',d;d<a.length;d++){var e=a[d];e.isMove?c+='<m x="'+e.point.getX()+'" y="'+e.point.getY()+'"/>':c+='<l x="'+e.point.getX()+'" y="'+e.point.getY()+'"/>'}return c+="</lines>"},_buildStartDrawShapeEventData:function(a,b){var c='<lines group="whiteboard_'+b+'" alpha="'+a.getAlpha()+'" width="'+a.getWidth()+'"';return a.isFilled()?c+=' fillColor="'+a.getColor()+'"':c+=' color="'+a.getColor()+'"',c+="/>"},_buildEndDrawShapeEventData:function(a,b){return'<lines group="whiteboard_'+b+'"/>'},_buildDrawTextEventData:function(a,b){return'<drawText fillColor="'+a.getColor()+'" fontSize="'+a.getFontSize()+'" group="whiteboard_'+b+'" text="'+this._escapeXMLSpecialChars(a.getContent())+'" x="'+a.getPosition().getX()+'" y="'+a.getPosition().getY()+'"/>'},_translateColor:function(a){return parseInt("0x".concat(a.slice(1))).toString()},_decorateRequest:function(b,c,d,e,f){return"live_event"+(f?"?event_data="+encodeURIComponent(f)+"&":"?")+"event_type="+b+"&meeting_id="+c+"&sender_id="+d+"&sender_name="+e+"&request_id="+a.Base.Utils.makeId(32,"0123456789abcdef")},_escapeXMLSpecialChars:function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/\n/g,"&#xA;")}},a.Providers.WCS.WCSMessageBuilder=b}(AvayaClientServices),function(a){"use strict";function b(){a.Providers.Interfaces.CollaborationProvider.call(this),this._providers=[],this._selectedProvider=void 0,this._config={}}b.prototype=Object.create(a.Providers.Interfaces.CollaborationProvider.prototype),b.prototype.stop=function(){return a.Base.Utils.isDefined(this._selectedProvider)?this._selectedProvider.stop():$.Deferred().resolve().promise()},b.prototype.registerWCSProvider=function(a,b){this._providers.push({version:a,provider:b})},b.prototype.start=function(a,b){return $.isEmptyObject(a)||this._config===a||(this._config=a.wcsConfiguration),this._selectedProvider=this._providers[0].provider,this._selectedProvider.start(a.wcsConfiguration,b)},b.prototype.on=function(a,b){this._selectedProvider.on(a,b)},b.prototype.off=function(a,b){this._selectedProvider.off(a,b)},b.prototype.getReceivingBitrate=function(){return this._selectedProvider.getReceivingBitrate()},b.prototype.getBufferedAmount=function(){return this._selectedProvider.getBufferedAmount()},b.prototype.addCircle=function(a,b){return this._selectedProvider.addCircle(a,b)},b.prototype.pause=function(){return this._selectedProvider.pause()},b.prototype.resume=function(){return this._selectedProvider.resume()},b.prototype.addText=function(a,b){return this._selectedProvider.addText(a,b)},b.prototype.addShape=function(a,b){return this._selectedProvider.addShape(a,b)},b.prototype.discoverResources=function(a){return this._selectedProvider.discoverResources(a)},b.prototype.startDrawShape=function(a,b){return this._selectedProvider.startDrawShape(a,b)},b.prototype.liveDrawShape=function(a,b){return this._selectedProvider.liveDrawShape(a,b)},b.prototype.endDrawShape=function(a,b){return this._selectedProvider.endDrawShape(a,b)},b.prototype.moveSelection=function(a,b,c){return this._selectedProvider.moveSelection(a,b,c)},b.prototype.observeCollaboration=function(a){this._selectedProvider.observeCollaboration(a)},b.prototype.startWhiteboard=function(a){return this._selectedProvider.startWhiteboard(a)},b.prototype.endWhiteboard=function(a){return this._selectedProvider.endWhiteboard(a)},b.prototype.addWhiteboardSurface=function(){return this._selectedProvider.addWhiteboardSurface()},b.prototype.removeWhiteboardSurface=function(a){return this._selectedProvider.removeWhiteboardSurface(a)},b.prototype.sendMessage=function(a){return this._selectedProvider.sendMessage(a)},b.prototype.startScreenSharing=function(){return this._selectedProvider.startScreenSharing()},b.prototype.stopScreenSharing=function(){return this._selectedProvider.stopScreenSharing()},b.prototype.pauseScreenSharing=function(){return this._selectedProvider.pauseScreenSharing()},b.prototype.sendLiveEvent=function(a){return this._selectedProvider.sendLiveEvent(a)},b.prototype.removeShape=function(a,b,c){return this._selectedProvider.removeShape(a,b,c)},b.prototype.clearContent=function(a){return this._selectedProvider.clearContent(a)},b.prototype.getParticipants=function(){return this._selectedProvider.getParticipants()},b.prototype.isOpened=function(){return this._selectedProvider&&this._selectedProvider.isOpened()},b.prototype.isFeatureAvailable=function(a){return this._selectedProvider&&this._selectedProvider.isFeatureAvailable(a)},b.prototype.run=function(a){return this._selectedProvider.run(a)},b.prototype.getServerCapabilities=function(){return this._selectedProvider.getServerCapabilities()},a.Providers.WCS.WCSProvider=b}(AvayaClientServices),function(a){"use strict";function b(){this._collaborationProvider={}}b.prototype={getWCSProvider:function(b){if(a.Base.Utils.isDefined(b)&&b.enabled){if($.isEmptyObject(this._collaborationProvider)){var c=this._createWCSv1_1Provider();this._collaborationProvider=new a.Providers.WCS.WCSProvider,this._collaborationProvider.registerWCSProvider("1.1",c)}return this._collaborationProvider}},_createWCSv1_1Provider:function(){var b=new a.Base.RESTProvider,c=new a.Base.NetworkProvider(b),d=new a.Providers.WCS.CometParser,e=new a.Providers.WCS.WCSCometProvider(d),f=new a.Providers.WCS.WCSTransactionalWebSocketProvider,g=new a.Base.NetworkProvider(f,e),h=this._createEventsParser(),i=this._createBinaryParser(),j=new a.Providers.WCS.FrameBuilder,k=new a.Providers.WCS.WCSMessageBuilder,l=new a.Providers.WCS.WCSContentSharingHandler(j),m=new a.Providers.WCS.WCSShapeConverter,n=new a.Providers.WCS.WCSWhiteboardHandler(m),o=new a.Services.Analytics.CollaborationsAnalyticsService;return new a.Providers.WCS.WCSv1_1Provider(c,h,i,k,l,n,g,o)},_createEventsParser:function(){var b=new a.Providers.WCS.WCSEventsParser;return b.register(a.Providers.WCS.WCSEventTypes.ERROR,new a.Providers.WCS.ErrorParser),b.register(a.Providers.WCS.WCSEventTypes.LIVE_SESSION,new a.Providers.WCS.LiveSessionParser),b.register(a.Providers.WCS.WCSEventTypes.LIVE_VIEWER,new a.Providers.WCS.LiveViewerParser),b.register(a.Providers.WCS.WCSEventTypes.SEND_MESSAGE,new a.Providers.WCS.SendMessageParser),b.register(a.Providers.WCS.WCSEventTypes.DRAW_SHAPE,new a.Providers.WCS.DrawShapeParser),b.register(a.Providers.WCS.WCSEventTypes.DRAW_CIRCLE,new a.Providers.WCS.DrawCircleParser),b.register(a.Providers.WCS.WCSEventTypes.MOVE_SELECTION,new a.Providers.WCS.MoveSelectionParser),b.register(a.Providers.WCS.WCSEventTypes.DELETE_SELECTION,new a.Providers.WCS.DeleteSelectionParser),b.register(a.Providers.WCS.WCSEventTypes.CLEAR_DRAWING,new a.Providers.WCS.ClearDrawingParser),b.register(a.Providers.WCS.WCSEventTypes.DRAW_TEXT,new a.Providers.WCS.DrawTextParser),b.register(a.Providers.WCS.WCSEventTypes.START_DRAW_SHAPE,new a.Providers.WCS.StartDrawShapeParser),b.register(a.Providers.WCS.WCSEventTypes.END_DRAW_SHAPE,new a.Providers.WCS.EndDrawShapeParser),b.register(a.Providers.WCS.WCSEventTypes.START_WHITEBOARD,new a.Providers.WCS.StartWhiteboardParser),b.register(a.Providers.WCS.WCSEventTypes.ADD_WHITEBOARD,new a.Providers.WCS.AddWhiteboardParser),b.register(a.Providers.WCS.WCSEventTypes.DELETE_WHITEBOARD,new a.Providers.WCS.DeleteWhiteboardParser),b.register(a.Providers.WCS.WCSEventTypes.END_WHITEBOARD,new a.Providers.WCS.EndWhiteboardParser),b.register(a.Providers.WCS.WCSEventTypes.START_MEETING,new a.Providers.WCS.StartMeetingParser),b.register(a.Providers.WCS.WCSEventTypes.START_SCREEN_SHARING,new a.Providers.WCS.StartScreenSharingParser),b.register(a.Providers.WCS.WCSEventTypes.PAUSE_SCREEN_SHARING,new a.Providers.WCS.PauseScreenSharingParser),b.register(a.Providers.WCS.WCSEventTypes.END_SCREEN_SHARING,new a.Providers.WCS.EndScreenSharingParser),b.register(a.Providers.WCS.WCSEventTypes.GRANT_CONTROL,new a.Providers.WCS.GrantControlParser),b.register(a.Providers.WCS.WCSEventTypes.ADD_NOTE,new a.Providers.WCS.AddNoteParser),b.register(a.Providers.WCS.WCSEventTypes.DELETE_NOTE,new a.Providers.WCS.DeleteNoteParser),b.register(a.Providers.WCS.WCSEventTypes.SET_NOTE,new a.Providers.WCS.SetNoteParser),b.register(a.Providers.WCS.WCSEventTypes.DENY_CONTROL,new a.Providers.WCS.DenyControlParser),b.register(a.Providers.WCS.WCSEventTypes.END_CONTROL,new a.Providers.WCS.EndControlParser),b.register(a.Providers.WCS.WCSEventTypes.END_MEETING,new a.Providers.WCS.EndMeetingParser),b.register(a.Providers.WCS.WCSEventTypes.SEND_DOCUMENT,new a.Providers.WCS.SendDocumentParser),b.register(a.Providers.WCS.WCSEventTypes.ALLOW_PRESENTING,new a.Providers.WCS.AllowPresentingParser),b.register(a.Providers.WCS.WCSEventTypes.DENY_PRESENTING,new a.Providers.WCS.DenyPresentingParser),b.register(a.Providers.WCS.WCSEventTypes.EJECT_PARTICIPANT,new a.Providers.WCS.EjectParticipantParser),b.register(a.Providers.WCS.WCSEventTypes.LIVE_ATTENDEES,new a.Providers.WCS.LiveAttendeesParser),b.register(a.Providers.WCS.WCSEventTypes.FRAME_REPORT,new a.Providers.WCS.FrameReportParser),b.register(a.Providers.WCS.WCSEventTypes.LIVE_CAPABILITIES,new a.Providers.WCS.LiveCapabilitiesParser),b.register(a.Providers.WCS.WCSEventTypes.SERVER_CAPABILITIES,new a.Providers.WCS.ServerCapabilitiesParser),b},_createBinaryParser:function(){var b=new a.Providers.WCS.WCSBinaryParser;return b.registerParser(a.Providers.WCS.WCSTransmissionTypes.SCREEN_SHARING,a.Providers.WCS.WCSScreenSharingTagTypes.START_TAG,new a.Providers.WCS.StartTagBinaryParser),b.registerParser(a.Providers.WCS.WCSTransmissionTypes.SCREEN_SHARING,a.Providers.WCS.WCSScreenSharingTagTypes.BLOCK_TAG,new a.Providers.WCS.BlockTagBinaryParser),b.registerParser(a.Providers.WCS.WCSTransmissionTypes.SCREEN_SHARING,a.Providers.WCS.WCSScreenSharingTagTypes.CURSOR_TAG,new a.Providers.WCS.CursorTagBinaryParser),b.registerParser(a.Providers.WCS.WCSTransmissionTypes.SCREEN_SHARING,a.Providers.WCS.WCSScreenSharingTagTypes.END_TAG,new a.Providers.WCS.EndTagBinaryParser),b}},a.Providers.WCS.WCSProviderFactory=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={convertShape:function(b,c){var d=this._determineColor(b.data),e=b.liveEventCommonData.fromname,f=b.data.filled,g=b.liveEventCommonData.senderId===c,h=b.data.alpha,i=b.data.width,j=new a.Services.Collaboration.Shape(e,f,g,d,h,i);if(j.setId(b.liveEventCommonData.eventId),a.Base.Utils.isDefined(b.data.m)){var k=0;for(k;k<b.data.m.length;k++)j.addMovePoint(new a.Services.Collaboration.Point(b.data.m[k].x,b.data.m[k].y))}if(a.Base.Utils.isDefined(b.data.l)){var l=0;for(l;l<b.data.l.length;l++)j.addLinePoint(new a.Services.Collaboration.Point(b.data.l[l].x,b.data.l[l].y))}return j},convertLiveShape:function(b,c){var d=b.liveEventCommonData.fromname,e=!1,f=b.liveEventCommonData.senderId===c,g=this._convertColor(b.data.color),h=b.data.alpha,i=b.data.width,j=new a.Services.Collaboration.Shape(d,e,f,g,h,i);return j.setId(b.liveEventCommonData.eventId),j},convertText:function(b,c){var d,e=b.data.text,f=b.liveEventCommonData.fromname,g=b.data.filled,h=b.liveEventCommonData.senderId===c,i=this._convertColor(b.data.fillColor),j=b.data.fontSize,k=new a.Services.Collaboration.WhiteboardText(e,j,f,g,h,i,d);return k.setId(b.liveEventCommonData.eventId),k.setPosition(new a.Services.Collaboration.Point(b.data.x,b.data.y)),k},convertCircle:function(b,c){var d=this._determineColor(b.data),e=b.liveEventCommonData.fromname,f=b.data.filled,g=b.liveEventCommonData.senderId===c,h=b.data.width,i=b.data.alpha,j=this._calculatePoints(b.data),k=new a.Services.Collaboration.Circle(j.topLeft,j.bottomRight,e,f,g,d,i,h);return k.setId(b.liveEventCommonData.eventId),k},_determineColor:function(a){return a.filled&&a.fillColor?this._convertColor(a.fillColor):a.contour&&a.color?this._convertColor(a.color):void 0},_convertColor:function(a){return 0===a.indexOf("#")?parseInt(a.slice(1),16):parseInt(a,16)},_calculatePoints:function(b){var c,d;return b.x0<b.x1&&b.y0<b.y1?(c=new a.Services.Collaboration.Point(b.x0,b.y0),d=new a.Services.Collaboration.Point(b.x1,b.y1)):b.x0>=b.x1&&b.y0>=b.y1?(c=new a.Services.Collaboration.Point(b.x1,b.y1),d=new a.Services.Collaboration.Point(b.x0,b.y0)):b.x0<b.x1&&b.y0>=b.y1?(c=new a.Services.Collaboration.Point(b.x0,b.y1),d=new a.Services.Collaboration.Point(b.x1,b.y0)):(c=new a.Services.Collaboration.Point(b.x1,b.y0),d=new a.Services.Collaboration.Point(b.x0,b.y1)),{topLeft:c,bottomRight:d}}},a.Providers.WCS.WCSShapeConverter=b}(AvayaClientServices),function(a){"use strict";var b={SCREEN_SHARING:0,SLIDE_SHARING:2};a.Providers.WCS.WCSTransmissionTypes=b}(AvayaClientServices),function(a){"use strict";function b(a){this._shapeConverter=a}b.prototype={addWhiteboard:function(b,c){a.Base.Logger.debug(a.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"addWhiteboard");var d=b.getWhiteboard(),e=d.getSurfaceById(c.liveEventCommonData.eventId);if(a.Base.Utils.isDefined(e))return void this.startWhiteboard(b,c);var f=this._createNewSurface(d,c.liveEventCommonData.eventId),g=d.getActiveSurface(),h=this._getParticipant(b,c);a.Base.Utils.isDefined(g)&&(g._active=!1),f._active=!0,d._activeSurface=f,d._onWhiteboardSurfaceAddedCallbacks.fire(c,f,h),d._onWhiteboardSurfaceSetActiveCallbacks.fire(d,f,h),d._recalculateRemoveWhiteboardCapability()},startWhiteboard:function(b,c){a.Base.Logger.debug(a.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"startWhiteboard");var d,e=c.data&&c.data.id?c.data.id:c.liveEventCommonData.eventId,f=b.getWhiteboard(),g=f.getSurfaceById(e),h=f.getActiveSurface()||f._recentlyActiveSurface,i=this._getParticipant(b,c);a.Base.Utils.isDefined(h)&&(h._active=!1),a.Base.Utils.isDefined(g)?(g._active=!0,f._activeSurface=g,f._onWhiteboardSurfaceSetActiveCallbacks.fire(f,g,i)):(d=this._createNewSurface(f,c.liveEventCommonData.eventId),d._active=!0,f._activeSurface=d,f._onWhiteboardSurfaceAddedCallbacks.fire(f,d,i),f._onWhiteboardSurfaceSetActiveCallbacks.fire(f,d,i)),f._onWhiteboardStartedCallbacks.fire(f,d,i),f._recalculateRemoveWhiteboardCapability()},endWhiteboard:function(b,c){a.Base.Logger.debug(a.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"endWhiteboard");var d=b.getWhiteboard(),e=this._getParticipant(b,c);d._recentlyActiveSurface=d._activeSurface,d._activeSurface=void 0,d._onWhiteboardEndedCallbacks.fire(d,e),d._recalculateRemoveWhiteboardCapability()},deleteWhiteboard:function(b,c){a.Base.Logger.debug(a.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"deleteWhiteboard");var d,e=b.getWhiteboard(),f=e.getSurfaceById(c.data.id),g=this._getParticipant(b,c);if(f){d=f,f.isActive()&&(e._activeSurface=this._chooseNewActiveSurface(e,c.data.id));var h=e.getSurfaces().indexOf(f);h>-1&&e.getSurfaces().splice(h,1),e._onWhiteboardSurfaceRemovedCallbacks.fire(e,d,g),e._onWhiteboardSurfaceSetActiveCallbacks.fire(e,e.getActiveSurface(),g)}e._recalculateRemoveWhiteboardCapability()},startDrawShape:function(b,c){a.Base.Logger.debug(a.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"startDrawShape");var d=b.getWhiteboard(),e=d.getSurfaceById(c.data.groupId);if(e){var f=this._shapeConverter.convertLiveShape(c,b._selfParticipant.getParticipantId());f._tempId=c.liveEventCommonData.eventId,e._appendShape(c.liveEventCommonData.eventId,f),d._currentLiveDrawingWhiteboardIds[c.liveEventCommonData.senderId]=c.data.groupId,d._currentLiveDrawingShapes[c.liveEventCommonData.senderId]=f,e._onShapeAddedCallbacks.fire(e,f)}},drawShape:function(b,c){a.Base.Logger.debug(a.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"drawShape");var d=b.getWhiteboard(),e=d.getSurfaceById(c.data.groupId);if(a.Base.Utils.isDefined(d._currentLiveDrawingShapes[c.liveEventCommonData.senderId])){e=d.getSurfaceById(d._currentLiveDrawingWhiteboardIds[c.liveEventCommonData.senderId]);var f=e._getShapeById(d._currentLiveDrawingShapes[c.liveEventCommonData.senderId].getId()),g=c.liveEventCommonData.senderId===b._selfParticipant.getParticipantId();if(f&&!g){if(c.data.m.length>0&&d._currentLiveDrawingShapes[c.liveEventCommonData.senderId].addMovePoint(new a.Services.Collaboration.Point(c.data.m[0].x,c.data.m[0].y)),c.data.l.length>0)for(var h=0;h<c.data.l.length;h++)d._currentLiveDrawingShapes[c.liveEventCommonData.senderId].addLinePoint(new a.Services.Collaboration.Point(c.data.l[h].x,c.data.l[h].y));e._onShapeUpdatedCallbacks.fire(e,d._currentLiveDrawingShapes[c.liveEventCommonData.senderId])}}else if(a.Base.Utils.isDefined(e)){var i=this._shapeConverter.convertShape(c,b._selfParticipant.getParticipantId());e._appendShape(c.liveEventCommonData.eventId,i),e._onShapeAddedCallbacks.fire(e,i)}},endDrawShape:function(b,c){a.Base.Logger.debug(a.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"endDrawShape");var d=b.getWhiteboard(),e=d.getSurfaceById(c.data.groupId);if(e&&d._currentLiveDrawingShapes[c.liveEventCommonData.senderId]){var f=e._getShapeById(d._currentLiveDrawingShapes[c.liveEventCommonData.senderId].getId());e._removeShapeById(d._currentLiveDrawingShapes[c.liveEventCommonData.senderId].getId()),f.setId(c.liveEventCommonData.eventId),e._appendShape(c.liveEventCommonData.eventId,f),e._onShapeUpdatedCallbacks.fire(e,f),f._tempId=c.liveEventCommonData.eventId,delete d._currentLiveDrawingWhiteboardIds[c.liveEventCommonData.senderId],d._currentLiveDrawingShapes[c.liveEventCommonData.senderId].finishDrawing(),delete d._currentLiveDrawingShapes[c.liveEventCommonData.senderId]}},drawCircle:function(b,c){a.Base.Logger.debug(a.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"drawCircle");var d=b.getWhiteboard(),e=d.getSurfaceById(c.data.groupId);if(e){var f=this._shapeConverter.convertCircle(c,b._selfParticipant.getParticipantId());e._appendShape(c.liveEventCommonData.eventId,f),
e._onShapeAddedCallbacks.fire(e,f)}},drawText:function(b,c){a.Base.Logger.debug(a.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"drawText");var d=b.getWhiteboard(),e=d.getSurfaceById(c.data.groupId);if(e){var f=this._shapeConverter.convertText(c,b._selfParticipant.getParticipantId());e._appendShape(c.liveEventCommonData.eventId,f),e._onShapeAddedCallbacks.fire(e,f)}},clearDrawing:function(b,c){a.Base.Logger.debug(a.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"clearDrawing");var d=b.getWhiteboard(),e=d.getSurfaceById(c.data.groupId);e&&(e._clearShapes(),e._onSurfaceClearedCallbacks.fire(e))},moveSelection:function(b,c){var d=b.getWhiteboard(),e=d.getSurfaceById(c.data.groupId);if(e){var f=e._getShapeById(c.data.shapeId);f.setTranslation(new a.Services.Collaboration.Point(c.data.moveToX,c.data.moveToY)),e._onShapeUpdatedCallbacks.fire(e,f)}},deleteSelection:function(b,c){a.Base.Logger.debug(a.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"deleteSelection");var d=b.getWhiteboard(),e=d.getSurfaceById(c.data.groupId);if(e){var f=e._getShapeById(c.data.shapeId);f&&(e._onShapeDeletedCallbacks.fire(e,f),e._removeShapeById(f.getId()))}},_createNewSurface:function(b,c){var d=new a.Services.Collaboration.WhiteboardSurface(b,b._whiteboardService);return b.getSurfaces().push(d),d._surfaceId=c,d},_chooseNewActiveSurface:function(b,c){var d=b.getSurfaces(),e=b.getSurfaceById(c),f=d.indexOf(e);return a.Base.Utils.isDefined(b.getActiveSurface())&&(b.getActiveSurface()._active=!1),0===f?d.length>1?(d[1]._active=!0,d[1]):(d[0]._active=!0,d[0]):(d[f-1]._active=!0,d[f-1])},_getParticipant:function(b,c){var d=b._participants.filter(function(a){return a.getParticipantId()===c.liveEventCommonData.senderId})[0];return d||(d=new a.Services.Collaboration.Participant(c.liveEventCommonData.senderId,c.liveEventCommonData.senderName),b._participants.push(d)),d}},a.Providers.WCS.WCSWhiteboardHandler=b}(AvayaClientServices),function(a){"use strict";var b={NOTIFICATION_ERROR:"Notification failed",UNAUTHORIZED:"Unauthorized status",NETWORK_ERROR:"Network Error",MESSAGE_SENDING_ERROR:"Message sending error",CONNECTION_BACKOFF_ALGORITHM_ERROR:"connection Backoff Algorithm error",GETTING_CONVERSATIONS_ERROR:"Getting conversations error",SEARCHING_CONVERSATIONS_ERROR:"Searching conversations error",STARTING_COLLABORATION_ERROR:"Starting Collaboration is error",HOLD_CALL_ERROR:"Hold call error",TRANSFER_CALL_ERROR:"Transfer call error",ATTENDED_TRANSFER_CALL_ERROR:"Attended transfer call error",JOIN_CALL_ERROR:"Join call error",STARTING_CALL_ERROR:"Starting call is error",STOPPING_CALL_ERROR:"Stopping call is error",GETTING_CALL_STATISTICS_ERROR:"Getting call statistics error",SETTING_VIDEO_MODE_ERROR:"Setting video mode error",DENY_SEND_VIDEO_ERROR:"Deny send video error",ACCEPT_SEND_VIDEO_ERROR:"Accept send video error",MUTE_AUDIO_ERROR:"Mute audio error",UNMUTE_AUDIO_ERROR:"Unmute audio error",MUTE_SPEAKER_ERROR:"Mute speaker error",UNMUTE_SPEAKER_ERROR:"Unmute speaker error",ACCEPT_CALL_ERROR:"accept call error",MEDIA_PRESERVED_ERROR:"Media preserved error",SEND_DTMF_ERROR:"send dtmf error",WEBRTC_NOT_SUPPORTED:"WebRTC not supported",NO_CALL_WAS_CREATED_ERROR:"No call was created"};a.Services.Analytics.AnalyticsErrorCode=b}(AvayaClientServices),function(a){"use strict";var b={AUTO_CALLBACK:"AUTO_CALLBACK",AUTOMATIC_CALL_DISTRIBUTION_EXTERNAL:"AUTOMATIC_CALL_DISTRIBUTION_EXTERNAL",AUTOMATIC_CALL_DISTRIBUTION_INTERNAL:"AUTOMATIC_CALL_DISTRIBUTION_INTERNAL",DIRECT_AGENT_CALL_EXTERNAL:"DIRECT_AGENT_CALL_EXTERNAL",DIRECT_AGENT_CALL_INTERNAL:"DIRECT_AGENT_CALL_INTERNAL",DIRECT_AGENT_CALL_PRIORITY:"DIRECT_AGENT_CALL_PRIORITY",EXTERNAL:"EXTERNAL",HOLD_RECALL:"HOLD_RECALL",INTERCOM:"INTERCOM",INTERNAL:"INTERNAL",NONE:"NONE",PRIORITY:"PRIORITY",TRANSFER_RECALL:"TRANSFER_RECALL",UNSPECIFIED:"UNSPECIFIED"};a.Services.Call.AlertType=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(a,b,c,d,e,f,g,h){this.bytesReceived=a,this.bytesTransmitted=b,this.packetsReceived=c,this.packetsTransmitted=d,this.roundTripTimeMilliseconds=e,this.packetLossTotalTransmitted=f,this.packetLossTotalReceived=g,this.jitterMillisecondsReceived=h}a.Services.Call.AudioDetails=b}(AvayaClientServices||{}),function(a){"use strict";function b(b,c,d){this._remoteAddress=b,this._presentationModeOnly=!!a.Base.Utils.isDefined(c)&&!!c,this._subject=d,this._avayaLineId=void 0,this._avayaLineOwner=void 0,this._conferenceID=void 0,this._conferencePasscode=void 0,this._portalToken=void 0,this._meetMeUserName=void 0,this._serviceGatewayURL=void 0,this._uccpURL=void 0,this._callType=a.Services.Call.CallType.CallTypeDefaultRegisteredService}b.prototype={getRemoteAddress:function(){return this._remoteAddress},isPresentationModeOnly:function(){return a.Base.Utils.isDefined(this._presentationModeOnly)&&!!this._presentationModeOnly},getSubject:function(){return this._subject},getConferenceID:function(){return this._conferenceID},setConferenceID:function(a){this._conferenceID=a},getPasscode:function(){return this._conferencePasscode},setPasscode:function(a){this._conferencePasscode=a},getPortalToken:function(){return this._portalToken},setPortalToken:function(a){this._portalToken=a},getMeetMeUserName:function(){return this._meetMeUserName},setMeetMeUserName:function(a){this._meetMeUserName=a},getCallType:function(){return this._callType},setCallType:function(a){this._callType=a},getServiceGatewayURL:function(){return this._serviceGatewayURL},setServiceGatewayURL:function(a){this._serviceGatewayURL=a},setUccpURL:function(a){this._uccpURL=a},getUccpURL:function(){return this._uccpURL},getAvayaLineId:function(){return this._avayaLineId},getAvayaLineOwner:function(){return this._avayaLineOwner}},a.Services.Call.CallCreationInfo=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";var b={BUSY:"BUSY",FORBIDDEN:"FORBIDDEN",TEMPORARILY_UNAVAILABLE:"TEMPORARILY_UNAVAILABLE"};a.Services.Call.CallDenialReason=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(){"use strict";function a(a,b,c,d,e,f){this.callId=a,this.callingParticipant=b,this.calledParticipant=c,this.participants=d,this.connectionId=e,this.status=f}AvayaClientServices.Services.Call.CallDetails=a}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(a,b,c,d){this._reason=a,this._reasonProtocol=b,this._reasonCause=c,this._reasonText=d}b.prototype={getReason:function(){return this._reason},getReasonProtocol:function(){return this._reasonProtocol},getReasonCause:function(){return this._reasonCause},getReasonText:function(){return this._reasonText},_setReason:function(a){this._reason=a}},a.Services.Call.CallEndEvent=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";var b={CALL_DISCONNECTED:"CALL_DISCONNECTED",CALL_DISCONNECTED_UNKNOWN_REASON:"CALL_DISCONNECTED_UNKNOWN_REASON",CALL_ENDED_LOCALLY:"CALL_ENDED_LOCALLY",DISCONNECTED_BY_CONFERENCE_MODERATOR:"DISCONNECTED_BY_CONFERENCE_MODERATOR",CONFERENCE_TERMINATED:"CONFERENCE_TERMINATED",DTLS_FAILURE:"DTLS_FAILURE",ICE_FAILURE:"ICE_FAILURE"};a.Services.Call.CallEndReason=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";var b={AUTHENTICATION_ERROR:"AUTHENTICATION_ERROR",AUTO_HOLD_FAILED:"AUTO_HOLD_FAILED",BUSY:"BUSY",CALL_STATE_MISMATCH:"CALL_STATE_MISMATCH",CALL_NOT_FOUND:"CALL_NOT_FOUND",CAPABILITY_NOT_ALLOWED:"CAPABILITY_NOT_ALLOWED",CODEC_MISMATCH:"CODEC_MISMATCH",DEVICES_NOT_FOUND:"DEVICES_NOT_FOUND",MICROPHONE_NOT_FOUND:"MICROPHONE_NOT_FOUND",SPEAKERS_NOT_FOUND:"SPEAKERS_NOT_FOUND",CAMERA_NOT_FOUND:"CAMERA_NOT_FOUND",FAILED:"FAILED",ENDED:"ENDED",IN_PROGRESS:"IN_PROGRESS",INTERNAL_ERROR:"INTERNAL_ERROR",INVALID_PARAMETER:"INVALID_PARAMETER",LINE_RESERVATION_ERROR:"LINE_RESERVATION_ERROR",MEDIA_CREATION_FAILURE:"MEDIA_CREATION_FAILURE",MEDIA_START_FAILURE:"MEDIA_START_FAILURE",MULTIPLE_VIDEO_CHANNELS_NOT_SUPPORTED:"MULTIPLE_VIDEO_CHANNELS_NOT_SUPPORTED",MUTE_STATE_MISMATCH:"MUTE_STATE_MISMATCH",NO_AVAILABLE_CALL_APPEARANCE:"NO_AVAILABLE_CALL_APPEARANCE",NOT_AUTHORIZED:"NOT_AUTHORIZED",NOT_FOUND:"NOT_FOUND",NOT_LICENSED:"NOT_LICENSED",NOT_REGISTERED:"NOT_REGISTERED",REDIRECTED:"REDIRECTED",REMOTE_CALL_NOT_ALERTING:"REMOTE_CALL_NOT_ALERTING",REMOTE_MEDIA_PROCESSING_FAILURE:"REMOTE_MEDIA_PROCESSING_FAILURE",SEND_ERROR:"SEND_ERROR",SERVER_ERROR:"SERVER_ERROR",SUCCESS:"SUCCESS",TIMEOUT:"TIMEOUT",TRANSPORT_ERROR:"TRANSPORT_ERROR",UNDEFINED:"UNDEFINED",UNHANDLED_VIDEO_DIRECTION:"UNHANDLED_VIDEO_DIRECTION",USER_NOT_FOUND:"USER_NOT_FOUND",USER_TEMPORARILY_UNAVAILABLE:"USER_TEMPORARILY_UNAVAILABLE",VIDEO_DENIED:"VIDEO_DENIED",WEBRTC_NOT_SUPPORTED:"WEBRTC_NOT_SUPPORTED",STATISTICS_UNAVAILABLE:"STATISTICS_UNAVAILABLE",MEDIA_PRESERVED:"MEDIA_PRESERVED",SERVICE_TEMPORARILY_UNAVAILABLE:"SERVICE_TEMPORARILY_UNAVAILABLE"};a.Services.Call.CallError=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(){"use strict";function a(a,b,c,d){this._error=a,this._protocolType=b,this._protocolErrorCode=c,this._protocolErrorReason=d}a.prototype={getError:function(){return this._error},getProtocolType:function(){return this._protocolType},getProtocolErrorCode:function(){return this._protocolErrorCode},getProtocolErrorReason:function(){return this._protocolErrorReason}},AvayaClientServices.Services.Call.CallException=a}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b,c,d,e,f){this._providerFactory=b,this._bandwidthManager=e,this._mediaServiceFactory=c,this._callService={},this._callManager=new a.Services.Call.CallManager,this.calls=void 0,this._callProvider={},this._participantService=void 0,this._conferenceService=void 0,this._contactsIntegrationService=d,this._callsAnalyticsService=f}b.prototype={init:function(b){this._callProvider=this._providerFactory.getCallProviders(b,this._mediaServiceFactory,this._callsAnalyticsService)[0],this._callService=new a.Services.Call.CallService(b,this._callProvider,this._callManager,this._mediaServiceFactory,this._contactsIntegrationService,this._bandwidthManager,this._callsAnalyticsService),this.calls=new a.Services.Call.Calls(this._callManager,this._callService)},getCalls:function(){return this.calls}},a.Services.Call.CallFactory=b}(AvayaClientServices),function(a){"use strict";function b(){this._callsObject=void 0,this._calls=[],this._lastMissedCall=void 0}b.prototype={setCalls:function(a){this._callsObject=a},createCall:function(b){var c=new a.Services.Call.Call(b);return c._setServiceAvailability(b.isServiceAvailable()),this._calls.push(c),this._callsObject._callCreatedCallbacks.fire(c),c},createRemoteOrIncomingCall:function(b,c,d,e,f,g,h,i,j,k,l,m){var n=new a.Services.Call.Call(b);return n._setServiceAvailability(b.isServiceAvailable()),n._setCallId(c),n._setRemoteAddress(d),n._setRemoteDisplayName(e),n._isPrivateCallerID=!!a.Base.Utils.isDefined(g)&&g,n._isAuraAsserted=!!a.Base.Utils.isDefined(f)&&f,n._alertType=i,n._subject=j,h&&(n._incomingVideoOffered=a.Services.Call.VideoNetworkSignalingType.SUPPORTED),n._setRemote(!!a.Base.Utils.isDefined(l)&&l),n._setState(k),n._incoming=!!a.Base.Utils.isDefined(m)&&m,n.isRemote()&&this._lastMissedCall&&(this._lastMissedCall.getRemoteAddress()===d&&n._setIsMissed(!0),this._lastMissedCall=void 0),this._calls.push(n),this._callsObject._callCreatedCallbacks.fire(n),n},createMakeCall:function(b,c,d,e,f,g){var h=new a.Services.Call.Call(b);return h._setServiceAvailability(b.isServiceAvailable()),h._setCallId(c),h._setRemoteAddress(d),a.Base.Utils.isDefined(e)&&h._setUserToUserInfo(new a.Services.Call.UserToUserInfo(e,f,g)),this._calls.push(h),this._callsObject._callCreatedCallbacks.fire(h),h},deleteCall:function(a){var b=this._calls.indexOf(a);b>-1&&(this._calls.splice(b,1),this._callsObject._callRemovedCallbacks.fire(a))},getCallCount:function(){return this._calls.length},setLastMissedCall:function(a){this._lastMissedCall=a},getLastMissedCall:function(){return this._lastMissedCall},getAllCalls:function(){return this._calls},getActiveCall:function(){for(var b=0;b<this._calls.length;b++){var c=this._calls[b];if(c.getState()===a.Services.Call.CallStates.ESTABLISHED&&!c.isRemote()||c.getState()===a.Services.Call.CallStates.RENEGOTIATING||c.getState()===a.Services.Call.CallStates.FAR_END_RENEGOTIATING)return c}},getIgnoredCalls:function(){return this._calls.filter(function(b){return b.getState()===a.Services.Call.CallStates.IGNORED})},hasHeldCall:function(){for(var b=0;b<this._calls.length;b++){if(this._calls[b].getState()===a.Services.Call.CallStates.HELD)return!0}return!1},hasInitiatingCall:function(){for(var b=0;b<this._calls.length;b++){var c=this._calls[b];if(c.getState()===a.Services.Call.CallStates.INITIATING||c.getState()===a.Services.Call.CallStates.REMOTE_ALERTING||c.getState()===a.Services.Call.CallStates.IDLE)return!0}return!1},setCallMode:function(a,b){var c=this._calls.indexOf(a);this._calls[c]._modes.push(b)},getCallModes:function(a){var b=this._calls.indexOf(a);return b<0?[]:this._calls[b]._modes}},a.Services.Call.CallManager=b}(AvayaClientServices),function(a){"use strict";var b={CONFERENCE_CALL:"conferenceCall",AV_COLLABORATION_CALL:"avCollaborationCall"};a.Services.Call.CallModes=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";var b={APPLICATION:"APPLICATION",HTTP:"HTTP"};a.Services.Call.CallProtocolType=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a,b){"use strict";function c(b,c,d,e,f,g,h){a.Base.Observable.call(this),this._config=b,this._bandwidthManager=g,this._callProvider=c,this._callManager=d,this._mediaServiceFactory=e,this._isServiceAvailable=!1,this._mediaServices=e.getMediaServices(),this._scopiaConferenceProviderFactory=new a.Providers.Scopia.ScopiaConferenceProviderFactory,this._contactsIntegrationService=f,this._onContactListChanged=void 0,this._videoLicenseEnabled=!0,this.videoResolution={},this._videoCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._calls=void 0,this._callsAnalyticsService=h}c.prototype=Object.create(a.Base.Observable.prototype),c.prototype.setCollaborations=function(a){this._collaborations=a},c.prototype.startCall=function(c){if(a.Base.Logger.info(a.Base.LoggerTags.CALL_SERVICE,"Call Service is starting..."),!this._isMakeCallAllowed(c))return this._callsAnalyticsService.sendOperationFailureEvent("start",a.Services.Call.CallError.CAPABILITY_NOT_ALLOWED),b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.CAPABILITY_NOT_ALLOWED)).promise();if(this._bandwidthManager.registerCall(c),c.addOnCallEndedCallback(function(a){this._bandwidthManager.unregisterCall(a),this._stopCollaboration(a)}.bind(this)),c._isDataOnly())for(var d=this._callManager.getCallModes(c),e=0;e<d.length;e++){var f=d[e];if(f.id===a.Services.Call.CallModes.CONFERENCE_CALL)return void f.startCall(c)}else{var g=c.getRemoteAddress();if(null===g.match(/sips?:.*/)){var h=g.search(/,/);-1!==h&&(c._setDtmfString(g.substring(h).split("")),c._setRemoteAddress(g.substring(0,h)))}}var i=this._getMicrophoneAvailability(),j=this._getSpeakersAvailability(),k=this._getCameraAvailability(c),l=c.getVideoChannels().length>0;if(this._setupDevicesListeners(c),this._setupAnalyticsListeners(c),i)if(j){if(this.isVideoEnabled()&&l&&!k){var m=c.getVideoChannels();m[0].getRequestedDirection()===a.Services.Call.MediaDirection.SEND_RECV?(m[0]._setRequestedDirection(a.Services.Call.MediaDirection.RECV_ONLY),a.Base.Logger.warn(a.Base.LoggerTags.CALL_SERVICE,"No camera found for video call - update SEND_RECV video direction to RECV_ONLY")):m[0].getRequestedDirection()===a.Services.Call.MediaDirection.SEND_ONLY&&(m[0]._setRequestedDirection(a.Services.Call.MediaDirection.INACTIVE),a.Base.Logger.warn(a.Base.LoggerTags.CALL_SERVICE,"No camera found for video call - update SEND_ONLY video direction to INACTIVE"))}var n=function(){return this._callProvider.startCall(c,this.isVideoEnabled(),this.isWebCollaborationEnabled(),this.isUccpEnabled(),this._mediaServices.getAudioInterface().getInputInterface().getSelectedDevice(),this._mediaServices.getVideoInterface().getSelectedDevice(),this.videoResolution).fail(function(b){this._callsAnalyticsService.sendOperationFailureEvent("start",a.Services.Call.CallError.FAILED)}.bind(this))}.bind(this),o=this._callManager.getActiveCall();void 0!==o?o.hold().then(function(){n()}.bind(this),function(){this._notifyCallFailure(c,a.Services.Call.CallError.AUTO_HOLD_FAILED),this._callsAnalyticsService.sendOperationFailureEvent("start",a.Services.Call.CallError.AUTO_HOLD_FAILED)}.bind(this)):n()}else this._notifyCallFailure(c,a.Services.Call.CallError.SPEAKERS_NOT_FOUND),this._callsAnalyticsService.sendOperationFailureEvent("start",a.Services.Call.CallError.SPEAKERS_NOT_FOUND);else this._notifyCallFailure(c,a.Services.Call.CallError.MICROPHONE_NOT_FOUND),this._callsAnalyticsService.sendOperationFailureEvent("start",a.Services.Call.CallError.MICROPHONE_NOT_FOUND)},c.prototype._getMicrophoneAvailability=function(){var a=this._mediaServices.getAudioInterface().getInputInterface(),b=a.getSelectDeviceCapability().isAllowed,c=a.getAvailableDevices().length>0;return!b||c},c.prototype._getSpeakersAvailability=function(){var b,c=this._mediaServices.getAudioInterface().getOutputInterface(),d=c.getSelectDeviceCapability().isAllowed,e=a.Base.Utils.getBrowserType();return b=e===a.Base.BrowserType.FIREFOX||e===a.Base.BrowserType.FIREFOX_EXTENSION||c.getAvailableDevices().length>0,!d||b},c.prototype._getCameraAvailability=function(b){var c=!1;b.getVideoChannels().length>0&&(c=b.getVideoChannels().reduce(function(b,c){return b&&c.getRequestedDirection()===a.Services.Call.MediaDirection.RECV_ONLY},!0));var d=this._mediaServices.getVideoInterface(),e=d.getSelectDeviceCapability().isAllowed,f=d.getAvailableDevices().length>0;return c||!e||f},c.prototype._setupDevicesListeners=function(a){var b=this._handleOnSelectedDeviceChanged(a).bind(this);this._mediaServices.getAudioInterface().getInputInterface().addOnSelectedDeviceChangedCallback(b),this._mediaServices.getVideoInterface().addOnSelectedDeviceChangedCallback(b);var c=this._handleOnSelectedDeviceRemoved;this._mediaServices.getAudioInterface().getInputInterface().addOnSelectedDeviceRemovedCallback(c),this._mediaServices.getAudioInterface().getOutputInterface().addOnSelectedDeviceRemovedCallback(c),this._mediaServices.getVideoInterface().addOnSelectedDeviceRemovedCallback(c),a.addOnCallEndedCallback(function(){this._mediaServices.getAudioInterface().getInputInterface().removeOnSelectedDeviceChangedCallback(b),this._mediaServices.getVideoInterface().removeOnSelectedDeviceChangedCallback(b),this._mediaServices.getAudioInterface().getInputInterface().removeOnSelectedDeviceRemovedCallback(c),this._mediaServices.getAudioInterface().getOutputInterface().removeOnSelectedDeviceRemovedCallback(c),this._mediaServices.getVideoInterface().removeOnSelectedDeviceRemovedCallback(c)}.bind(this))},c.prototype._setupAnalyticsListeners=function(a){var b;a.addOnCallEstablishedCallback(function(){b=this._callsAnalyticsService.startTimingMetric(),this._callsAnalyticsService.setCallMediaTypes(Boolean(a._videoChannels.length))}.bind(this)),a.addOnCallVideoChannelsUpdatedCallback(function(){this._callsAnalyticsService.setCallMediaTypes(!0)}.bind(this)),a.addOnCallEndedCallback(function(){this._callsAnalyticsService.callTimeEnd(b),this._callsAnalyticsService.sendCallMediaTypes()}.bind(this))},c.prototype._initAnalyticsMetrics=function(){var b,c;this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.CALL_SERVICE_UNAVAILABLE,function(d){b=this._callsAnalyticsService.startTimingMetric();var e=d&&d.getState()===a.Services.Call.CallStates.ESTABLISHED;c=this._callsAnalyticsService.callPreservationTimeStart(e)}.bind(this)),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.CALL_SERVICE_AVAILABLE,function(){this._callsAnalyticsService.serviceUnavailableTimeEnd(b);var a=this._callsAnalyticsService.callPreservationTimeEnd(c);this._callsAnalyticsService.sendPreservationEvent(!0,a)}.bind(this)),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.CALL_ENDED,function(){var a=this._callsAnalyticsService.callPreservationTimeEnd(c);this._callsAnalyticsService.sendPreservationEvent(!1,a)}.bind(this))},c.prototype._handleOnSelectedDeviceRemoved=function(a){var b=a.getAvailableDevices();a.getSelectDeviceCapability().isAllowed&&b.length&&a.setSelectedDevice(b[0])},c.prototype._handleOnSelectedDeviceChanged=function(b){return function(c,d){b.isRemote()||b.getState()!==a.Services.Call.CallStates.ESTABLISHED&&b.getState()!==a.Services.Call.CallStates.HELD&&b.getState()!==a.Services.Call.CallStates.RENEGOTIATING&&b.getState()!==a.Services.Call.CallStates.FAR_END_RENEGOTIATING||this._callProvider.updateDevices(b,d).fail(function(b){this._callsAnalyticsService.sendOperationFailureEvent("updateDevices",a.Services.Call.CallError.FAILED)}.bind(this))}.bind(this)},c.prototype._updateVideoResolution=function(c,d){if(c.isRemote()||c.getState()!==a.Services.Call.CallStates.ESTABLISHED&&c.getState()!==a.Services.Call.CallStates.HELD&&c.getState()!==a.Services.Call.CallStates.RENEGOTIATING&&c.getState()!==a.Services.Call.CallStates.FAR_END_RENEGOTIATING){var e=b.Deferred();return e.reject(),e.promise()}return this._callProvider.updateVideoResolution(c,d).fail(function(b){this._callsAnalyticsService.sendOperationFailureEvent("updateVideoResolution",a.Services.Call.CallError.FAILED)}.bind(this))},c.prototype.endCall=function(b,c){if(b._isDataOnly())for(var d=this._callManager.getCallModes(b),e=0;e<d.length;e++){var f=d[e];if(f.id===a.Services.Call.CallModes.CONFERENCE_CALL)return void f.endCall(b)}return this._callProvider._cpCalls[b.getCallId()]&&b.isConference()&&this._disconnectCallFromConference(b),this._callProvider.stopCall(b,c).then(function(){b._remoteVideoRemovedCallbacks.fire(b)},function(c){c.getError()===a.Services.Call.CallError.CALL_NOT_FOUND&&this._callManager.deleteCall(b),b._callFailedCallbacks.fire(b,c),this._callsAnalyticsService.sendOperationFailureEvent("end",a.Services.Call.CallError.FAILED)}.bind(this))},c.prototype.mute=function(c){return c.getMuteCapability().isAllowed?this._callProvider.muteAudio(c).then(function(){c._isAudioMuted=!0,c._onCallAudioMuteStatusChangedCallbacks.fire(c,!0)},function(c){return this._callsAnalyticsService.sendOperationFailureEvent("mute",a.Services.Analytics.AnalyticsErrorCode.MUTE_AUDIO_ERROR),b.Deferred().reject(c).promise()}.bind(this)):(a.Base.Logger.error(a.Base.LoggerTags.CALL_SERVICE,"Could not mute call: "+c.getCallId()+": "+c.getMuteCapability().denialReason),this._callsAnalyticsService.sendOperationFailureEvent("mute",a.Services.Call.CallError.CAPABILITY_NOT_ALLOWED),b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.CAPABILITY_NOT_ALLOWED)).promise())},c.prototype.unmute=function(c){return c.getUnmuteCapability().isAllowed?this._callProvider.unmuteAudio(c).then(function(){c._isAudioMuted=!1,c._onCallAudioMuteStatusChangedCallbacks.fire(c,!1)},function(c){return this._callsAnalyticsService.sendOperationFailureEvent("unmute",a.Services.Analytics.AnalyticsErrorCode.UNMUTE_AUDIO_ERROR),b.Deferred().reject(c).promise()}.bind(this)):(a.Base.Logger.error(a.Base.LoggerTags.CALL_SERVICE,"Could not un-mute call: "+c.getCallId()+": "+c.getUnmuteCapability().denialReason),this._callsAnalyticsService.sendOperationFailureEvent("unmute",a.Services.Call.CallError.CAPABILITY_NOT_ALLOWED),b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.CAPABILITY_NOT_ALLOWED)).promise())},c.prototype.muteSpeaker=function(c){if(c.getMuteSpeakerCapability().isAllowed)return this._callProvider.muteSpeaker(c).then(function(){c._isSpeakerMuted=!0,c._onCallSpeakerMuteStatusChangedCallbacks.fire(c,!0)},function(c){return this._callsAnalyticsService.sendOperationFailureEvent("muteSpeaker",a.Services.Analytics.AnalyticsErrorCode.MUTE_SPEAKER_ERROR),b.Deferred().reject(c).promise()}.bind(this));a.Base.Logger.error(a.Base.LoggerTags.CALL_SERVICE,"Could not mute speakers for call: "+c.getCallId()+": "+c.getMuteSpeakerCapability().denialReason);var d=a.Services.Call.CallError.CAPABILITY_NOT_ALLOWED;return this._callsAnalyticsService.sendOperationFailureEvent("muteSpeaker",d),b.Deferred().reject(new a.Services.Call.CallException(d)).promise()},c.prototype.unmuteSpeaker=function(c){return c.getUnmuteSpeakerCapability().isAllowed?this._callProvider.unmuteSpeaker(c).then(function(){c._isSpeakerMuted=!1,c._onCallSpeakerMuteStatusChangedCallbacks.fire(c,!1)},function(c){return this._callsAnalyticsService.sendOperationFailureEvent("unmuteSpeaker",a.Services.Analytics.AnalyticsErrorCode.UNMUTE_SPEAKER_ERROR),b.Deferred().reject(c).promise()}.bind(this)):(a.Base.Logger.error(a.Base.LoggerTags.CALL_SERVICE,"Could not un-mute speakers for call: "+c.getCallId()+": "+c.getUnmuteSpeakerCapability().denialReason),this._callsAnalyticsService.sendOperationFailureEvent("unmuteSpeaker",a.Services.Call.CallError.CAPABILITY_NOT_ALLOWED),b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.CAPABILITY_NOT_ALLOWED)).promise())},c.prototype.hold=function(c){if(c.getHoldCapability().isAllowed){c._setState(a.Services.Call.CallStates.HOLDING);var d=this._callProvider.hold(c);return d.then(function(){c._heldTime=new Date,c._setState(a.Services.Call.CallStates.HELD),c._onCallHeldCallbacks.fire(c)},function(d){return c.getState()===a.Services.Call.CallStates.HOLDING&&c._setState(a.Services.Call.CallStates.ESTABLISHED),this._callsAnalyticsService.sendOperationFailureEvent("hold",a.Services.Analytics.AnalyticsErrorCode.HOLD_CALL_ERROR),b.Deferred().reject(d).promise()}.bind(this)),d}return a.Base.Logger.error(a.Base.LoggerTags.CALL_SERVICE,"Could not hold call: "+c.getCallId()+": "+c.getHoldCapability().denialReason),this._callsAnalyticsService.sendOperationFailureEvent("hold",a.Services.Call.CallError.CAPABILITY_NOT_ALLOWED),b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.CAPABILITY_NOT_ALLOWED)).promise()},c.prototype.unhold=function(c){var d=this._callManager.getActiveCall(),e=function(){c._setState(a.Services.Call.CallStates.ESTABLISHED),c._onCallUnheldCallbacks.fire(c)},f=function(d){return c.getState()===a.Services.Call.CallStates.UNHOLDING&&c._setState(a.Services.Call.CallStates.HELD),this._callsAnalyticsService.sendOperationFailureEvent("unhold",a.Services.Call.CallError.FAILED),b.Deferred().reject(d).promise()}.bind(this);return c.getUnholdCapability().isAllowed?void 0!==d?(c._setState(a.Services.Call.CallStates.UNHOLDING),d.hold().then(function(){return this._callProvider.unhold(c).then(e,f)}.bind(this),function(){var c=b.Deferred();return this._callsAnalyticsService.sendOperationFailureEvent("unhold",a.Services.Call.CallError.AUTO_HOLD_FAILED),c.reject(new a.Services.Call.CallException(a.Services.Call.CallError.AUTO_HOLD_FAILED)),c.promise()}.bind(this))):this._callProvider.unhold(c).then(e,f):(a.Base.Logger.error(a.Base.LoggerTags.CALL_SERVICE,"Could not un-hold call: "+c.getCallId()+": "+c.getUnholdCapability().denialReason),this._callsAnalyticsService.sendOperationFailureEvent("unhold",a.Services.Call.CallError.CAPABILITY_NOT_ALLOWED),b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.CAPABILITY_NOT_ALLOWED)).promise())},c.prototype.ignore=function(c){var d=b.Deferred();return c.getState()===a.Services.Call.CallStates.ALERTING?(c._setState(a.Services.Call.CallStates.IGNORED),c._onCallIgnoredCallbacks.fire(c),d.resolve()):(a.Base.Logger.error(a.Base.LoggerTags.CALL_SERVICE,"Could not ignore call: "+c.getCallId()+": CALL_STATE_MISMATCH"),this._callsAnalyticsService.sendOperationFailureEvent("ignore",a.Services.Call.CallError.CALL_STATE_MISMATCH),d.reject(new a.Services.Call.CallException(a.Services.Call.CallError.CALL_STATE_MISMATCH))),d.promise()},c.prototype._notifyCallFailure=function(b,c){b._setState(a.Services.Call.CallStates.FAILED),b._callFailedCallbacks.fire(b,new a.Services.Call.CallException(c,void 0,void 0,void 0))},c.prototype._stopCollaboration=function(a){if(this._collaborations){var b;this._collaborations._isCollaborationForCall(a.getCallId())?(b=this._collaborations.getCollaborationForCall(a.getCallId()),b.stop().always(function(){this._collaborations._deleteCollaboration(b._collaborationId)}.bind(this))):this._collaborations._isCollaborationForCall("standalone")&&(b=this._collaborations.getCollaborationForCall("standalone"),b.stop().always(function(){this._collaborations._deleteCollaboration(b._collaborationId)}.bind(this)))}},c.prototype.accept=function(c){c._setIsMissed(!1),this._bandwidthManager.registerCall(c),c.addOnCallEndedCallback(function(a){this._bandwidthManager.unregisterCall(a),this._stopCollaboration(a)}.bind(this));var d=this._getMicrophoneAvailability(),e=this._getSpeakersAvailability();if(this._setupDevicesListeners(c),this._setupAnalyticsListeners(c),d){if(e){if(c.getState()!==a.Services.Call.CallStates.ALERTING&&c.getState()!==a.Services.Call.CallStates.IGNORED)return a.Base.Logger.error(a.Base.LoggerTags.CALL_SERVICE,"Could not accept call: "+c.getCallId()+": CALL_STATE_MISMATCH"),this._callsAnalyticsService.sendOperationFailureEvent("accept",a.Services.Call.CallError.CALL_STATE_MISMATCH),b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.CALL_STATE_MISMATCH)).promise();if(c.getVideoChannels().length>0){this._getCameraAvailability(c)||c.getVideoChannels()[0]._setRequestedDirection(a.Services.Call.MediaDirection.RECV_ONLY)}var f=this._callManager.getActiveCall();return void 0!==f?f.hold().then(function(){return this._callProvider.accept(c,this._mediaServices.getAudioInterface().getInputInterface().getSelectedDevice(),this._mediaServices.getVideoInterface().getSelectedDevice()).fail(function(b){this._callsAnalyticsService.sendOperationFailureEvent("accept",a.Services.Analytics.AnalyticsErrorCode.ACCEPT_CALL_ERROR)}.bind(this))}.bind(this),function(c){var d=b.Deferred();return this._callsAnalyticsService.sendOperationFailureEvent("accept",a.Services.Call.CallError.AUTO_HOLD_FAILED),d.reject(new a.Services.Call.CallException(a.Services.Call.CallError.AUTO_HOLD_FAILED)),d.promise()}.bind(this)):this._callProvider.accept(c,this._mediaServices.getAudioInterface().getInputInterface().getSelectedDevice(),this._mediaServices.getVideoInterface().getSelectedDevice()).fail(function(b){this._callsAnalyticsService.sendOperationFailureEvent("accept",a.Services.Analytics.AnalyticsErrorCode.ACCEPT_CALL_ERROR)}.bind(this))}return a.Base.Logger.error(a.Base.LoggerTags.CALL_SERVICE,"Could not accept call: "+c.getCallId()+": Speakers not available"),this._callsAnalyticsService.sendOperationFailureEvent("accept",a.Services.Call.CallError.SPEAKERS_NOT_FOUND),b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.SPEAKERS_NOT_FOUND))}return a.Base.Logger.error(a.Base.LoggerTags.CALL_SERVICE,"Could not accept call: "+c.getCallId()+": Microphone not available"),this._callsAnalyticsService.sendOperationFailureEvent("accept",a.Services.Call.CallError.MICROPHONE_NOT_FOUND),b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.MICROPHONE_NOT_FOUND))},c.prototype.acceptSendVideo=function(c,d){if(c.getState()!==a.Services.Call.CallStates.FAR_END_RENEGOTIATING)return a.Base.Logger.error(a.Base.LoggerTags.CALL_SERVICE,"Could not acceptSendVideo for call: "+c.getCallId()+": CALL_STATE_MISMATCH"),this._callsAnalyticsService.sendOperationFailureEvent("acceptSendVideo",a.Services.Call.CallError.AUTO_HOLD_FAILED),b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.CALL_STATE_MISMATCH)).promise();this._mediaServices.getVideoInterface().addOnSelectedDeviceChangedCallback(function(b,d){this._callProvider.updateDevices(c,d).fail(function(b){
this._callsAnalyticsService.sendOperationFailureEvent("updateDevices",a.Services.Call.CallError.FAILED)}.bind(this))}.bind(this)),this._getCameraAvailability(c)||(d=a.Services.Call.VideoMode.RECEIVE_ONLY);var e=function(){c.getState()===a.Services.Call.CallStates.FAR_END_RENEGOTIATING&&c._setState(a.Services.Call.CallStates.ESTABLISHED)},f=function(c){return e(),this._callsAnalyticsService.sendOperationFailureEvent("acceptSendVideo",a.Services.Analytics.AnalyticsErrorCode.ACCEPT_SEND_VIDEO_ERROR),b.Deferred().reject(c).promise()}.bind(this);return this._callProvider.acceptSendVideo(c,this._mediaServices.getVideoInterface().getSelectedDevice(),d).then(e,f)},c.prototype.denySendVideo=function(c){if(c.getState()!==a.Services.Call.CallStates.FAR_END_RENEGOTIATING)return a.Base.Logger.error(a.Base.LoggerTags.CALL_SERVICE,"Could not denySendVideo for call: "+c.getCallId()+": CALL_STATE_MISMATCH"),this._callsAnalyticsService.sendOperationFailureEvent("denySendVideo",a.Services.Call.CallError.CALL_STATE_MISMATCH),b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.CALL_STATE_MISMATCH)).promise();var d=function(){c.getState()===a.Services.Call.CallStates.FAR_END_RENEGOTIATING&&c._setState(a.Services.Call.CallStates.ESTABLISHED)},e=function(c){return d(),this._callsAnalyticsService.sendOperationFailureEvent("denySendVideo",a.Services.Analytics.AnalyticsErrorCode.DENY_SEND_VIDEO_ERROR),b.Deferred().reject(c).promise()}.bind(this);return this._callProvider.denySendVideo(c).then(d,e)},c.prototype.transfer=function(c,d){if(c.getTransferCapability().isAllowed){var e=c.getState();return c._setState(a.Services.Call.CallStates.TRANSFERRING),this._callProvider.transfer(c,d).then(function(){c._setState(a.Services.Call.CallStates.ESTABLISHED)},function(d){return a.Base.Logger.error(a.Base.LoggerTags.CALL_SERVICE,"Unattended transfer failed: "+d),c._setState(e),this._callsAnalyticsService.sendOperationFailureEvent("transfer",a.Services.Analytics.AnalyticsErrorCode.TRANSFER_CALL_ERROR),b.Deferred().reject(d).promise()}.bind(this))}return a.Base.Logger.error(a.Base.LoggerTags.CALL_SERVICE,"Could not transfer call: "+c.getCallId()+": "+c.getTransferCapability().denialReason),this._callsAnalyticsService.sendOperationFailureEvent("transfer",a.Services.Call.CallError.CAPABILITY_NOT_ALLOWED),b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.CAPABILITY_NOT_ALLOWED)).promise()},c.prototype.attendedTransfer=function(c,d){if(c.getTransferCapability().isAllowed&&d.getTransferToCapability().isAllowed){var e=c.getState();return c._setState(a.Services.Call.CallStates.TRANSFERRING),this._callProvider.attendedTransfer(c,d).then(function(){c._setState(a.Services.Call.CallStates.ESTABLISHED)},function(d){return a.Base.Logger.error(a.Base.LoggerTags.CALL_SERVICE,"Attended transfer failed: "+d),c._setState(e),this._callsAnalyticsService.sendOperationFailureEvent("attendedTransfer",a.Services.Analytics.AnalyticsErrorCode.ATTENDED_TRANSFER_CALL_ERROR),b.Deferred().reject(d).promise()}.bind(this))}return a.Base.Logger.error(a.Base.LoggerTags.CALL_SERVICE,"Could not attended transfer call: "+c.getCallId()+": "+c.getTransferCapability().denialReason+" "+d.getTransferToCapability().denialReason),this._callsAnalyticsService.sendOperationFailureEvent("attendedTransfer",a.Services.Call.CallError.CAPABILITY_NOT_ALLOWED),b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.CAPABILITY_NOT_ALLOWED)).promise()},c.prototype.join=function(c){if(!c.getJoinCapability().isAllowed)return a.Base.Logger.error(a.Base.LoggerTags.CALL_SERVICE,"Could not join call: "+c.getCallId()+": "+c.getJoinCapability().denialReason),this._callsAnalyticsService.sendOperationFailureEvent("join",a.Services.Call.CallError.CAPABILITY_NOT_ALLOWED),b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.CAPABILITY_NOT_ALLOWED)).promise();var d=this._getMicrophoneAvailability(),e=this._getSpeakersAvailability();if(this._setupDevicesListeners(c),this._setupAnalyticsListeners(c),d){if(e){var f=this._callManager.getActiveCall();return void 0!==f&&f.getCallId()!==c.getCallId()?f.hold().then(function(){return this._callProvider.join(c,this._mediaServices.getAudioInterface().getInputInterface().getSelectedDevice()).fail(function(b){this._callsAnalyticsService.sendOperationFailureEvent("join",a.Services.Analytics.AnalyticsErrorCode.JOIN_CALL_ERROR)}.bind(this))}.bind(this),function(){return this._callsAnalyticsService.sendOperationFailureEvent("join",a.Services.Call.CallError.AUTO_HOLD_FAILED),b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.AUTO_HOLD_FAILED))}.bind(this)):this._callProvider.join(c,this._mediaServices.getAudioInterface().getInputInterface().getSelectedDevice()).fail(function(b){this._callsAnalyticsService.sendOperationFailureEvent("join",a.Services.Analytics.AnalyticsErrorCode.JOIN_CALL_ERROR)}.bind(this))}this._notifyCallFailure(c,a.Services.Call.CallError.SPEAKERS_NOT_FOUND),this._callsAnalyticsService.sendOperationFailureEvent("join",a.Services.Call.CallError.SPEAKERS_NOT_FOUND)}else this._notifyCallFailure(c,a.Services.Call.CallError.MICROPHONE_NOT_FOUND),this._callsAnalyticsService.sendOperationFailureEvent("join",a.Services.Call.CallError.MICROPHONE_NOT_FOUND)},c.prototype.start=function(c){return this._startDfd=b.Deferred(),this._calls=c,this._config.mediaConfiguration&&this._config.mediaConfiguration.voipConfigurationVideo&&this._config.callUserConfiguration.videoMaxBandwidthAnyNetwork&&(this.videoResolution=this._callProvider.getMediaServiceFactory().getMediaServicesService().getUserMedia().adjustVideoResolution(this._config.callUserConfiguration.videoMaxBandwidthAnyNetwork,a.Base.VideoResolution[this._config.mediaConfiguration.voipConfigurationVideo.videoResolution])||a.Base.VideoResolution[this._config.mediaConfiguration.voipConfigurationVideo.videoResolution]),this._recalculateVideoCapability(),this._registerCallbacks(),this._callProvider.on(a.Providers.CallServiceGateway.ObservableEvents.IVIEW_TOKEN_UPDATE,function(a){c._onIviewTokenChanged(a)}.bind(this)),this._callProvider.on(a.Base.NetworkProviderEvents.UNAUTHORIZED,function(){(a.Base.Utils.isUndefined(c._isAvailable)||c._isAvailable)&&(c._isAvailable=!1,c._callsServiceUnavailableCallbacks.fire(c))}.bind(this)),this._callProvider.on(a.Base.NetworkProviderEvents.AUTHORIZED,function(){!a.Base.Utils.isUndefined(c._isAvailable)&&c._isAvailable||(c._isAvailable=!0,c._callsServiceAvailableCallbacks.fire(c))}.bind(this)),this._initAnalyticsMetrics(),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.CALL_SERVICE_AVAILABLE,function(){!a.Base.Utils.isUndefined(c._isAvailable)&&c._isAvailable||(c._isAvailable=!0,c._callsServiceAvailableCallbacks.fire(c)),c._voipCallingCapability._recalculate()}.bind(this)),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.CALL_SERVICE_UNAVAILABLE,function(){(a.Base.Utils.isUndefined(c._isAvailable)||c._isAvailable)&&(c._isAvailable=!1,c._callsServiceUnavailableCallbacks.fire(c)),c._voipCallingCapability._recalculate(),this._startDfd.state()===a.Base.DeferredStates.PENDING&&this._startDfd.reject()}.bind(this)),this._callProvider.start(this._config,this.videoResolution).then(function(b){return this._onContactListChanged=function(){this._callManager.getAllCalls().forEach(this._updateMatchedContactsForCall,this)}.bind(this),this._contactsIntegrationService.addOnContactListChangedCallback(this._onContactListChanged),this._startDfd.state()===a.Base.DeferredStates.PENDING&&this._startDfd.resolve(),!a.Base.Utils.isUndefined(c._isAvailable)&&c._isAvailable||(c._isAvailable=!0,c._callsServiceAvailableCallbacks.fire(c)),b}.bind(this),function(b){this._callsAnalyticsService.sendOperationFailureEvent("start",a.Services.Analytics.AnalyticsErrorCode.STARTING_CALL_ERROR),this._startDfd.reject(b)}.bind(this)),this._startDfd.promise()},c.prototype.stop=function(){return this._callProvider.stop().then(function(a){return this._contactsIntegrationService.removeOnContactListChangedCallback(this._onContactListChanged),this._onContactListChanged=void 0,this._calls=void 0,a}.bind(this),function(c){return this._callsAnalyticsService.sendOperationFailureEvent("stop",a.Services.Analytics.AnalyticsErrorCode.STOPPING_CALL_ERROR),b.Deferred().reject(c).promise()}.bind(this))},c.prototype.stopImmediately=function(){return this._callProvider.stopImmediately().fail(function(b){this._callsAnalyticsService.sendOperationFailureEvent("stopImmediately",a.Services.Call.CallError.FAILED)}.bind(this))},c.prototype.sendDTMF=function(c,d){return c.getSendDTMFCapability().isAllowed?this._callProvider.sendDTMF(c,d).fail(function(b){this._callsAnalyticsService.sendOperationFailureEvent("sendDTMF",a.Services.Analytics.AnalyticsErrorCode.SEND_DTMF_ERROR)}.bind(this)):(a.Base.Logger.error(a.Base.LoggerTags.CALL_SERVICE,"Could not send DTMF for call: "+c.getCallId()+": "+c.getSendDTMFCapability().denialReason),this._callsAnalyticsService.sendOperationFailureEvent("sendDTMF",a.Services.Call.CallError.CAPABILITY_NOT_ALLOWED),b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.CAPABILITY_NOT_ALLOWED)).promise())},c.prototype.isVideoEnabled=function(){var b=a.Base.Utils.queryJSONObject(this._config,"callUserConfiguration.videoEnabled");return this._videoLicenseEnabled&&(!!b||a.Base.Utils.isUndefined(b))},c.prototype.isWebCollaborationEnabled=function(){return!(!a.Base.Utils.isDefined(this._config.wcsConfiguration)||!a.Base.Utils.isDefined(this._config.wcsConfiguration.enabled))&&this._config.wcsConfiguration.enabled},c.prototype.isUccpEnabled=function(){return!(!a.Base.Utils.isDefined(this._config.uccpConfiguration)||!a.Base.Utils.isDefined(this._config.uccpConfiguration.enabled))&&this._config.uccpConfiguration.enabled},c.prototype.setVideoChannels=function(b,c){return 0===c.length?this.setVideoMode(b,a.Services.Call.VideoMode.DISABLE):this.setVideoMode(b,this._getVideoMode(c[0].direction))},c.prototype._getVideoMode=function(b){switch(b){case a.Services.Call.MediaDirection.SEND_RECV:return a.Services.Call.VideoMode.SEND_RECEIVE;case a.Services.Call.MediaDirection.SEND_ONLY:return a.Services.Call.VideoMode.SEND_ONLY;case a.Services.Call.MediaDirection.RECV_ONLY:return a.Services.Call.VideoMode.RECEIVE_ONLY;case a.Services.Call.MediaDirection.DISABLE:return a.Services.Call.VideoMode.DISABLE;default:return a.Services.Call.VideoMode.INACTIVE}},c.prototype.setVideoMode=function(c,d){if(c.getState()===a.Services.Call.CallStates.IDLE||c.getState()===a.Services.Call.CallStates.ALERTING||c.getState()===a.Services.Call.CallStates.IGNORED||c.getUpdateVideoChannelsCapability().isAllowed){if(!this._isSetVideoModeCapabilityAllowed(c,d))return d===a.Services.Call.VideoMode.INACTIVE?b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.UNHANDLED_VIDEO_DIRECTION)):b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.CAPABILITY_NOT_ALLOWED));c.getState()===a.Services.Call.CallStates.ESTABLISHED&&c._setState(a.Services.Call.CallStates.RENEGOTIATING);var e=function(){c.getState()===a.Services.Call.CallStates.RENEGOTIATING&&c._setState(a.Services.Call.CallStates.ESTABLISHED)},f=function(c){return e(),this._callsAnalyticsService.sendOperationFailureEvent("setVideoMode",a.Services.Analytics.AnalyticsErrorCode.SETTING_VIDEO_MODE_ERROR),b.Deferred().reject(c).promise()}.bind(this),g=this._callProvider.setVideoMode(c,d,this._mediaServices.getVideoInterface().getSelectedDevice());return g.then(e,f),g}return a.Base.Logger.error(a.Base.LoggerTags.CALL_SERVICE,"Could not setVideoMode for call: "+c.getCallId()+": "+c.getUpdateVideoChannelsCapability().denialReason),this._callsAnalyticsService.sendOperationFailureEvent("setVideoMode",a.Services.Call.CallError.CAPABILITY_NOT_ALLOWED),b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.CAPABILITY_NOT_ALLOWED)).promise()},c.prototype._isSetVideoModeCapabilityAllowed=function(b,c){switch(c){case a.Services.Call.VideoMode.SEND_RECEIVE:return b.getState()===a.Services.Call.CallStates.IDLE||b.getUpdateVideoModeSendReceiveCapability().isAllowed;case a.Services.Call.VideoMode.SEND_ONLY:return b.getState()===a.Services.Call.CallStates.IDLE||b.getUpdateVideoModeSendOnlyCapability().isAllowed;case a.Services.Call.VideoMode.RECEIVE_ONLY:return b.getState()===a.Services.Call.CallStates.IDLE||b.getUpdateVideoModeReceiveOnlyCapability().isAllowed;case a.Services.Call.VideoMode.INACTIVE:return b.getState()===a.Services.Call.CallStates.IDLE||b.getUpdateVideoModeInactiveCapability().isAllowed;case a.Services.Call.VideoMode.DISABLE:return b.getUpdateVideoModeDisableCapability().isAllowed;default:return!1}},c.prototype.isServiceAvailable=function(){return this._isServiceAvailable},c.prototype.getVideoCapability=function(){return this._videoCapability},c.prototype.getDefaultVideoResolution=function(){return this._config.mediaConfiguration.voipConfigurationVideo.videoResolution},c.prototype._recalculateVideoCapability=function(){var b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED;this.isServiceAvailable()&&this.isVideoEnabled()||(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED),this._videoCapability._updateIfChanged(b,c)},c.prototype.startRinging=function(a){return this._callProvider.startRinging(a)},c.prototype.acceptAnswerCallRequest=function(a){return this._callProvider.acceptAnswerCallRequest(a)},c.prototype.acceptTerminateCallRequest=function(a){return this._callProvider.acceptTerminateCallRequest(a)},c.prototype.acceptUpdateCallRequest=function(a,b){return this._callProvider.acceptUpdateCallRequest(a,b)},c.prototype.acceptMakeCallRequest=function(a){return this._callProvider.acceptMakeCallRequest(a)},c.prototype.rejectAnswerCallRequest=function(a){return this._callProvider.rejectAnswerCallRequest(a)},c.prototype.rejectTerminateCallRequest=function(a){return this._callProvider.rejectTerminateCallRequest(a)},c.prototype.rejectUpdateCallRequest=function(a,b){return this._callProvider.rejectUpdateCallRequest(a,b)},c.prototype.rejectMakeCallRequest=function(a){return this._callProvider.rejectMakeCallRequest(a)},c.prototype._registerCallbacks=function(){this._callProvider._removeListeners(),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.CONFERENCE_ESCALATION,this._conferenceEscalationHandler.bind(this)),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.CALL_STARTED,this._callStartedHandler.bind(this)),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.CALL_RINGING,this._callRingingHandler.bind(this)),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.CALL_ESTABLISHED,this._callEstablishedHandler.bind(this)),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.CALL_ESTABLISHING,this._callEstablishingHandler.bind(this)),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.INCOMING_CALL,this._incomingCallHandler.bind(this)),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.INCOMING_ADD_VIDEO_REQUEST,this._incomingAddVideoRequestHandler.bind(this)),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.INCOMING_ADD_VIDEO_ACCEPTED,this._incomingAddVideoAcceptedHandler.bind(this)),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.INCOMING_ADD_VIDEO_DENIED,this._incomingAddVideoDeniedHandler.bind(this)),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.INCOMING_ADD_VIDEO_TIMEDOUT,this._incomingAddVideoTimedOutHandler.bind(this)),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.INCOMING_HOLD,this._incomingHoldHandler.bind(this)),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.INCOMING_UNHOLD,this._incomingUnholdHandler.bind(this)),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.VIDEO_CHANNEL_UPDATE,this._videoChannelUpdateHandler.bind(this)),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.CALL_ENDED,this._callEndedHandler.bind(this)),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,this._callFailureHandler.bind(this)),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.CALL_SERVICE_UNAVAILABLE,this._callServiceUnavailableHandler.bind(this)),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.CALL_SERVICE_AVAILABLE,this._callServiceAvailableHandler.bind(this)),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.REMOTE_ADDRESS_CHANGED,this._remoteAddressChangedHandler.bind(this)),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.REMOTE_CALL_CREATED,this._remoteCallCreatedHandler.bind(this)),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.VIDEO_LICENSE_UPDATED,this._videoLicenseUpdatedHandler.bind(this)),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.RINGBACK_TONE_URLS_CHANGED,this._ringbackToneURLsChangedHandler.bind(this)),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.ANSWER_CALL_REQUESTED,this._answerCallRequestedHandler.bind(this)),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.TERMINATE_CALL_REQUESTED,this._terminateCallRequestedHandler.bind(this)),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.UPDATE_CALL_REQUESTED,this._updateCallRequestedHandler.bind(this)),this._callProvider.on(a.Providers.Interfaces.CallProviderCallbackIds.MAKE_CALL_REQUESTED,this._makeCallRequestedHandler.bind(this))},c.prototype._conferenceEscalationHandler=function(b,c,d){var e;if(d=this._config.wcsConfiguration.enabled&&a.Base.Utils.isNotEmptyString(d)?d:void 0,b.isConference())a.Base.Utils.isDefined(c)&&null!==c&&(this._config.uccpConfiguration.enabled?(b._conference._isStarted?b._conference.stop().then(function(){e=this._parseUccpUrl(c),b._conference._setConfiguration(e)}.bind(this)):(e=this._parseUccpUrl(c),b._conference._setConfiguration(e)),a.Base.Utils.isDefined(d)&&this.createCollaborationForConference(b,d)):c=void 0),b._conference._collaborationURI=d;else if(a.Base.Utils.isDefined(c)&&null!==c)if(this._config.uccpConfiguration.enabled){e=this._parseUccpUrl(c);var f=this._scopiaConferenceProviderFactory.getScopiaConferenceProvider(e),g=new a.Services.Conference.Chat(this.createChatService(f)),h=this.createParticipantService(f),i=new a.Services.Conference.ConferenceService(a.Services.Conference.ConferenceType.SCOPIA_CONFERENCE,f,this._contactsIntegrationService);b._setConference(new a.Services.Conference.Conference(i,h,g)),b._conference._collaborationURI=d,a.Base.Utils.isDefined(d)&&this.createCollaborationForConference(b,d),b._conference._isUccpConference=!0,b._conference._setConfiguration(e)}else c=void 0;else b._createCMConference();b._onCallConferenceStatusChangedCallbacks.fire(b,!0,c,d)},c.prototype.getScopiaConferenceProvider=function(b){var c=a.Base.Utils.isDefined(b)?b:this._config.uccpConfiguration;return this._scopiaConferenceProviderFactory.getScopiaConferenceProvider(c)},c.prototype.createChatService=function(b){return new a.Services.Conference.ChatService(b)},c.prototype.createParticipantService=function(b){return new a.Services.Conference.ParticipantService(b)},c.prototype.createCollaborationForConference=function(b,c){if(b.getCallId()?b._conference._setCollaboration(this._collaborations.getCollaborationForCall(b.getCallId())):b._conference._setCollaboration(this._collaborations.getCollaborationForCall("standalone")),a.Base.Utils.isDefined(c)){var d=this._parseWebCollabUrl(c);this._config.wcsConfiguration=d,b._conference._collaboration._setConfiguration(this._config,d.meetingId)}b._conference.addOnConferenceCollaborationURIChangedCallback(function(c,e){d=this._parseWebCollabUrl(e),(b._conference._collaborationURI!==e||a.Base.Utils.isUndefined(c._collaboration._config))&&(c._collaboration._isStarted?c._collaboration.stop().then(function(){this._config.wcsConfiguration=d,c._collaboration._setConfiguration(this._config,d.meetingId),c._collaboration.start()}.bind(this)):(this._config.wcsConfiguration=d,c._collaboration._setConfiguration(this._config,d.meetingId)))}.bind(this))},c.prototype._parseUccpUrl=function(b){var c=a.Base.Utils.parseUrl(b);return{enabled:!0,networkProviderConfiguration:{webSocketConfig:new a.Config.ServerInfo(c.hostname,c.port,c.isSecure,c.path,c.credentials,c.query)}}},c.prototype._parseWebCollabUrl=function(b){var c;if(a.Base.Utils.isDefined(b)){var d=a.Base.Utils.parseUrl(b),e=d.path.indexOf("/viewer.php"),f=d.path.substring(0,e),g="https:"===document.location.protocol||"chrome-extension:"===document.location.protocol,h=new a.Config.ServerInfo(d.hostname,d.port,g,f),i=d.query.split("&").map(function(a){var b=a.split("=");return{key:b[0],value:b[1]}});i.getValue=function(a){var b=this.filter(function(b){return b.key===a});return 0!==b.length?b[0].value:null};var j=i.getValue("token"),k=i.getValue("meeting_id"),l=i.getValue("mode"),m=i.getValue("login"),n=i.getValue("participantId");c={enabled:!0,meetingId:k,credentialProvider:new a.Config.WCSCredentialTokenProvider(j,m,n,void 0,l),networkProviderConfiguration:{restConfig:h}}}return c},c.prototype._callStartedHandler=function(a){a._onCallStartedCallbacks.fire(a)},c.prototype._callRingingHandler=function(b,c){b.getState()===a.Services.Call.CallStates.ESTABLISHED?b._setState(a.Services.Call.CallStates.BEING_TRANSFERRED):b.getState()!==a.Services.Call.CallStates.HELD&&b._setState(a.Services.Call.CallStates.REMOTE_ALERTING),b._isEarlyMedia=c,b._sendDTMFCapability._recalculate(c),b._onCallRemoteAlertingCallbacks.fire(b,c),a.Base.Utils.isDefined(b._dtmfString)&&c&&this._handleDTMFString(b)},c.prototype._callEstablishedHandler=function(b,c,d,e,f,g){b.getState()!==a.Services.Call.CallStates.HELD&&b._setState(a.Services.Call.CallStates.ESTABLISHED),b._heldRemotely=!1,b._establishedTime=new Date,a.Base.Utils.isDefined(e)&&b._setUserToUserInfo(new a.Services.Call.UserToUserInfo(e,f,g)),b._onCallEstablishedCallbacks.fire(b),b.isRemote()&&!1===d&&(this._callManager.setLastMissedCall(void 0),b._setRemote(!1),b._setIsMissed(!1),b._onCallJoinedCallbacks.fire(b)),a.Base.Utils.isDefined(b._dtmfString)&&!b._isEarlyMedia&&this._handleDTMFString(b),this._callsAnalyticsService.sendCallInfo(b._incoming,b._videoChannels.length),this._callsAnalyticsService.sendCallType(c)},c.prototype._callEstablishingHandler=function(b){var c=b.getUserToUserInfo();c&&a.Base.Utils.isDefined(c.getUCID())&&b._onCallEstablishingCallbacks.fire(b)},c.prototype._remoteCallCreatedHandler=function(b,c,d,e,f,g,h,i){var j=this._callManager.createRemoteOrIncomingCall(this,b,c,d,e,f,g,h,i,a.Services.Call.CallStates.ESTABLISHED,!0,!1);this._callProvider.registerIncomingOrRemoteCall(j)},c.prototype._incomingCallHandler=function(b,c,d,e,f,g,h,i,j,k,l){var m=this._callManager.createRemoteOrIncomingCall(this,b,c,d,e,f,g,h,i,a.Services.Call.CallStates.ALERTING,!1,!0);a.Base.Utils.isDefined(j)&&m._setUserToUserInfo(new a.Services.Call.UserToUserInfo(j,k,l)),this._callProvider.registerIncomingOrRemoteCall(m),this.trigger(a.Providers.Interfaces.CallServiceCallbackIds.INCOMING_CALL,[m])},c.prototype._incomingAddVideoRequestHandler=function(b,c){b._setState(a.Services.Call.CallStates.FAR_END_RENEGOTIATING),b._onCallIncomingVideoAddRequestReceivedCallbacks.fire(b,c)},c.prototype._incomingAddVideoAcceptedHandler=function(a){a._onCallIncomingVideoAddRequestAcceptedCallbacks.fire(a)},c.prototype._incomingAddVideoDeniedHandler=function(a){a._onCallIncomingVideoAddRequestDeniedCallbacks.fire(a)},c.prototype._incomingAddVideoTimedOutHandler=function(b){b.getState()===a.Services.Call.CallStates.FAR_END_RENEGOTIATING&&b._setState(a.Services.Call.CallStates.ESTABLISHED),b._onCallIncomingVideoAddRequestTimedOutCallbacks.fire(b)},c.prototype._incomingHoldHandler=function(a){a._heldTime=new Date,a._heldRemotely=!0,a._onCallHeldRemotelyCallbacks.fire(a)},c.prototype._incomingUnholdHandler=function(a){a._heldRemotely=!1,a._onCallUnheldRemotelyCallbacks.fire(a)},c.prototype._videoChannelUpdateHandler=function(b){b.getState()===a.Services.Call.CallStates.ESTABLISHED&&(b._updateVideoModeSendReceiveCapability._recalculate(),b._updateVideoModeSendOnlyCapability._recalculate(),b._updateVideoModeReceiveOnlyCapability._recalculate(),b._updateVideoModeInactiveCapability._recalculate(),b._updateVideoModeDisableCapability._recalculate()),b._onCallVideoChannelsUpdatedCallback.fire(b,b._videoChannels)},c.prototype._videoEscalationRejectedHandler=function(a){a._videoChannels=videoChannels,a._onCallVideoChannelsUpdatedCallback.fire(a,videoChannels)},c.prototype._callEndedHandler=function(b,c,d){b.isConference()&&this._stopConferenceCall(b),b.getState()!==a.Services.Call.CallStates.ALERTING&&b.getState()!==a.Services.Call.CallStates.IGNORED||(b._setIsMissed(!0),this._callManager.setLastMissedCall(b)),b.getState()!==a.Services.Call.CallStates.ENDING||d&&d.getCause()||(c=!1);var e=this._createEndCallEvent(c,d);b._setState(a.Services.Call.CallStates.ENDED),b._onCallEndedCallbacks.fire(b,e),this._callManager.deleteCall(b)},c.prototype._callFailureHandler=function(b,c,d,e,f){var g=c;c!==a.Services.Call.CallError.NOT_FOUND||b.getState()!==a.Services.Call.CallStates.ENDING&&b.getState()!==a.Services.Call.CallStates.ENDED||(g=a.Services.Call.CallError.ENDED);var h=new a.Services.Call.CallException(g,d,e,f);b._callFailedCallbacks.fire(b,h),this._callsAnalyticsService.sendDroppedCallEvent(g)},c.prototype._callServiceUnavailableHandler=function(b){this._isServiceAvailable=!1,this._recalculateVideoCapability(),a.Base.Utils.isDefined(b)&&(b._setServiceAvailability(!1),b._callServiceUnavailableCallbacks.fire(b))},c.prototype._callServiceAvailableHandler=function(b){this._isServiceAvailable=!0,this._recalculateVideoCapability(),a.Base.Utils.isDefined(b)&&(b._setServiceAvailability(!0),b._callServiceAvailableCallbacks.fire(b))},c.prototype._remoteAddressChangedHandler=function(b,c,d){a.Base.Utils.isDefined(b)&&(a.Base.Utils.isDefined(c)&&b._setRemoteAddress(c),a.Base.Utils.isDefined(d)&&b._setRemoteDisplayName(d),b._onCallRemoteAddressChangedCallbacks.fire(b))},c.prototype._videoLicenseUpdatedHandler=function(a){this._videoLicenseEnabled!==a&&(this._videoLicenseEnabled=a,this._recalculateVideoCapability())},c.prototype._buildUccpConfig=function(b){var c=this._config.uccpConfiguration,d=a.Base.Utils.parseUrl(b);return c.networkProviderConfiguration.webSocketConfig.hostName=d.hostname,c.networkProviderConfiguration.webSocketConfig.port=d.port,c.networkProviderConfiguration.webSocketConfig.isSecure=d.isSecure,c.networkProviderConfiguration.webSocketConfig.path=d.path,c},c.prototype._updateMatchedContactsForCall=function(a){a&&this._contactsIntegrationService.updateMatchedContactsForParticipant(a.getRemoteParticipant())},c.prototype._handleDTMFString=function(b){var c,d=2e3,e=200,f=2e3,g=function(){if(0===b._dtmfString.length)clearTimeout(c);else{var a=b._dtmfString.shift();","!==a?(this.sendDTMF(b,this._convertToDtmf(a)),c=setTimeout(g.bind(this),e)):c=setTimeout(g.bind(this),f)}};setTimeout(function(){a.Base.Logger.info(a.Base.LoggerTags.CALL_SERVICE,"Handle DTMF string passed as part of dial string"),c=setTimeout(g.bind(this),e)}.bind(this),d)},c.prototype._convertToDtmf=function(b){var c;switch(b){case"1":c=a.Services.Call.DTMFTone.ONE;break;case"2":c=a.Services.Call.DTMFTone.TWO;break;case"3":c=a.Services.Call.DTMFTone.THREE;break;case"4":c=a.Services.Call.DTMFTone.FOUR;break;case"5":c=a.Services.Call.DTMFTone.FIVE;break;case"6":c=a.Services.Call.DTMFTone.SIX;break;case"7":c=a.Services.Call.DTMFTone.SEVEN;break;case"8":c=a.Services.Call.DTMFTone.EIGHT;break;case"9":c=a.Services.Call.DTMFTone.NINE;break;case"0":c=a.Services.Call.DTMFTone.ZERO;break;case"A":c=a.Services.Call.DTMFTone.A;break;case"B":c=a.Services.Call.DTMFTone.B;break;case"C":c=a.Services.Call.DTMFTone.C;break;case"D":c=a.Services.Call.DTMFTone.D;break;case"*":c=a.Services.Call.DTMFTone.STAR;break;case"#":c=a.Services.Call.DTMFTone.POUND;break;default:a.Base.Logger.warn(a.Base.LoggerTags.CALL_SERVICE,"{0} is not a DTMF symbol",b)}return c},c.prototype.createCMConference=function(b){var c=new a.Providers.CM.CMConferenceProvider(this._callProvider,b.getCallId()),d=new a.Services.Conference.ConferenceService(a.Services.Conference.ConferenceType.CM_CONFERENCE,c,this._contactsIntegrationService);return new a.Services.Conference.Conference(d)},c.prototype._disconnectCallFromConference=function(a){a.isConference()&&a.getConference()._disconnect()},c.prototype._stopConferenceCall=function(a){a.isConference()&&(a.getConference()._disconnect(),a.getConference().stop(),a._conference._setCollaboration(void 0),a._setConference(void 0))},c.prototype.getAudioDetails=function(a){return this._getCallStatistics(a).then(function(a){return a.audioStatistics})},c.prototype.getVideoDetails=function(a){return this._getCallStatistics(a).then(function(a){return a.videoStatistics})},c.prototype._getCallStatistics=function(c){return this._callProvider.getCallStatistics(c).then(function(b){switch(a.Base.Utils.getBrowserType()){case a.Base.BrowserType.CHROME:case a.Base.BrowserType.CHROME_EXTENSION:var c=this._parseChromeStatistics(b);return a.Base.Logger.debug(a.Base.LoggerTags.CALL_SERVICE,"Call statistics download successful: ",c),c;case a.Base.BrowserType.FIREFOX:var d=this._parseFirefoxStatistics(b);return a.Base.Logger.debug(a.Base.LoggerTags.CALL_SERVICE,"Call statistics download successful: ",d),d;default:return{}}}.bind(this),function(c){return this._callsAnalyticsService.sendOperationFailureEvent("_getCallStatistics",a.Services.Analytics.AnalyticsErrorCode.GETTING_CALL_STATISTICS_ERROR),b.Deferred().reject(c).promise()}.bind(this))},c.prototype._parseChromeStatistics=function(b){var c,d,e,f,g,h,i,j,k,l;return b.result().forEach(function(a){var b=a.stat("mediaType");"ssrc"===a.type&&a.id.indexOf("send")>-1&&"audio"===b&&(c=a),"ssrc"===a.type&&a.id.indexOf("send")>-1&&"video"===b&&(e=a),"ssrc"===a.type&&a.id.indexOf("recv")>-1&&"audio"===b&&(d=a),"ssrc"===a.type&&a.id.indexOf("recv")>-1&&"video"===b&&(f=a)}),d&&c&&(g={bytesReceived:parseInt(d.stat("bytesReceived")),packetsReceived:parseInt(d.stat("packetsReceived")),packetsLost:parseInt(d.stat("packetsLost")),googJitterReceived:parseInt(d.stat("googJitterReceived"))},h={bytesSent:parseInt(c.stat("bytesSent")),packetsSent:parseInt(c.stat("packetsSent")),googRtt:parseInt(c.stat("googRtt")),packetsLost:parseInt(c.stat("packetsLost"))},""===c.stat("packetsLost")&&(h.packetsLost=0),""===c.stat("googRtt")&&(h.googRtt=0),k=new a.Services.Call.AudioDetails(g.bytesReceived,h.bytesSent,g.packetsReceived,h.packetsSent,h.googRtt,h.packetsLost,g.packetsLost,g.googJitterReceived)),f&&e&&(i={bytesReceived:parseInt(f.stat("bytesReceived")),actualBitRateReceived:void 0,packetsReceived:parseInt(f.stat("packetsReceived")),packetsLost:parseInt(f.stat("packetsLost")),googFrameRateReceived:parseInt(f.stat("googFrameRateReceived"))},a.Base.Utils.isUndefined(i.packetsLost)&&(i.packetsLost=0),a.Base.Utils.isUndefined(i.packetsReceived)&&(i.packetsReceived=0),0===i.packetsReceived?i.packetsLossFractionReceived=0:i.packetsLossFractionReceived=f.stat("packetsLost")/f.stat("packetsReceived"),j={bytesSent:parseInt(e.stat("bytesSent")),actualBitRateTransmitted:void 0,packetsSent:parseInt(e.stat("packetsSent")),packetsLost:parseInt(e.stat("packetsLost")),googFrameRateSent:parseInt(e.stat("googFrameRateSent"))},a.Base.Utils.isUndefined(j.packetsLost)&&(j.packetsLost=0),a.Base.Utils.isUndefined(j.packetsSent)&&(j.packetsSent=0),0===j.packetsSent?j.packetsLossFractionTransmitted=0:j.packetsLossFractionTransmitted=e.stat("packetsLost")/e.stat("packetsSent"),
l=new a.Services.Call.VideoDetails(j.bytesSent,i.bytesReceived,j.actualBitRateTransmitted,i.actualBitRateReceived,j.packetsSent,i.packetsReceived,j.packetsLost,i.packetsLost,j.packetsLossFractionTransmitted,i.packetsLossFractionReceived,j.googFrameRateSent,i.googFrameRateReceived)),{audioStatistics:k,videoStatistics:l}},c.prototype._parseFirefoxStatistics=function(b){var c,d,e={},f={},g={},h={};return a.Base.Utils.isDefined(b.inbound_rtp_audio_0)&&(e.bytesReceived=b.inbound_rtp_audio_0.bytesReceived,e.packetsReceived=b.inbound_rtp_audio_0.packetsReceived,e.packetsLost=b.inbound_rtp_audio_0.packetsLost,e.jitterReceived=b.inbound_rtp_audio_0.jitter),a.Base.Utils.isDefined(b.outbound_rtp_audio_0)&&(f.bytesSent=b.outbound_rtp_audio_0.bytesSent,f.packetsSent=b.outbound_rtp_audio_0.packetsSent),a.Base.Utils.isDefined(b.outbound_rtcp_audio_0)&&(f.mozRtt=b.outbound_rtcp_audio_0.mozRtt,f.packetsLost=b.outbound_rtcp_audio_0.packetsLost),a.Base.Utils.isUndefined(f.packetsLost)&&(f.packetsLost=0),a.Base.Utils.isUndefined(f.mozRtt)&&(f.mozRtt=0),c=new a.Services.Call.AudioDetails(e.bytesReceived,f.bytesSent,e.packetsReceived,f.packetsSent,f.mozRtt,f.packetsLost,e.packetsLost,e.jitterReceived),a.Base.Utils.isDefined(b.inbound_rtp_video_1)&&(g.bytesReceived=b.inbound_rtp_video_1.bytesReceived,g.actualBitRateReceived=b.inbound_rtp_video_1.bitrateMean,g.packetsReceived=b.inbound_rtp_video_1.packetsReceived,g.packetsLost=b.inbound_rtp_video_1.packetsLost,g.frameRateReceived=b.inbound_rtp_video_1.framerateMean),a.Base.Utils.isUndefined(g.packetsLost)&&(g.packetsLost=0),a.Base.Utils.isUndefined(g.packetsReceived)&&(g.packetsReceived=0),0===g.packetsReceived?g.packetsLossFractionReceived=0:g.packetsLossFractionReceived=g.packetsLost/g.packetsReceived,a.Base.Utils.isDefined(b.outbound_rtcp_video_1)&&(h.packetsLost=b.outbound_rtcp_video_1.packetsLost),a.Base.Utils.isDefined(b.outbound_rtp_video_1)&&(h.bytesSent=b.outbound_rtp_video_1.bytesSent,h.actualBitRateTransmitted=b.outbound_rtp_video_1.bitrateMean,h.packetsSent=b.outbound_rtp_video_1.packetsSent,h.frameRateSent=b.outbound_rtp_video_1.framerateMean),a.Base.Utils.isUndefined(h.packetsLost)&&(h.packetsLost=0),a.Base.Utils.isUndefined(h.packetsSent)&&(h.packetsSent=0),0===h.packetsSent?h.packetsLossFractionTransmitted=0:h.packetsLossFractionTransmitted=h.packetsLost/h.packetsSent,d=new a.Services.Call.VideoDetails(h.bytesSent,g.bytesReceived,h.actualBitRateTransmitted,g.actualBitRateReceived,h.packetsSent,g.packetsReceived,h.packetsLost,g.packetsLost,h.packetsLossFractionTransmitted,g.packetsLossFractionReceived,h.frameRateSent,g.frameRateReceived),{audioStatistics:c,videoStatistics:d}},c.prototype._ringbackToneURLsChangedHandler=function(a){this._calls&&this._calls._onRingbackToneURLsChangedCallback.fire(a)},c.prototype._answerCallRequestedHandler=function(a){a._answerCallRequestedCallbacks.fire(a)},c.prototype._terminateCallRequestedHandler=function(a){a._terminateCallRequestedCallbacks.fire(a)},c.prototype._updateCallRequestedHandler=function(a,b){a._updateCallRequestedCallbacks.fire(a,b)},c.prototype._makeCallRequestedHandler=function(b,c,d,e,f){var g=this._callManager.createMakeCall(this,b,c,d,e,f);this._callProvider.registerIncomingOrRemoteCall(g),this.trigger(a.Providers.Interfaces.CallServiceCallbackIds.MAKE_CALL_REQUESTED,[g])},c.prototype._isMakeCallAllowed=function(b){var c=a.Base.Utils.getBrowserType();return!(!b._isDataOnly()&&c!==a.Base.BrowserType.CHROME&&c!==a.Base.BrowserType.CHROME_EXTENSION&&c!==a.Base.BrowserType.FIREFOX&&c!==a.Base.BrowserType.FIREFOX_EXTENSION)},c.prototype._createEndCallEvent=function(b,c){var d;if(b)if(c&&c.getCause()){if(d=new a.Services.Call.CallEndEvent(a.Services.Call.CallEndReason.CALL_DISCONNECTED_UNKNOWN_REASON,c.getProtocol(),c.getCause(),c.getText()),"avaya-action"===c.getProtocol())switch(c.getCause()){case 200:d._setReason(a.Services.Call.CallEndReason.DISCONNECTED_BY_CONFERENCE_MODERATOR);break;case 201:d._setReason(a.Services.Call.CallEndReason.CONFERENCE_TERMINATED);break;case 202:d._setReason(a.Services.Call.CallEndReason.CALL_DISCONNECTED);break;case 450:d._setReason(a.Services.Call.CallEndReason.DTLS_FAILURE);break;case 451:d._setReason(a.Services.Call.CallEndReason.ICE_FAILURE)}}else d=new a.Services.Call.CallEndEvent(a.Services.Call.CallEndReason.CALL_DISCONNECTED);else d=new a.Services.Call.CallEndEvent(a.Services.Call.CallEndReason.CALL_ENDED_LOCALLY);return d},a.Services.Call.CallService=c}(AvayaClientServices,jQuery),function(a){"use strict";var b={FAR_END_RENEGOTIATING:"far_end_renegotiating",IDLE:"idle",IGNORED:"ignored",INITIATING:"initiating",REMOTE_ALERTING:"remote_alerting",RENEGOTIATING:"renegotiating",FAILED:"failed",ALERTING:"alerting",HELD:"held",ENDED:"ended",ENDING:"ending",HOLDING:"holding",UNHOLDING:"unholding",ESTABLISHED:"established",BEING_TRANSFERRED:"being_transferred",TRANSFERRING:"transferring"};a.Services.Call.CallStates=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";var b={CallTypeDefaultRegisteredService:"DefaultRegisteredService",CallTypeHttpMeetMe:"HttpMeetMe"};a.Services.Call.CallType=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b,c,d,e,f,g){a.Base.Capability.call(this,a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._call=b,this._validCallStates=c,this._mediaPreservedAllowed=d,this._validForRemote=e,this._validForLocal=f,this._validForBrowsers=g,b._addOnCallStateChangedCallback(this._recalculate.bind(this)),b.addOnCallServiceAvailableCallback(this._recalculate.bind(this)),b.addOnCallServiceUnavailableCallback(this._recalculate.bind(this)),b.addOnCallJoinedCallback(this._recalculate.bind(this))}b.prototype=Object.create(a.Base.Capability.prototype),b.prototype._recalculateDenialReason=function(){var b=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED;return-1===this._validCallStates.indexOf(this._call.getState())||!this._mediaPreservedAllowed&&!this._call.isServiceAvailable()?b=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE:this._call.isRemote()&&!this._validForRemote?b=a.Base.CapabilityDenialReason.CAPABILITY_CALL_IS_REMOTE:this._call.isRemote()||this._validForLocal?this._isSupportedBrowser()||(b=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):b=a.Base.CapabilityDenialReason.CAPABILITY_CALL_IS_NOT_REMOTE,b},b.prototype._recalculate=function(){var b=this._recalculateDenialReason(),c=b===a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED;this._updateIfChanged(c,b)},b.prototype._isSupportedBrowser=function(){var b=a.Base.Utils.getBrowserType();return!this._validForBrowsers||-1!==this._validForBrowsers.indexOf(b)},a.Services.Call.Capabilities.AbstractCallStateCapability=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c=[a.Services.Call.CallStates.ESTABLISHED],d=[a.Base.BrowserType.CHROME,a.Base.BrowserType.CHROME_EXTENSION];a.Services.Call.Capabilities.AbstractCallStateCapability.call(this,b,c,!1,!1,!0,d)}b.prototype=Object.create(a.Services.Call.Capabilities.AbstractCallStateCapability.prototype),a.Services.Call.Capabilities.HoldCapability=b}(AvayaClientServices),function(a){"use strict";function b(b){var c=[a.Services.Call.CallStates.ESTABLISHED,a.Services.Call.CallStates.HELD];a.Services.Call.Capabilities.AbstractCallStateCapability.call(this,b,c,!1,!0,!1)}b.prototype=Object.create(a.Services.Call.Capabilities.AbstractCallStateCapability.prototype),a.Services.Call.Capabilities.JoinCapability=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c=[a.Services.Call.CallStates.ESTABLISHED,a.Services.Call.CallStates.RENEGOTIATING,a.Services.Call.CallStates.FAR_END_RENEGOTIATING];a.Services.Call.Capabilities.AbstractCallStateCapability.call(this,b,c,!0,!1,!0)}b.prototype=Object.create(a.Services.Call.Capabilities.AbstractCallStateCapability.prototype),b.prototype._recalculate=function(b){var c=a.Services.Call.Capabilities.AbstractCallStateCapability.prototype._recalculateDenialReason.call(this),d=c===a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED;!d&&b&&this._call.getState()===a.Services.Call.CallStates.REMOTE_ALERTING&&(d=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._updateIfChanged(d,c)},a.Services.Call.Capabilities.SendDTMFCapability=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c=[a.Services.Call.CallStates.ESTABLISHED];b.addOnCallConferenceStatusChangedCallback(function(){this._recalculate()}.bind(this)),a.Services.Call.Capabilities.AbstractCallStateCapability.call(this,b,c,!1,!1,!0)}b.prototype=Object.create(a.Services.Call.Capabilities.AbstractCallStateCapability.prototype),b.prototype._recalculate=function(){var b=a.Services.Call.Capabilities.AbstractCallStateCapability.prototype._recalculateDenialReason.call(this),c=b===a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED;c&&this._call.isConference()&&(c=!1,b=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateIfChanged(c,b)},a.Services.Call.Capabilities.TransferCapability=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c=[a.Services.Call.CallStates.ESTABLISHED,a.Services.Call.CallStates.HELD];b.addOnCallConferenceStatusChangedCallback(function(){this._recalculate()}.bind(this)),a.Services.Call.Capabilities.AbstractCallStateCapability.call(this,b,c,!1,!1,!0)}b.prototype=Object.create(a.Services.Call.Capabilities.AbstractCallStateCapability.prototype),b.prototype._recalculate=function(){var b=a.Services.Call.Capabilities.AbstractCallStateCapability.prototype._recalculateDenialReason.call(this),c=b===a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED;c&&this._call.isConference()&&(c=!1,b=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateIfChanged(c,b)},a.Services.Call.Capabilities.TransferToCapability=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){var c=[a.Services.Call.CallStates.HELD],d=[a.Base.BrowserType.CHROME,a.Base.BrowserType.CHROME_EXTENSION];a.Services.Call.Capabilities.AbstractCallStateCapability.call(this,b,c,!1,!1,!0,d)}b.prototype=Object.create(a.Services.Call.Capabilities.AbstractCallStateCapability.prototype),a.Services.Call.Capabilities.UnholdCapability=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b,c){this._videoCapability=c,this._videoCapability.addOnChangedCallback(this._recalculate.bind(this));var d=[a.Services.Call.CallStates.ESTABLISHED];a.Services.Call.Capabilities.AbstractCallStateCapability.call(this,b,d,!1,!1,!0)}b.prototype=Object.create(a.Services.Call.Capabilities.AbstractCallStateCapability.prototype),b.prototype._recalculate=function(){var b=a.Services.Call.Capabilities.AbstractCallStateCapability.prototype._recalculateDenialReason.call(this),c=b===a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED;c&&!this._videoCapability.isAllowed&&(c=!1,b=this._videoCapability.denialReason),this._updateIfChanged(c,b)},a.Services.Call.Capabilities.UpdateVideoChannelsCapability=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b,c){this._videoCapability=c,this._videoCapability.addOnChangedCallback(this._recalculate.bind(this));var d=[a.Services.Call.CallStates.ESTABLISHED],e=[a.Base.BrowserType.CHROME,a.Base.BrowserType.CHROME_EXTENSION];a.Services.Call.Capabilities.AbstractCallStateCapability.call(this,b,d,!1,!1,!0,e)}b.prototype=Object.create(a.Services.Call.Capabilities.AbstractCallStateCapability.prototype),b.prototype._recalculate=function(){var b=a.Services.Call.Capabilities.AbstractCallStateCapability.prototype._recalculateDenialReason.call(this),c=b===a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED,d=this._call.getVideoChannels(),e=d.length>0&&d[0].getNegotiatedDirection()!==a.Services.Call.MediaDirection.INACTIVE&&d[0].getNegotiatedDirection()!==a.Services.Call.MediaDirection.DISABLE;!c||this._videoCapability.isAllowed&&e||(c=!1,b=this._videoCapability.isAllowed?a.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED:this._videoCapability.denialReason),this._updateIfChanged(c,b)},a.Services.Call.Capabilities.UpdateVideoModeDisableCapability=b}(AvayaClientServices),function(a){"use strict";function b(b,c){this._videoCapability=c,this._videoCapability.addOnChangedCallback(this._recalculate.bind(this));var d=[a.Services.Call.CallStates.IDLE,a.Services.Call.CallStates.IGNORED];a.Services.Call.Capabilities.AbstractCallStateCapability.call(this,b,d,!1,!1,!0)}b.prototype=Object.create(a.Services.Call.Capabilities.AbstractCallStateCapability.prototype),b.prototype._recalculate=function(){var b=a.Services.Call.Capabilities.AbstractCallStateCapability.prototype._recalculateDenialReason.call(this),c=b===a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED,d=this._call.getVideoChannels(),e=d.length>0&&d[0].getNegotiatedDirection()!==a.Services.Call.MediaDirection.INACTIVE&&d[0].getNegotiatedDirection()!==a.Services.Call.MediaDirection.DISABLE;!c||this._videoCapability.isAllowed&&e||(c=!1,b=this._videoCapability.isAllowed?a.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED:this._videoCapability.denialReason),this._updateIfChanged(c,b)},a.Services.Call.Capabilities.UpdateVideoModeInactiveCapability=b}(AvayaClientServices),function(a){"use strict";function b(b,c){this._videoCapability=c,this._videoCapability.addOnChangedCallback(this._recalculate.bind(this));var d=[a.Services.Call.CallStates.IDLE,a.Services.Call.CallStates.IGNORED,a.Services.Call.CallStates.ALERTING,a.Services.Call.CallStates.ESTABLISHED];a.Services.Call.Capabilities.AbstractCallStateCapability.call(this,b,d,!1,!1,!0)}b.prototype=Object.create(a.Services.Call.Capabilities.AbstractCallStateCapability.prototype),b.prototype._recalculate=function(){var b=a.Services.Call.Capabilities.AbstractCallStateCapability.prototype._recalculateDenialReason.call(this),c=b===a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED,d=this._call.getVideoChannels(),e=0===d.length&&this._call.getState()!==a.Services.Call.CallStates.ESTABLISHED||d.length>0&&d[0].getNegotiatedDirection()!==a.Services.Call.MediaDirection.RECV_ONLY;!c||this._videoCapability.isAllowed&&e||(c=!1,b=this._videoCapability.isAllowed?a.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED:this._videoCapability.denialReason),this._updateIfChanged(c,b)},a.Services.Call.Capabilities.UpdateVideoModeReceiveOnlyCapability=b}(AvayaClientServices),function(a){"use strict";function b(b,c){this._videoCapability=c,this._videoCapability.addOnChangedCallback(this._recalculate.bind(this));var d=[a.Services.Call.CallStates.IDLE,a.Services.Call.CallStates.IGNORED,a.Services.Call.CallStates.ALERTING,a.Services.Call.CallStates.ESTABLISHED],e=[a.Base.BrowserType.CHROME,a.Base.BrowserType.CHROME_EXTENSION];a.Services.Call.Capabilities.AbstractCallStateCapability.call(this,b,d,!1,!1,!0,e)}b.prototype=Object.create(a.Services.Call.Capabilities.AbstractCallStateCapability.prototype),b.prototype._recalculate=function(){var b=a.Services.Call.Capabilities.AbstractCallStateCapability.prototype._recalculateDenialReason.call(this),c=b===a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED,d=this._call.getVideoChannels(),e=0===d.length&&this._call.getState()!==a.Services.Call.CallStates.ESTABLISHED||d.length>0&&d[0].getNegotiatedDirection()!==a.Services.Call.MediaDirection.SEND_ONLY&&d[0].getNegotiatedDirection()!==a.Services.Call.MediaDirection.RECV_ONLY;!c||this._videoCapability.isAllowed&&e||(c=!1,b=this._videoCapability.isAllowed?a.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED:this._videoCapability.denialReason),this._updateIfChanged(c,b)},a.Services.Call.Capabilities.UpdateVideoModeSendOnlyCapability=b}(AvayaClientServices),function(a){"use strict";function b(b,c){this._videoCapability=c,this._videoCapability.addOnChangedCallback(this._recalculate.bind(this));var d=[a.Services.Call.CallStates.IDLE,a.Services.Call.CallStates.IGNORED,a.Services.Call.CallStates.ALERTING,a.Services.Call.CallStates.ESTABLISHED];a.Services.Call.Capabilities.AbstractCallStateCapability.call(this,b,d,!1,!1,!0)}b.prototype=Object.create(a.Services.Call.Capabilities.AbstractCallStateCapability.prototype),b.prototype._recalculate=function(){var b=a.Services.Call.Capabilities.AbstractCallStateCapability.prototype._recalculateDenialReason.call(this),c=b===a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED,d=this._call.getVideoChannels(),e=-1!==[a.Base.BrowserType.CHROME,a.Base.BrowserType.CHROME_EXTENSION].indexOf(a.Base.Utils.getBrowserType()),f=0===d.length&&(e||this._call.getState()!==a.Services.Call.CallStates.ESTABLISHED)||d.length>0&&d[0].getNegotiatedDirection()!==a.Services.Call.MediaDirection.SEND_RECV;!c||this._videoCapability.isAllowed&&f||(c=!1,b=this._videoCapability.isAllowed?a.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED:this._videoCapability.denialReason),this._updateIfChanged(c,b)},a.Services.Call.Capabilities.UpdateVideoModeSendReceiveCapability=b}(AvayaClientServices),function(a){"use strict";function b(b){a.Base.Capability.call(this,a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._calls=b}b.prototype=Object.create(a.Base.Capability.prototype),b.prototype._recalculate=function(){var b=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED,c=!0,d=a.Base.Utils.getBrowserType(),e=d===a.Base.BrowserType.CHROME||d===a.Base.BrowserType.CHROME_EXTENSION||d===a.Base.BrowserType.FIREFOX||d===a.Base.BrowserType.FIREFOX_EXTENSION;this._calls._isAvailable&&e||(c=!1,b=e?a.Services.Call.CallError.SERVICE_TEMPORARILY_UNAVAILABLE:a.Services.Call.CallError.WEBRTC_NOT_SUPPORTED),this._updateIfChanged(c,b)},a.Services.Call.Capabilities.VoipCallingCapability=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b,c,d,e){this._token=b,this._isOTT=!!a.Base.Utils.isDefined(c)&&c,this._meetingId=a.Base.Utils.isDefined(d)?d:null,this._passcode=a.Base.Utils.isDefined(e)?e:null}b.prototype={getToken:function(){return this._token},setToken:function(a){this._token=a},isOTT:function(){return this._isOTT},enableOTT:function(a){this._isOTT=a,this._isWebRTCAbleConf=this._isOTT},getMeetingId:function(){return this._meetingId},setMeetingId:function(a){this._meetingId=a},getPasscode:function(){return this._passcode},setPasscode:function(a){this._passcode=a}},a.Services.Call.ConferenceEntryOptions=b}(AvayaClientServices),function(a){"use strict";var b={A:"A",B:"B",C:"C",D:"D",STAR:"*",POUND:"#",ONE:1,TWO:2,THREE:3,FOUR:4,FIVE:5,SIX:6,SEVEN:7,EIGHT:8,NINE:9,ZERO:0};a.Services.Call.DTMFTone=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";var b={RECV_ONLY:"recvonly",SEND_ONLY:"sendonly",SEND_RECV:"sendrecv",INACTIVE:"inactive",DISABLE:"disable",UNDEFINED:"undefined"};a.Services.Call.MediaDirection=b}(AvayaClientServices),function(a){"use strict";function b(a,b){this.call=a,this.id=b}b.prototype.startCall=function(a){},b.prototype.endCall=function(a){},a.Services.Call.Modes.AbstractCallMode=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b,c,d){a.Services.Call.Modes.AbstractCallMode.call(this,b,c),this._contactsIntegrationService=d}b.prototype=Object.create(a.Services.Call.Modes.AbstractCallMode.prototype),b.prototype.startCall=function(b){var c;if(this._createDataOnlyConference(b),b._onCallStartedCallbacks.fire(b),b._onCallEstablishedCallbacks.fire(b),a.Base.Utils.isDefined(b._callCreationInfo)&&a.Base.Utils.isDefined(b._callCreationInfo.getUccpURL())){c=b._callCreationInfo.getUccpURL();var d=b._callService._parseUccpUrl(c);b._conference._setConfiguration(d)}b._callService.createCollaborationForConference(b),b._onCallConferenceStatusChangedCallbacks.fire(b,!0,c)},b.prototype.endCall=function(b){b.getConference()._conferenceService.sendDisconnectEvent(),b.getConference().stop();var c=new a.Services.Call.CallEndEvent(a.Services.Call.CallEndReason.CALL_DISCONNECTED);b._onCallEndedCallbacks.fire(b,c),b._callService._callManager.deleteCall(b)},b.prototype._createDataOnlyConference=function(b){var c=b._callService.getScopiaConferenceProvider(),d=b._callService.createChatService(c),e=b._callService.createParticipantService(c),f=new a.Services.Conference.Chat(d),g=new a.Services.Conference.ConferenceService(a.Services.Conference.ConferenceType.SCOPIA_CONFERENCE,c,this._contactsIntegrationService);b._setConference(new a.Services.Conference.Conference(g,e,f)),b._conference._isUccpConference=!0},a.Services.Call.Modes.ConferenceCallMode=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(){this.ringback=void 0,this.intercept=void 0,this.reorder=void 0,this.fastBusy=void 0}b.prototype._setRingbackToneUrl=function(a){this.ringback=a},b.prototype.getRingbackToneUrl=function(){return this.ringback},b.prototype._setInterceptToneUrl=function(a){this.intercept=a},b.prototype.getInterceptToneUrl=function(){return this.intercept},b.prototype._setReorderToneUrl=function(a){this.reorder=a},b.prototype.getReorderToneUrl=function(){return this.reorder},b.prototype._setFastBusyToneUrl=function(a){this.fastBusy=a},b.prototype.getFastBusyToneUrl=function(){return this.fastBusy},a.Services.Call.RingbackToneURLs=b}(AvayaClientServices),function(a){"use strict";var b={ACCEPTED:"ACCEPTED",NONE:"NONE",REMOTE_CALL_ESTABLISHED:"REMOTE_CALL_ESTABLISHED",REMOTE_CALL_IN_PROGRESS:"REMOTE_CALL_IN_PROGRESS",REMOTE_CALL_STARTED:"REMOTE_CALL_STARTED",STARTED:"STARTED"};a.Services.Call.TransferProgressCode=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(){"use strict";function a(a,b,c){this._ucid=a,this._parentUcid=b,this._contextId=c}a.prototype={getUCID:function(){return this._ucid},getParentUCID:function(){return this._parentUcid},getContextId:function(){return this._contextId},setContextId:function(a){this._contextId=a},_setUCID:function(a){this._ucid=a},_setParentUCID:function(a){this._parentUcid=a}},AvayaClientServices.Services.Call.UserToUserInfo=a}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";var b={NONE:"none",DISABLED_BY_LOCAL_USER:"disabledByLocalUser",DISABLED_BY_REMOTE_USER:"disabledByRemoteUser",DISABLED_DUE_TO_CPU_OVERLOAD:"disabledDueToCpuOverload",DISABLED_DUE_TO_INSUFFICIENT_BANDWIDTH:"disabledDueToInsufficientBandwidth",DISABLED_DUE_TO_LOCAL_PLATFORM_LIMITATIONS:"disabledDueToLocalPlatformLimitations",DISABLED_DUE_TO_LOCAL_LAYOUT_SELECTION:"disabledDueToLocalLayoutSelection"};a.Services.Call.VideoChannelDisabledReason=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(){this._channelId=void 0,this._requestedDirection=void 0,this._negotiatedDirection=void 0,this._disabledReason=a.Services.Call.VideoChannelDisabledReason.NONE}b.prototype={getChannelId:function(){return this._channelId},getNegotiatedDirection:function(){return this._negotiatedDirection},getRequestedDirection:function(){return this._requestedDirection},getVideoDisabledReason:function(){return this._disabledReason},isDisabled:function(){return this._disabledReason!==a.Services.Call.VideoChannelDisabledReason.NONE},_setRequestedDirection:function(a){this._requestedDirection=a},_setNegotiatedDirection:function(a){this._negotiatedDirection=a},_setChannelId:function(a){this._channelId=a},_setVideoDisabledReason:function(a){this._disabledReason=a}},a.Services.Call.VideoChannel=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d,e,f,g,h,i,j,k,l){this.bytesTransmitted=a,this.bytesReceived=b,this.actualBitRateTransmitted=c,this.actualBitRateReceived=d,this.packetsTransmitted=e,this.packetsReceived=f,this.packetLossTotalTransmitted=g,this.packetLossTotalReceived=h,this.packetsLossFractionTransmitted=i,this.packetsLossFractionReceived=j,this.actualFrameRateTransmitted=k,this.actualFrameRateReceived=l}a.Services.Call.VideoDetails=b}(AvayaClientServices||{}),function(a){"use strict";var b={SEND_RECEIVE:"SEND_RECEIVE",RECEIVE_ONLY:"RECEIVE_ONLY",SEND_ONLY:"SEND_ONLY",INACTIVE:"INACTIVE",DISABLE:"DISABLE"};a.Services.Call.VideoMode=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";var b={INDEFINITE:"indefinite",OFF:"off",SUPPORTED:"supported"};a.Services.Call.VideoNetworkSignalingType=b}(AvayaClientServices),function(a){"use strict";var b={COLLABORATION_START_FAILURE:"Failed to start collaboration.",COLLABORATION_STOP_FAILURE:"Failed to stop collaboration.",COLLABORATION_NOTIFICATIONS_CHANNEL_FAILED:"Start notification channel failed.",BROWSER_NOT_SUPPORTED:"Browser is not supported",WHITEBOARD_REMOVE_LAST_SURFACE:"Failed to remove surface. You cannot remove last surface.",WHITEBOARD_REMOVE_SURFACE_FAILED:"Failed to remove surface.",WHITEBOARD_REMOVE_SHAPE_NOT_MINE:"Failed to remove shape. You can only remove shapes that you drew.",WHITEBOARD_ALREADY_ACTIVE:"Failed to start whiteboard surface. Surface is already started.",INTERNAL_ERROR:"An internal error occurred."};a.Services.Collaboration.CollaborationErrorReason=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Base.BaseError.call(this,b,c),this.name="CollaborationError"}b.prototype=Object.create(a.Base.BaseError.prototype),a.Services.Collaboration.CollaborationError=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d){this._userConfig=a,this._providerFactory=b,this._bandwidthManager=c,this._colaborationsAnalyticsService=d}b.prototype={create:function(b,c,d,e){e=e||this._userConfig;var f=this._providerFactory.createCollaborationProviders(e)[0],g=this._createCollaborationService(f),h=this._createWhiteboard(f),i=this._createContentSharing(f,e,b);return new a.Services.Collaboration.Collaboration(g,h,i,c,d)},_createCollaborationService:function(b){return this._identity=void 0,this._collaborationProviderInitialized=!1,new a.Services.Collaboration.CollaborationService(b,this._colaborationsAnalyticsService)},_createWhiteboard:function(b){var c=new a.Services.Collaboration.WhiteboardService(b,this._colaborationsAnalyticsService);return new a.Services.Collaboration.Whiteboard(c)},_createContentSharing:function(b,c,d){var e=this._createContentSharingService(b,c.collaborationConfiguration);return new a.Services.Collaboration.ContentSharing(e,d)},_createContentSharingService:function(b,c){(a.Base.Utils.isUndefined(c)||a.Base.Utils.isUndefined(c.contentSharingWorkerPath))&&a.Base.Logger.warn(a.Base.LoggerTags.COLLABORATION_SERVICE,"Web worker path is undefined. Content sharing will not be enabled.");var d=new a.Providers.ContentSharing.ScreenSharingProviderFactory(b,this._bandwidthManager);return new a.Services.Collaboration.ContentSharingService(b,d.getScreenSharingProvider(c),this._colaborationsAnalyticsService)}},a.Services.Collaboration.CollaborationFactory=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d,e,f){this._x=a,this._y=b,this._width=c,this._height=d,this._bitmapData=f,this._imageType=e}b.prototype={getXOffset:function(){return this._x},getYOffset:function(){return this._y},getRawBitmapData:function(){return this._bitmapData},getBlobData:function(){var a=new Blob([this._bitmapData],{type:"image/"+(0===this._imageType?"jpeg":"png")});return window.URL.createObjectURL(a)},getBase64BitmapData:function(){return"data:image/"+(0===this._imageType?"jpeg":"png")+";base64,"+this._toBase64(this._bitmapData)},getWidth:function(){return this._width},getHeight:function(){return this._height},_toBase64:function(a){for(var b,c,d,e,f,g="",h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=new Uint8Array(a),j=i.byteLength,k=j%3,l=j-k,m=0;m<l;m+=3)f=i[m]<<16|i[m+1]<<8|i[m+2],b=(16515072&f)>>18,c=(258048&f)>>12,d=(4032&f)>>6,e=63&f,g+=h[b]+h[c]+h[d]+h[e];return 1===k?(f=i[l],b=(252&f)>>2,c=(3&f)<<4,g+=h[b]+h[c]+"=="):2===k&&(f=i[l]<<8|i[l+1],b=(64512&f)>>10,c=(1008&f)>>4,d=(15&f)<<2,g+=h[b]+h[c]+h[d]+"="),g}},a.Services.Collaboration.Bitmap=b}(AvayaClientServices),function(a){"use strict";var b={LIBRARY:"LIBRARY",POLLING:"POLLING",MINUTES:"MINUTES",WHITEBOARD:"WHITEBOARD",MESSAGES:"MESSAGES",REPORTS:"REPORTS",SCREEN_SHARING:"SCREEN_SHARING",SLIDER:"SLIDER",REMOTE_CONTROL:"REMOTE_CONTROL"};a.Services.Collaboration.FeaturesAvailable=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c,d){this._keyFrame=d,this._height=b,this._width=a,this._bitmaps=c}b.prototype={getBitmaps:function(){return this._bitmaps},getWidth:function(){return this._width},getHeight:function(){return this._height},isKeyFrame:function(){return this._keyFrame}},a.Services.Collaboration.Frame=b}(AvayaClientServices),function(a){"use strict";function b(a,b){this._x=a,this._y=b}b.prototype={getX:function(){return this._x},getY:function(){return this._y},setX:function(a){this._x=a},setY:function(a){this._y=a}},a.Services.Collaboration.Point=b}(AvayaClientServices),function(a){"use strict";var b={PENDING:"PENDING",CONFIRMED:"CONFIRMED",ERROR:"ERROR"};a.Services.Collaboration.SelectionStatus=b}(AvayaClientServices),function(a){"use strict";var b={SMALL:4,MEDIUM:8,LARGE:12};a.Services.Collaboration.WhiteboardLineWidths=b}(AvayaClientServices),function(a){"use strict";var b={SMALL:19,MEDIUM:23,LARGE:27};a.Services.Collaboration.WhiteboardTextSizes=b}(AvayaClientServices),function(a){"use strict";var b={STROKE:"STROKE",FILLED:"FILLED"};a.Services.Collaboration.WhiteboardToolModes=b}(AvayaClientServices),function(a){"use strict";var b={SELECTION:"SELECTION",RECTANGLE:"RECTANGLE",CIRCLE:"CIRCLE",MARKER:"MARKER",PEN:"PEN",LINE:"LINE",STAMP:"STAMP",TEXT:"TEXT",DELETE:"DELETE",CLEAR:"CLEAR"};a.Services.Collaboration.WhiteboardToolTypes=b}(AvayaClientServices),function(a){"use strict";function b(b,d,e){this._collaborationProvider=b,this._contentSharingType=c.NONE,this._sharingState=a.Services.Collaboration.ContentSharingState.NOT_SHARING,this._screenSharingProvider=d,this._isScreenScraperActive=!1,this._collaborationsAnalyticsService=e}var c={NONE:"none",FULL_SCREEN_SHARING:"full screen",APP_WINDOW_SHARING:"application window"};b.prototype={start:function(a){this._screenSharingProvider.start(),this._initSharingEventHandler(a)},stop:function(a){this._screenSharingProvider.stop(),this._removeSharingEventHandler(a)},startScreenSharingFullScreen:function(b){a.Base.Logger.info(a.Base.LoggerTags.COLLABORATION_SERVICE,"Content Screen Sharing Service: Start full screen sharing..."),b._collaborationEnd=!1,this._contentSharingType=c.FULL_SCREEN_SHARING;var d=b._getCollaborations();return this._screenSharingProvider.startFullScreen().then(function(c){return this._isScreenScraperActive=!0,this._sharingState=a.Services.Collaboration.ContentSharingState.SHARING,d._activeContentSharing=b,d._onActiveContentSharingChangedCallback.fire(),this._collaborationsAnalyticsService.sendStartupEvent(!0),c}.bind(this),function(a){return d._activeContentSharing=void 0,d._onActiveContentSharingChangedCallback.fire(),this._collaborationsAnalyticsService.sendStartupEvent(!1),$.Deferred().reject(a).promise()}.bind(this))},isSharingFullScreen:function(){return this._sharingState!==a.Services.Collaboration.ContentSharingState.NOT_SHARING&&this._contentSharingType===c.FULL_SCREEN_SHARING},startSharingApplicationWindow:function(b){a.Base.Logger.info(a.Base.LoggerTags.COLLABORATION_SERVICE,"Content Screen Sharing Service: Start appl window sharing..."),b._collaborationEnd=!1,this._contentSharingType=c.APP_WINDOW_SHARING;var d=b._getCollaborations();return this._screenSharingProvider.startApplicationWindow().then(function(c){return this._isScreenScraperActive=!0,this._sharingState=a.Services.Collaboration.ContentSharingState.SHARING,d._activeContentSharing=b,d._onActiveContentSharingChangedCallback.fire(),this._collaborationsAnalyticsService.sendStartupEvent(!0),c}.bind(this),function(a){return d._activeContentSharing=void 0,d._onActiveContentSharingChangedCallback.fire(),
this._collaborationsAnalyticsService.sendStartupEvent(!1),$.Deferred().reject(a).promise()}.bind(this))},isSharingApplicationWindow:function(){return this._sharingState!==a.Services.Collaboration.ContentSharingState.NOT_SHARING&&this._contentSharingType===c.APP_WINDOW_SHARING},end:function(b,d){if(this._sharingState!==a.Services.Collaboration.ContentSharingState.NOT_SHARING){a.Base.Logger.info(a.Base.LoggerTags.COLLABORATION_SERVICE,"Content Screen Sharing Service: Stop sharing..."),this._sharingState=a.Services.Collaboration.ContentSharingState.NOT_SHARING,this._contentSharingType=c.NONE;var e=d._getCollaborations();return e._activeContentSharing=void 0,e._onActiveContentSharingChangedCallback.fire(),this._isScreenScraperActive=!1,this._screenSharingProvider.stopScreenSharing(b)}var f=$.Deferred();return f.resolve(),f.promise()},isPresenting:function(){return this._contentSharingType!==c.NONE},isContentSharingActive:function(){return this._sharingState!==a.Services.Collaboration.ContentSharingState.NOT_SHARING},pause:function(){if(this._sharingState===a.Services.Collaboration.ContentSharingState.SHARING)return a.Base.Logger.info(a.Base.LoggerTags.COLLABORATION_SERVICE,"Content Screen Sharing Service: Pause sharing..."),this._sharingState=a.Services.Collaboration.ContentSharingState.PAUSED,this._screenSharingProvider.pause();var b=$.Deferred();return b.resolve(),b.promise()},resume:function(){if(this._sharingState===a.Services.Collaboration.ContentSharingState.PAUSED)return a.Base.Logger.info(a.Base.LoggerTags.COLLABORATION_SERVICE,"Content Screen Sharing Service: Resume sharing..."),this._sharingState=a.Services.Collaboration.ContentSharingState.SHARING,this._screenSharingProvider.resume();var b=$.Deferred();return b.resolve(),b.promise()},getShareApplicationWindowCapability:function(){return this._screenSharingProvider.getShareApplicationWindowCapability()},getReceivingBitrate:function(){return this._collaborationProvider.getReceivingBitrate()},getShareFullScreenCapability:function(){return this._screenSharingProvider.getShareFullScreenCapability()},isOpened:function(){return this._screenSharingProvider.isOpened()},isFeatureAvailable:function(a){return this._collaborationProvider.isFeatureAvailable(a)},_initSharingEventHandler:function(a){this._startScreenSharingEventHandler=this._startScreenSharingHandler(),this._endScreenSharingEventHandler=this._endScreenSharingHandler(),a.addOnContentSharingStartedCallback(this._startScreenSharingEventHandler),a.addOnContentSharingEndedCallback(this._endScreenSharingEventHandler)},_removeSharingEventHandler:function(a){this._startScreenSharingEventHandler&&this._endScreenSharingEventHandler&&(a.removeOnContentSharingStartedCallback(this._startScreenSharingEventHandler),a.removeOnContentSharingEndedCallback(this._endScreenSharingEventHandler))},_startScreenSharingHandler:function(){return function(a){}.bind(this)},_endScreenSharingHandler:function(){return function(a){if(this._contentSharingType=c.NONE,this._isScreenScraperActive)return this._isScreenScraperActive=!1,this._screenSharingProvider.stopScreenCapturer()}.bind(this)},_pauseScreenSharingHandler:function(a){return function(b){a._onContentSharingPausedCallbacks.fire(b)}},_recalculateAllContentSharingCapabilities:function(a){a._recalculateShareApplicationWindowCapability(),a._recalculateShareFullScreenCapability()}},a.Services.Collaboration.ContentSharingService=b}(AvayaClientServices),function(a){"use strict";var b={NOT_SHARING:"not sharing",SHARING:"sharing",PAUSED:"paused"};a.Services.Collaboration.ContentSharingState=b}(AvayaClientServices),function(a){"use strict";function b(a,b){this._collaborationProvider=a,this._checkOnNewPoints=void 0,this._throttlingInterval=100,this._collaborationsAnalyticsService=b}b.prototype={start:function(b,c){var d=function(){this._collaborationsAnalyticsService.sendStartupEvent(!0)}.bind(this),e=function(){this._collaborationsAnalyticsService.sendStartupEvent(!1)}.bind(this);if(a.Base.Utils.isDefined(c)){if(c.isActive()){var f=jQuery.Deferred();return f.reject(new a.Services.Collaboration.CollaborationError(a.Services.Collaboration.CollaborationErrorReason.WHITEBOARD_ALREADY_ACTIVE)),f.promise()}return b.getSurfaces().forEach(function(a){a._active=!1}),this._collaborationProvider.startWhiteboard(c.getSurfaceId()).then(d,e)}var g=b.getSurfaces();if(0===g.length)return this._collaborationProvider.startWhiteboard().then(d,e);var h=g.filter(function(a){return a.isActive()})[0];return h?this._collaborationProvider.startWhiteboard(h.getSurfaceId()).then(d,e):this._collaborationProvider.startWhiteboard(g[0].getSurfaceId()).then(d,e)},end:function(a){return this._collaborationProvider.endWhiteboard(a)},stop:function(b){var c=$.Deferred();return b._currentLiveDrawingWhiteboardIds=[],b._currentLiveDrawingShapes=[],b._activeSurface=void 0,b._recentlyActiveSurface=void 0,b._surfaces.length=0,b._onWhiteboardStartedCallbacks.empty(),b._onWhiteboardEndedCallbacks.empty(),b._onWhiteboardSurfaceAddedCallbacks.empty(),b._onWhiteboardSurfaceRemovedCallbacks.empty(),b._onWhiteboardSurfaceSetActiveCallbacks.empty(),b._removeWhiteboardCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),c.resolve(),c.promise()},requestNewSurface:function(){return this._collaborationProvider.addWhiteboardSurface()},removeSurface:function(b,c){var d=jQuery.Deferred();return b.getSurfaces().length>1?this._collaborationProvider.removeWhiteboardSurface(c.getSurfaceId()).then(function(a){d.resolve(a)},function(b){d.reject(new a.Services.Collaboration.CollaborationError(a.Services.Collaboration.CollaborationErrorReason.WHITEBOARD_REMOVE_SURFACE_FAILED,b))}):d.reject(new a.Services.Collaboration.CollaborationError(a.Services.Collaboration.CollaborationErrorReason.WHITEBOARD_REMOVE_LAST_SURFACE)),d.promise()},addCircle:function(a,b){return this._collaborationProvider.addCircle(b,a.getSurfaceId()).done(function(c){var d=b.getId();return b.setId(c),delete a.getShapes()[d],a.getShapes()[c]=b,c})},addShape:function(a,b){return b.isFinished()?this._collaborationProvider.addShape(b,a.getSurfaceId()).done(function(c){var d=b.getId();return b.setId(c),delete a.getShapes()[d],a.getShapes()[c]=b,c}):(b._readyToSendCallbacks.add(this._throttleLiveDrawing.bind(this,b,a)),this._collaborationProvider.startDrawShape(b,a.getSurfaceId()).done(function(c){var d=b.getId();return b.setId(c),delete a.getShapes()[d],a.getShapes()[c]=b,c}))},addText:function(a,b){return this._collaborationProvider.addText(b,a.getSurfaceId()).done(function(c){var d=b.getId();return b.setId(c),delete a.getShapes()[d],a.getShapes()[c]=b,c})},moveSelection:function(b,c){return c instanceof a.Services.Collaboration.Shape?this._collaborationProvider.moveSelection(c,b.getSurfaceId(),c.getPoints()[0].point):c instanceof a.Services.Collaboration.Circle?this._collaborationProvider.moveSelection(c,b.getSurfaceId(),c.getTopLeft()):c instanceof a.Services.Collaboration.WhiteboardText?this._collaborationProvider.moveSelection(c,b.getSurfaceId(),c.getPosition()):this._collaborationProvider.moveSelection(c,b.getSurfaceId())},removeShape:function(b,c){if(c.isMine()){var d;return c instanceof a.Services.Collaboration.Shape?d=c.getPoints()[0].point:c instanceof a.Services.Collaboration.Circle?d=c.getTopLeft():c instanceof a.Services.Collaboration.WhiteboardText&&(d=c.getPosition()),this._collaborationProvider.removeShape(c,b.getSurfaceId(),d)}var e=$.Deferred();return e.reject(new a.Services.Collaboration.CollaborationError(a.Services.Collaboration.CollaborationErrorReason.WHITEBOARD_REMOVE_SHAPE_NOT_MINE)),e.promise()},clearContent:function(a){return this._collaborationProvider.clearContent(a.getSurfaceId())},endDrawShape:function(a,b){return b._hasPointsToSend()&&this._collaborationProvider.liveDrawShape(b,a.getSurfaceId()),this._collaborationProvider.endDrawShape(b,a.getSurfaceId())},_throttleLiveDrawing:function(a,b){if(a._hasPointsToSend())return this._collaborationProvider.liveDrawShape(a,b.getSurfaceId())}},a.Services.Collaboration.WhiteboardService=b}(AvayaClientServices),function(){"use strict";function a(){this[AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.SELECTION]={name:"Selection",type:AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.SELECTION},this[AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.PEN]={type:AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.PEN,name:"Pen",drag:!1,live:!0},this[AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.MARKER]={type:AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.MARKER,name:"Marker",drag:!1,live:!0},this[AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.LINE]={type:AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.LINE,name:"Line",drag:!0,live:!1,modes:AvayaClientServices.Services.Collaboration.WhiteboardLineWidths,startFunction:function(){},endFunction:function(){}},this[AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.RECTANGLE]={type:AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.RECTANGLE,name:"Rect",drag:!0,live:!1,modes:AvayaClientServices.Services.Collaboration.WhiteboardToolModes,startFunction:function(){},endFunction:function(){}},this[AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.CIRCLE]={type:AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.CIRCLE,name:"Circle",drag:!0,live:!1,modes:AvayaClientServices.Services.Collaboration.WhiteboardToolModes,startFunction:function(){},endFunction:function(){}},this[AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.STAMP]={type:AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.STAMP,name:"Stamp",drag:!1,live:!1,drawFunction:function(){}},this[AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.TEXT]={type:AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.TEXT,name:"Text",drag:!1,live:!1,modes:AvayaClientServices.Services.Collaboration.WhiteboardTextSizes},this[AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.DELETE]={type:AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.DELETE,name:"Delete"},this[AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.CLEAR]={type:AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.CLEAR,name:"Clear All"}}AvayaClientServices.Services.Collaboration.WhiteboardTools=a}(),function(a){"use strict";function b(a,b,c,d){this._messageContent=a,this._sender=b,this._recipient=c,this._isPrivate=d,this._time=new Date,this._id=this._sender._participantId+Date.now().toString(32),this.status=void 0}b.prototype={setStatus:function(b){a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:"string"}]}),this.status=b},getSender:function(){return this._sender},getMessageContent:function(){return this._messageContent},isPrivate:function(){return this._isPrivate},getRecipient:function(){return this._recipient},getTime:function(){return this._time},getId:function(){return this._id}},a.Services.Conference.ChatMessage=b}(AvayaClientServices),function(a){"use strict";function b(a){this._conferenceProvider=a}b.prototype={sendMessage:function(b,c,d){var e=d?d._participantId:void 0,f=!!d,g=new a.Services.Conference.ChatMessage(c,b._selfParticipant,d,f);return g.setStatus(a.Services.Conference.ChatMessageStatus.PENDING),this.addMessage(b,g),this._conferenceProvider.sendChatMessage(c,e).then(function(){g.setStatus(a.Services.Conference.ChatMessageStatus.CONFIRMED)}.bind(this),function(){g.setStatus(a.Services.Conference.ChatMessageStatus.ERROR)}.bind(this))},addMessage:function(a,b){b.isPrivate()?a._privateMessages.push(b):a._publicMessages.push(b),a._allMessages.push(b),a._onChatMessageReceivedCallbacks.fire(a,b)}},a.Services.Conference.ChatService=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c){this._conferenceType=a,this._conferenceProvider=b,this._contactsIntegrationService=c,this._onContactListChanged=void 0,this._isDisconnecting=!1}b.prototype={start:function(b,c){if(a.Base.Utils.isDefined(this._conferenceProvider))return a.Base.Logger.info(a.Base.LoggerTags.CONFERENCE_SERVICE,"Conference Service is starting..."),this._conferenceProvider.start(b,c).then(function(){this._conferenceProvider.on(a.Base.NetworkProviderEvents.UNAUTHORIZED,function(){(a.Base.Utils.isUndefined(b._isAvailable)||b._isAvailable)&&(b._isAvailable=!1,b._onConferenceServiceUnavailableCallbacks.fire(b))}.bind(this)),this._conferenceProvider.on(a.Base.NetworkProviderEvents.AUTHORIZED,function(){!a.Base.Utils.isUndefined(b._isAvailable)&&b._isAvailable||(b._isAvailable=!0,b._onConferenceServiceAvailableCallbacks.fire(b))}.bind(this)),this._onContactListChanged=function(){this._updateMatchedContactsForConference(b)}.bind(this),this._contactsIntegrationService.addOnContactListChangedCallback(this._onContactListChanged),!a.Base.Utils.isUndefined(b._isAvailable)&&b._isAvailable||(b._isAvailable=!0,b._onConferenceServiceAvailableCallbacks.fire(b)),b._setConferenceStarted(!0),b._recalculateAllAddParticipantFromCallCapability(),b.addOnConferenceRecordingStatusChangedCallback(this._recalculateConferenceRecordingStatuses)}.bind(this));var d=$.Deferred();return a.Base.Logger.info(a.Base.LoggerTags.CONFERENCE_SERVICE,"Conference Service is not enabled"),d.reject({name:a.Services.Conference.ConferenceStartStatus.CONFERENCE_SERVICE_NOT_ENABLED,message:"Conference Service is not enabled"}),d.promise()},stop:function(b){return b._isAvailable&&(b._isAvailable=!1,b._onConferenceServiceUnavailableCallbacks.fire(b)),b._setConferenceStarted(!1),a.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.stop().then(function(c){return this._contactsIntegrationService.removeOnContactListChangedCallback(this._onContactListChanged),this._onContactListChanged=void 0,b.removeOnConferenceRecordingStatusChangedCallback(this._recalculateConferenceRecordingStatuses),b._selfParticipantId="",b._activeTalkerId="",b._lecturerId="",b._presenterId="",b._mediaStatus="",b._activeParticipants=[],b._droppedParticipants=[],b._pendingParticipants=[],b._isLectureModeActive=!1,b._isHandRaised=!1,b._recordingStatus=a.Services.Conference.RecordingStatus.OFF,b._isVideoAllowed=!1,b._isWebCollaborationActive=!1,b._isLocked=!1,b._isPasscodeRequiredToBecomeModerator=!1,b._isVideoParticipantNameDisplayActive=!1,b._isVideoSelfSeeActive=!1,b._isVideoSelfSeeChangeAllowed=!1,b._isVideoPinAllowed=!1,b._isVideoParticipantNameDisplayChangeAllowed=!1,b._currentVideoLayout="",b._supportedVideoLayouts=[],b._subject="",b._sipURI="",b._isApplicationSharingActive=!1,b._brandName="",b._collaborationURI="",b._joinMeetingURI="",b._streamingURI="",b._dialInInformation="",b._admissionPermissionNeeded=!1,b._admissionPasscodeNeeded=!1,c}.bind(this)):$.Deferred().reject().promise()},terminateConference:function(b){return a.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.terminateConference():$.Deferred().reject().promise()},getType:function(){return this._conferenceType},removeLastParticipant:function(){return a.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.removeLastParticipant():$.Deferred().reject().promise()},sendAdmissionRequest:function(b,c){return a.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.sendAdmissionRequest(b,c):$.Deferred().reject().promise()},requestToBecomeModerator:function(b,c){return a.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.requestToBecomeModerator(c):$.Deferred().reject().promise()},signIn:function(b,c){return a.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.signIn(c):$.Deferred().reject().promise()},videoPin:function(b,c,d,e,f){return a.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.videoPin(b,c,d,e,f):$.Deferred().reject().promise()},extendMeeting:function(b){return a.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.extendMeeting(b):$.Deferred().reject().promise()},addParticipant:function(b,c){return a.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.addParticipant(b,c):$.Deferred().reject().promise()},addParticipantFromCall:function(b){return a.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.addParticipantFromCall(b):$.Deferred().reject().promise()},cancelDialoutParticipant:function(b,c){return a.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.cancelDialoutParticipant(b,c._participantId):$.Deferred().reject().promise()},setAsLecturer:function(b){return a.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.setAsLecturer(b._participantId):$.Deferred().reject().promise()},setLocked:function(b,c){return a.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.setLocked(c):$.Deferred().reject().promise()},startRecording:function(b,c,d){return a.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.startRecording(b,c,d):$.Deferred().reject().promise()},stopRecording:function(b){return a.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.stopRecording(b):$.Deferred().reject().promise()},pauseRecording:function(b){return a.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.pauseRecording(b):$.Deferred().reject().promise()},resumeRecording:function(b){return a.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.resumeRecording(b):$.Deferred().reject().promise()},setVideoLayout:function(b,c){return a.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.setVideoLayout(c):$.Deferred().reject().promise()},setVideoLayoutSelfSee:function(b,c){return a.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.setVideoLayoutSelfSee(c):$.Deferred().reject().promise()},setVideoLayoutTextOverlay:function(b,c){return a.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.setVideoLayoutTextOverlay(c):$.Deferred().reject().promise()},getCurrentVideoLayout:function(b){return a.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.getCurrentVideoLayout():$.Deferred().reject().promise()},muteAllParticipants:function(b){return a.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.muteUnmuteAll(!0):$.Deferred().reject().promise()},unmuteAllParticipants:function(b){return a.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.muteUnmuteAll(!1):$.Deferred().reject().promise()},raiseLowerHand:function(b){return a.Base.Utils.isDefined(this._conferenceProvider)?b?this._conferenceProvider.raiseLowerHand(a.Services.Conference.ParticipantHandState.RAISE):this._conferenceProvider.raiseLowerHand(a.Services.Conference.ParticipantHandState.LOWER):$.Deferred().reject().promise()},disconnectParticipant:function(b){return a.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.disconnectParticipant(b):$.Deferred().reject().promise()},sendDisconnectEvent:function(){return a.Base.Utils.isDefined(this._conferenceProvider)?this._isDisconnecting?$.Deferred().resolve():(this._isDisconnecting=!0,a.Base.Logger.info(a.Base.LoggerTags.CONFERENCE_SERVICE,"Conference sent disconnect event"),this._conferenceProvider.sendDisconnectEvent(a.Services.Conference.DisconnectReason.CALL_DISCONNECTED)):$.Deferred().reject().promise()},sendLocalMuteEvent:function(b,c){return a.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.sendLocalMuteEvent(b,c):$.Deferred().reject().promise()},_recalculateAllCapabilities:function(a){a._recalculateSetLockCapability(),a._recalculateDisplayVideoParticipantNameCapability(),a._recalculateVideoSelfSeeCapability(),a._recalculateSetVideoLayoutCapability(),a._recalculateStartStopRecordingCapability(),a._recalculatePauseResumeRecordingCapability(),a._recalculateMuteUnmuteAllCapability(),a._recalculateRaiseHandSupportCapability(),a._recalculateLowerHandSupportCapability(),a._recalculateRequestToBecomeModeratorCapability(),a._recalculateVideoPinCapability(),a._recalculateRemoveSelectParticipantCapability(),a._recalculateAddParticipantViaDialoutCapability(),a._recalculateSignInCapability(),a._recalculateModerateConferenceCapability(),a._recalculateActiveTalkerCapability(),a._recalculateMuteSelfAudioCapability(),a._recalculateUnmuteSelfAudioCapability(),a._recalculateTerminateConferenceCapability(),a._recalculateAcceptPendingParticipantCapability(),a._recalculateDenyPendingParticipantCapability(),a._recalculateExtendMeetingCapability(),a._recalculateRetrieveParticipantListCapability()},_updateMatchedContactsForParticipant:function(a){this._contactsIntegrationService.updateMatchedContactsForParticipant(a,!0)},_updateMatchedContactsForConference:function(a){if(this._contactsIntegrationService.isStarted()&&a){var b=[];a.getActiveParticipants().forEach(function(a){b.push(a)}),a.getPendingParticipants().forEach(function(a){b.push(a)}),a.getDroppedParticipants().forEach(function(a){b.push(a)}),b.forEach(function(a){this._updateMatchedContactsForParticipant(a)},this)}},_recalculateAddParticipantFromCallCapability:function(a,b){this._conferenceProvider&&this._conferenceProvider.recalculateAddParticipantFromCallCapability(a,b)},_recalculateAddParticipantFromCallCapabilityByCallId:function(a,b){this._conferenceProvider&&this._conferenceProvider.recalculateAddParticipantFromCallCapabilityByCallId(a,b)},_recalculateConferenceRecordingStatuses:function(a){a._recalculateStartStopRecordingCapability(),a._recalculatePauseResumeRecordingCapability()}},a.Services.Conference.ConferenceService=b}(AvayaClientServices),function(a){"use strict";var b={CM_CONFERENCE:"CM",SCOPIA_CONFERENCE:"Scopia"};a.Services.Conference.ConferenceType=b}(AvayaClientServices),function(a){"use strict";var b={SUCCESS:"success",INCORRECT_PASSCODE_TRY_AGAIN:"incorrectPasscodeTryAgain",INCORRECT_PASSCODE_DISCONNECTING:"incorrectPasscodeDisconnecting",PENDING_APPROVAL:"pendingApproval",REJECTED:"rejected"};a.Services.Conference.AdmissionResponseCode=b}(AvayaClientServices),function(a){"use strict";var b={CAMERA_CONTROL_UP:"up",CAMERA_CONTROL_DOWN:"down",CAMERA_CONTROL_RIGHT:"right",CAMERA_CONTROL_LEFT:"left",CAMERA_CONTROL_ZOOM_IN:"in",CAMERA_CONTROL_ZOOM_OUT:"out"};a.Services.Conference.CameraControl=b}(AvayaClientServices),function(a){"use strict";var b={PENDING:"pending",CONFIRMED:"confirmed",ERROR:"error"};a.Services.Conference.ChatMessageStatus=b}(AvayaClientServices),function(a){"use strict";var b={PRIVATE:"private",PUBLIC:"public"};a.Services.Conference.ChatType=b}(AvayaClientServices),function(a){"use strict";var b={CAPABILITY_NOT_ALLOWED:"CAPABILITY_NOT_ALLOWED"};a.Services.Conference.ConferenceError=b}(AvayaClientServices),function(a){"use strict";var b={ADMISSION_NEEDED:"admissionNeeded",CONFERENCE_SERVICE_NOT_ENABLED:"conferenceServiceNotEnabled",CONFERENCE_CONFIG_NOT_ENABLED:"conferenceConfigIsNotEnabled"};a.Services.Conference.ConferenceStartStatus=b}(AvayaClientServices),function(a){"use strict";var b={ACTIVE:"active",ALLOWED:"allowed",NOT_ALLOWED:"notAllowed"};a.Services.Conference.ContentFromParticipantStatus=b}(AvayaClientServices),function(a){"use strict";var b={DIALING:"dialing",UNAUTHORIZED:"unauthorized",FAIL:"fail",NOT_ADMITTED:"notAdmitted",NOT_ALLOWED:"notAllowed",CONNECT:"connect",BUSY:"busy",NO_ANSWER:"noAnswer",CANCELED:"canceled"};a.Services.Conference.DialoutStatus=b}(AvayaClientServices),function(a){"use strict";var b={CALL_DISCONNECTED:"callDisconnected",CONFERENCE_TERMINATED:"conferenceTerminated",DISCONNECTED_BY_MODERATOR_OR_ADMIN:"disconnectedByModeratorOrAdmin",ERROR:"error"};a.Services.Conference.DisconnectReason=b}(AvayaClientServices),function(a){"use strict";var b={ACTIVE:"active",NA:"na",SELF_MUTED:"selfMuted",MODERATOR_MUTED:"moderatorMuted",BOTH_MUTED:"bothMuted"};a.Services.Conference.MediaFromParticipantStatus=b}(AvayaClientServices),function(a){"use strict";var b={WAITING_ROOM:"waitingRoom",ACTIVE:"active",MUTE_ALL_AUDIO:"muteAllAudio"};a.Services.Conference.MediaStatus=b}(AvayaClientServices),function(a){"use strict";var b={AVAILABLE:"available",NA:"na"};a.Services.Conference.MediaToParticipantStatus=b}(AvayaClientServices),function(a){"use strict";var b={AUDIO:"audio",VIDEO:"video"};a.Services.Conference.MediaType=b}(AvayaClientServices),function(a){"use strict";var b={YES:"yes",NO:"no",PARTIAL:"partial"};a.Services.Conference.MeetingEncryptionStatus=b}(AvayaClientServices),function(a){"use strict";var b={ADMIT:"admit",REJECT:"reject"};a.Services.Conference.ModeratorAdmissionActions=b}(AvayaClientServices),function(a){"use strict";var b={ACTIVE:"active",AUTHORIZING:"authorizing"};a.Services.Conference.ParticipantAuthorizationStatus=b}(AvayaClientServices),function(a){"use strict";var b={CONNECTION_STATUS_UNKNOWN:"CONNECTION_STATUS_UNKNOWN",CONNECTION_STATUS_CONNECTING:"CONNECTION_STATUS_CONNECTING",CONNECTION_STATUS_CONNECTED:"CONNECTION_STATUS_CONNECTED",CONNECTION_STATUS_DISCONNECTING:"CONNECTION_STATUS_DISCONNECTING",CONNECTION_STATUS_DISCONNECTED:"CONNECTION_STATUS_DISCONNECTED"};a.Services.Conference.ParticipantConnectionStatus=b}(AvayaClientServices);!function(a){"use strict";var b={DISCONNECT_REASON_UNKNOWN:"DISCONNECT_REASON_UNKNOWN",DISCONNECT_REASON_DEPARTED:"DISCONNECT_REASON_DEPARTED",DISCONNECT_REASON_DISCONNECTED_BY_MODERATOR:"DISCONNECT_REASON_DISCONNECTED_BY_MODERATOR"};a.Services.Conference.ParticipantDisconnectionReason=b}(AvayaClientServices),function(a){"use strict";var b={RAISE:"raise",LOWER:"lower"};a.Services.Conference.ParticipantHandState=b}(AvayaClientServices),function(a){"use strict";var b={MEDIA_STATUS_NO_MEDIA:"MEDIA_STATUS_NO_MEDIA",MEDIA_STATUS_INACTIVE:"MEDIA_STATUS_INACTIVE",MEDIA_STATUS_RECEIVE_ONLY:"MEDIA_STATUS_RECEIVE_ONLY",MEDIA_STATUS_SEND_ONLY:"MEDIA_STATUS_SEND_ONLY",MEDIA_STATUS_SEND_RECEIVE:"MEDIA_STATUS_SEND_RECEIVE"};a.Services.Conference.ParticipantMediaState=b}(AvayaClientServices),function(a){"use strict";var b={MODERATOR:"moderator",PARTICIPANT:"participant",GUEST:"guest",OPERATOR:"operator"};a.Services.Conference.ParticipantRole=b}(AvayaClientServices),function(a){"use strict";var b={ALLOWED:"allowed",NOT_ALLOWED:"notAllowed",NEED_SIGNIN:"needSignin",NEED_MODERATOR:"needModerator",NEED_SIGNIN_OR_MODERATOR:"needSigninOrModerator"};a.Services.Conference.PermissionStatus=b}(AvayaClientServices),function(a){"use strict";var b={NONE:"none",START_STOP:"start/stop",WITH_PAUSE:"withPause"};a.Services.Conference.RecorderStatus=b}(AvayaClientServices),function(a){"use strict";var b={START:"start",STOP:"stop",PAUSE:"pause",RESUME:"resume"};a.Services.Conference.RecordingOperation=b}(AvayaClientServices),function(a){"use strict";var b={ON:"on",OFF:"off",PAUSE:"pause"};a.Services.Conference.RecordingStatus=b}(AvayaClientServices),function(a){"use strict";var b={LAYOUT_AUTOMATIC:"1",LAYOUT_SINGLE_SCREEN:"10",LAYOUT_DOUBLE_SCREEN_HORIZONTAL:"21",LAYOUT_DOUBLE_SCREEN_VERTICAL:"22",LAYOUT_DOUBLE_SCREEN_4_TO_1:"27",LAYOUT_1_HOST_1_PIP:"28",LAYOUT_PYRAMID_3:"32",LAYOUT_LANDSCAPE_PLUS_2_ASYM:"33",LAYOUT_1_HOST_2_PIP:"34",LAYOUT_3x1:"35",LAYOUT_2x2:"40",LAYOUT_4_PYRAMID:"41",LAYOUT_3_PLUS_1:"42",LAYOUT_1_HOST_3_PIP:"43",LAYOUT_5_PYRAMID:"51",LAYOUT_1_HOST_4_PIP:"52",LAYOUT_5_PLUS_1:"60",LAYOUT_3x2:"61",LAYOUT_6_PLUS_1_1:"75",LAYOUT_7_PLUS_1_NEW:"81",LAYOUT_4x2:"82",LAYOUT_3x3:"90",LAYOUT_9_PYRAMID:"91",LAYOUT_8_PLUS_2_1_2:"101",LAYOUT_4x3:"120",LAYOUT_12_PLUS_1_1:"131",LAYOUT_12_PLUS_1_5:"135",LAYOUT_4x4:"160",LAYOUT_20_PLUS_1:"210",LAYOUT_20_PLUS_1_LEFT:"211",LAYOUT_1_PLUS_27:"280"};a.Services.Conference.VideoLayout=b}(AvayaClientServices),function(a){"use strict";function b(a){this._conferenceProvider=a}b.prototype={setAsLecturer:function(a){return this._conferenceProvider.setAsLecturer(a.getParticipantId())},unsetAsLecturer:function(){return this._conferenceProvider.unsetAsLecturer()},controlRemoteCamera:function(a,b){return this._conferenceProvider.controlRemoteCamera(a.getParticipantId(),b)},mute:function(b){return this._conferenceProvider.muteUnmute(b.getParticipantId(),a.Services.Conference.MediaType.AUDIO,!0)},unmute:function(b){return this._conferenceProvider.muteUnmute(b.getParticipantId(),a.Services.Conference.MediaType.AUDIO,!1)},accept:function(b){return this._conferenceProvider.moderatorAdmission(b,a.Services.Conference.ModeratorAdmissionActions.ADMIT)},deny:function(b){return this._conferenceProvider.moderatorAdmission(b,a.Services.Conference.ModeratorAdmissionActions.REJECT)},blockVideo:function(b){return this._conferenceProvider.muteUnmute(b.getParticipantId(),a.Services.Conference.MediaType.VIDEO,!0)},unblockVideo:function(b){return this._conferenceProvider.muteUnmute(b.getParticipantId(),a.Services.Conference.MediaType.VIDEO,!1)},lowerHand:function(a,b){return this._conferenceProvider.moderatorLowerHand(a.getParticipantId(),b)},recalculateAllCapabilities:function(a){a._recalculateBlockUnblockVideoCapability(),a._recalculateMuteUnmuteCapability(),a._recalculateLowerHandCapability(),a._recalculateSetAsLecturerCapability(),a._recalculateRemoteCameraControlCapability()}},a.Services.Conference.ParticipantService=b}(AvayaClientServices),function(a){"use strict";var b={SIZE:4};a.Services.Conference.RecentTalkersConfiguration=b}(AvayaClientServices),function(a){"use strict";function b(){this._writeCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED)}b.prototype={getWriteCapability:function(){return this._writeCapability},_setWriteCapability:function(a){this._writeCapability=a}},a.Services.Contacts.ContactField=b}(AvayaClientServices),function(a){"use strict";function b(){a.Services.Contacts.ContactField.call(this),this._address=void 0,this._imAddressType=a.Services.Contacts.ContactIMAddressType.IM_ADDRESS_OTHER,this._default=!1,this._avayaAdministered=!1}b.prototype=Object.create(a.Services.Contacts.ContactField.prototype),b.prototype.getAddress=function(){return this._address},b.prototype.getIMAddressType=function(){return this._imAddressType},b.prototype.isDefault=function(){return this._default},b.prototype.setAvayaAdministered=function(a){this._avayaAdministered=a},b.prototype.isAvayaAdministered=function(){return this._avayaAdministered},a.Services.Contacts.ContactIMAddressField=b}(AvayaClientServices),function(a){"use strict";function b(){a.Services.Contacts.ContactField.call(this),this._value=0}b.prototype=Object.create(a.Services.Contacts.ContactField.prototype),b.prototype.getValue=function(){return this._value},a.Services.Contacts.ContactNumberField=b}(AvayaClientServices),function(a){"use strict";function b(){a.Services.Contacts.ContactField.call(this),this._phoneNumber=void 0,this._label1=void 0,this._label2=void 0,this._phoneNumberType=a.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_WORK,this._speedDialEnabled=!1,this._default=!1,this._avayaAdministered=!1}b.prototype=Object.create(a.Services.Contacts.ContactField.prototype),b.prototype.getPhoneNumber=function(){return this._phoneNumber},b.prototype.getLabel1=function(){return this._label1},b.prototype.getLabel2=function(){return this._label2},b.prototype.getPhoneNumberType=function(){return this._phoneNumberType},b.prototype.isSpeedDialEnabled=function(){return this._speedDialEnabled},b.prototype.isDefault=function(){return this._default},b.prototype.setAvayaAdministered=function(a){this._avayaAdministered=a},b.prototype.isAvayaAdministered=function(){return this._avayaAdministered},a.Services.Contacts.ContactPhoneField=b}(AvayaClientServices),function(a){"use strict";function b(){a.Services.Contacts.ContactField.call(this),this._value=void 0}b.prototype=Object.create(a.Services.Contacts.ContactField.prototype),b.prototype.getValue=function(){return this._value},a.Services.Contacts.ContactStringField=b}(AvayaClientServices),function(a){"use strict";function b(){a.Services.Contacts.ContactIMAddressField.call(this)}
b.prototype=Object.create(a.Services.Contacts.ContactIMAddressField.prototype),b.prototype.setAddress=function(a){this._address=a},b.prototype.setIMAddressType=function(b){this._imAddressType=b,this._default=this._imAddressType===a.Services.Contacts.ContactIMAddressType.IM_ADDRESS_WORK},a.Services.Contacts.EditableContactIMAddressField=b}(AvayaClientServices),function(a){"use strict";function b(){a.Services.Contacts.ContactNumberField.call(this)}b.prototype=Object.create(a.Services.Contacts.ContactNumberField.prototype),b.prototype.setValue=function(a){this._value=a},a.Services.Contacts.EditableContactNumberField=b}(AvayaClientServices),function(a){"use strict";function b(){a.Services.Contacts.ContactPhoneField.call(this)}b.prototype=Object.create(a.Services.Contacts.ContactPhoneField.prototype),b.prototype.setPhoneNumber=function(a){this._phoneNumber=a},b.prototype.setLabel1=function(a){this._label1=a},b.prototype.setLabel2=function(a){this._label2=a},b.prototype.setPhoneNumberType=function(a){this._phoneNumberType=a},b.prototype.setSpeedDialEnabled=function(a){this._speedDialEnabled=a},b.prototype.setDefault=function(a){this._default=a},a.Services.Contacts.EditableContactPhoneField=b}(AvayaClientServices),function(a){"use strict";function b(){a.Services.Contacts.ContactStringField.call(this)}b.prototype=Object.create(a.Services.Contacts.ContactStringField.prototype),b.prototype.setValue=function(a){this._value=a},a.Services.Contacts.EditableContactStringField=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d,e,f){this._uniqueSearchId=a.Base.Utils.makeId(16),this._searchString=b,this._searchField=c,this._searchSource=d,this._maxResults=e,this._maxChunkSize=f}b.prototype={getUniqueSearchId:function(){return this._uniqueSearchId},getSearchString:function(){return this._searchString},_setSearchString:function(a){this._searchString=a},getSearchField:function(){return this._searchField},getSearchSource:function(){return this._searchSource},getMaxResults:function(){return this._maxResults},getMaxChunkSize:function(){return this._maxChunkSize}},a.Services.Contacts.ContactSearchRequest=b}(AvayaClientServices),function(a){"use strict";function b(){this._cacheKeys=[a.Services.Contacts.ContactCacheKeys.FIRST_NAME,a.Services.Contacts.ContactCacheKeys.LAST_NAME,a.Services.Contacts.ContactCacheKeys.DISPLAY_NAME,a.Services.Contacts.ContactCacheKeys.ALIAS,a.Services.Contacts.ContactCacheKeys.EMAIL_ADDRESS,a.Services.Contacts.ContactCacheKeys.HANDLE,a.Services.Contacts.ContactCacheKeys.LOGIN_ID,a.Services.Contacts.ContactCacheKeys.PHONE_NUMBER,a.Services.Contacts.ContactCacheKeys.CITY,a.Services.Contacts.ContactCacheKeys.DEPARTMENT,a.Services.Contacts.ContactCacheKeys.ADDRESS_FOR_MATCHING,a.Services.Contacts.ContactCacheKeys.TERMINAL_NAME],this._imdb=new a.Base.SimpleIMDB(this._cacheKeys)}b.prototype={addContact:function(b){var c=this._buildKeys(b);try{this._imdb.addElement(c,b)}catch(d){a.Base.Logger.warn(a.Base.LoggerTags.CONTACTS_SERVICE,"Failed to add contact to cache ("+d.message+")")}},updateContact:function(b){var c=this._buildKeysWithMatchingAddressOnly(b),d=this._buildKeys(b);try{this._imdb.updateElement(c,d,b)}catch(e){a.Base.Logger.warn(a.Base.LoggerTags.CONTACTS_SERVICE,"Failed to update contact in cache ("+e.message+")")}},deleteContact:function(b){var c=this._buildKeysWithMatchingAddressOnly(b);try{this._imdb.deleteElements(c)}catch(d){a.Base.Logger.warn(a.Base.LoggerTags.CONTACTS_SERVICE,"Failed to delete contact from cache ("+d.message+")")}},searchContacts:function(b,c,d){var e=b.trim();if(c===a.Services.Contacts.SearchFieldType.NAME)return this.searchByName(e,d);if(c===a.Services.Contacts.SearchFieldType.HANDLE)return this.searchByHandle(e,d);if(c===a.Services.Contacts.SearchFieldType.LOGIN_ID)return this.searchByLoginId(e,d);if(c===a.Services.Contacts.SearchFieldType.TERMINAL)return this.searchByTerminal(e,d);if(c===a.Services.Contacts.SearchFieldType.ALL)return this.searchAll(e,d);throw new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.INVALID_SEARCH_FIELD,"Unknown contact search scope: "+c)},resolveContacts:function(b,c,d){var e=b.trim();if(c===a.Services.Contacts.ResolveContactsFieldType.HANDLE)return this.searchByHandle(e,d);if(c===a.Services.Contacts.ResolveContactsFieldType.PHONE_NUMBER)return this.resolveContactsByPhone(e,d);throw new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.INVALID_SEARCH_FIELD,"Unknown contact search scope: "+c)},searchAll:function(b,c){var d=a.Services.Contacts.ContactsUtils.normalizeAndSimplifyNameString(b).split(/[,]+/);d=d.filter(function(a){return""!==a.trim()}),1===d.length&&(d=d.toString().split(/[\s]+/)),d.length>2&&(d[2]=d.slice(2).toString().trim());var e=new Array(d.length);if(e[0]=this._imdb.searchByAllKeys(d[0].trim(),a.Base.IMDBSearchOptions.BEGINS_WITH),void 0!==e[0]){for(var f=1;f<d.length&&f<3;f++)if(e[f]=this._imdb.searchByAllKeys(d[f].trim(),a.Base.IMDBSearchOptions.BEGINS_WITH),void 0===e[f])return;var g=a.Base.Utils.removeDuplicatesFromArray(e[0]),h=g.filter(function(a){for(f=1;f<e.length;f++){for(var b=e[f],c=!1,d=0;d<b.length;d++)a===b[d]&&(c=!0);if(!c)return!1}return!0});if(c){var i=new a.Services.Contacts.MatchedContactsWithMatchLevel;return h.length>0&&(i._exactType1Contacts=h,i._allContacts=h,i._empty=!1),i}return h}},searchByName:function(b,c){var d=a.Services.Contacts.ContactsUtils.normalizeAndSimplifyNameString(b).split(/[,]+/);d=d.filter(function(a){return""!==a.trim()}),1===d.length&&(d=d.toString().split(/[\s]+/)),d.length>2&&(d[2]=d.slice(2).toString().trim());for(var e=new Array(d.length),f=[a.Services.Contacts.ContactCacheKeys.FIRST_NAME,a.Services.Contacts.ContactCacheKeys.LAST_NAME,a.Services.Contacts.ContactCacheKeys.DISPLAY_NAME,a.Services.Contacts.ContactCacheKeys.ALIAS],g=0;g<d.length&&g<3;g++){e[g]=[];for(var h=0;h<f.length;h++){var i=this._imdb.searchBySingleKey(f[h],d[g].trim(),a.Base.IMDBSearchOptions.BEGINS_WITH);e[g]=e[g].concat(i)}if(0===e[g].length)return}var j=a.Base.Utils.removeDuplicatesFromArray(e[0]),k=j.filter(function(a){var b=function(b){return a===b};for(g=1;g<e.length;g++)if(!e[g].some(b))return!1;return!0});if(c){var l=new a.Services.Contacts.MatchedContactsWithMatchLevel;return k.length>0&&(l._exactType1Contacts=k,l._allContacts=k,l._empty=!1),l}return k},searchByHandle:function(b,c){var d=a.Services.Contacts.ContactsUtils.normalizeHandle(b),e=this._imdb.searchBySingleKey(a.Services.Contacts.ContactCacheKeys.HANDLE,d),f=this._imdb.searchBySingleKey(a.Services.Contacts.ContactCacheKeys.EMAIL_ADDRESS,d),g=e.concat(f);if(g=a.Base.Utils.removeDuplicatesFromArray(g),c){var h=new a.Services.Contacts.MatchedContactsWithMatchLevel;return g.length>0&&(h._exactType1Contacts=g,h._allContacts=g,h._empty=!1),h}return g},searchByLoginId:function(b,c){var d=this._imdb.searchBySingleKey(a.Services.Contacts.ContactCacheKeys.LOGIN_ID,b);if(d=a.Base.Utils.removeDuplicatesFromArray(d),c){var e=new a.Services.Contacts.MatchedContactsWithMatchLevel;return d.length>0&&(e._exactType1Contacts=d,e._allContacts=d,e._empty=!1),e}return d},searchByTerminal:function(b,c){var d=a.Services.Contacts.ContactsUtils.normalizeAndSimplifyNameString(b),e=this._imdb.searchBySingleKey(a.Services.Contacts.ContactCacheKeys.TERMINAL_NAME,d,a.Base.IMDBSearchOptions.CONTAINS);if(e=a.Base.Utils.removeDuplicatesFromArray(e),c){var f=new a.Services.Contacts.MatchedContactsWithMatchLevel;return e.length>0&&(f._exactType1Contacts=e,f._allContacts=e,f._empty=!1),f}return e},searchByPhone:function(b,c){for(var d=this._imdb.getAllElements(),e=new a.Services.Contacts.MatchedContactsWithMatchLevel,f=!1,g=function(b,c,d){var g=a.Services.Contacts.ContactsUtils.comparePhoneStrings(b,c);g===a.Services.Contacts.ContactMatchTypes.EXACT_TYPE1?(e._exactType1Contacts.push(d),f=!0):g===a.Services.Contacts.ContactMatchTypes.EXACT_TYPE2?e._exactType2Contacts.push(d):g===a.Services.Contacts.ContactMatchTypes.PARTIAL_TYPE1&&e._partialType1Contacts.push(d)}.bind(this),h=0;h<d.length&&!f;h++){for(var i=d[h],j=i.getPhoneNumbers().getValues(),k=0;k<j.length&&!f;k++)g(b,j[k].getPhoneNumber(),i);var l=i.getEmailAddresses().getValues();for(k=0;k<l.length&&!f;k++)g(b,l[k].getAddress(),i);var m=i.getEmailAddresses().getValues();for(k=0;k<m.length&&!f;k++)g(b,m[k].getAddress(),i);g(b,i.getFirstName().getValue(),i),g(b,i.getLastName().getValue(),i),g(b,i.getDisplayName().getValue(),i),g(b,i.getASCIIFirstName().getValue(),i),g(b,i.getASCIILastName().getValue(),i),g(b,i.getASCIIDisplayName().getValue(),i),g(b,i.getAlias().getValue(),i),g(b,i.getManager().getValue(),i),g(b,i.getCompany().getValue(),i),g(b,i.getDepartment().getValue(),i),g(b,i.getNotes().getValue(),i),g(b,i.getLocation().getValue(),i),g(b,i.getStreetAddress().getValue(),i),g(b,i.getCity().getValue(),i),g(b,i.getState().getValue(),i),g(b,i.getCountry().getValue(),i),g(b,i.getPostalCode().getValue(),i),g(b,i.getWorkRoomNumber().getValue(),i);var n=i.getCustom1().getValues();for(k=0;k<n.length&&!f;k++)g(b,n[h].getValue(),i);var o=i.getCustom2().getValues();for(k=0;k<o.length&&!f;k++)g(b,o[h].getValue(),i);var p=i.getCustom3().getValues();for(k=0;k<p.length&&!f;k++)g(b,p[h].getValue(),i)}return e._allContacts=e._exactType1Contacts.concat(e._exactType2Contacts).concat(e._partialType1Contacts),e._allContacts=a.Base.Utils.removeDuplicatesFromArray(e._allContacts),c?(e._allContacts.length>0&&(e._empty=!1),e):e._allContacts},resolveContactsByPhone:function(b,c){var d=this._imdb.searchBySingleKey(a.Services.Contacts.ContactCacheKeys.PHONE_NUMBER,b,a.Base.IMDBSearchOptions.EXACT_MATCH);if(d=a.Base.Utils.removeDuplicatesFromArray(d),c){var e=new a.Services.Contacts.MatchedContactsWithMatchLevel;return d.length>0&&(e._exactType1Contacts=d,e._allContacts=d,e._empty=!1),e}return d},empty:function(){this._imdb=new a.Base.SimpleIMDB(this._cacheKeys)},_buildKeys:function(b){var c=b.getUniqueAddressForMatching();if(this.hasUniqueAddressForMatching(c)){var d=[],e=b.getFirstName().getValue(),f=b.getASCIIFirstName().getValue();void 0!==e&&""!==e&&d.push(a.Services.Contacts.ContactsUtils.normalizeAndSimplifyNameString(e)),void 0!==f&&""!==f&&f!==e&&d.push(f);var g=[],h=b.getLastName().getValue(),i=b.getASCIILastName().getValue();void 0!==h&&""!==h&&g.push(a.Services.Contacts.ContactsUtils.normalizeAndSimplifyNameString(h)),void 0!==i&&""!==i&&i!==h&&g.push(i);var j=[],k=b.getDisplayName().getValue(),l=b.getASCIIDisplayName().getValue();void 0!==k&&""!==k&&j.push(a.Services.Contacts.ContactsUtils.normalizeAndSimplifyNameString(k)),void 0!==l&&""!==l&&l!==k&&j.push(l);for(var m=[],n=b.getPhoneNumbers().getValues(),o=0;o<n.length;o++){var p=n[o].getPhoneNumber();void 0!==p&&""!==p&&-1===m.indexOf(p)&&m.push(p)}var q=[],r=b.getEmailAddresses().getValues();for(o=0;o<r.length;o++){var s=r[o].getAddress();void 0!==s&&""!==s&&-1===q.indexOf(s)&&q.push(s)}var t=[],u=b.getIMAddresses().getValues();for(o=0;o<u.length;o++){var v=u[o].getAddress();void 0!==v&&""!==v&&-1===t.indexOf(v)&&t.push(v)}var w={};w[a.Services.Contacts.ContactCacheKeys.ADDRESS_FOR_MATCHING]=[c];var x=b.getAlias().getValue();void 0!==x&&""!==x&&(w[a.Services.Contacts.ContactCacheKeys.ALIAS]=[a.Services.Contacts.ContactsUtils.normalizeAndSimplifyNameString(x)]);var y=b.getCity().getValue();void 0!==y&&""!==y&&(w[a.Services.Contacts.ContactCacheKeys.CITY]=[y]);var z=b.getAlias().getValue();if(void 0!==z&&""!==z&&(w[a.Services.Contacts.ContactCacheKeys.DEPARTMENT]=[z]),a.Base.Utils.isDefined(b.getTerminal())){var A=b.getTerminal().getTerminalName();void 0!==A&&""!==A&&(w[a.Services.Contacts.ContactCacheKeys.TERMINAL_NAME]=[A])}d.length>0&&(w[a.Services.Contacts.ContactCacheKeys.FIRST_NAME]=d),g.length>0&&(w[a.Services.Contacts.ContactCacheKeys.LAST_NAME]=g),j.length>0&&(w[a.Services.Contacts.ContactCacheKeys.DISPLAY_NAME]=j),m.length>0&&(w[a.Services.Contacts.ContactCacheKeys.PHONE_NUMBER]=m),q.length>0&&(w[a.Services.Contacts.ContactCacheKeys.EMAIL_ADDRESS]=q),t.length>0&&(w[a.Services.Contacts.ContactCacheKeys.HANDLE]=t);var B=b.getScopiaLoginId().getValue();return void 0!==B&&""!==B&&(w[a.Services.Contacts.ContactCacheKeys.LOGIN_ID]=[B]),w}},_buildKeysWithMatchingAddressOnly:function(b){var c=b.getUniqueAddressForMatching();if(this.hasUniqueAddressForMatching(c)){var d={};return d[a.Services.Contacts.ContactCacheKeys.ADDRESS_FOR_MATCHING]=[c],d}},hasUniqueAddressForMatching:function(b){return!(!a.Base.Utils.isDefined(b)||""===b)||(a.Base.Logger.warn(a.Base.LoggerTags.CONTACTS_SERVICE,"Failed to build keys for contact without unique address"),!1)},isContactInCache:function(b){if(!this.hasUniqueAddressForMatching(b))return!1;var c=a.Services.Contacts.ContactCacheKeys.ADDRESS_FOR_MATCHING;return this._imdb.searchBySingleKey(c,b).length>0}},a.Services.Contacts.ContactsCache=b}(AvayaClientServices),function(a){"use strict";function b(b){a.Base.BaseError.call(this),this._reason=b}b.prototype=Object.create(a.Base.BaseError.prototype),b.prototype.getReason=function(){return this._reason},a.Services.Contacts.ContactsError=b}(AvayaClientServices),function(a,b){"use strict";function c(){this._contactsService=void 0,this._contacts=void 0,this._started=!1,this._onContactsChangedCallback=void 0,this._externalContactListChangesCallbacks=b.Callbacks()}c.prototype={start:function(a,b){!this._started&&a&&b&&(this._started=!0,this._contactsService=a,this._contacts=b,this._registerCallbacks())},stop:function(){this._started&&(this._started=!1,this._unregisterCallbacks())},isStarted:function(){return this._started},addOnContactListChangedCallback:function(a){a&&this._externalContactListChangesCallbacks.add(a)},removeOnContactListChangedCallback:function(a){a&&this._externalContactListChangesCallbacks.remove(a)},updateMatchedContactsForParticipant:function(b,c){var d=a.Services.Contacts.SearchFieldType.HANDLE,e=a.Services.Contacts.SearchFieldType.ALL;if(this._started&&b){var f=b.getAddress();if(f){var g=this._contactsService.findLocalMatchingContacts(f,d);if(c&&g.isEmpty()){var h=a.Services.Contacts.ContactsUtils.parseSipUri(f).userpart;a.Base.Utils.isDefined(h)&&(g=this._contactsService.findLocalMatchingContacts(h,e))}b.setMatchedContacts(g)}}},_registerCallbacks:function(){this._onContactsChangedCallback=function(){this._externalContactListChangesCallbacks.fire()}.bind(this),this._contactsService.getDataSet().addOnDataSetChangedCallback(this._onContactsChangedCallback)},_unregisterCallbacks:function(){this._contactsService.getDataSet().removeOnDataSetChangedCallback(this._onContactsChangedCallback)}},a.Services.Contacts.ContactsIntegrationService=c}(AvayaClientServices,jQuery),function(a,b){"use strict";function c(b,c,d,e,f,g){this._presenceService=e,this._contactsService=f,this._directorySearchProvider=c,this._contactsCache=d,this._searchRequest=b,this._dataSet=new a.Base.DataSet,this._dataRetrieval=new a.Base.DataRetrieval(this._dataSet),this._dataRetrieval._onCancel=this._cancel.bind(this),this._resultsCounter=0,this._currentSearchString=void 0,this._searchCompletionDate=void 0,this._contactsAnalyticsService=g}c.prototype={start:function(){var b=this._searchRequest.getSearchSource(),c=this._searchRequest.getSearchString();this._currentSearchString=c,this._searchCompletionDate=void 0,this._resultsCounter=0;var d=function(){this._isResultValid(c)&&(this._dataRetrieval._dataRetrievalDone.fire(),this._searchCompletionDate=new Date)}.bind(this),e=function(a){this._isResultValid(c)&&(this._dataRetrieval._dataRetrievalFailed.fire(a),this._searchCompletionDate=new Date)}.bind(this),f=function(a){this._isResultValid(c)&&this._handleResults(a)}.bind(this);b===a.Services.Contacts.SearchSourceType.NETWORK?this._searchNetworkContacts().then(d,e,f):b===a.Services.Contacts.SearchSourceType.LOCAL?this._searchLocalContacts().then(d,e,f):this._searchAllContacts().then(d,e,f)},updateRequest:function(b){this._searchRequest._setSearchString(b),this._dataSet.onDataSetChanged(this._dataSet.splice(0,this._dataSet.length),a.Base.DataSetChangeTypes.REMOVED),this._searchFinished=!1,this.start()},getDataRetrieval:function(){return this._dataRetrieval},getSearchCompletionDate:function(){return this._searchCompletionDate},_isResultValid:function(a){return!this._searchCompletionDate&&this._currentSearchString===a},_handleResults:function(b){for(var c=0;c<b.length&&!this._searchFinished;c++){b[c]._setPresenceService(this._presenceService),b[c]._setContactsService(this._contactsService),this._dataSet.push(b[c]);var d=this._searchRequest.getMaxResults();this._searchFinished=void 0!==d&&0!==d&&++this._resultsCounter>=d}this._dataSet.onDataSetChanged(b.slice(0,c),a.Base.DataSetChangeTypes.ADDED),this._dataRetrieval._dataRetrievalProgress.fire(),this._searchFinished&&this._dataRetrieval._dataRetrievalDone.fire()},_cancel:function(){this._searchCompletionDate=new Date,this._dataRetrieval._dataRetrievalFailed.fire(new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.REQUEST_CANCELED)),this._searchRequest.getSearchSource()!==a.Services.Contacts.SearchSourceType.LOCAL&&this._directorySearchProvider.stopDirectorySearch(this._searchRequest.getUniqueSearchId())},_searchNetworkContacts:function(){var a=this._contactsAnalyticsService.startTimingMetric(),b=this._directorySearchProvider.startDirectorySearch(this._searchRequest);return b.then(function(b){return this._contactsAnalyticsService.sendNumDirectorySearches(this._searchRequest.getSearchField()),this._contactsAnalyticsService.directorySearchTimeEnd(a),b}.bind(this)),b},_searchLocalContacts:function(){var a=b.Deferred(),c=this._contactsAnalyticsService.startTimingMetric(),d=this._contactsCache.searchContacts(this._searchRequest.getSearchString(),this._searchRequest.getSearchField(),!1);return this._contactsAnalyticsService.cachedContactsSearchTimeEnd(c),this._contactsAnalyticsService.sendNumCachedContactSearches(this._searchRequest.getSearchField()),setTimeout(function(){d&&a.notify(d),a.resolve()},0),a.promise()},_searchAllContacts:function(){var c=b.Deferred(),d=[],e=function(a,b){b?a=a.filter(function(a){return-1===d.indexOf(a.getUniqueAddressForMatching())}):a.forEach(function(a){d.push(a.getUniqueAddressForMatching())}),c.notify(a)},f=function(){return this._searchLocalContacts().then(function(){c.resolve()},function(){c.reject(error)},function(a){e(a,!0)})}.bind(this),g=function(b){a.Base.Logger.error(a.Base.LoggerTags.CONTACTS_SERVICE,"Network contacts search failed",b),f()};return this._searchNetworkContacts().then(f,g,e),c.promise()}},a.Services.Contacts.ContactsSearch=c}(AvayaClientServices,jQuery),function(a,b){"use strict";function c(b,c,d,e,f){this._started=!1,this._starting=!1,this._contactsModule=void 0,this._contactsIntegrationService=d,this._presenceService=e,this._contactsProvider=b,this._directorySearchProvider=c,this._contactsCache=new a.Services.Contacts.ContactsCache,this._contactsDataSet=new a.Base.DataSet,this._contactsRetrieval=new a.Base.DataRetrieval(this._contactsDataSet),this._retrievalFinished=!1,this._selfContact=void 0,this._activeSearches={},this._activeResolveContactsRequests={},this._searchAuditIntervalId=void 0,this._deniedCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._addContactCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._updateContactCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._deleteContactCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._searchContactCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._searchTerminalCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._resolveContactsCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._contactsAnalyticsService=f}var d=12e4;c.prototype={start:function(c,d){a.Base.Logger.info(a.Base.LoggerTags.CONTACTS_SERVICE,"Starting the service");var e,f=this._contactsAnalyticsService.startTimingMetric();c.addOnContactsServiceUnavailableCallback(function(){e=this._contactsAnalyticsService.startTimingMetric()}.bind(this)),c.addOnContactsServiceAvailableCallback(function(){this._contactsAnalyticsService.durationContactProviderOutagesEnd(e)}.bind(this)),this._contactsModule=c,this._starting=!0;var g=function(){return this._contactsProvider.start(d,c)}.bind(this),h=function(){return this._contactsProvider.on(a.Base.NetworkProviderEvents.UNAUTHORIZED,function(){c._fireContactsUnavailableCallback(c)}.bind(this)),this._directorySearchProvider.start(d,c)}.bind(this),i=function(){return this._directorySearchProvider.getSelfContact().then(function(b){b._setContactsService(this),b._setPresenceService(this._presenceService),b._setSelfContact(!0),this._selfContact=b,this._starting=!1,this._started=!0,c._fireContactsAvailableCallback(c),a.Base.Logger.info(a.Base.LoggerTags.CONTACTS_SERVICE,"Service started successfully")}.bind(this),function(c){return this._starting=!1,a.Base.Logger.error(a.Base.LoggerTags.CONTACTS_SERVICE,"Self contact cannot be found",c),b.Deferred().reject(c).promise()}.bind(this))}.bind(this);return g().then(h).then(function(){this._registerContactChangesCallbacks(),this._recalculateCapabilities(),this._contactsIntegrationService.start(this,c)}.bind(this)).then(i).fail(function(b){this._starting=!1,this._started=!1,a.Base.Logger.error(a.Base.LoggerTags.CONTACTS_SERVICE,"Failed to start service",b)}.bind(this)).then(function(){this._contactsAnalyticsService.contactsLoadTimeEnd(f)}.bind(this))},stop:function(c){a.Base.Logger.info(a.Base.LoggerTags.CONTACTS_SERVICE,"Stopping the service");var d=b.Deferred();this._started||d.reject(new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.INTERNAL_ERROR)),c._fireContactsUnavailableCallback(c),this._started=!1;var e=function(b){this._started=!0,a.Base.Logger.error(a.Base.LoggerTags.CONTACTS_SERVICE,"Failed to stop service",b),d.reject(b)}.bind(this),f=function(){return this._contactsProvider.stop().fail(e)}.bind(this),g=function(){return this._cleanupResources(),this._directorySearchProvider.stop().fail(e)}.bind(this);return f().then(g).then(function(){this._contactsIntegrationService.stop(),this._selfContact=void 0,a.Base.Logger.info(a.Base.LoggerTags.CONTACTS_SERVICE,"Service stopped successfully"),d.resolve()}.bind(this),e.bind(this)),d.promise()},isStarted:function(){return this._started},isStarting:function(){return this._starting},createEditableContact:function(){var a=this._contactsProvider.createContactForAdd();return a._setContactsService(this),a},createEditableContactFromContact:function(b){if(b.getTerminal()&&""!==b.getTerminal().getTerminalId())throw new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.EDIT_TERMINAL_NOT_SUPPORTED);var c=new a.Services.Contacts.EditableContact,d=this._contactsProvider.createContactForAdd();c._setContactsService(this),c._setInContactList(b._isInContactList()),c._isInContactList()&&c._setUniqueAddressForMatching(b.getUniqueAddressForMatching()),c.getFirstName().setValue(b.getFirstName().getValue()),c.getLastName().setValue(b.getLastName().getValue()),c.getDisplayName().setValue(b.getDisplayName().getValue()),c.getASCIIFirstName().setValue(b.getASCIIFirstName().getValue()),c.getASCIILastName().setValue(b.getASCIILastName().getValue()),c.getASCIIDisplayName().setValue(b.getASCIIDisplayName().getValue()),c.getAlias().setValue(b.getAlias().getValue()),c.getLocation().setValue(b.getLocation().getValue()),c.getWorkRoomNumber().setValue(b.getWorkRoomNumber().getValue()),c.getStreetAddress().setValue(b.getStreetAddress().getValue()),c.getCity().setValue(b.getCity().getValue()),c.getState().setValue(b.getState().getValue()),c.getCountry().setValue(b.getCountry().getValue()),c.getPostalCode().setValue(b.getPostalCode().getValue()),c.getCompany().setValue(b.getCompany().getValue()),c.getManager().setValue(b.getManager().getValue()),c.getDepartment().setValue(b.getDepartment().getValue()),c.getLanguage().setValue(b.getLanguage().getValue()),c.getNotes().setValue(b.getNotes().getValue()),c.getScopiaUserId().setValue(b.getScopiaUserId().getValue()),c.getScopiaLoginId().setValue(b.getScopiaLoginId().getValue()),c.getRank().setValue(b.getRank().getValue()),c.isBuddy().setValue(b.isBuddy().getValue()),c.isFavorite().setValue(b.isFavorite().getValue()),c.isVideoCapable().setValue(b.isVideoCapable().getValue()),c.getFirstName()._setWriteCapability(b.getFirstName().getWriteCapability()),c.getLastName()._setWriteCapability(b.getLastName().getWriteCapability()),c.getDisplayName()._setWriteCapability(b.getDisplayName().getWriteCapability()),c.getASCIIFirstName()._setWriteCapability(b.getASCIIFirstName().getWriteCapability()),c.getASCIILastName()._setWriteCapability(b.getASCIILastName().getWriteCapability()),c.getASCIIDisplayName()._setWriteCapability(b.getASCIIDisplayName().getWriteCapability()),c.getAlias()._setWriteCapability(b.getAlias().getWriteCapability()),c.getLocation()._setWriteCapability(b.getLocation().getWriteCapability()),c.getWorkRoomNumber()._setWriteCapability(b.getWorkRoomNumber().getWriteCapability()),c.getStreetAddress()._setWriteCapability(b.getStreetAddress().getWriteCapability()),c.getCity()._setWriteCapability(b.getCity().getWriteCapability()),c.getState()._setWriteCapability(b.getState().getWriteCapability()),c.getCountry()._setWriteCapability(b.getCountry().getWriteCapability()),c.getPostalCode()._setWriteCapability(b.getPostalCode().getWriteCapability()),c.getCompany()._setWriteCapability(b.getCompany().getWriteCapability()),c.getManager()._setWriteCapability(b.getManager().getWriteCapability()),c.getDepartment()._setWriteCapability(b.getDepartment().getWriteCapability()),c.getLanguage()._setWriteCapability(b.getLanguage().getWriteCapability()),c.getNotes()._setWriteCapability(b.getNotes().getWriteCapability()),c.getScopiaUserId()._setWriteCapability(b.getScopiaUserId().getWriteCapability()),c.getScopiaLoginId()._setWriteCapability(b.getScopiaLoginId().getWriteCapability()),c.getRank()._setWriteCapability(b.getRank().getWriteCapability()),c.isBuddy()._setWriteCapability(b.isBuddy().getWriteCapability()),c.isFavorite()._setWriteCapability(b.isFavorite().getWriteCapability()),c.isVideoCapable()._setWriteCapability(b.isVideoCapable().getWriteCapability());for(var e=b.getPhoneNumbers().getValues(),f=c.getPhoneNumbers().getValues(),g=0;g<e.length;g++){var h=new a.Services.Contacts.EditableContactPhoneField;h.setPhoneNumber(e[g].getPhoneNumber()),h.setPhoneNumberType(e[g].getPhoneNumberType()),h.setSpeedDialEnabled(e[g].isSpeedDialEnabled()),h.setLabel1(e[g].getLabel1()),h.setLabel2(e[g].getLabel2()),h.setDefault(e[g].isDefault()),h._setWriteCapability(e[g].getWriteCapability()),f.push(h)}var i=b.getEmailAddresses().getValues(),j=c.getEmailAddresses().getValues();for(g=0;g<i.length;g++){var k=new a.Services.Contacts.EditableContactEmailAddressField;k.setAddress(i[g].getAddress()),k.setEmailAddressType(i[g].getEmailAddressType()),k._setWriteCapability(i[g].getWriteCapability()),j.push(k)}var l=b.getIMAddresses().getValues(),m=c.getIMAddresses().getValues();for(g=0;g<l.length;g++){var n=new a.Services.Contacts.EditableContactIMAddressField;n.setAddress(l[g].getAddress()),n.setIMAddressType(l[g].getIMAddressType()),n._setWriteCapability(l[g].getWriteCapability()),m.push(n)}var o=b.getCustom1().getValues(),p=c.getCustom1().getValues();for(g=0;g<o.length;g++){var q=new a.Services.Contacts.EditableContactStringField;q.setValue(o[g].getValue()),q._setWriteCapability(o[g].getWriteCapability()),p.push(q)}var r=b.getCustom2().getValues(),s=c.getCustom2().getValues();for(g=0;g<r.length;g++){var t=new a.Services.Contacts.EditableContactStringField;t.setValue(r[g].getValue()),t._setWriteCapability(r[g].getWriteCapability()),s.push(t)}var u=b.getCustom3().getValues(),v=c.getCustom3().getValues();for(g=0;g<u.length;g++){var w=new a.Services.Contacts.EditableContactStringField;w.setValue(u[g].getValue()),w._setWriteCapability(u[g].getWriteCapability()),v.push(w)}return b.getPhoneNumbers()._setWriteCapability(d.getPhoneNumbers().getWriteCapability()),b.getEmailAddresses()._setWriteCapability(d.getEmailAddresses().getWriteCapability()),b.getIMAddresses()._setWriteCapability(d.getIMAddresses().getWriteCapability()),b.getCustom1()._setWriteCapability(d.getCustom1().getWriteCapability()),b.getCustom2()._setWriteCapability(d.getCustom2().getWriteCapability()),b.getCustom3()._setWriteCapability(d.getCustom3().getWriteCapability()),c},addContact:function(a){return this._contactsProvider.addContact(a)},updateContact:function(a){return this._contactsProvider.updateContact(a)},deleteContact:function(a){return this._contactsProvider.deleteContact(a)},getContacts:function(){if(!this._retrievalFinished){var a=function(){this._contactsAnalyticsService.sendNumContactsLoaded(this._contactsDataSet.length),this._contactsRetrieval._dataRetrievalDone.fire()}.bind(this),b=function(a){this._contactsRetrieval._dataRetrievalFailed.fire(a)}.bind(this),c=function(){this._contactsRetrieval._dataRetrievalProgress.fire()}.bind(this);this._contactsProvider.retrieveAllContacts().then(a,b,c)}return this._contactsRetrieval},searchContacts:function(b){var c=b.getUniqueSearchId();if(this._activeSearches[c])return a.Base.Logger.warn(a.Base.LoggerTags.CONTACTS_SERVICE,"Contact search with provided requestId is already in progress - returning associated DataRetrieval"),this._activeSearches[c].getDataRetrieval();var d=new a.Services.Contacts.ContactsSearch(b,this._directorySearchProvider,this._contactsCache,this._presenceService,this,this._contactsAnalyticsService);return this._activeSearches[c]=d,d.start(),d.getDataRetrieval()},resolveContacts:function(b){var c=b.getUniqueSearchId();if(this._activeResolveContactsRequests[c])return a.Base.Logger.warn(a.Base.LoggerTags.CONTACTS_SERVICE,"Contact resolution with provided requestId is already in progress - returning associated DataRetrieval"),this._activeResolveContactsRequests[c].getDataRetrieval();var d=new a.Services.Contacts.ResolveContacts(b,this._directorySearchProvider,this._contactsCache,this._contactsAnalyticsService);return this._activeResolveContactsRequests[c]=d,d.start(),d.getDataRetrieval()},changeSearchContactsRequest:function(b,c){var d;for(var e in this._activeSearches)if(this._activeSearches.hasOwnProperty(e)&&this._activeSearches[e].getDataRetrieval()===b){d=this._activeSearches[e];break}if(!d)throw new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.SEARCH_REQUEST_NOT_FOUND);d.updateRequest(c)},_startSearchRequestsAudit:function(){this._searchAuditIntervalId=setInterval(function(){var a=new Date;for(var b in this._activeSearches)if(this._activeSearches.hasOwnProperty(b)){var c=this._activeSearches[b].getSearchCompletionDate();c&&a-c>d&&delete this._activeSearches[b]}}.bind(this),d)},_stopSearchRequestsAudit:function(){clearInterval(this._searchAuditIntervalId),this._searchAuditIntervalId=void 0},findLocalMatchingContacts:function(a,b){return this._contactsCache.searchContacts(a,b,!0)},getAddContactCapability:function(){return this._addContactCapability},getUpdateContactCapability:function(a){return a&&a._isInContactList()?this._updateContactCapability:this._deniedCapability},getDeleteContactCapability:function(a){return a&&a._isInContactList()?this._deleteContactCapability:this._deniedCapability},getNetworkSearchContactCapability:function(){return this._searchContactCapability},getNetworkResolveContactsCapability:function(){return this._resolveContactsCapability},getNetworkSearchTerminalCapability:function(){return this._searchTerminalCapability},getExtendedContactDetailsCapability:function(){return this._extendedDetailsCapability},_recalculateCapabilities:function(){var a=!1,b=this._contactsProvider.getAddContactCapability();this._addContactCapability!==b&&(this._addContactCapability=b,a=!0)
;var c=this._contactsProvider.getUpdateContactCapability();this._updateContactCapability!==c&&(this._updateContactCapability=c,a=!0);var d=this._contactsProvider.getDeleteContactCapability();this._deleteContactCapability!==d&&(this._deleteContactCapability=d,a=!0);var e=this._directorySearchProvider.getNetworkSearchContactCapability();this._searchContactCapability!==e&&(this._searchContactCapability=e,a=!0);var f=this._directorySearchProvider.getNetworkResolveContactsCapability();this._resolveContactsCapability!==f&&(this._resolveContactsCapability=f,a=!0);var g=this._directorySearchProvider.getNetworkSearchTerminalCapability();this._searchTerminalCapability!==g&&(this._searchTerminalCapability=g,a=!0);var h=this._contactsProvider.getExtendedContactDetailsCapability();this._extendedDetailsCapability!==h&&(this._extendedDetailsCapability=h,a=!0),a&&this._contactsModule._onCapabilitiesChangedCallbacks.fire(this)},_registerContactChangesCallbacks:function(){var b=a.Providers.Interfaces.ContactsProviderCallbackIds;this._contactsProvider.on(b.CONTACT_ADDED,function(b){for(var c=0;c<b.length;c++)b[c]._setInContactList(!0),b[c]._setPresenceService(this._presenceService),b[c]._setContactsService(this),this._contactsDataSet.push(b[c]),this._contactsCache.addContact(b[c]);this._contactsDataSet.onDataSetChanged(b,a.Base.DataSetChangeTypes.ADDED)}.bind(this));var c=function(a){for(var b=0;b<this._contactsDataSet.length;b++)if(a.getUniqueAddressForMatching()===this._contactsDataSet[b].getUniqueAddressForMatching())return b}.bind(this);this._contactsProvider.on(b.CONTACT_UPDATED,function(b){var d=c(b);a.Base.Utils.isDefined(d)?(this._contactsDataSet[d]=b,this._contactsDataSet.onDataSetChanged([b],a.Base.DataSetChangeTypes.UPDATED)):(a.Base.Logger.warn(a.Base.LoggerTags.CONTACTS_SERVICE,"Updated contact was not found in DataSet",b),this._contactsDataSet.push(b),this._contactsDataSet.onDataSetChanged([b],a.Base.DataSetChangeTypes.ADDED)),b._setInContactList(!0),b._setPresenceService(this._presenceService),b._setContactsService(this),this._contactsCache.updateContact(b)}.bind(this)),this._contactsProvider.on(b.CONTACT_DELETED,function(b){for(var d=0;d<b.length;d++){var e=c(b[d]);this._contactsDataSet.splice(e,1),b[d]._setInContactList(!1),b[d]._setPresenceService(this._presenceService),b[d]._setContactsService(this),this._contactsCache.deleteContact(b[d])}this._contactsDataSet.onDataSetChanged(b,a.Base.DataSetChangeTypes.REMOVED)}.bind(this)),this._contactsProvider.on(b.CAPABILITIES_CHANGED,this._recalculateCapabilities.bind(this)),this._directorySearchProvider.on(b.CAPABILITIES_CHANGED,this._recalculateCapabilities.bind(this))},getContactsModule:function(){return this._contactsModule},isContactInCache:function(a){return this._contactsCache.isContactInCache(a.getUniqueAddressForMatching())},getSelfContact:function(){return this._selfContact},getDataSet:function(){return this._contactsDataSet},_cleanupResources:function(){this._contactsCache.empty();var b=this._contactsDataSet.splice(0,this._contactsDataSet.length);b.length>0&&this._contactsDataSet.onDataSetChanged(b,a.Base.DataSetChangeTypes.REMOVED),this._contactsDataSet.dataSetChangeCallbacks.empty(),this._contactsDataSet.dataSetInvalidatedCallbacks.empty(),this._contactsRetrieval._dataRetrievalProgress.empty(),this._contactsRetrieval._dataRetrievalDone.empty(),this._contactsRetrieval._dataRetrievalFailed.empty(),this._activeSearches={},this._activeResolveContactsRequests={}}},a.Services.Contacts.ContactsService=c}(AvayaClientServices,jQuery),function(a){"use strict";var b="\\+?[0-9\\(\\)\\.\\-]*\\d{1}[0-9\\(\\)\\.\\-]*",c="(\\*|#|\\d)\\d{0,3}",d="(("+b+")|("+c+"))[#\\*,;]{1}[#\\*,;0-9]*",e="^(([^:/?#]+):)?(([^/?@#]*)@)?([^/?;#\\s]*)?",f=new RegExp("^"+b+"$","i"),g=new RegExp("^"+c+"$","i"),h=new RegExp("^"+d+"$","i"),i=new RegExp(e,"i"),j=new RegExp("^\\++[1-9]\\d{1,14}$","i"),k=new RegExp("^.+\\@.+$","i"),l=new RegExp("^\\+?[0-9a-z]+[0-9a-z\\(\\)\\.\\-]*$","i"),m={getPhoneStringType:function(b){return b&&""!==b.trim()?m.isPhoneNumber(b)?a.Services.Contacts.PhoneStringTypes.PHONE_NUMBER:m.isDialString(b)?a.Services.Contacts.PhoneStringTypes.DIALSTRING:m.isFeatureAccessCode(b)?a.Services.Contacts.PhoneStringTypes.FEATURE_ACCESS_CODE:m.isSipUri(b)?a.Services.Contacts.PhoneStringTypes.SIP_URI:a.Services.Contacts.PhoneStringTypes.UNKNOWN:a.Services.Contacts.PhoneStringTypes.UNKNOWN},isSipUri:function(a){return!!a&&!!m.parseSipUri(a).userpart},isPhoneNumber:function(a){return f.test(a)},isFeatureAccessCode:function(a){return g.test(a)},isDialString:function(a){return h.test(a)},isPhoneWithDomain:function(a){return k.test(a)},isE164Userpart:function(a){return j.test(m.parseSipUri(a).userpart)},isAlphanumericUserpart:function(a){return l.test(m.parseSipUri(a).userpart)},isNumericUserpart:function(a){return m.isPhoneNumber(m.parseSipUri(a).userpart)},normalizePhoneString:function(a){var b=a.replace(/^(\+)+|([\s\-\(\)\.])+/g,"");return m.mapAlphabeticalToITU(b)},normalizeHandle:function(a){return a.replace(/^([a-z]+[a-z0-9+.-]*\:)/g,"")},normalizeAndSimplifyNameString:function(a){return a.toLowerCase().replace(/\u1E9E/g,"sz").replace(/\u00DF/g,"sz").replace(/\u00F8/g,"o").normalize("NFD").replace(/[\u0080-\u036F]/g,"").replace("ss","sz").replace("ue","u").replace("ae","a").replace("oe","o")},mapAlphabeticalToITU:function(a){return a.replace(/[ABC]{1}/i,"2").replace(/[DEF]{1}/i,"3").replace(/[GHI]{1}/i,"4").replace(/[JKL]{1}/i,"5").replace(/[MNO]{1}/i,"6").replace(/[PQRS]{1}/i,"7").replace(/[TUV]{1}/i,"8").replace(/[WXYZ]{1}/i,"9")},parseSipUri:function(a){var b=a.match(i);return{scheme:b[2],userpart:b[4],host:b[5]}},comparePhoneStrings:function(b,c){var d=a.Services.Contacts.PhoneStringTypes,e=a.Services.Contacts.ContactMatchTypes,f=m.getPhoneStringType(b),g=m.getPhoneStringType(c);if(f===d.UNKNOWN||g===d.UNKNOWN)return e.NO_MATCH;var h,i,j,k;return f===d.SIP_URI?(j=m.parseSipUri(b),h=m.normalizePhoneString(j.userpart)):h=m.normalizePhoneString(b),g===d.SIP_URI?(k=m.parseSipUri(c),i=m.normalizePhoneString(k.userpart)):i=m.normalizePhoneString(c),f!==d.SIP_URI||g!==d.SIP_URI||j.scheme===k.scheme&&j.host===k.host?h===i?f===d.SIP_URI&&g!==d.SIP_URI||f!==d.SIP_URI&&g===d.SIP_URI?e.EXACT_TYPE2:e.EXACT_TYPE1:m._trimPhoneString(h)===m._trimPhoneString(i)?e.PARTIAL_TYPE1:e.NO_MATCH:e.NO_MATCH},_trimPhoneString:function(a){return a.substr(a.length-10)},getPhoneAndVideoChannelPresenceAddress:function(b){var c=b.getPhoneNumbers().getValues(),d=c.filter(function(b){return b.isAvayaAdministered()&&b.getPhoneNumberType()===a.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_WORK}),e=d.filter(function(a){return m.isPhoneWithDomain(a.getPhoneNumber())}),f=e.filter(function(a){return m.isE164Userpart(a.getPhoneNumber())});if(f[0])return a.Base.Logger.info(a.Base.LoggerTags.CONTACTS_SERVICE,"Using first E.164 phone number as Phone/Video channel presence address"),f[0];var g=e.filter(function(a){return m.isNumericUserpart(a.getPhoneNumber())});if(g[0])return a.Base.Logger.info(a.Base.LoggerTags.CONTACTS_SERVICE,"Using first numeric phone number as Phone/Video channel presence address"),g[0];var h=e.filter(function(a){return m.isAlphanumericUserpart(a.getPhoneNumber())});return h[0]?(a.Base.Logger.info(a.Base.LoggerTags.CONTACTS_SERVICE,"Using first alphanumeric phone number as Phone/Video channel presence address"),h[0]):e[0]?(a.Base.Logger.info(a.Base.LoggerTags.CONTACTS_SERVICE,"Using first phone number with domain as Phone/Video channel presence address"),e[0]):d[0]?(a.Base.Logger.info(a.Base.LoggerTags.CONTACTS_SERVICE,"Using first Avaya administered phone number as Phone/Video channel presence address"),d[0]):void a.Base.Logger.warn(a.Base.LoggerTags.CONTACTS_SERVICE,"No suitable Phone/Video channel presence address found in self contact. Channel presence publications might not work as expected.")}};a.Services.Contacts.ContactsUtils=m}(AvayaClientServices),function(a){"use strict";function b(){this._uniqueAddressForMatching=void 0,this._firstName=new a.Services.Contacts.EditableContactStringField,this._lastName=new a.Services.Contacts.EditableContactStringField,this._displayName=new a.Services.Contacts.EditableContactStringField,this._asciiFirstName=new a.Services.Contacts.EditableContactStringField,this._asciiLastName=new a.Services.Contacts.EditableContactStringField,this._asciiDisplayName=new a.Services.Contacts.EditableContactStringField,this._alias=new a.Services.Contacts.EditableContactStringField,this._company=new a.Services.Contacts.EditableContactStringField,this._location=new a.Services.Contacts.EditableContactStringField,this._workRoomNumber=new a.Services.Contacts.EditableContactStringField,this._streetAddress=new a.Services.Contacts.EditableContactStringField,this._city=new a.Services.Contacts.EditableContactStringField,this._state=new a.Services.Contacts.EditableContactStringField,this._country=new a.Services.Contacts.EditableContactStringField,this._postalCode=new a.Services.Contacts.EditableContactStringField,this._manager=new a.Services.Contacts.EditableContactStringField,this._department=new a.Services.Contacts.EditableContactStringField,this._language=new a.Services.Contacts.EditableContactStringField,this._emailAddresses=new a.Services.Contacts.ContactFieldList,this._phoneNumbers=new a.Services.Contacts.ContactFieldList,this._imAddresses=new a.Services.Contacts.ContactFieldList,this._buddy=new a.Services.Contacts.EditableContactBooleanField,this._favorite=new a.Services.Contacts.EditableContactBooleanField,this._videoCapable=new a.Services.Contacts.EditableContactBooleanField,this._rank=new a.Services.Contacts.EditableContactNumberField,this._notes=new a.Services.Contacts.EditableContactStringField,this._custom1=new a.Services.Contacts.ContactFieldList,this._custom2=new a.Services.Contacts.ContactFieldList,this._scopiaUserId=new a.Services.Contacts.EditableContactStringField,this._scopiaLoginId=new a.Services.Contacts.EditableContactStringField,this._custom3=new a.Services.Contacts.ContactFieldList,this._inContactList=!1,this._contactsService=void 0}b.prototype={getUniqueAddressForMatching:function(){return this._uniqueAddressForMatching},_setUniqueAddressForMatching:function(a){this._uniqueAddressForMatching=a},getFirstName:function(){return this._firstName},getLastName:function(){return this._lastName},getDisplayName:function(){return this._displayName},getASCIIFirstName:function(){return this._asciiFirstName},getASCIILastName:function(){return this._asciiLastName},getASCIIDisplayName:function(){return this._asciiDisplayName},getAlias:function(){return this._alias},getLocation:function(){return this._location},getWorkRoomNumber:function(){return this._workRoomNumber},getStreetAddress:function(){return this._streetAddress},getCity:function(){return this._city},getState:function(){return this._state},getCountry:function(){return this._country},getPostalCode:function(){return this._postalCode},getCompany:function(){return this._company},getManager:function(){return this._manager},getDepartment:function(){return this._department},getLanguage:function(){return this._language},getEmailAddresses:function(){return this._emailAddresses},getPhoneNumbers:function(){return this._phoneNumbers},getIMAddresses:function(){return this._imAddresses},isBuddy:function(){return this._buddy},isFavorite:function(){return this._favorite},isVideoCapable:function(){return this._videoCapable},getNotes:function(){return this._notes},getRank:function(){return this._rank},getCustom1:function(){return this._custom1},getCustom2:function(){return this._custom2},getCustom3:function(){return this._custom3},getScopiaUserId:function(){return this._scopiaUserId},getScopiaLoginId:function(){return this._scopiaLoginId},_isInContactList:function(){return this._inContactList},_setInContactList:function(a){this._inContactList=a},_setContactsService:function(a){this._contactsService=a}},a.Services.Contacts.EditableContact=b}(AvayaClientServices),function(a){"use strict";var b={ADDRESS_FOR_MATCHING:"ADDRESS_FOR_MATCHING",FIRST_NAME:"FIRST_NAME",LAST_NAME:"LAST_NAME",DISPLAY_NAME:"DISPLAY_NAME",ALIAS:"ALIAS",CITY:"CITY",DEPARTMENT:"DEPARTMENT",PHONE_NUMBER:"PHONE_NUMBER",EMAIL_ADDRESS:"EMAIL_ADDRESS",HANDLE:"HANDLE",LOGIN_ID:"LOGIN_ID",TERMINAL_NAME:"TERMINAL_NAME"};a.Services.Contacts.ContactCacheKeys=b}(AvayaClientServices),function(a){"use strict";var b={EMAIL_ADDRESS_WORK:"EMAIL_ADDRESS_WORK",EMAIL_ADDRESS_OTHER:"EMAIL_ADDRESS_OTHER"};a.Services.Contacts.ContactEmailAddressType=b}(AvayaClientServices),function(a){"use strict";var b={IM_ADDRESS_WORK:"IM_ADDRESS_WORK",IM_ADDRESS_OTHER:"IM_ADDRESS_OTHER"};a.Services.Contacts.ContactIMAddressType=b}(AvayaClientServices),function(a){"use strict";var b={EXACT_TYPE1:"EXACT_TYPE1",EXACT_TYPE2:"EXACT_TYPE2",PARTIAL_TYPE1:"PARTIAL_TYPE1",NO_MATCH:"NO_MATCH"};a.Services.Contacts.ContactMatchTypes=b}(AvayaClientServices),function(a){"use strict";var b={PHONE_NUMBER_WORK:"PHONE_NUMBER_WORK",PHONE_NUMBER_HANDLE:"PHONE_NUMBER_HANDLE",PHONE_NUMBER_MOBILE:"PHONE_NUMBER_MOBILE",PHONE_NUMBER_HOME:"PHONE_NUMBER_HOME",PHONE_NUMBER_FAX:"PHONE_NUMBER_FAX",PHONE_NUMBER_PAGER:"PHONE_NUMBER_PAGER"};a.Services.Contacts.ContactPhoneNumberType=b}(AvayaClientServices),function(a){"use strict";var b={XSMALL:"XSMALL",SMALL:"SMALL",MEDIUM:"MEDIUM",LARGE:"LARGE",XLARGE:"XLARGE",XXLARGE:"XXLARGE"};a.Services.Contacts.ContactPictureSize=b}(AvayaClientServices),function(a){"use strict";var b={UNKNOWN_REASON:"UNKNOWN_REASON",INTERNAL_ERROR:"INTERNAL_ERROR",RETRY:"RETRY",SERVER_UNAVAILABLE:"SERVER_UNAVAILABLE",INVALID_SERVER_RESPONSE:"INVALID_SERVER_RESPONSE",AUTHENTICATION_FAILED:"AUTHENTICATION_FAILED",REQUEST_TIMEOUT:"REQUEST_TIMEOUT",REQUEST_CANCELED:"REQUEST_CANCELED",DUPLICATE_CONTACT:"DUPLICATE_CONTACT",INVALID_CONTACT:"INVALID_CONTACT",REQUIRED_DATA_MISSING:"REQUIRED_DATA_MISSING",DELETE_CONTACT_NOT_AVAILABLE:"DELETE_CONTACT_NOT_AVAILABLE",ADD_CONTACT_NOT_AVAILABLE:"ADD_CONTACT_NOT_AVAILABLE",UPDATE_CONTACT_NOT_AVAILABLE:"UPDATE_CONTACT_NOT_AVAILABLE",SEARCH_CONTACTS_NOT_AVAILABLE:"SEARCH_CONTACTS_NOT_AVAILABLE",SEARCH_TERMINALS_NOT_AVAILABLE:"SEARCH_TERMINALS_NOT_AVAILABLE",CONTACT_NOT_FOUND:"CONTACT_NOT_FOUND",INVALID_SEARCH_REQUEST:"INVALID_SEARCH_REQUEST",INVALID_SEARCH_STRING:"INVALID_SEARCH_STRING",INVALID_SEARCH_STRINGS:"INVALID_SEARCH_STRINGS",INVALID_SEARCH_SOURCE:"INVALID_SEARCH_SOURCE",INVALID_SEARCH_FIELD:"INVALID_SEARCH_FIELD",SEARCH_REQUEST_NOT_FOUND:"SEARCH_REQUEST_NOT_FOUND",SEARCH_STRINGS_TOO_LARGE:"SEARCH_STRINGS_TOO_LARGE",EDIT_TERMINAL_NOT_SUPPORTED:"EDIT_TERMINAL_NOT_SUPPORTED",CONTACTS_NOTIFICATIONS_CHANNEL_FAILED:"CONTACTS_NOTIFICATIONS_CHANNEL_FAILED"};a.Services.Contacts.ContactsErrorReason=b}(AvayaClientServices),function(a){"use strict";var b={PHONE_NUMBER:"PHONE_NUMBER",DIALSTRING:"DIALSTRING",FEATURE_ACCESS_CODE:"FEATURE_ACCESS_CODE",SIP_URI:"SIP_URI",UNKNOWN:"UNKNOWN"};a.Services.Contacts.PhoneStringTypes=b}(AvayaClientServices),function(a){"use strict";var b={HANDLE:"HANDLE",PHONE_NUMBER:"PHONE_NUMBER"};a.Services.Contacts.ResolveContactsFieldType=b}(AvayaClientServices),function(a){"use strict";var b={NAME:"NAME",HANDLE:"HANDLE",LOGIN_ID:"LOGIN_ID",TERMINAL:"TERMINAL",ALL:"ALL"};a.Services.Contacts.SearchFieldType=b}(AvayaClientServices),function(a){"use strict";var b={LOCAL:"LOCAL",NETWORK:"NETWORK",ALL:"ALL"};a.Services.Contacts.SearchSourceType=b}(AvayaClientServices),function(a){"use strict";function b(){this._exactType1Contacts=[],this._exactType2Contacts=[],this._partialType1Contacts=[],this._allContacts=[],this._empty=!0}b.prototype={getExactType1Contacts:function(){return this._exactType1Contacts},getExactType2Contacts:function(){return this._exactType2Contacts},getPartialType1Contacts:function(){return this._partialType1Contacts},getAllContacts:function(){return this._allContacts},isEmpty:function(){return this._empty},_setExactType1Contacts:function(a){this._exactType1Contacts=a},_setExactType2Contacts:function(a){this._exactType2Contacts=a},_setPartialType1Contacts:function(a){this._partialType1Contacts=a},_setAllContacts:function(a){this._allContacts=a},_setEmpty:function(a){this._empty=a},_equals:function(a){return a&&this.empty===a.empty&&this._areArraysEqual(this._exactType1Contacts,a._exactType1Contacts)&&this._areArraysEqual(this._exactType2Contacts,a._exactType2Contacts)&&this._areArraysEqual(this._partialType1Contacts,a._partialType1Contacts)},_areArraysEqual:function(a,b){return a.length===b.length&&a.every(function(a,c){return a===b[c]})}},a.Services.Contacts.MatchedContactsWithMatchLevel=b}(AvayaClientServices),function(a){"use strict";function b(a,b,c){this.searchString=a,this.searchScope=b,this.contacts=c}a.Services.Contacts.ResolveContactResult=b}(AvayaClientServices),function(a,b){"use strict";function c(b,c,d,e){this._directorySearchProvider=c,this._contactsCache=d,this._resolveContactsRequest=b,this._dataSet=new a.Base.DataSet,this._dataRetrieval=new a.Base.DataRetrieval(this._dataSet),this._uniqueSearchStrings=a.Base.Utils.removeDuplicatesFromArray(b.getSearchStrings()),this._contactsAnalyticsService=e}c.prototype={start:function(){var b=this._resolveContactsRequest.getSearchSource(),c=function(){this._dataRetrieval._dataRetrievalDone.fire()}.bind(this),d=function(a){this._dataRetrieval._dataRetrievalFailed.fire(a)}.bind(this),e=function(a){this._handleResults(a)}.bind(this);b===a.Services.Contacts.SearchSourceType.NETWORK?this._searchNetworkContacts().then(c,d,e):b===a.Services.Contacts.SearchSourceType.LOCAL?this._searchLocalContacts().then(c,d,e):this._searchAllContacts().then(c,d,e)},getDataRetrieval:function(){return this._dataRetrieval},_handleResults:function(b){var c=!1;b.forEach(function(a){a.contacts.length&&(c=!0,this._dataSet.push(a))}.bind(this)),c&&(this._dataSet.onDataSetChanged(b.slice(),a.Base.DataSetChangeTypes.ADDED),this._dataRetrieval._dataRetrievalProgress.fire())},_searchNetworkContacts:function(a){var b=a||this._uniqueSearchStrings,c=this._contactsAnalyticsService.startTimingMetric(),d=this._resolveContactsRequest.getSearchField(),e=this._directorySearchProvider.startResolvingContacts(b,d);return e.then(function(){this._contactsAnalyticsService.sendNumResolveContacts(d),this._contactsAnalyticsService.resolveContactsTimeEnd(c)}.bind(this)),e},_searchLocalContacts:function(){var c=b.Deferred(),d=this._resolveContactsRequest.getSearchField(),e=this._uniqueSearchStrings.reduce(function(b,c){var e=this._contactsCache.resolveContacts(c,d,!1);return b.push(new a.Services.Contacts.ResolveContactResult(c,d,e)),b}.bind(this),[]);return setTimeout(function(){e&&c.notify(e),c.resolve()},0),c.promise()},_searchAllContacts:function(){var c=b.Deferred(),d=[],e=function(a){a.forEach(function(a){a.contacts.length&&d.push(a.searchString)}),c.notify(a)},f=function(){var b=this._uniqueSearchStrings.filter(function(a){return-1===d.indexOf(a)});return b.length?this._searchNetworkContacts(b).then(function(){c.resolve()},function(b){a.Base.Logger.error(a.Base.LoggerTags.CONTACTS_SERVICE,"Network contacts quick search failed",b),c.reject(b)},function(a){e(a)}):void c.resolve()}.bind(this),g=function(b){a.Base.Logger.error(a.Base.LoggerTags.CONTACTS_SERVICE,"Local contacts quick search failed",b),f()};return this._searchLocalContacts().then(f,g,e),c.promise()}},a.Services.Contacts.ResolveContacts=c}(AvayaClientServices,jQuery),function(a){"use strict";function b(b,c,d){this._uniqueSearchId=a.Base.Utils.makeId(16),this._searchStrings=b,this._searchField=c,this._searchSource=d}b.prototype={getUniqueSearchId:function(){return this._uniqueSearchId},_setSearchStrings:function(a){this._searchStrings=a},_setSearchField:function(a){this._searchField=a},_setSearchSource:function(a){this._searchSource=a},getSearchStrings:function(){return this._searchStrings},getSearchField:function(){return this._searchField},getSearchSource:function(){return this._searchSource}},a.Services.Contacts.ResolveContactsRequest=b}(AvayaClientServices),function(a){"use strict";function b(){this._terminalId="",this._terminalName=""}b.prototype={getTerminalId:function(){return this._terminalId},getTerminalName:function(){return this._terminalName}},a.Services.Contacts.Terminal=b}(AvayaClientServices),function(a){"use strict";function b(a){this._attachmentBuilder=a}b.prototype={_resizeImage:function(a,b){var c,d,e=document.createElement("canvas");return b.scale?(d=a.width*b.scale,c=a.height*b.scale):b.width&&!b.height?(d=b.width,c=parseInt(b.width*a.height/a.width)):b.height&&!b.width?(d=parseInt(b.height*a.width/a.height),c=b.height):(d=a.width,c=a.height),e.height=c,e.width=d,e.getContext("2d").drawImage(a,0,0,d,c),e.toDataURL("image/jpeg")},create:function(){}},a.Services.Messaging.AbstractThumbnailCreator=b}(AvayaClientServices),function(a){"use strict";function b(a){this._thumbnailCreator=a}b.prototype={build:function(b,c){var d=new a.Services.Messaging.Attachment(this._thumbnailCreator);return b=b||{},d.disposition=b.disposition,d.duration=b.duration,d.mimeType=b.mimeType,d.id=b.partId,d.location=b.location||b.media,d.size=b.size,d.name=d.getName(),d.file=c,d.status=b.status||a.Services.Messaging.ResourceStatus.PUBLISHED,this._recalculateCapabilities(d),d},update:function(b,c){c.thumbnail&&(b.thumbnail.location=c.thumbnail.location),b.id=c.partId,b.location=c.location||c.media,b.duration!==c.duration&&(b.duration=c.duration,b._onDurationChangedCallbacks.fire(b,c.duration)),b.status!==a.Services.Messaging.ResourceStatus.PUBLISHED&&(b.status=a.Services.Messaging.ResourceStatus.PUBLISHED,b._onStatusChangedCallbacks.fire(b,a.Services.Messaging.ResourceStatus.PUBLISHED)),b.file&&(b.file=void 0)},_recalculateCapabilities:function(a){a._recalculateUpdateNameCapability(),a._recalculateUpdateMimeTypeCapability(),a._recalculateUpdateDurationCapability(),a._recalculateUpdateIsSelfGeneratedCapability(),a._recalculateCreateThumbnailCapability(),a._recalculateRemoveThumbnailCapability(),a._recalculateRemoveCapability()}},a.Services.Messaging.AttachmentBuilder=b}(AvayaClientServices),function(a){"use strict";var b={READY_TO_DOWNLOAD:"READY_TO_DOWNLOAD",DOWNLOADING:"DOWNLOADING",READY_TO_CONSUME:"READY_TO_CONSUME",CONSUMED:"CONSUMED",ERROR:"ERROR"};a.Services.Messaging.AttachmentStatus=b}(AvayaClientServices),function(a){"use strict";var b={MAIN:"MAIN",THUMBNAIL:"THUMBNAIL"};a.Services.Messaging.AttachmentType=b}(AvayaClientServices),function(a){"use strict";function b(a,b){this.action=a?a.action||"typing":"typing",this.participant=b,this.state=a?a.state||"paused":"paused",this.timestamp=a?a.timestamp:void 0}b.prototype={getAction:function(){return this.action},getParticipant:function(){return this.participant},getState:function(){return this.state},getTimestamp:function(){return this.timestamp}},a.Services.Messaging.ChatStateEvent=b}(AvayaClientServices),function(a){"use strict";var b={THREAD:"THREAD"};a.Services.Messaging.ConversationType=b}(AvayaClientServices),function(a){"use strict";var b={HIGH:"HIGH",LOW:"LOW",NORMAL:"NORMAL"};a.Services.Messaging.MessageImportance=b}(AvayaClientServices),function(a){"use strict";var b={MESSAGE:"MESSAGE",JOINED:"JOINED",LEFT:"LEFT",SESSION:"SESSION",SUBJECT_CHANGE:"SUBJECT_CHANGE",CLOSED:"CLOSED",START:"START"};a.Services.Messaging.MessageType=b}(AvayaClientServices),function(a){"use strict";var b={MESSAGING_NOTIFICATIONS_DISABLED:"Notification channel is disabled.",MESSAGING_CLOSE_FAILED:"Server failed to be closed.",MESSAGING_SEND_ATTACHMENT_FAILED:"Failed to send attachment.",MESSAGING_FEATURE_NOT_AVAILABLE:"Feature is not available in determined server version.",MESSAGING_SERVER_ERROR:"Action failed due to server error.",MESSAGING_NOTIFICATION_FAILED:"Notification failed.",MESSAGING_PARTICIPANT_ADDRESS_INVALID:"Failed to add Participant to Conversation.",MESSAGING_LEAVE_CONVERSATION_FAILED:"Failed to leave one or more conversations.",MESSAGING_NOT_STARTED:"Failed to perform selected action. Messaging is not started.",MESSAGING_CREATE_ATTACHMENT_FAILED:"Failed to create attachment. Internal browser error.",MESSAGING_BODY_LENGTH_EXCEEDED:"Failed to sent message. Maximum message body length exceeded.",MESSAGING_INVALID_STATE:"Invalid state.",MESSAGING_NOTIFICATIONS_CHANNEL_FAILED:"Start notification channel failed.",MESSAGING_INTERNAL_ERROR:"An internal error occurred.",MESSAGING_TIMEOUT:"An operation has timed out"};a.Services.Messaging.MessagingErrorReason=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Base.BaseError.call(this,b,c),this.name="MessagingError",this.message=b}b.prototype=Object.create(a.Base.BaseError.prototype),a.Services.Messaging.MessagingError=b}(AvayaClientServices),function(a){"use strict";function b(){this._searchBody=!1,this._searchParticipants=!1,this._searchSubject=!1,this._resultsPerConversation=0,this._query="",this._after=void 0}b.prototype={isSearchParticipants:function(){return this._searchParticipants},isSearchSubject:function(){return this._searchSubject},isSearchBody:function(){return this._searchBody},getQueryAfter:function(){return this._after},getQuery:function(){return this._query},getNumberResultsPerConversation:function(){return this._resultsPerConversation},searchParticipants:function(a){this._searchParticipants=a},searchSubject:function(a){this._searchSubject=a},searchBody:function(a){this._searchBody=a},setQueryAfter:function(a){this._after=a},setQuery:function(a){this._query=a.toLowerCase()},setNumberResultsPerConversation:function(a){this._resultsPerConversation=a}},a.Services.Messaging.MessagingQuery=b}(AvayaClientServices),function(a){"use strict";var b={DRAFT_UNSENT:"DRAFT_UNSENT",DRAFT_SENDING:"DRAFT_SENDING",DRAFT_REMOVING:"DRAFT_REMOVING",DRAFT_ERROR:"DRAFT_ERROR",PUBLISHED:"PUBLISHED",PUBLISHED_LEAVING:"PUBLISHED_LEAVING",PUBLISHED_LEFT:"PUBLISHED_LEFT"};a.Services.Messaging.ResourceStatus=b}(AvayaClientServices),function(a){"use strict";var b={NORMAL:"NORMAL",PERSONAL:"PERSONAL",PRIVATE:"PRIVATE",CONFIDENTIAL:"CONFIDENTIAL"};a.Services.Messaging.SensitivityLevel=b}(AvayaClientServices),function(a){"use strict";var b={AUDIO:"AUDIO",VIDEO:"VIDEO"};a.Services.Messaging.SessionType=b}(AvayaClientServices),function(a){"use strict";function b(a){this._href=a?a.href||"":"",this._id=a?a.id||"":"",this._lastAccessedTime=a?a.lastAccessedTime||"":"",this._lastUpdated=a?a.lastUpdated||"":""}b.prototype={getHref:function(){return this._href},getId:function(){return this._id},getLastAccessedTime:function(){return this._lastAccessedTime},getLastUpdatedTime:function(){return this._lastUpdated}},a.Services.Messaging.ConversationId=b}(AvayaClientServices),function(a,b){"use strict";function c(a,b,c,d,e,f,g){this._provider=a,this._messageService=b,this._participantsService=c,this._escalationService=d,this._messageBuilder=e,this._messagingService=void 0,this._conversationBuilder=f,this._messagingAnalyticsService=g}c.prototype={getParticipants:function(a,b,c){return a.participants},createMessage:function(b){var c={subject:b.subject,threadId:b.id,to:b.participants,event:{type:a.Services.Messaging.MessageType.MESSAGE},resourceStatus:a.Services.Messaging.ResourceStatus.DRAFT_UNSENT,flags:{sensitivity:b.getSensitivity()}},d=this._messageBuilder.build(c,this._participantsService.getSelfParticipant(),this._messageService,b);return this._provider.on(a.Providers.AMM.ProviderStates.AVAILABLE,function(){this._messageService._recalculateAllMessageCapabilities(d)}.bind(this)),this._provider.on(a.Providers.AMM.ProviderStates.UNAVAILABLE,function(){this._messageService._recalculateAllMessageCapabilities(d)}.bind(this)),b._getLastMessage()&&(d.coalesced=this._messageBuilder.isMessageCoalesced(d,b._getLastMessage())),d.addOnStatusChangedCallback(function(c,e){if(e===a.Services.Messaging.ResourceStatus.PUBLISHED){var f=b._draftMessages.indexOf(c);b._draftMessages.splice(f,1),b.getStatus()===a.Services.Messaging.ResourceStatus.DRAFT_SENDING&&(b.id=c.threadId,b.getParticipants(),b._setStatus(a.Services.Messaging.ResourceStatus.PUBLISHED))}else e===a.Services.Messaging.ResourceStatus.DRAFT_ERROR?(b.getStatus()===a.Services.Messaging.ResourceStatus.DRAFT_SENDING&&b._setStatus(a.Services.Messaging.ResourceStatus.DRAFT_ERROR),b.messages.onDataSetChanged([d],a.Base.DataSetChangeTypes.UPDATED)):e===a.Services.Messaging.ResourceStatus.DRAFT_SENDING&&(b.getStatus()===a.Services.Messaging.ResourceStatus.DRAFT_UNSENT&&b._setStatus(a.Services.Messaging.ResourceStatus.DRAFT_SENDING),b._onMessagesAddedCallbacks.fire(b,[d]),b.messages.onDataSetChanged([d],a.Base.DataSetChangeTypes.UPDATED));this._messageService._recalculateAllMessageCapabilities(d)}.bind(this)),b._draftMessages.push(d),b.messages.unshift(d),d},getMessageById:function(a,b){for(var c=0;c<a.length;c++)if(a[c].id===b)return a[c]},createNewClientMessage:function(a,b){return this._messageBuilder.build(a,this._participantsService.getOrCreateParticipant(a.from),this._messageService,b)},leave:function(c){var d=b.Deferred();return a.Base.Utils.isDefined(c.id)?this._provider.leaveConversation(c.id).then(function(){var b=this._messagingService.conversations.indexOf(c);b>=0&&(this._messagingService.conversations.splice(b,1),this._messagingService.conversations.onDataSetChanged([c],a.Base.DataSetChangeTypes.REMOVED)),d.resolve(!0)}.bind(this),function(a){d.reject(a)}):d.reject(new a.Services.Messaging.MessagingError(a.Services.Messaging.MessagingErrorReason.MESSAGING_LEAVE_CONVERSATION_FAILED)),d.promise()},changeSubject:function(a,b){for(var c={threadId:a.id,body:"",event:{type:"SUBJECT_CHANGE"},subject:b,to:[]},d=a.getParticipants(),e=0;e<d.length;e++)c.to.push({address:d[e].getAddress(),type:d[e].getType()});return this._provider.changeSubject(c)},getOtherMessages:function(b,c,d,e){var f=new a.Base.DataRetrieval,g=f.getDataSet(),h=this._provider.getMaxMessageCount();if(d&&d>h)this._getMoreOtherMessages(b,c,d,e,h,f);else{var i={cancel:function(){}};this._provider.getMessages(i,e.getId(),d,b,c).done(function(b){var c;e.getMessages().length>0&&(c=this._conversationBuilder.update(e,b,this),g.push(c),g.onDataSetChanged(c,a.Base.DataSetChangeTypes.ADDED),f._dataRetrievalProgress.fire(c.length,!0,c.length),f.isCompleted=!0,f._dataRetrievalDone.fire())}.bind(this)).fail(function(a){f._dataRetrievalFailed.fire(a)}),f._onCancel=function(){i.cancel()}}return f},_getMoreOtherMessages:function(b,c,d,e,f,g){var h=[],i={},j=g.getDataSet(),k=0,l=Math.floor(d/f),m=d%f;m&&(l+=1);for(var n=function(b,c,d,e){if(!g.isCancelled&&!g.isCompleted){var n,o={cancel:function(){}};this._provider.getMessages(o,e.id,d,b,c).done(function(o){0===k?i=o:i.messages=i.messages.concat(o.messages),b?b=o.messages[o.messages.length-1]:c=o.messages[o.messages.length-1],k+=1,k<l&&o.messages.length===f?(k===l-1&&m?h[k](b,c,m,e):h[k](b,c,d,e),n=this._conversationBuilder.updateMessages(e,i,this),j.push(n),j.onDataSetChanged(n,a.Base.DataSetChangeTypes.ADDED),g._dataRetrievalProgress.fire(o.messages.length,!1)):(n=this._conversationBuilder.updateMessages(e,i,this),j.push(n),j.onDataSetChanged(n,a.Base.DataSetChangeTypes.ADDED),g._dataRetrievalProgress.fire(o.messages.length,!1),g.isCompleted=!0,g._dataRetrievalDone.fire())}.bind(this)).fail(function(a){g._dataRetrievalFailed.fire(a)}),g._onCancel=function(){o.cancel()}}}.bind(this),o=0;o<l;o++)h.push(n);h[0](b,c,void 0,e)},markAllAsRead:function(a){return this._provider.markAllAsRead(a.id)},markMultipleAsRead:function(a,b,c){return this._provider.markAllAsRead(a.id,b,c)},removeMessage:function(c,d,e){var f=b.Deferred();if(e)if(e.getRemoveCapability().isAllowed){var g=c.indexOf(e);g>=0&&(c.splice(g,1),c.onDataSetChanged([e],a.Base.DataSetChangeTypes.REMOVED)),g=d.indexOf(e),g>=0&&d.splice(g,1),f.resolve()}else f.reject(e.getRemoveCapability().denialReason);else f.reject();return f.promise()},createEscalation:function(b){var c={type:a.Services.Messaging.MessageType.SESSION,extensions:{},conversation:b},d=new a.Services.Messaging.Escalation(c,this._escalationService)
;return this._provider.on(a.Providers.AMM.ProviderStates.AVAILABLE,function(){this._escalationService._recalculateAllEscalationCapabilities(d)}.bind(this)),this._provider.on(a.Providers.AMM.ProviderStates.UNAVAILABLE,function(){this._escalationService._recalculateAllEscalationCapabilities(d)}.bind(this)),d.addParticipants(this.getParticipants(b)),d._setStatus(a.Services.Messaging.ResourceStatus.DRAFT_UNSENT),d.addOnStatusChangedCallback(function(c,e){if(e===a.Services.Messaging.ResourceStatus.PUBLISHED){var f=b._draftEscalations.indexOf(c);b._draftEscalations.splice(f,1)}else e===a.Services.Messaging.ResourceStatus.DRAFT_ERROR&&b.getStatus()===a.Services.Messaging.ResourceStatus.DRAFT_SENDING?b._setStatus(a.Services.Messaging.ResourceStatus.DRAFT_ERROR):e===a.Services.Messaging.ResourceStatus.DRAFT_SENDING&&b.getStatus()===a.Services.Messaging.ResourceStatus.DRAFT_UNSENT&&b._setStatus(a.Services.Messaging.ResourceStatus.DRAFT_SENDING);this._escalationService._recalculateAllEscalationCapabilities(d)}.bind(this)),d},removeEscalation:function(a,c){var d=b.Deferred();if(a)if(a.getRemoveCapability().isAllowed){var e=c.indexOf(a);e>=0&&c.splice(e,1),d.resolve()}else d.reject(a.getRemoveCapability().denialReason);else d.reject();return d.promise()},addParticipantAddresses:function(c,d){var e=b.Deferred();a.Base.Utils.clean(d,"");var f=b.map(c.getActiveParticipants(),function(a,b){return a.getAddress()}),g=d.filter(function(a){return-1===f.indexOf(a)}),h=d.filter(function(a){return-1!==f.indexOf(a)}),i=function(b){var d=[];if(c.getStatus()===a.Services.Messaging.ResourceStatus.PUBLISHED){for(var f={participants:[]},g=0;g<b.length;g++)f.participants.push({address:b[g]._address,type:"CONTACT"}),d.push(b[g]._address);this._provider.addParticipantsToConversation(c.getId(),f).then(function(a){this._updateParticipantsList(c,a.participants),e.resolve(d)}.bind(this),function(a){e.reject(a)})}else if(c.getStatus()===a.Services.Messaging.ResourceStatus.DRAFT_UNSENT){for(var h=0;h<b.length;h++)d.push(b[h]._address);this._updateParticipantsList(c,b),e.resolve(d)}}.bind(this),j=function(b,d){if(d&&d.length>0){for(var f=[],g={participants:[]},i=0;i<d.length;i++)g.participants.push({address:d[i]._address,type:d[i].type}),f.push(d[i]._address);c.getStatus()===a.Services.Messaging.ResourceStatus.PUBLISHED?this._provider.addParticipantsToConversation(c.getId(),g).then(function(a){this._updateParticipantsList(c,a.participants),e.resolve(f)}.bind(this),function(a){e.reject(a)}):c.getStatus()===a.Services.Messaging.ResourceStatus.DRAFT_UNSENT&&(this._updateParticipantsList(c,d),e.resolve(f))}else b._data=b.getData().concat(h),e.reject(b)}.bind(this);return this.validateUsers(g).then(i,j.bind(this)),e.promise()},validateUsers:function(c){function d(a){return/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i.test(a)}this._messagingAnalyticsService.trackNumAddressValidationRequests(c.length);for(var e,f,g=b.Deferred(),h=this._provider.getRoutableDomains(),i=[],j=[],k=0,l=0;l<c.length;l++){if(e=!1,f=!1,d(c[l])){e=!0;for(var m=0;m<h.length;m++)if(null!==c[l].match(h[m])){i.push(c[l]),f=!0;break}f||k++}e&&f||(j.push(c[l]),a.Base.Logger.debug(a.Base.LoggerTags.MESSAGING_SERVICE,"Invalid address email:",c[l]))}if(this._messagingAnalyticsService.trackAddrValidationResInvalidDomain(k),i.length>0){var n=this._messagingAnalyticsService.startTimingMetric();this._provider.validateUsers(i).then(function(b){this._messagingAnalyticsService.trackTimeRequestsValidateAddressesEnd(n);for(var c=[],d=0;d<b.validatedAddresses.length;d++)b.validatedAddresses[d].addresses.length>0?c.push(b.validatedAddresses[d].addresses[0]):j.push(b.validatedAddresses[d].query);this._messagingAnalyticsService.trackAddrValidationResNotValid(j.length),this._messagingAnalyticsService.trackAddrValidationResValid(c.length),j.length>0?g.reject(new a.Services.Messaging.MessagingError(a.Services.Messaging.MessagingErrorReason.MESSAGING_PARTICIPANT_ADDRESS_INVALID,j),c):g.resolve(c)}.bind(this),function(b){var c=a.Services.Messaging.MessagingErrorReason.MESSAGING_SERVER_ERROR;this._messagingAnalyticsService.trackErrorsResponseValidateAddresses(c),g.reject(new a.Services.Messaging.MessagingError(c,b))}.bind(this))}else this._messagingAnalyticsService.trackAddrValidationResNotValid(j.length),this._messagingAnalyticsService.trackAddrValidationResValid(0),g.reject(new a.Services.Messaging.MessagingError(a.Services.Messaging.MessagingErrorReason.MESSAGING_PARTICIPANT_ADDRESS_INVALID,j));return g.promise()},addParticipants:function(a,b){for(var c=[],d=0;d<b.length;d++)c.push(b[d].address);return this.addParticipantAddresses(a,c)},_updateParticipantsList:function(b,c){for(var d,e=[],f=[],g=0;g<c.length;g++){d=!0;for(var h=0;h<b.participants.length;h++)if(c[g]._address===b.participants[h]._address){d=!1;break}if(d){var i=this._participantsService.getOrCreateParticipant(c[g]);e.push(i),b.participants.push(i),f.push(i)}}return f.length>0&&(b.participants.onDataSetChanged(f,a.Base.DataSetChangeTypes.ADDED),b._onParticipantsAddedCallbacks.fire(b,f)),b.participants},getParticipantsFromMessage:function(b){for(var c=new a.Base.DataSet,d=0;d<b.to.length;d++){var e=this._participantsService.getOrCreateParticipant(b.to[d]);c.push(e)}if(a.Base.Utils.isDefined(b.event)&&b.event.type===a.Services.Messaging.MessageType.LEFT)for(var f=0;f<b.event.participants.length;f++){var g=this._participantsService.getOrCreateParticipant(b.event.participants[f]),h=c.indexOf(g);c.splice(h,1)}return c},removeParticipantAddresses:function(c,d){var e=b.Deferred(),f=!1,g=[];if(a.Base.Utils.clean(d,""),c.getStatus()===a.Services.Messaging.ResourceStatus.DRAFT_UNSENT){for(var h=0;h<d.length;h++)for(var i=c.participants.length-1;i>=0;i--)if(c.participants[i]._address===d[h]){g.push(c.participants.splice(i,1)[0]),f=!0;break}f&&(c.participants.onDataSetChanged(g,a.Base.DataSetChangeTypes.REMOVED),c._onParticipantsRemovedCallbacks.fire(c,g)),e.resolve()}else e.reject("Could not remove participants");return e.promise()},removeParticipants:function(a,b){for(var c=[],d=0;d<b.length;d++)c.push(b[d].address);return this.removeParticipantAddresses(a,c)},close:function(a){return this._provider.close(a.id).then(function(b){return a.closed=!0,a._onClosedStatusChangedCallbacks.fire(a,a.closed),b}.bind(this))},setLastAccessTime:function(a){this._provider.setLastAccessTime(a.id,{}).then(function(){a._onLastAccessTimeChangedCallbacks.fire(a,a.lastAccessTime)})},subscribeForTypingEvents:function(b,c){var d=function(d){if(c){var e=new a.Services.Messaging.ChatStateEvent(d,this._participantsService._getParticipant(d.address));c(e)}"composing"===d.state?this.addComposingParticipantToConversation(b,this._participantsService._getParticipant(d.address)):"paused"===d.state&&this.removeComposingParticipantFromConversation(b,this._participantsService._getParticipant(d.address))}.bind(this);return this._provider.subscribeForTypingEventsInConversation(b.getId(),d).then(function(a){return b._isSubscribed=!0,this._recalculateAllConversationCapabilities(b),a}.bind(this))},unsubscribeForTypingEvents:function(a){return this._provider.unsubscribeForTypingEventsInConversation(a.getId()).then(function(b){return a._isSubscribed=!1,this._recalculateAllConversationCapabilities(a),b}.bind(this))},reportTyping:function(b,c){var d=this._participantsService.getSelfParticipant();c?this._provider.reportTyping(b.threadId,c).then(function(){this.addComposingParticipantToConversation(b.conversation,d)}.bind(this),function(b){a.Base.Logger.error(a.Base.LoggerTags.MESSAGING_SERVICE,"Error on report typing: ",b)}.bind(this)):this._provider.reportTyping(b.conversation.id,c).then(function(){this.removeComposingParticipantFromConversation(b.conversation,d)}.bind(this),function(b){a.Base.Logger.error(a.Base.LoggerTags.MESSAGING_SERVICE,"Error on report paused typing: ",b)}.bind(this))},reportCustomChatNotification:function(c,d,e){var f=this._participantsService.getSelfParticipant();return e?this._provider.reportCustomChatNotification(c.getId(),d,e).then(function(a){return this.addComposingParticipantToConversation(c,f),a}.bind(this),function(c){return a.Base.Logger.error(a.Base.LoggerTags.MESSAGING_SERVICE,"Error on report custom chat notification: ",c),b.Deferred().reject(c).promise()}.bind(this)):this._provider.reportCustomChatNotification(c.getId(),d,e).then(function(a){return this.removeComposingParticipantFromConversation(c,f),a}.bind(this),function(c){return a.Base.Logger.error(a.Base.LoggerTags.MESSAGING_SERVICE,"Error on report pause custom chat notification: ",c),b.Deferred().reject(c).promise()}.bind(this))},addComposingParticipantToConversation:function(a,b){a.getComposingParticipants().indexOf(b)<0&&(a.composingParticipants.push(b),a._onIsComposingStatusChangedCallbacks.fire(a,!0))},removeComposingParticipantFromConversation:function(a,b){var c=a.composingParticipants.indexOf(b);c>=0&&(a.composingParticipants.splice(c,1),a._onIsComposingStatusChangedCallbacks.fire(a,!0))},isOpened:function(){return this._provider.isOpened()},isServiceAvailable:function(){return this._provider.isAvailable()},getMaxMessageCount:function(){return this._provider.getMaxMessageCount()},_recalculateAllConversationCapabilities:function(a){a._recalculateUpdateSubjectCapability(),a._recalculateUpdateLastAccessTimeCapability(),a._recalculateUpdateSensitivityCapability(),a._recalculateOlderContentCapability(),a._recalculateAddParticipantsCapability(),a._recalculateRemoveParticipantsCapability(),a._recalculateCreateMessageCapability(),a._recalculateCreateEscalationCapability(),a._recalculateMarkAllContentAsReadCapability(),a._recalculateLeaveCapability(),a._recalculateRemoveCapability(),a._recalculateStartCapability(),a._recalculateIsTypingCapability()},isUpdateSubjectSupported:function(){return this._provider.isUpdateSubjectSupported()},isMarkAllContentAsReadSupported:function(){return this._provider.isMarkAllContentAsReadSupported()},getNumberOfMessagesWithUnreadContentSinceLastAccess:function(a){var b=a.getMessages();return a.getLastAccessTime().getTime()?b.filter(function(b){return!b.isRead()&&b.getReceivedDate()>a.getLastAccessTime()}).length:b.length}},a.Services.Messaging.ConversationService=c}(AvayaClientServices,$),function(a,b){"use strict";function c(a){this._provider=a}c.prototype={start:function(b){for(var c={extensions:b.extensions,sessionType:b.sessionType||a.Services.Messaging.SessionType.AUDIO,type:b.type,participants:[]},d=0;d<b.participants.length;d++)c.participants.push({address:b.participants[d]._address});return b._setStatus(a.Services.Messaging.ResourceStatus.DRAFT_SENDING),this._provider.callEscalationEvent(c,b.conversation.id).then(function(c){return b._setStatus(a.Services.Messaging.ResourceStatus.PUBLISHED),this._recalculateAllEscalationCapabilities(b),b._onStartSuccessCallbacks.fire(b),c}.bind(this),function(a){this._recalculateAllEscalationCapabilities(b),b._onStartFailedCallbacks.fire(b,a)}.bind(this))},addParticipantAddresses:function(c,d){var e=b.Deferred(),f=this._provider.getRoutableDomains();if(c.getAddParticipantsCapability().isAllowed){for(var g=[],h=0;h<d.length;h++)for(var i=0;i<f.length;i++)if(null!==d[h].match(f[i])){var j={_address:d[h]};c.participants.push(j),g.push(j)}g.length>0&&c.participants.onDataSetChanged(g,a.Base.DataSetChangeTypes.ADDED),e.resolve(c)}else e.reject(c.getAddParticipantsCapability().denialReason);return e.promise()},addParticipants:function(c,d){var e=b.Deferred();if(c.getAddParticipantsCapability().isAllowed){for(var f=!1,g=0;g<d.length;g++)c.participants.push(d[g]),f=!0;f&&c.participants.onDataSetChanged(d,a.Base.DataSetChangeTypes.ADDED),e.resolve(c)}else e.reject(c.getAddParticipantsCapability().denialReason);return e.promise()},removeParticipantAddresses:function(c,d){var e=b.Deferred();if(c.getRemoveParticipantsCapability().isAllowed){for(var f=[],g=c.participants.length-1;g>=0;g--)for(var h=d.length-1;h>=0;h--)if(c.participants[g]._address===d[h]){f.push(c.participants[g]),c.participants.splice(g,1),d.splice(h,1);break}f.length>0&&c.participants.onDataSetChanged(f,a.Base.DataSetChangeTypes.REMOVED),e.resolve(c)}else e.reject(c.getRemoveParticipantsCapability().denialReason);return e.promise()},removeParticipants:function(c,d){var e=b.Deferred(),f=[];if(c.getRemoveParticipantsCapability().isAllowed){for(var g=c.participants.length-1;g>=0;g--)for(var h=d.length-1;h>=0;h--)if(c.participants[g]._address===d[h]._address){f.push(c.participants[g]),c.participants.splice(g,1),d.splice(h,1);break}f.length>0&&c.participants.onDataSetChanged(f,a.Base.DataSetChangeTypes.REMOVED),e.resolve(c)}else e.reject(c.getRemoveParticipantsCapability().denialReason);return e.promise()},setSessionType:function(b,c){if(!a.Base.Utils.isDefined(a.Services.Messaging.SessionType[c]))throw b._onSessionTypeChangedFailedCallbacks.fire(this,c),new Error("Unknown Session type");b.sessionType=c,b._onSessionTypeChangedSuccessCallbacks.fire(this,c)},isServiceAvailable:function(){return this._provider.isAvailable()},_recalculateAllEscalationCapabilities:function(a){a._recalculateStartCapability(),a._recalculateAddParticipantsCapability(),a._recalculateRemoveParticipantsCapability(),a._recalculateUpdateSessionTypeCapability(),a._recalculateRemoveCapability()}},a.Services.Messaging.EscalationService=c}(AvayaClientServices,$),function(a,b){"use strict";function c(b){a.Services.Messaging.AbstractThumbnailCreator.call(this,b)}c.prototype=Object.create(a.Services.Messaging.AbstractThumbnailCreator.prototype),c.prototype.create=function(a,c){var d=b.Deferred(),e={disposition:a.disposition.replace("attachment","inline"),mimeType:"image/jpeg",status:a.status},f=new FileReader;return f.onloadend=function(){var b=new Image;b.src=f.result;var g=new Blob([this._resizeImage(b,c)],{type:"image/jpeg"});e.size=g.size,a.thumbnail=this._attachmentBuilder.build(e,g),d.resolve(a.thumbnail)}.bind(this),f.onerror=function(a){d.reject(a)}.bind(this),f.readAsDataURL(a.file),d.promise()},a.Services.Messaging.ImageThumbnailCreator=c}(AvayaClientServices,jQuery),function(a){"use strict";function b(a,b){this._attachmentBuilder=a,this._participantService=b}b.prototype={build:function(b,c,d,e){var f=new a.Services.Messaging.Message(d,e);if(f.resourceStatus=b.resourceStatus||a.Services.Messaging.ResourceStatus.PUBLISHED,f.body=b.body,b.event&&(f.type=b.event.type,f.eventRelatedParticipants=b.event.participants,f._sessionType=b.event.sessionType),b.flags&&(f.sensitivity=b.flags.sensitivity,f.importance=b.flags.importance,f.read=b.flags.read,f.doNotForward=b.flags.doNotForward),f.from=c,f.inReplyTo=b.inReplyTo,f.href=b.href,f.id=b.id,f.lastModifiedDate=b.lastModifiedDate?new Date(b.lastModifiedDate):new Date,f.receivedDate=new Date(b.receivedDate),f.subject=b.subject,f.threadId=b.threadId,f.to=[],b.to&&b.to.forEach&&(b.to.forEach(function(a){f.to.push(this._participantService.getOrCreateParticipant(a))}.bind(this)),e._updateParticipantsList(f.to)),b.parts){var g=[];b.parts.forEach(function(a){g.push(this._attachmentBuilder.build(a))}.bind(this)),f.parts=this.pairThumbnailsAndAttachments(g)}return d._recalculateAllMessageCapabilities(f),f},update:function(a,b){a.body!==b.body&&(a.body=b.body,a._onBodyChangedCallbacks.fire(a,a.body)),a.type!==b.event.type&&(a.type=b.event.type,a._onTypeChangedCallbacks.fire(a,a.type)),a.doNotForward!==b.flags.doNotForward&&(a.doNotForward=b.flags.doNotForward,a._onDoNotForwardStatusChangedCallbacks.fire(a,a.doNotForward)),a.importance!==b.flags.importance&&(a.importance=b.flags.importance,a._onImportanceChangedCallbacks.fire(a,a.importance)),a.sensitivity!==b.flags.sensitivity&&(a.sensitivity=b.flags.sensitivity,a._onSensitivityChangedCallbacks.fire(a,a.sensitivity)),a.read!==b.flags.read&&(a.read=b.flags.read,a._onIsReadStatusChangedCallbacks.fire(a,a.read)),a.href!==b.href&&(a.href=b.href);var c=new Date(b.lastModifiedDate);a.lastModifiedDate&&a.lastModifiedDate.toISOString()===c.toISOString()||(a.lastModifiedDate=c,a._onLastModifiedDateChangedCallbacks.fire(a,c)),c=new Date(b.receivedDate),a.receivedDate&&"Invalid Date"!==a.receivedDate.toString()&&a.receivedDate.toISOString()===c.toISOString()||(a.receivedDate=c),a.subject!==b.subject&&(a.subject=b.subject),a.id!==b.id&&(a.id=b.id),a.threadId!==b.threadId&&(a.threadId=b.threadId),a.getInReplyTo()!==b.inReplyTo&&(a.inReplyTo=b.inReplyTo,a._onInReplyToChangedCallbacks(a,a.getInReplyTo()));var d=[];b.parts.forEach(function(a){d.push(this._attachmentBuilder.build(a))}.bind(this)),this.pairThumbnailsAndAttachments(d).forEach(function(b){var c=a.parts.filter(function(a){return a.disposition===b.disposition})[0];c&&this._attachmentBuilder.update(c,b)}.bind(this)),a._attachments.length>0&&a._attachments.splice(0,a._attachments.length)},isMessageCoalesced:function(b,c){if(null===b||void 0===b)return!1;if(null===c||void 0===c)return!1;if(b.getStatus()===a.Services.Messaging.ResourceStatus.DRAFT_ERROR)return!1;if(c.getStatus()===a.Services.Messaging.ResourceStatus.DRAFT_ERROR)return!1;if(void 0!==b.getFromParticipant()&&b.getFromParticipant().getAddress()!==c.getFromParticipant().getAddress())return!1;if(b.hasAttachment())return!1;if(b.getType()===a.Services.Messaging.MessageType.JOINED||b.getType()===a.Services.Messaging.MessageType.LEFT||b.getType()===a.Services.Messaging.MessageType.CLOSED||b.getType()===a.Services.Messaging.MessageType.START)return!1;if(c.getType()===a.Services.Messaging.MessageType.JOINED||c.getType()===a.Services.Messaging.MessageType.LEFT||c.getType()===a.Services.Messaging.MessageType.CLOSED||c.getType()===a.Services.Messaging.MessageType.START)return!1;if(b.getSensitivity()!==c.getSensitivity())return!1;if(c.hasAttachment())return!1;if(b.getReceivedDate()<c.getReceivedDate())return!1;var d=b.getReceivedDate()-c.getReceivedDate();return!(isNaN(d)||d>6e4)},pairThumbnailsAndAttachments:function(a){var b,c={},d=[],e=function(a){return function(b){return b.getName()===a}};for(b=0;b<a.length;b++)c[a[b].getName()]=a.filter(e(a[b].getName()));for(var f in c)if(c.hasOwnProperty(f))if(2===c[f].length){var g=c[f][0]._isThumbnail()?c[f][0]:c[f][1],h=c[f][0]._isThumbnail()?c[f][1]:c[f][0];h.thumbnail=g,d.push(h)}else for(b=0;b<c[f].length;b++)d.push(c[f][b]);return d}},a.Services.Messaging.MessageBuilder=b}(AvayaClientServices),function(a,b){"use strict";function c(a,b,c,d){this._provider=a,this._attachmentBuilder=c,this._messageBuilder=b,this._messagesToRead=[],this._promises=[],this._messagingAnalyticsService=d}c.prototype={_prepareMessage:function(b){var c={body:b.getBody(),subject:b.subject,threadId:b.threadId,flags:{sensitivity:b.getSensitivity(),importance:b.getImportance()},to:[]};a.Base.Utils.isUndefined(b.inReplyTo)||(c.inReplyTo=b.inReplyTo);for(var d=b.conversation.getParticipants(),e=0;e<d.length;e++)c.to.push({address:d[e].getAddress(),type:d[e].type});return c},send:function(c){if(c.getBody().length<=this._provider.getMaxTextLength()){var d=this._messagingAnalyticsService.startTimingMetric();c.conversation.getStatus()===a.Services.Messaging.ResourceStatus.DRAFT_UNSENT&&(c.subject=c.conversation.getSubject());var e,f=this._prepareMessage(c),g=function(b){this._messagingAnalyticsService.trackTimeRequestsSendMessageEnd(d),this._messageBuilder.update(c,b),c.lastModifiedDate=new Date,c._setStatus(a.Services.Messaging.ResourceStatus.PUBLISHED),this._recalculateAllMessageCapabilities(c);var e=c.getAttachments().length;e>0&&c.getAttachments().forEach(function(b){b._setStatus(a.Services.Messaging.ResourceStatus.PUBLISHED),this._messagingAnalyticsService.trackMessageAttachmentSize(b.size,b.mimeType)}.bind(this));var f=c.getBody().length;return this._messagingAnalyticsService.trackNumMessagesSent(f,e),this._messagingAnalyticsService.trackMessageTextSize(f,e),c},h=function(d){return this._messagingAnalyticsService.trackErrorsResponseSendMessage(a.Services.Analytics.AnalyticsErrorCode.MESSAGE_SENDING_ERROR),c._setStatus(a.Services.Messaging.ResourceStatus.DRAFT_ERROR),this._recalculateAllMessageCapabilities(c),c.getAttachments().length>0&&c.getAttachments().forEach(function(b){b._setStatus(a.Services.Messaging.ResourceStatus.DRAFT_ERROR)}.bind(this)),b.Deferred().reject(d).promise()};return c.getAttachments().length>0?(c.getAttachments().forEach(function(b){b._setStatus(a.Services.Messaging.ResourceStatus.DRAFT_SENDING)}.bind(this)),e=this._provider.sendMessageWithAttachments(f,c.getAttachments()).then(g.bind(this),h.bind(this))):e=this._provider.sendMessage(f).then(g.bind(this),h.bind(this)),c._setStatus(a.Services.Messaging.ResourceStatus.DRAFT_SENDING),e}var i=b.Deferred();return i.reject(new a.Services.Messaging.MessagingError(a.Services.Messaging.MessagingErrorReason.MESSAGING_BODY_LENGTH_EXCEEDED)),i.promise()},getPartById:function(a,b){return a.filter(function(a){return a.id===b})[0]},markAsRead:function(a){var c=b.Deferred();return 0===this._messagesToRead.length&&setTimeout(function(){var a=[];this._messagesToRead.forEach(function(b){a.push(b.id)}),this._provider.markAsReadBatch(a).then(function(a){this._messagesToRead.forEach(function(a){a._recalculateMarkAsReadCapability()}),this._promises.forEach(function(b){b.resolve(a)}),this._messagesToRead=[],this._promises=[]}.bind(this),function(a){this._messagesToRead.forEach(function(a){a._recalculateMarkAsReadCapability()}),this._promises.forEach(function(b){b.reject(a)}),this._messagesToRead=[],this._promises=[]}.bind(this))}.bind(this),2e3),this._messagesToRead.push(a),this._promises.push(c),c.promise()},removeDraftAttachment:function(b,c){var d=b.parts.indexOf(c);-1!==d&&(b.parts.splice(d,1),b.parts.onDataSetChanged([c],a.Base.DataSetChangeTypes.REMOVED)),-1!==(d=b._attachments.indexOf(c))&&b._attachments.splice(b._attachments.indexOf(c),1)},removeAllDraftAttachments:function(b){var c=[];b._attachments.forEach(function(a){var d=b.parts.indexOf(a);-1!==d&&(b.parts.splice(d,1),c.push(a))}.bind(b)),c.length>0&&b.parts.onDataSetChanged(c,a.Base.DataSetChangeTypes.REMOVED),b._attachments.splice(0,b._attachments.length)},createAttachment:function(b,c){if(this._validateAttachmentSize(c)){var d={disposition:'attachment; filename="'+c.name+'"',mimeType:""!==c.type?c.type:"application/octet-stream",size:c.size,status:a.Services.Messaging.ResourceStatus.DRAFT_UNSENT},e=this._attachmentBuilder.build(d,c);return b._attachments.push(e),b.parts.push(e),b.parts.onDataSetChanged([e],a.Base.DataSetChangeTypes.ADDED),e.addOnStatusChangedCallback(function(){this._recalculateAllAttachmentCapabilities(e)}.bind(this)),e}throw new Error("Size not valid.")},stop:function(){this._messagesToRead=[],this._promises=[]},setBodyAndReportTyping:function(c,d,e){var f=b.Deferred();return c.getUpdateBodyCapability().isAllowed?(c.body=e,c._onBodyChangedCallbacks.fire(c,e),d.getStatus()===a.Services.Messaging.ResourceStatus.PUBLISHED&&d.getIsTypingCapability().isAllowed&&d._conversationService.reportTyping(c,!0),f.resolve(this._provider.getMaxTextLength()-c.body.length)):f.reject(new a.Services.Messaging.MessagingError(a.Services.Messaging.MessagingErrorReason.MESSAGING_INVALID_STATE)),f.promise()},isServiceAvailable:function(){return this._provider.isAvailable()},_recalculateAllMessageCapabilities:function(a){a._recalculateUpdateBodyCapability(),a._recalculateUpdateSensitivityCapability(),a._recalculateUpdateInReplyToCapability(),a._recalculateUpdateDoNotForwardCapability(),a._recalculateUpdateImportanceCapability(),a._recalculateCreateAttachmentCapability(),a._recalculateSendCapability(),a._recalculateMarkAsReadCapability(),a._recalculateRemoveCapability()},_recalculateAllAttachmentCapabilities:function(a){a._recalculateUpdateNameCapability(),a._recalculateUpdateMimeTypeCapability(),a._recalculateUpdateDurationCapability(),a._recalculateUpdateIsSelfGeneratedCapability(),a._recalculateCreateThumbnailCapability(),a._recalculateRemoveThumbnailCapability(),a._recalculateRemoveCapability()},_validateAttachmentSize:function(a){return!a.type||!(-1!==a.type.indexOf("image")&&this._provider.getMaxImageSize()&&a.size>this._provider.getMaxImageSize()||-1!==a.type.indexOf("video")&&this._provider.getMaxVideoSize()&&a.size>this._provider.getMaxVideoSize()||-1!==a.type.indexOf("audio")&&this._provider.getMaxAudioSize()&&a.size>this._provider.getMaxAudioSize())&&!(-1===a.type.indexOf("image")&&-1===a.type.indexOf("video")&&-1===a.type.indexOf("audio")&&this._provider.getMaxGenericAttachmentSize()&&a.size>this._provider.getMaxGenericAttachmentSize())}},a.Services.Messaging.MessageService=c}(AvayaClientServices,jQuery),function(a){"use strict";function b(b,c,d){this._contactsIntegrationService=d;var e=new a.Services.Messaging.ThumbnailCreator,f=c.getMessagingProviders(b)[0];this._messagingService=this._createMessagingService(f,e)}b.prototype={create:function(){var b=new a.Services.Messaging.Messaging(this._messagingService);return this._messagingService._recalculateAllMessagingCapabilities(b),b},_createMessagingService:function(b,c){var d=new a.Services.Messaging.ParticipantService,e=new a.Services.Messaging.AttachmentBuilder(c);c.registerCreator("image/*",new a.Services.Messaging.ImageThumbnailCreator(e)),c.registerCreator("video/*",new a.Services.Messaging.VideoThumbnailCreator(e));var f=new a.Services.Messaging.MessageBuilder(e,d),g=new a.Services.Analytics.MessagingAnalyticsService,h=new a.Services.Messaging.MessageService(b,f,e,g),i=new a.Services.Messaging.EscalationService(b),j=new a.Services.Messaging.ConversationBuilder(f),k=new a.Services.Messaging.ConversationService(b,h,d,i,f,j,g),l=new a.Services.Messaging.MessagingService(b,k,h,d,j,this._contactsIntegrationService,g);return k._messagingService=l,l}},a.Services.Messaging.MessagingFactory=b}(AvayaClientServices),function(a,b){"use strict";function c(b,c,d,e,f,g,h){this._hasStarted=!1,this._conversationsSubscribed=!1,this._provider=b,this._messageService=d,this._conversationService=c,this.conversations=new a.Base.DataSet,this._draftConversations=[],this._identity={},this._participantsService=e,this._conversationBuilder=f,this._updateByIdDataSetFnc=void 0,this._contactsIntegrationService=g,this._onContactListChanged=void 0,this._numberOfConversationsWithUnreadContentSinceLastAccessTime=void 0,this._unreadConversationsCounter=void 0,this._messagingAnalyticsService=h}c.prototype={getActiveConversations:function(b){var c=new a.Base.DataRetrieval(this.conversations),d=this._messagingAnalyticsService.startTimingMetric(),e=function(e){this._messagingAnalyticsService.trackTimeRequestsGetConversationsEnd(d),this._updateConversationsContainer(e,this.conversations,b),0===this.conversations.length&&this.conversations.onDataSetChanged(this.conversations,a.Base.DataSetChangeTypes.ADDED),this._subscribeForConversationsUpdates(b),c.isCompleted=!0,c._dataRetrievalProgress.fire(this.conversations.length,!1),c._dataRetrievalDone.fire()}.bind(this),f=function(b){this._messagingAnalyticsService.trackErrorsResponseGetConversations(a.Services.Analytics.AnalyticsErrorCode.GETTING_CONVERSATIONS_ERROR),c._dataRetrievalFailed.fire(b)}.bind(this),g=function(a){c._dataRetrievalProgress.fire(a,!1)},h={cancel:function(){}},i=this._provider.getConversations(h);return c._onCancel=function(){h.cancel()},i.then(e,f,g),c},getDraftConversations:function(){return this._draftConversations},leaveAllConversations:function(){return this.leaveConversations(this.conversations)},leaveConversations:function(c){for(var d=this._messagingAnalyticsService.startTimingMetric(),e=[],f=b.Deferred(),g=c.length,h=0;h<g;h++)e.push(c[h].leave());return b.when.apply(this,e).then(function(){this._messagingAnalyticsService.trackTimeRequestsLeaveConversationsEnd(d),f.resolve(!0)}.bind(this),function(){var b=a.Services.Messaging.MessagingErrorReason.MESSAGING_LEAVE_CONVERSATION_FAILED;this._messagingAnalyticsService.trackErrorsResponseLeaveConversations(b),f.reject(new a.Services.Messaging.MessagingError(b))}.bind(this)),f.promise()},createConversation:function(b){var c=this._conversationBuilder.build({resourceStatus:a.Services.Messaging.ResourceStatus.DRAFT_UNSENT},this._conversationService);return c.participants.push(this._participantsService.getSelfParticipant()),this.conversations.push(c),this.conversations.onDataSetChanged([c],a.Base.DataSetChangeTypes.ADDED),this._draftConversations.push(c),this._provider.on(a.Providers.AMM.ProviderStates.AVAILABLE,function(){this._conversationService._recalculateAllConversationCapabilities(c)}.bind(this)),this._provider.on(a.Providers.AMM.ProviderStates.UNAVAILABLE,function(){this._conversationService._recalculateAllConversationCapabilities(c)}.bind(this)),c.addOnStatusChangedCallback(function(b,c){if(c===a.Services.Messaging.ResourceStatus.PUBLISHED){var d=this._draftConversations.indexOf(b);this._draftConversations.splice(d,1)}this._conversationService._recalculateAllConversationCapabilities(b)}.bind(this)),c.addOnActiveStatusChangedCallback(function(a){this._conversationService._recalculateAllConversationCapabilities(a)}.bind(this)),c.addOnClosedStatusChangedCallback(function(b,c){var d=this.conversations.indexOf(b);d>-1&&(this.conversations.splice(d,1),this.conversations.onDataSetChanged([b],a.Base.DataSetChangeTypes.REMOVED)),this._conversationService._recalculateAllConversationCapabilities(b)}.bind(this)),c.lastUpdated=new Date,c},start:function(c,d){return a.Base.Logger.debug(a.Base.LoggerTags.MESSAGING_SERVICE,"Messaging Service is starting..."),this._serviceUnavailableAnalyticsInit(c),this._hasStarted=!0,this._provider.on(a.Base.NetworkProviderEvents.UNAUTHORIZED,function(){c._fireMessagingUnavailableCallback(a.Services.Analytics.AnalyticsErrorCode.UNAUTHORIZED)}.bind(this)),this._provider.on(a.Base.NetworkProviderEvents.AUTHORIZED,function(){c._fireMessagingAvailableCallback()}.bind(this)),this._provider.start(d.ammConfiguration,c).then(function(){return this.validateUsers([this._provider.getSelfAddress()])}.bind(this)).then(function(a){var b=this._participantsService.getOrCreateParticipant(a[0]);this._identity.participant=b,this._participantsService.setSelfParticipant(b),this._recalculateAllMessagingCapabilities(c),this._onContactListChanged=function(){this.conversations.forEach(function(a){this._updateMatchedContactsForConversation(a)},this)}.bind(this),this._contactsIntegrationService.addOnContactListChangedCallback(this._onContactListChanged),c.addOnMessagingServiceAvailableCallback(function(){this._recalculateAllMessagingCapabilities(c)}.bind(this)),c.addOnMessagingServiceUnavailableCallback(function(){this._recalculateAllMessagingCapabilities(c)}.bind(this))}.bind(this),function(a){return this._hasStarted=!1,this._recalculateAllMessagingCapabilities(c),b.Deferred().reject(a).promise()}.bind(this))},_serviceUnavailableAnalyticsInit:function(a){var b;a.addOnMessagingServiceUnavailableCallback(function(a){a._messagingUnavailableReason&&(b=this._messagingAnalyticsService.startTimingMetric(),this._messagingAnalyticsService.trackServiceUnavailable(a._messagingUnavailableReason))}.bind(this)),a.addOnMessagingServiceAvailableCallback(function(){this._messagingAnalyticsService.trackDurationServiceUnavailableEnd(b)}.bind(this))},stop:function(c){c._isAvailable&&(c._isAvailable=void 0,c._onMessagingServiceUnavailableCallbacks.fire(c));var d=function(){if(!this._hasStarted){var d=b.Deferred(),e=new a.Services.Messaging.MessagingError(a.Services.Messaging.MessagingErrorReason.MESSAGING_NOT_STARTED);return d.reject(e),d.promise()}return this._provider.stop().then(function(b){this._messageService.stop(),this._participantsService.stop(),this._draftConversations=[];for(var d=this.conversations.length,e=0;e<d;e++){for(var f=this.conversations[e].messages.length,g=0;g<f;g++){for(var h=this.conversations[e].messages[g].parts.length,i=0;i<h;i++)delete this.conversations[e].messages[g].parts[i];delete this.conversations[e].messages[g]}for(var j=this.conversations[e]._draftEscalations.length,k=0;k<j;k++)delete this.conversations[e]._draftEscalations[k];delete this.conversations[e]}
return this.conversations=new a.Base.DataSet,this._hasStarted=!1,c._onMessagingLimitsChangedCallbacks.empty(),c._onNumberOfConversationsWithUnreadContentChangedCallbacks.empty(),c._onNumberOfConversationsWithUnreadContentSinceLastAccessChangedCallbacks.empty(),c._onRoutableDomainsChangedCallbacks.empty(),this._contactsIntegrationService.removeOnContactListChangedCallback(this._onContactListChanged),this._onContactListChanged=void 0,this._unreadConversationsCounter=void 0,this._numberOfConversationsWithUnreadContentSinceLastAccessTime=void 0,this._recalculateAllMessagingCapabilities(c),b}.bind(this))}.bind(this);return this.logout().then(d,d)},logout:function(){return this._provider.logout()},getNumberOfConversationsWithUnreadContent:function(){return this.conversations.filter(function(a){return a.getUnreadMessageCount()>0||a.getUnreadAttachmentCount()>0}).length},getNumberOfConversationsWithUnreadContentSinceLastAccess:function(){return this.conversations.filter(function(a){return a.hasUnreadMessagesSinceLastAccess()}).length},validateUsers:function(a){return this._conversationService.validateUsers(a)},searchConversations:function(b,c){var d=this._messagingAnalyticsService.startTimingMetric(),e=new a.Base.DataRetrieval,f=e.getDataSet(),g={cancel:function(){}},h={q:b.getQuery(),subject:b.isSearchSubject(),participants:b.isSearchParticipants(),body:b.isSearchBody()};b.getQueryAfter()&&(h.after=b.getQueryAfter().toISOString());var i=function(a){this._messagingAnalyticsService.trackTimeRequestsSearchConversationsEnd(d),this._updateConversationsContainer(a,f,c),e.isCompleted=!0,e._dataRetrievalProgress.fire(f.length,!1),e._dataRetrievalDone.fire(),this._messagingAnalyticsService.trackNumConversationSearchRequests(h.body,h.subject,h.participants)}.bind(this),j=function(b){this._messagingAnalyticsService.trackErrorsResponseSearchConversations(a.Services.Analytics.AnalyticsErrorCode.SEARCHING_CONVERSATIONS_ERROR),e._dataRetrievalFailed.fire(b)}.bind(this),k=function(a){e._dataRetrievalProgress.fire(a,!1)}.bind(this);return this._provider.getConversationsByQuery(h,null,g).then(i,j,k),e._onCancel=function(){g.cancel()},this._searchLocalConversations(this.conversations,b).forEach(function(a){f.push(a)}),setTimeout(function(){f.onDataSetChanged(f,a.Base.DataSetChangeTypes.ADDED),k(f,!1)},0),e},_createNewConversation:function(b,c){var d=this._conversationBuilder.build(b,this._conversationService);return this._provider.on(a.Providers.AMM.ProviderStates.AVAILABLE,function(){this._conversationService._recalculateAllConversationCapabilities(d)}.bind(this)),this._provider.on(a.Providers.AMM.ProviderStates.UNAVAILABLE,function(){this._conversationService._recalculateAllConversationCapabilities(d)}.bind(this)),this._conversationBuilder.update(d,b,this._conversationService),d.addOnClosedStatusChangedCallback(function(b,c){var d=this.conversations.indexOf(b);d>-1&&(this.conversations.splice(d,1),this.conversations.onDataSetChanged([b],a.Base.DataSetChangeTypes.ADDED))}.bind(this)),d},_getById:function(a,b){return a.filter(function(a){return a.id===b})[0]},_updateConversationsContainer:function(b,c,d){if(b&&b.conversations&&b.conversations.length>0){for(var e=[],f=[],g=0;g<b.conversations.length;g++){var h=b.conversations[g],i=this._getById(c,h.id);if(i)i.getLastUpdatedTime().toISOString()!==new Date(h.lastUpdated).toISOString()&&(this._conversationBuilder.update(i,h,this._conversationService),e.push(i),this._updateMatchedContactsForConversation(i));else if(h.flags.active){var j=this._createNewConversation(h,d);j.participants=this._conversationService.getParticipantsFromMessage(h.messages[0]),c.unshift(j),f.push(j),this._updateMatchedContactsForConversation(j)}}f.length>0&&c.onDataSetChanged(f,a.Base.DataSetChangeTypes.ADDED),e.length>0&&c.onDataSetChanged(e,a.Base.DataSetChangeTypes.UPDATED),this._updateNumberOfConversationsWithUnreadContent(d),this._updateNumberOfConversationsWithUnreadContentSinceLastAccessTime(d)}},_searchLocalConversations:function(c,d){var e=[];return c.forEach(function(c){var f=!1;d.isSearchSubject()&&-1!==c.getSubject().toLowerCase().indexOf(d.getQuery())&&(f=!0),d.isSearchParticipants()&&c.getParticipants().forEach(function(a){-1===a.givenName.toLowerCase().indexOf(d.getQuery())&&-1===a.surname.toLowerCase().indexOf(d.getQuery())||(f=!0)});var g=c.getMessages();d.isSearchBody()&&(g=c.getMessages().filter(function(a){if(d.isSearchBody()&&a.body&&-1!==a.body.toLowerCase().indexOf(d.getQuery()))return f=!0,!0}));var h=d.getQueryAfter();if(h&&f&&(f=c.getLastUpdatedTime()>=h),f){var i=b.extend(new a.Services.Messaging.Conversation,c);i.messages=new a.Base.DataSet,g.forEach(function(c){i.messages.push(b.extend(new a.Services.Messaging.Message(this._messageService,i),c))}.bind(this)),this._conversationBuilder._updatePreviewText(i),e.push(i)}}.bind(this)),e},_subscribeForConversationsUpdates:function(b){this._conversationsSubscribed||this._provider.observeConversations().then(function(){this._provider.on(a.Providers.Interfaces.MessagingProviderHandlers.CONVERSATIONS_UPDATE,function(a){this._updateConversationsContainer(a,this.conversations,b)}.bind(this)),this._conversationsSubscribed=!0}.bind(this))},_updateConversationsByIdDataSet:function(a,b,c){var d={conversations:[]};a.forEach(function(a){var c=b.filter(function(b){return b.id===a.id})[0];c&&d.conversations.push(c)}.bind(this)),d.conversations.length>0&&this._updateConversationsContainer(d,a,c)},removeConversation:function(c){var d=b.Deferred();if(c.getRemoveCapability().isAllowed){var e=this.conversations.indexOf(c);e>=0&&(this.conversations.splice(e,1),this.conversations.onDataSetChanged([c],a.Base.DataSetChangeTypes.REMOVED)),e=this._draftConversations.indexOf(c),e>=0&&this._draftConversations.splice(e,1),d.resolve()}else d.reject(new a.Base.BaseError(c.getRemoveCapability().denialReason));return d.promise()},removeAllDraftConversations:function(){for(var a=this._draftConversations.length-1;a>=0;a--)this.removeConversation(this._draftConversations[a])},serviceIsAvailable:function(){return!!this._provider.isAvailable()&&this._hasStarted},_recalculateAllMessagingCapabilities:function(a){a._recalculateRetrieveConversationsCapability(),a._recalculateStartServiceCapability(),a._recalculateCreateConversationCapability(),a._recalculateSearchConversationsCapability(),a._recalculateValidateParticipantAddressCapability(),a._recalculateMarkContentAsReadCapability()},getRoutableDomains:function(){return this._provider.getRoutableDomains()},getSelfAddress:function(){return this._provider.getSelfAddress()},getConversationResource:function(){return this._provider.getSelfAddress()},getValidateAddressResource:function(){return this._provider.getValidateAddressResource()},getMarkAsReadResource:function(){return this._provider.getMarkAsReadResource()},_updateMatchedContactsForConversation:function(a){this._contactsIntegrationService.isStarted()&&a.getParticipants().forEach(function(a){this._updateMatchedContactsForParticipant(a)},this)},_updateMatchedContactsForParticipant:function(a){this._contactsIntegrationService.updateMatchedContactsForParticipant(a)},_updateNumberOfConversationsWithUnreadContent:function(b){var c=this.getNumberOfConversationsWithUnreadContent(),d=a.Base.Utils.isDefined(this._unreadConversationsCounter);this._unreadConversationsCounter!==c&&(this._unreadConversationsCounter=c,d&&b._onNumberOfConversationsWithUnreadContentChangedCallbacks.fire(b,c))},_updateNumberOfConversationsWithUnreadContentSinceLastAccessTime:function(b){var c=this.getNumberOfConversationsWithUnreadContentSinceLastAccess(),d=a.Base.Utils.isDefined(this._numberOfConversationsWithUnreadContentSinceLastAccessTime);this._numberOfConversationsWithUnreadContentSinceLastAccessTime!==c&&(this._numberOfConversationsWithUnreadContentSinceLastAccessTime=c,d&&b._onNumberOfConversationsWithUnreadContentSinceLastAccessChangedCallbacks.fire(b,c))}},a.Services.Messaging.MessagingService=c}(AvayaClientServices,jQuery),function(a){"use strict";function b(){this._participants=[],this._selfParticipant=void 0}b.prototype={getOrCreateParticipant:function(b){var c=b._address||b.address||b.from._address||b.from.address,d=this._getParticipant(c);if(!d){var e=!!this._selfParticipant&&this._selfParticipant.getAddress()===c;d=new a.Services.Messaging.Participant(b,e),this._participants.push(d)}return d},_getParticipant:function(a){return this._participants.filter(function(b){return b.getAddress()===a})[0]},setSelfParticipant:function(a){this._selfParticipant=a,this._selfParticipant.self=!0},getSelfParticipant:function(){return this._selfParticipant},stop:function(){this._selfParticipant=void 0,this._participants=[]}},a.Services.Messaging.ParticipantService=b}(AvayaClientServices),function(a){"use strict";function b(a){var b={width:128};this._config=a||b,this._creators={}}b.prototype={getConfig:function(){return this._config},setConfig:function(a){this._config=a},registerCreator:function(a,b){this._creators[a]=b},unregisterCreator:function(a){this._creators[a]=void 0},create:function(a,b){if(b||(b=this._config),a.getCreateThumbnailCapability().isAllowed){var c;return c=this._creators[a.getMimeType()]?a.getMimeType():a.getMimeType().slice(0,a.getMimeType().indexOf("/")+1)+"*",this._creators[c].create(a,b)}}},a.Services.Messaging.ThumbnailCreator=b}(AvayaClientServices),function(a,b){"use strict";function c(b){a.Services.Messaging.AbstractThumbnailCreator.call(this,b)}c.prototype=Object.create(a.Services.Messaging.AbstractThumbnailCreator.prototype),c.prototype.create=function(a,c){var d=b.Deferred(),e={disposition:a.disposition.replace("attachment","inline"),mimeType:"image/jpeg",status:a.status},f=new FileReader;return f.onloadend=function(){this._getFirstFrameFromVideo(f.result,function(b){var f=new Image;f.src=b;var g=new Blob([this._resizeImage(f,c)],{type:"image/jpeg"});e.size=g.size,a.thumbnail=this._attachmentBuilder.build(e,g),d.resolve(a.thumbnail)}.bind(this))}.bind(this),f.readAsDataURL(a.file),d.promise()},c.prototype._getFirstFrameFromVideo=function(a,c){var d,e,f=document.createElement("canvas"),g=document.createElement("video"),h=document.createElement("source");h.src=a,h.type="video/mp4",g.appendChild(h),b(g).on("loadedmetadata",function(){f.height=e=g.videoHeight,f.width=d=g.videoWidth}),b(g).on("loadeddata",function(){f.getContext("2d").drawImage(g,0,0,d,e),c(f.toDataURL("image/jpeg"))}),b(g).on("error",function(){throw new Error}),g.load()},a.Services.Messaging.VideoThumbnailCreator=c}(AvayaClientServices,jQuery),function(a){"use strict";function b(){this._address="",this._participantId=void 0,this._displayName="",this._localUser=!1,this._matchedContacts=new a.Services.Contacts.MatchedContactsWithMatchLevel,this._onParticipantMatchedContactsChangedCallbacks=$.Callbacks()}b.prototype={getAddress:function(){return this._address},setAddress:function(a){this._address=a},getDisplayName:function(){return this._displayName},setDisplayName:function(a){this._displayName=a},getParticipantId:function(){return this._participantId},isLocalUser:function(){return this._localUser},getBestContactMatch:function(){if(this._matchedContacts&&!this._matchedContacts.empty){if(this._matchedContacts._exactType1Contacts.length>0)return this._matchedContacts._exactType1Contacts[0];if(this._matchedContacts._exactType2Contacts.length>0)return this._matchedContacts._exactType2Contacts[0];if(this._matchedContacts._partialType1Contacts.length>0)return this._matchedContacts._partialType1Contacts[0]}},getAllPossibleContactMatches:function(){return this._matchedContacts},setMatchedContacts:function(a){(a&&!a._equals(this._matchedContacts)||!a&&this._matchedContacts)&&(this._matchedContacts=a,this._onParticipantMatchedContactsChangedCallbacks.fire(this))}},a.Services.Participant=b}(AvayaClientServices),function(a){"use strict";var b={UNKNOWN:"UNKNOWN",UNSUPPORTED:"UNSUPPORTED",CANCELED:"CANCELED",INVALID_REQUEST:"INVALID_REQUEST",INVALID_STATE:"INVALID_STATE",INTERNAL_ERROR:"INTERNAL_ERROR",SEND_ERROR:"SEND_ERROR",TIMEOUT:"TIMEOUT",RETRY_LIMIT_EXCEEDED:"RETRY_LIMIT_EXCEEDED",INVALID_RESPONSE:"INVALID_RESPONSE",AUTHENTICATION_ERROR:"AUTHENTICATION_ERROR",SERVER_ERROR:"SERVER_ERROR"};a.Services.Presence.PresenceErrorReason=b}(AvayaClientServices),function(a){"use strict";var b={PRESENCE_LOCATION_MODE_UNSPECIFIED:"PRESENCE_LOCATION_MODE_UNSPECIFIED",PRESENCE_LOCATION_MODE_OFFICE:"PRESENCE_LOCATION_MODE_OFFICE",PRESENCE_LOCATION_MODE_HOME:"PRESENCE_LOCATION_MODE_HOME",PRESENCE_LOCATION_MODE_MOBILE:"PRESENCE_LOCATION_MODE_MOBILE",PRESENCE_LOCATION_MODE_TRAVELING:"PRESENCE_LOCATION_MODE_TRAVELING"};a.Services.Presence.PresenceLocationMode=b}(AvayaClientServices),function(a){"use strict";var b={PRESENCE_STATE_UNKNOWN:"PRESENCE_STATE_UNKNOWN",PRESENCE_STATE_UNSPECIFIED:"PRESENCE_STATE_UNSPECIFIED",PRESENCE_STATE_AVAILABLE:"PRESENCE_STATE_AVAILABLE",PRESENCE_STATE_ON_A_CALL:"PRESENCE_STATE_ON_A_CALL",PRESENCE_STATE_BUSY:"PRESENCE_STATE_BUSY",PRESENCE_STATE_AWAY:"PRESENCE_STATE_AWAY",PRESENCE_STATE_DO_NOT_DISTURB:"PRESENCE_STATE_DO_NOT_DISTURB",PRESENCE_STATE_OUT_OF_OFFICE:"PRESENCE_STATE_OUT_OF_OFFICE",PRESENCE_STATE_OFFLINE:"PRESENCE_STATE_OFFLINE"};a.Services.Presence.PresenceState=b;var c={PRESENCE_STATE_UNKNOWN:b.PRESENCE_STATE_UNKNOWN,PRESENCE_STATE_UNSPECIFIED:b.PRESENCE_STATE_UNSPECIFIED,PRESENCE_STATE_AVAILABLE:b.PRESENCE_STATE_AVAILABLE,PRESENCE_STATE_BUSY:b.PRESENCE_STATE_BUSY,PRESENCE_STATE_AWAY:b.PRESENCE_STATE_AWAY,PRESENCE_STATE_OUT_OF_OFFICE:b.PRESENCE_STATE_OUT_OF_OFFICE,PRESENCE_STATE_OFFLINE:b.PRESENCE_STATE_OFFLINE};a.Services.Presence.ManualPresenceState=c;var d={PRESENCE_STATE_UNKNOWN:b.PRESENCE_STATE_UNKNOWN,PRESENCE_STATE_UNSPECIFIED:b.PRESENCE_STATE_UNSPECIFIED,PRESENCE_STATE_AVAILABLE:b.PRESENCE_STATE_AVAILABLE,PRESENCE_STATE_ON_A_CALL:b.PRESENCE_STATE_ON_A_CALL,PRESENCE_STATE_AWAY:b.PRESENCE_STATE_AWAY,PRESENCE_STATE_OUT_OF_OFFICE:b.PRESENCE_STATE_OUT_OF_OFFICE,PRESENCE_STATE_OFFLINE:b.PRESENCE_STATE_OFFLINE};a.Services.Presence.PhonePresenceState=d;var e={PRESENCE_STATE_UNKNOWN:b.PRESENCE_STATE_UNKNOWN,PRESENCE_STATE_UNSPECIFIED:b.PRESENCE_STATE_UNSPECIFIED,PRESENCE_STATE_AVAILABLE:b.PRESENCE_STATE_AVAILABLE,PRESENCE_STATE_ON_A_CALL:b.PRESENCE_STATE_ON_A_CALL,PRESENCE_STATE_AWAY:b.PRESENCE_STATE_AWAY,PRESENCE_STATE_OFFLINE:b.PRESENCE_STATE_OFFLINE};a.Services.Presence.VideoPresenceState=e;var f={PRESENCE_STATE_UNKNOWN:b.PRESENCE_STATE_UNKNOWN,PRESENCE_STATE_UNSPECIFIED:b.PRESENCE_STATE_UNSPECIFIED,PRESENCE_STATE_AVAILABLE:b.PRESENCE_STATE_AVAILABLE,PRESENCE_STATE_AWAY:b.PRESENCE_STATE_AWAY,PRESENCE_STATE_OFFLINE:b.PRESENCE_STATE_OFFLINE};a.Services.Presence.IMPresenceState=f;var g={PRESENCE_STATE_UNKNOWN:b.PRESENCE_STATE_UNKNOWN,PRESENCE_STATE_UNSPECIFIED:b.PRESENCE_STATE_UNSPECIFIED,PRESENCE_STATE_AVAILABLE:b.PRESENCE_STATE_AVAILABLE,PRESENCE_STATE_AWAY:b.PRESENCE_STATE_AWAY,PRESENCE_STATE_OFFLINE:b.PRESENCE_STATE_OFFLINE};a.Services.Presence.CalendarPresenceState=g}(AvayaClientServices),function(a){"use strict";function b(a){Error.call(this),this._reason=a}b.prototype=Object.create(Error.prototype),b.prototype.getReason=function(){return this._reason},a.Services.Presence.PresenceError=b}(AvayaClientServices),function(a){"use strict";function b(a){this._presentity=a,this._locationMode=void 0,this._note=void 0,this._calendarStartTime=void 0,this._calendarEndTime=void 0,this._calendarState=void 0,this._manualState=void 0,this._overallState=void 0,this._enterpriseIMState=void 0,this._phoneState=void 0,this._videoState=void 0,this._enterpriseIMContact=void 0,this._phoneContact=void 0,this._videoContact=void 0}b.prototype={getPresentity:function(){return this._presentity},getOverallState:function(){return this._overallState},_setOverallState:function(a){this._overallState=a},getManualState:function(){return this._manualState},_setManualState:function(a){this._manualState=a},getPhoneState:function(){return this._phoneState},_setPhoneState:function(a){this._phoneState=a},getPhoneContact:function(){return this._phoneContact},_setPhoneContact:function(a){this._phoneContact=a},getVideoState:function(){return this._videoState},_setVideoState:function(a){this._videoState=a},getVideoContact:function(){return this._videoContact},_setVideoContact:function(a){this._videoContact=a},getEnterpriseIMState:function(){return this._enterpriseIMState},_setEnterpriseIMState:function(a){this._enterpriseIMState=a},getEnterpriseIMContact:function(){return this._enterpriseIMContact},_setEnterpriseIMContact:function(a){this._enterpriseIMContact=a},getCalendarState:function(){return this._calendarState},_setCalendarState:function(a){this._calendarState=a},getCalendarStartTime:function(){return this._calendarStartTime},_setCalendarStartTime:function(a){this._calendarStartTime=a},getCalendarEndTime:function(){return this._calendarEndTime},_setCalendarEndTime:function(a){this._calendarEndTime=a},getLocationMode:function(){return this._locationMode},_setLocationMode:function(a){this._locationMode=a},getNote:function(){return this._note},_setNote:function(a){this._note=a}},a.Services.Presence.Presence=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Services.Presence.Presence.prototype),b.prototype.setPhoneState=function(a){this._setPhoneState(a)},b.prototype.setVideoState=function(a){this._setVideoState(a)},b.prototype.setEnterpriseIMState=function(a){this._setEnterpriseIMState(a)},a.Services.Presence.SelfPresence=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype={getCallLogId:function(){},getParticipantList:function(){},getStartTime:function(){},getCallDuration:function(){},isCallerIdPrivate:function(){},getSubject:function(){},getRemoteAddress:function(){},getLocalAddress:function(){},getCallType:function(){},getWebConferenceAddress:function(){},getChannelTypeList:function(){},isBridged:function(){},isIncoming:function(){},isMissed:function(){},isDeclined:function(){},isFailed:function(){},isRead:function(){},getCorrelatedCallLogIdList:function(){}},a.Services.SessionLogs.CallLogItem=b}(AvayaClientServices=AvayaClientServices||{}),function(a){"use strict";function b(){}b.prototype={getUnreadCount:function(){}},a.Services.SessionLogs.CallLogsDataSet=b}(AvayaClientServices=AvayaClientServices||{}),function(a){"use strict";a.Services.SessionLogs.create=function(){return new a.Services.SessionLogs.SessionLogs}}(AvayaClientServices=AvayaClientServices||{}),function(a){"use strict";function b(){}b.prototype={getCurrentCallLogItemList:function(){},markAsRead:function(a,b){},deleteCallLogItemList:function(a,b){}},a.Services.SessionLogs.SessionLogs=b}(AvayaClientServices=AvayaClientServices||{}),function(a){"use strict";function b(a){this._messageWaiting=a}b.prototype={isMessageWaiting:function(){return this._messageWaiting},_setMessageWaiting:function(a){this._messageWaiting=a}},a.Services.VoiceMessaging.VoiceMessagingStatusParameters=b}(AvayaClientServices),function(a,b){"use strict";function c(c){this._vmProvider=c,this._available=void 0,this._starting=!1,this._started=!1,this._vmNumber=void 0,this._vmStatus=new a.Services.VoiceMessaging.VoiceMessagingStatusParameters(!1),this._onVoicemailNumberChange=void 0,this._onMWIStatusChange=void 0,this._onNetworkAvailable=void 0,this._onNetworkUnavailable=void 0,this._onVoicemailNumberChangedCallbacks=b.Callbacks(),this._onVoiceMessagingStatusChangedCallbacks=b.Callbacks(),this._onVoiceMessagingServiceAvailableCallbacks=b.Callbacks(),this._onVoiceMessagingServiceUnavailableCallbacks=b.Callbacks(),this._serviceAvailableCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED)}c.prototype={getVoicemailNumber:function(){return this._vmNumber},getVoiceMessagingStatus:function(){return this._vmStatus},start:function(c){this.startDfd=b.Deferred();var d=a.Base.Utils.getBrowserType();return d!==a.Base.BrowserType.CHROME&&d!==a.Base.BrowserType.CHROME_EXTENSION&&d!==a.Base.BrowserType.FIREFOX&&d!==a.Base.BrowserType.FIREFOX_EXTENSION?(this._available=!1,this._started=!0,this._onVoiceMessagingServiceUnavailableCallbacks.fire(this),this._serviceAvailableCapability._updateIfChanged(!0,a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.WEBRTC_NOT_SUPPORTED)).promise()):(a.Base.Logger.info(a.Base.LoggerTags.VOICE_MESSAGING_SERVICE,"Starting the service"),this._subscribeForProvidersNotifications(),this._starting=!0,this._vmProvider.start(void 0,c.sgConfiguration).fail(function(b){this._starting=!1,this._available=!1,a.Base.Logger.error(a.Base.LoggerTags.VOICE_MESSAGING_SERVICE,"Failed to start service",b),this.startDfd.state()===a.Base.DeferredStates.PENDING&&this.startDfd.reject(b)}.bind(this)),a.Base.Utils.isDefined(this._vmProvider.isServiceAvailable())&&(this._vmProvider.isServiceAvailable()?this._onServiceAvailable():this._onServiceUnavailable()),this.startDfd.promise())},stop:function(){a.Base.Logger.info(a.Base.LoggerTags.VOICE_MESSAGING_SERVICE,"Stopping the service"),this._unsubscribeFromProvidersNotifications(),this._onServiceUnavailable();var c=function(){this._started=!1,this._onVoicemailNumberChangedCallbacks.empty(),this._onVoiceMessagingStatusChangedCallbacks.empty(),this._onVoiceMessagingServiceAvailableCallbacks.empty(),this._onVoiceMessagingServiceUnavailableCallbacks.empty()}.bind(this);return this._vmProvider.stop().then(function(){c(),a.Base.Logger.info(a.Base.LoggerTags.VOICE_MESSAGING_SERVICE,"Service stopped successfully")}.bind(this),function(d){return c(),a.Base.Logger.error(a.Base.LoggerTags.VOICE_MESSAGING_SERVICE,"Failed to stop service",d),b.Deferred().reject(d).promise()}.bind(this))},_onServiceAvailable:function(){this._available||(this._started||(this._starting=!1,this._started=!0,a.Base.Logger.info(a.Base.LoggerTags.VOICE_MESSAGING_SERVICE,"Service started successfully"),this.startDfd.state()===a.Base.DeferredStates.PENDING&&this.startDfd.resolve()),this._serviceAvailableCapability._updateIfChanged(!0,a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._available=!0,a.Base.Logger.info(a.Base.LoggerTags.VOICE_MESSAGING_SERVICE,"Service is available"),this._onVoiceMessagingServiceAvailableCallbacks.fire(this))},_onServiceUnavailable:function(){(this._available||this._starting)&&(this._starting&&(this._starting=!1,a.Base.Logger.error(a.Base.LoggerTags.VOICE_MESSAGING_SERVICE,"Failed to start service"),this.startDfd.state()===a.Base.DeferredStates.PENDING&&this.startDfd.reject()),this._serviceAvailableCapability._updateIfChanged(!1,a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._available=!1,a.Base.Logger.info(a.Base.LoggerTags.VOICE_MESSAGING_SERVICE,"Service is unavailable"),this._onVoiceMessagingServiceUnavailableCallbacks.fire(this))},_subscribeForProvidersNotifications:function(){this._started||this._starting||(this._onVoicemailNumberChange=function(a){this._vmNumber!==a&&(this._vmNumber=a,this._onVoicemailNumberChangedCallbacks.fire(a))}.bind(this),this._onMWIStatusChange=function(a){this._vmStatus.isMessageWaiting()!==a&&(this._vmStatus._setMessageWaiting(a),this._onVoiceMessagingStatusChangedCallbacks.fire(this._vmStatus))}.bind(this),this._onNetworkAvailable=this._onServiceAvailable.bind(this),this._onNetworkUnavailable=this._onServiceUnavailable.bind(this),this._vmProvider.on(a.Providers.Interfaces.VoiceMessagingProviderCallbackIds.VOICEMAIL_NUMBER_CHANGED,this._onVoicemailNumberChange),this._vmProvider.on(a.Providers.Interfaces.VoiceMessagingProviderCallbackIds.MWI_STATUS_CHANGED,this._onMWIStatusChange),this._vmProvider.on(a.Base.NetworkProviderEvents.UNAUTHORIZED,this._onNetworkUnavailable),this._vmProvider.on(a.Base.NetworkProviderEvents.AUTHORIZED,this._onNetworkAvailable),this._vmProvider.on(a.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,this._onNetworkUnavailable),this._vmProvider.on(a.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_AVAILABLE,this._onNetworkAvailable))},_unsubscribeFromProvidersNotifications:function(){this._started&&(this._vmProvider.off(a.Providers.Interfaces.VoiceMessagingProviderCallbackIds.VOICEMAIL_NUMBER_CHANGED,this._onVoicemailNumberChange),this._vmProvider.off(a.Providers.Interfaces.VoiceMessagingProviderCallbackIds.MWI_STATUS_CHANGED,this._onMWIStatusChange),this._vmProvider.off(a.Base.NetworkProviderEvents.UNAUTHORIZED,this._onNetworkUnavailable),this._vmProvider.off(a.Base.NetworkProviderEvents.AUTHORIZED,this._onNetworkAvailable),this._vmProvider.off(a.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,this._onNetworkUnavailable),this._vmProvider.off(a.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_AVAILABLE,this._onNetworkAvailable),this._onNetworkAvailable=void 0,this._onNetworkUnavailable=void 0,this._onVoicemailNumberChange=void 0,this._onMWIStatusChange=void 0)}},a.Services.VoiceMessaging.VoiceMessaging=c}(AvayaClientServices,$),function(a,b){"use strict";var c={createLogAPICallAdvice:function(b){return new a.Base.AOPAdvice(a.Base.AOPPointcutType.BEFORE,function(c,d,e,f){a.Base.Logger.info(b,"API called: "+d+"."+e)})},createWrapCaughtErrorInPromiseAdvice:function(c,d){return new a.Base.AOPAdvice(a.Base.AOPPointcutType.AROUND,function(e,f,g,h,i,j){try{return i.apply(h,j)}catch(k){return a.Base.Logger.warn(c,"Caught error in execution of function returning promise",k),b.Deferred().reject(d).promise()}})}};c.LOG_CALL_API_CALLS=c.createLogAPICallAdvice(a.Base.LoggerTags.CALL_SERVICE),c.LOG_PRESENCE_API_CALLS=c.createLogAPICallAdvice(a.Base.LoggerTags.PRESENCE_SERVICE),c.LOG_CONTACTS_API_CALLS=c.createLogAPICallAdvice(a.Base.LoggerTags.CONTACTS_SERVICE),c.LOG_MESSAGING_API_CALLS=c.createLogAPICallAdvice(a.Base.LoggerTags.MESSAGING_SERVICE),c.LOG_COLLABORATION_API_CALLS=c.createLogAPICallAdvice(a.Base.LoggerTags.COLLABORATION_SERVICE),c.LOG_CONFERENCE_API_CALLS=c.createLogAPICallAdvice(a.Base.LoggerTags.CONFERENCE_SERVICE),c.LOG_USER_API_CALLS=c.createLogAPICallAdvice(a.Base.LoggerTags.USER_SERVICE),c.WRAP_CAUGHT_CALL_ERROR=c.createWrapCaughtErrorInPromiseAdvice(a.Base.LoggerTags.CALL_SERVICE,new a.Services.Call.CallException(a.Services.Call.CallError.INTERNAL_ERROR)),c.WRAP_CAUGHT_PRESENCE_ERROR=c.createWrapCaughtErrorInPromiseAdvice(a.Base.LoggerTags.PRESENCE_SERVICE,new a.Services.Presence.PresenceError(a.Services.Presence.PresenceErrorReason.INTERNAL_ERROR)),c.WRAP_CAUGHT_CONTACTS_ERROR=c.createWrapCaughtErrorInPromiseAdvice(a.Base.LoggerTags.CONTACTS_SERVICE,new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.INTERNAL_ERROR)),c.WRAP_CAUGHT_MESSAGING_ERROR=c.createWrapCaughtErrorInPromiseAdvice(a.Base.LoggerTags.MESSAGING_SERVICE,new a.Services.Messaging.MessagingError(a.Services.Messaging.MessagingErrorReason.MESSAGING_INTERNAL_ERROR)),c.WRAP_CAUGHT_COLLABORATION_ERROR=c.createWrapCaughtErrorInPromiseAdvice(a.Base.LoggerTags.COLLABORATION_SERVICE,new a.Services.Collaboration.CollaborationError(a.Services.Collaboration.CollaborationErrorReason.INTERNAL_ERROR)),c.WRAP_CAUGHT_CONFERENCE_ERROR=c.createWrapCaughtErrorInPromiseAdvice(a.Base.LoggerTags.CONFERENCE_SERVICE,{name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"An internal error occurred."}),c.WRAP_CAUGHT_USER_ERROR=c.createWrapCaughtErrorInPromiseAdvice(a.Base.LoggerTags.USER_SERVICE,new a.Base.BaseError(a.Base.ErrorReasons.INTERNAL_ERROR)),a.Base.AOPCommonAdvices=c}(AvayaClientServices,jQuery),function(a,b){"use strict";function c(b){a.Base.Observable.call(this),this._elements={},this._appliedElementIds=[],this._elementsIds=[],this._elementAdditionDates=[],this._options=b||new a.Base.CacheOptions,this.auditIntervald=void 0,this._startAudit()}c.prototype=Object.create(a.Base.Observable.prototype),c.prototype.getElement=function(a){return this._elements[a]},c.prototype.getAllElements=function(){var b=[];for(var c in this._elements)this._elements.hasOwnProperty(c)&&b.push(this._elements[c]);return a.Base.Utils.removeDuplicatesFromArray(b)},c.prototype.addElement=function(b,c){return!!this._addElement(b,c)&&(this.trigger(a.Base.ElementCacheEvents.ELEMENT_ADDED,[[c]]),!0)},c.prototype.addElements=function(b){var c=this._makeRoomForNewElements(b);if(c.length)for(var d=0;d<c.length;d++)this.addElement(c[d].elementId,c[d].element)||a.Base.Logger.error(a.Base.LoggerTags.CACHE,"The element was not added",c[d]);return c},c.prototype.updateElement=function(b,c){if(b&&c){var d=this.getElement(b);if(d&&!this._areElementsEqual(d,c)){this._elements[b]=c;var e=this._getIndexOfElementId(b);return e>-1&&(this._elementAdditionDates.splice(e,1),this._elementsIds.splice(e,1),this._elementAdditionDates.push(new Date),this._elementsIds.push(b)),this.trigger(a.Base.ElementCacheEvents.ELEMENT_UPDATED,[c]),!0}}return!1},c.prototype.deleteElement=function(b){var c=this._deleteElement(b);return!!c&&(this.trigger(a.Base.ElementCacheEvents.ELEMENT_DELETED,[[c]]),!0)},c.prototype.empty=function(){var b=[];for(var c in this._elements)if(this._elements.hasOwnProperty(c)){var d=this._deleteElement(c);d&&b.push(d)}this.trigger(a.Base.ElementCacheEvents.ELEMENT_DELETED,[b])},c.prototype.applyElements=function(c,d){for(var e,f,g=c.length,h=[],i=[],j=0;j<g;j++)e=c[j].elementId,f=c[j].element,e&&f&&(this._addElement(e,f)?(this._appliedElementIds.push(e),h.push(f)):this.updateElement(e,f)||this.getElement(e)?this._appliedElementIds.push(e):a.Base.Logger.warn(a.Base.LoggerTags.CACHE,"Failed to add or update cache element",f));if(h.length>0&&this.trigger(a.Base.ElementCacheEvents.ELEMENT_ADDED,[h]),!d){for(e in this._elements)if(-1===b.inArray(e,this._appliedElementIds)){var k=this._deleteElement(e);k&&i.push(k)}this._appliedElementIds=[]}i.length>0&&this.trigger(a.Base.ElementCacheEvents.ELEMENT_DELETED,[i])},c.prototype.getCacheSize=function(){return this._elementsIds.length},c.prototype.getCacheMaxSize=function(){return this._options.maxElements},c.prototype._addElement=function(a,b){if(a&&b&&!this.getElement(a)){var c=this._makeRoomForNewElements([{elementId:a,element:b}]);if(c.length)return this._elements[c[0].elementId]=c[0].element,this._elementsIds.push(c[0].elementId),this._elementAdditionDates.push(new Date),this._startAudit(),!0}return!1},c.prototype._deleteElement=function(a){var b=this.getElement(a);if(b){delete this._elements[a];var c=this._getIndexOfElementId(a);return c>-1&&(this._elementAdditionDates.splice(c,1),this._elementsIds.splice(c,1)),this.getCacheSize()||this._stopAudit(),b}},c.prototype._deleteElements=function(b){for(var c=!0,d=b.length,e=0;e<d;e++)this._deleteElement(b[e])||(c=!1,a.Base.Logger.error(a.Base.LoggerTags.CACHE,"The element was not deleted",b[e]));return c},c.prototype._areElementsEqual=function(a,b){return a===b||"function"==typeof a.equals&&a.equals(b)},c.prototype._makeRoomForNewElements=function(b){var c=this.getCacheSize(),d=this.getCacheMaxSize(),e=void 0!==d?d-c:void 0,f=b.length,g=void 0!==e?f-e:void 0,h=b.slice();return d&&f>d?(this.empty(),h=b.slice(-d),a.Base.Logger.warn(a.Base.LoggerTags.CACHE,"Some elements can not be added, because the size of adding data more then max cache size",b.slice(0,-d))):g&&g>0&&this._deleteElements(this._elementsIds.slice(0,g)),h},c.prototype._startAudit=function(){if(!this._options.auditInterval)return void this._stopAudit();this.auditIntervald||(this.auditIntervald=setInterval(function(){this._audit()}.bind(this),this._options.auditInterval))},c.prototype._audit=function(){if(this._options.timeToLive)for(var a=new Date,b=this._elementAdditionDates.length,c=0;c<b;c++){var d=a-this._elementAdditionDates[c];if(d>this._options.timeToLive){var e=this._elementsIds[c];this._deleteElement(e)}}},c.prototype._stopAudit=function(){this.auditIntervald&&(clearInterval(this.auditIntervald),this.auditIntervald=void 0)},c.prototype._getIndexOfElementId=function(b){var c=this._elementsIds.indexOf(b)
;return-1===c&&a.Base.Logger.warn(a.Base.LoggerTags.CACHE,"Can not find index of element",b),c},a.Base.ElementCache=c}(AvayaClientServices,jQuery),function(a,b){"use strict";var c={addOnDataRetrievalProgressCallback:function(a){this._dataRetrievalProgress.add(a)},removeOnDataRetrievalProgressCallback:function(a){this._dataRetrievalProgress.remove(a)},addOnDataRetrievalDoneCallback:function(a){this._dataRetrievalDone.add(a)},removeOnDataRetrievalDoneCallback:function(a){this._dataRetrievalDone.remove(a)},addOnDataRetrievalFailedCallback:function(a){this._dataRetrievalFailed.add(a)},removeOnDataRetrievalFailedCallback:function(a){this._dataRetrievalFailed.remove(a)}};b.extend(a.Base.DataRetrieval.prototype,c)}(AvayaClientServices,jQuery),function(a){"use strict";function b(){a.Base.MediaInterfaceService.call(this),this._deviceIdentifier=a.Base.MediaTypes.AUDIO_INPUT,this._audioInputVolumeController=void 0}b.prototype=Object.create(a.Base.MediaInterfaceService.prototype),b.prototype.start=function(b){return this._audioInputVolumeController=new a.Base.AudioInputVolumeController,a.Base.MediaInterfaceService.prototype.start.call(this,b)},b.prototype.stop=function(b){return this._audioInputVolumeController&&(this._audioInputVolumeController.stop(),this._audioInputVolumeController=void 0),a.Base.MediaInterfaceService.prototype.stop.call(this,b)},b.prototype._buildDevice=function(b){return new a.Base.AudioDevice(b.deviceId,b.groupId,b.label,a.Base.MediaTypes.AUDIO_INPUT)},b.prototype.localMediaStreamCreated=function(a){},b.prototype.setVolume=function(a){this._audioInputVolumeController.setVolume(a)},b.prototype.getVolume=function(){return this._audioInputVolumeController.getVolume()},b.prototype.getAudioInputVolumeController=function(){return this._audioInputVolumeController},a.Base.AudioInputInterfaceService=b}(AvayaClientServices),function(a){"use strict";function b(b){this._audioInputInterfaceService=b,a.Base.MediaInterface.call(this,b)}b.prototype=Object.create(a.Base.MediaInterface.prototype),b.prototype.setVolume=function(b){a.Base.Logger.warn(a.Base.LoggerTags.MEDIA_ENGINE,"Deprecated function is called: setVolume.")},b.prototype.getVolume=function(){a.Base.Logger.warn(a.Base.LoggerTags.MEDIA_ENGINE,"Deprecated function is called: getVolume.")},a.Base.AudioInputInterface=b}(AvayaClientServices),function(a,b){"use strict";function c(a,b){this._inputInterface=a,this._outputInterface=b}c.prototype=Object.create(a.Base.MediaInterface.prototype),c.prototype.getInputInterface=function(){return this._inputInterface},c.prototype.start=function(){return b.when(this._inputInterface.start(),this._outputInterface.start())},c.prototype.stop=function(){return b.when(this._inputInterface.stop(),this._outputInterface.stop())},c.prototype.getOutputInterface=function(){return this._outputInterface},a.Base.AudioInterface=c}(AvayaClientServices,jQuery),function(a){"use strict";function b(){a.Base.MediaInterfaceService.call(this),this._deviceIdentifier=a.Base.MediaTypes.AUDIO_OUTPUT,this._audioOutput=void 0}b.prototype=Object.create(a.Base.MediaInterfaceService.prototype),b.prototype.start=function(b){return this._audioOutput=new a.Base.AudioOutput,a.Base.MediaInterfaceService.prototype.start.call(this,b)},b.prototype.stop=function(b){return this._audioOutput&&(this._audioOutput.stop(),this._audioOutput=void 0),a.Base.MediaInterfaceService.prototype.stop.call(this,b)},b.prototype._buildDevice=function(b){return new a.Base.AudioDevice(b.deviceId,b.groupId,b.label,a.Base.MediaTypes.AUDIO_OUTPUT)},b.prototype.mute=function(){this._audioOutput.mute()},b.prototype.unmute=function(){this._audioOutput.unmute()},b.prototype.isMuted=function(){return this._audioOutput.isMuted()},b.prototype.setVolume=function(a){this._audioOutput.setVolume(a)},b.prototype.getVolume=function(){return this._audioOutput.getVolume()},b.prototype.onSelectedDeviceChanged=function(a,b){this._audioOutput.onSelectedDeviceChanged(b)},b.prototype.getAudioOutput=function(){return this._audioOutput},a.Base.AudioOutputInterfaceService=b}(AvayaClientServices),function(a){"use strict";function b(b){this._audioOutputInterfaceService=b,a.Base.MediaInterface.call(this,b),this.addOnSelectedDeviceChangedCallback(b.onSelectedDeviceChanged.bind(b))}b.prototype=Object.create(a.Base.MediaInterface.prototype),b.prototype.mute=function(){this._audioOutputInterfaceService.mute()},b.prototype.unmute=function(){this._audioOutputInterfaceService.unmute()},b.prototype.isMuted=function(){return this._audioOutputInterfaceService.isMuted()},b.prototype.setVolume=function(a){this._audioOutputInterfaceService.setVolume(a)},b.prototype.getVolume=function(){return this._audioOutputInterfaceService.getVolume()},a.Base.AudioOutputInterface=b}(AvayaClientServices),function(a){"use strict";function b(){a.Base.Observable.call(this),this._config=void 0,this._credentialProvider=void 0,this._protocolTypes={secure:"",nonSecure:""}}b.prototype=Object.create(a.Base.Observable.prototype),b.prototype.start=function(a,b,c,d,e,f){var g=$.Deferred();return this._config=a,this._credentialProvider=b,this.onOpen(),g.resolve(),g.promise()},b.prototype.send=function(a,b,c){},b.prototype.getBufferedAmount=function(){return 0},b.prototype._onCredentialsRequired=function(a){},b.prototype.onInvalidCredentialsProvided=function(a,b){},b.prototype._getServerURL=function(b){var c="";return b&&a.Base.Utils.isDefined(b.url)?c=b.url:(c+=(this._config.isSecure?this._protocolTypes.secure:this._protocolTypes.nonSecure)+"://",this._config.credentials&&(c+=this._config.credentials+"@"),c+=this._config.hostName,this._config.port&&(c+=":"+this._config.port)),b&&b.urlSuffix?c+=b.urlSuffix:this._config.path&&(c+=this._config.path),b&&b.query?c+="?"+b.query:this._config.query&&(c+="?"+this._config.query),c},b.prototype.run=function(a){},b.prototype.close=function(){this.onClose()},b.prototype.onOpen=function(){},b.prototype.onClose=function(){},b.prototype.onMessage=function(a){},b.prototype.onError=function(a){},b.prototype.onConnectionUnavailable=function(){},a.Base.AbstractNetworkProvider=b}(AvayaClientServices),function(a,b){"use strict";function c(b,c){function d(b,c){b.onOpen=function(a){c.onOpen(a)},b.onMessage=function(b,d){setTimeout(function(){if(b.data instanceof ArrayBuffer)a.Base.Logger.debug(a.Base.LoggerTags.NETWORK_PROVIDER,"BYTE LENGTH RECEIVED:",b.data.byteLength);else{var e;try{e=c._generateLoggedMessage(b)}catch(g){e="Failed to generate received message "+g}if(d&&d.getAllResponseHeaders){var f=d.getAllResponseHeaders();a.Base.Logger.debug(a.Base.LoggerTags.NETWORK_PROVIDER,"MESSAGE RECEIVED:",e,"HEADERS RECEIVED:",f)}else a.Base.Logger.debug(a.Base.LoggerTags.NETWORK_PROVIDER,"MESSAGE RECEIVED:",e)}c.onMessage(b,d)}.bind(this))},b.onClose=function(a){c.onClose(a)},b.onError=function(a){c.onError(a)},b.on(a.Base.NetworkErrorCodes.HTTP_REDIRECTION,c._handleRedirect.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_MOVED_PERMANENTLY,c._handleRedirect.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_FOUND,c._handleRedirect.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_SEE_OTHER,c._handleRedirect.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_NOT_MODIFIED,c._handleRedirect.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_USE_PROXY,c._handleRedirect.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_TEMPORARY_REDIRECT,c._handleRedirect.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_PERMANENT_REDIRECT,c._handleRedirect.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_BAD_REQUEST,c._handleError.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_UNAUTHORIZED,c._handleUnauthorized.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_PAYMENT_REQUIRED,c._handleError.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_FORBIDDEN,c._handleError.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_NOT_FOUND,c._handleError.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_METHOD_NOT_ALLOWED,c._handleError.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_NOT_ACCEPTABLE,c._handleError.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_PROXY_AUTHENTICATION_REQUIRED,c._handleUnauthorized.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_REQUEST_TIMEOUT,c._handleError.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_CONFLICT,c._handleError.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_GONE,c._handleError.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_LENGTH_REQUIRED,c._handleError.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_PRECONDITION_FAILED,c._handleError.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_PAYLOAD_TO_LARGE,c._handleError.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_URI_TOO_LONG,c._handleError.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_UNSUPPORTED_MEDIA_TYPE,c._handleError.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_NETWORK_ERROR,c._handleNetworkError.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_INTERNAL_SERVER_ERROR,c._handleError.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_NOT_IMPLEMENTED,c._handleError.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_BAD_GATEWAY,c._handleError.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_SERVICE_UNAVAILABLE,c._retry.bind(c)),b.on(a.Base.NetworkErrorCodes.HTTP_GATEWAY_TIMEOUT,c._handleError.bind(c)),b.on(a.Base.NetworkErrorCodes.WEBSOCKET_UNAUTHORIZED,c._handleUnauthorized.bind(c))}a.Base.AbstractNetworkProvider.apply(this),this._communicationAdapter={},this._mainProvider=b,this._fallbackProvider=c,this._config=void 0,this._credentialProvider=void 0,this._failoverCallback=void 0,this._reconnectionMainProvider=!1,this._unauthorizedCount=0,this._blackList=[],this._closing=!1,this._failoverPromise=void 0,this._onCredentialsRequired=function(){},this.onConnectionUnavailable=function(){!this._closing&&this._failoverCallback&&this._fallbackProvider&&!this._failoverPromise?(a.Base.Logger.debug(a.Base.LoggerTags.NETWORK_PROVIDER,"onConnectionUnavailable Callback - Reconnection process start with fallback provider"),this._reconnectionMainProvider?this._fallbackProvider&&(this._reconnectionMainProvider=!1,this._communicationAdapter=this._fallbackProvider,this._executeFailoverCallback()):(this._reconnectionMainProvider=!0,this._communicationAdapter=this._mainProvider,this._executeFailoverCallback().then(function(){this._reconnectionMainProvider=!1}.bind(this)))):this._closing||!this._failoverCallback||this._failoverPromise||(a.Base.Logger.debug(a.Base.LoggerTags.NETWORK_PROVIDER,"onConnectionUnavailable Callback - Reconnection process start without fallback provider"),this._executeFailoverCallback())}.bind(this),d(this._mainProvider,this),this._mainProvider.onConnectionUnavailable=this.onConnectionUnavailable,this._fallbackProvider&&(d(this._fallbackProvider,this),this._fallbackProvider.onConnectionUnavailable=this.onConnectionUnavailable),this._communicationAdapter=this._mainProvider}c.prototype=Object.create(a.Base.AbstractNetworkProvider.prototype),c.prototype.start=function(c,d,e,f,g,h){this._failoverCallback=g,this._config=c,this._credentialProvider=d,this._closing=!1,this._failoverPromise&&"resolved"===this._failoverPromise.state()&&(this._failoverPromise=void 0);var i={message:void 0,options:e||{}};return this._credentialProvider&&this._onCredentialsRequired(i),f||(f=new a.Base.NetworkRequestRetryHelper(function(){return this._closing?b.Deferred().reject().promise():this.start(this._config,d,e,f,g,h)}.bind(this))),this._communicationAdapter.start(this._config,this._credentialProvider,i.options,f,h)},c.prototype.send=function(b,c,d){this._logSendMessage(b,c);var e={message:b,options:c};return this._credentialProvider&&this._onCredentialsRequired(e,this._credentialProvider),d||(d=new a.Base.NetworkRequestRetryHelper(function(){return this.send(b,c,d)}.bind(this))),this._communicationAdapter.send(e.message,e.options,d)},c.prototype.close=function(b){return this._closing=!0,b||(b=new a.Base.NetworkRequestRetryHelper(function(){return this.close()}.bind(this))),this._communicationAdapter.close(b)},c.prototype._handleUnauthorized=function(b){var c=b.getDeferred(),d=new a.Config.InvalidCredentialsEvent(this._unauthorizedCount,function(d){this._credentialProvider=d,b.getRequestRetryHelper().getRetryCallback()().then(function(b){this._unauthorizedCount=0,c.resolve(b),this.trigger(a.Base.NetworkProviderEvents.AUTHORIZED,[])}.bind(this),function(b){c.reject(new a.Base.NetworkError(a.Base.ErrorReasons.NETWORK_UNAUTHORIZED,b))})}.bind(this),function(){c.reject(new a.Base.NetworkError(a.Base.ErrorReasons.NETWORK_AUTHORIZATION_CANCELED))}.bind(this));this.trigger(a.Base.NetworkProviderEvents.UNAUTHORIZED,[d]),this._unauthorizedCount++,this._credentialProvider?this._credentialProvider._onInvalidCredentialsProvidedCallbacks.fire(d):c.reject(new a.Base.NetworkError(a.Base.ErrorReasons.NETWORK_UNAUTHORIZED))},c.prototype._handleRedirect=function(b){a.Base.Utils.isDefined(b.getRetryAfter())?(a.Base.Logger.warn(a.Base.LoggerTags.NETWORK_PROVIDER,"Request failed. Retrying after "+b.getRetryAfter()),this._retry(b)):this._handleError(b)},c.prototype._handleError=function(b){var c=new a.Base.NetworkError(a.Base.ErrorReasons.NETWORK_ERROR,b);a.Base.Logger.error(a.Base.LoggerTags.NETWORK_PROVIDER,"Network error occurred. Status: "+b.getStatus()),b.getDeferred().reject(c),this.onError(c)},c.prototype._handleNetworkError=function(b){var c=new a.Base.NetworkError(a.Base.ErrorReasons.NETWORK_ERROR,b);a.Base.Logger.error(a.Base.LoggerTags.NETWORK_PROVIDER,"Network error occurred. Status: "+b.getStatus()),b.getDeferred().reject(c),this.onError(c)},c.prototype.registerBlackList=function(a){this._blackList=a},c.prototype._retry=function(b){b.getRequestRetryHelper().incrementCounter();var c=b.getDeferred(),d=b.getRetryAfter(),e=b.getRequestRetryHelper().getRetryCounter();d&&e<this._config.maxConnectionErrorCount?(setTimeout(function(){b.getRequestRetryHelper().getRetryCallback()().then(c.resolve,c.reject)},d),c.notify(a.Base.NetworkProviderEvents.RETRYING)):this._handleError(b)},c.prototype._logSendMessage=function(c,d){var e=["PROVIDER:",this._communicationAdapter.type],f=d;if(this._communicationAdapter.type&&this._communicationAdapter.type!==a.Base.ProviderTypes.WEB_SOCKET_PROVIDER){f=b.extend({},this._communicationAdapter.defaultOptions,d);var g=this._communicationAdapter._getServerURL(f);e.push("URL:",g)}if(c instanceof ArrayBuffer)e.push("BYTE LENGTH SENT:",c.byteLength);else{var h;try{h=this._generateLoggedMessage(c)}catch(j){h="Failed to generate sent message "+j}e.push("MESSAGE SENT:",h)}var i;try{i=this._generateLoggedMessage(f)}catch(j){i="Failed to generate sent options "+j}e.push("OPTIONS SENT:",i),a.Base.Logger.debug.call(this,a.Base.LoggerTags.NETWORK_PROVIDER,e)},c.prototype.isOpened=function(){return this._communicationAdapter.isOpened()},c.prototype.getBufferedAmount=function(){return this._communicationAdapter.getBufferedAmount()},c.prototype._generateLoggedMessage=function(a){if(a){a=a.data||a;var c;if("string"==typeof a){var d=this._blackList.join("|");if(this._isXML(a)){var e=new RegExp("("+d+')="(.*?)"',"mig");c=a.replace(e,'$1="REMOVED"');this._blackList.reduce(function(a,b){return c.indexOf("<"+b)>-1&&a.push(b),a},[]).forEach(function(a){var b=new RegExp("(?:(<"+a+"(?:[\\s\\S]*?))(\\/>))|(?:(<"+a+"(?:[\\s\\S]*?)>)([\\s\\S]*?)(</"+a+">))","mig");c=c.replace(b,"$1$2$3$5")})}else if(this._isJSON(a))c=JSON.parse(a),this._removeFromObject(c),c=JSON.stringify(c);else{var f=new RegExp("((?:"+d+")=)(.*?)([&]|$)","mig");c=a.replace(f,"$1REMOVED$3")}}else a instanceof Uint8Array?c="Uint8Array["+a.length+"]":"object"==typeof a&&(c=b.extend(!0,{},a),this._removeFromObject(c),c=JSON.stringify(c));return c}},c.prototype._isXML=function(a){return a=a.trim(),0===a.indexOf("<?xml")},c.prototype._isJSON=function(a){return a=a.trim(),0===a.indexOf("{")||0===a.indexOf("[")},c.prototype._removeFromObject=function(a){Object.keys(a).forEach(function(b){if(this._removeFromLogs(b))a[b]="REMOVED";else if("string"!=typeof a[b]&&null!==a[b]&&Object.keys(a[b]).length)this._removeFromObject(a[b]);else if("string"==typeof a[b]&&this._isJSON(a[b])){var c=JSON.parse(a[b]);this._removeFromObject(c),a[b]=JSON.stringify(c)}}.bind(this))},c.prototype._removeFromLogs=function(a){return this._blackList.indexOf(a)>-1},c.prototype.run=function(a){return this._communicationAdapter.run(a)},c.prototype.stopMonitorFallback=function(){this._fallbackProvider&&(this._fallbackProvider.close(),this._fallbackProvider=void 0),this._failoverCallback=void 0},c.prototype._executeFailoverCallback=function(){return this._closing||this._failoverPromise||"function"!=typeof this._failoverCallback||(this._failoverPromise=this._failoverCallback().always(function(){this._failoverPromise=void 0}.bind(this))),this._failoverPromise},a.Base.NetworkProvider=c}(AvayaClientServices,jQuery),function(a){"use strict";function b(){var b,d=this;this._url="",this._interval=1e3,this.startPolling=function(e,f,g,h){this._url=e,this._interval=f,b=setInterval(function(){a.Base.Logger.info(a.Base.LoggerTags.REST_NETWORK_PROVIDER,"polling "+d._url),c(d._url,g,h,function(a){d.onMessage({data:a})},function(a){d.onError(a)})},d._interval)},this.stopPolling=function(){clearInterval(b)}}function c(b,c,d,e,f){var g={type:"GET",url:b,dataType:"text",data:$.param(c)};if(a.Base.Utils.isDefined(d)&&(d.crossDomain&&!0===d.crossDomain&&(g.xhrFields={withCredentials:!0},g.crossDomain=!0),d.authentication&&"Basic"===d.authentication.type)){var h="Basic "+btoa(d.authentication.username+":"+d.authentication.password);g.beforeSend=function(a){a.setRequestHeader("Authorization",h)}}return $.ajax(g).then(e,f)}a.Providers=a.Providers||{},b.prototype=Object.create(a.Base.AbstractNetworkProvider.prototype),a.Base.PollingRESTProvider=b}(AvayaClientServices),function(a,b){"use strict";function c(){a.Base.AbstractNetworkProvider.call(this),this.type=a.Base.ProviderTypes.REST_PROVIDER,this._xhrPool=[],this._protocolTypes={secure:"https",nonSecure:"http"}}c.prototype=Object.create(a.Base.AbstractNetworkProvider.prototype),c.prototype.defaultOptions={url:void 0,sendType:"POST",timeout:3e4,urlSuffix:"",dataType:"text",headers:{},processData:!0},c.prototype.start=function(b,c,d,e){return a.Base.AbstractNetworkProvider.prototype.start.call(this,b.restConfig,c,d,e)},c.prototype.send=function(c,d,e){var f,g=b.extend({},this.defaultOptions,d),h=this._getServerURL(g),i={url:h,type:g.sendType,timeout:g.timeout,dataType:g.dataType,jsonp:!1,headers:g.headers,processData:g.processData,beforeSend:function(a){a.withCredentials=!0,this._xhrPool.push(a),f=a}.bind(this)};if(g.binaryProgressCallback&&(i.binaryProgressCallback=g.binaryProgressCallback),g.keepAliveCallback&&(i.keepAliveCallback=g.keepAliveCallback),g.responseType&&(i.responseType=g.responseType),c&&(i.data=c),g.crossDomain&&!0===g.crossDomain&&(i.crossDomain=!0),a.Base.Utils.isDefined(g.async)&&!0!==g.async||(i.xhrFields={withCredentials:!0}),g.contentType&&(i.contentType=g.contentType),g.authentication&&("Basic"===g.authentication.type||"Bearer"===g.authentication.type)){var j;j="Basic"===g.authentication.type?"Basic "+btoa(g.authentication.username+":"+g.authentication.password):"Bearer "+g.authentication.token,i.beforeSend=function(a){a.withCredentials=!0,a.setRequestHeader("Authorization",j),this._xhrPool.push(a),f=a}.bind(this)}return g.cancel&&(i.cancel=function(){f.abort(new a.Base.NetworkError(a.Base.ErrorReasons.NETWORK_CANCELED))}),a.Base.Utils.isDefined(g.async)&&!1===g.async?(i.async=!1,this._sendSync(i)):this._sendAsync(i,e)},c.prototype._sendAsync=function(c,d){var e=b.Deferred();return b.ajax(c).then(function(a,b,c){this._ajaxOnSuccess(a,b,c,e)}.bind(this),function(b,c,f){0===b.status&&(b.status=a.Base.NetworkErrorCodes.HTTP_NETWORK_ERROR),this._ajaxOnError(b,c,f,e,d)}.bind(this)),e.promise()},c.prototype._sendSync=function(c){var d=b.Deferred();return c.success=function(a,b,c){this._ajaxOnSuccess(a,b,c,d)}.bind(this),c.error=function(b,c,e){0===b.status&&(b.status=a.Base.NetworkErrorCodes.HTTP_NETWORK_ERROR),this._ajaxOnError(b,c,e,d)}.bind(this),b.ajax(c),d.promise()},c.prototype._ajaxOnSuccess=function(a,b,c,d){return this._removeXhrFromPool(c),this.onMessage(a,c),d.resolve(a,c),a},c.prototype._ajaxOnError=function(b,c,d,e,f){var g=new a.Base.NetworkErrorEvent(f,e,b.status,b.responseText,b.getResponseHeader("Retry-After"));if(this.hasListeners(b.status))this.trigger(b.status,[g]);else{this.onError(c);var h=new a.Base.NetworkError(a.Base.ErrorReasons.NETWORK_ERROR,new a.Base.NetworkErrorEvent(void 0,void 0,b.status,b.responseText));e.reject(h,b)}return this._removeXhrFromPool(b),b},c.prototype.close=function(){return this._xhrPool.forEach(function(a){a.abort()}),this._xhrPool=[],this.onClose(),b.Deferred().resolve().promise()},c.prototype._removeXhrFromPool=function(a){this._xhrPool.indexOf(a)>-1&&this._xhrPool.splice(this._xhrPool.indexOf(a),1)},a.Base.RESTProvider=c}(AvayaClientServices,jQuery),function(a){"use strict";function b(b,c){function d(b,c){b.onOpen=function(a){c.onOpen(a)},b.onMessage=function(b,d){b&&b.type===a.Base.ProvidersEventTypes.PING&&c._keepAlive(),c.onMessage(b,d)},b.onClose=function(a){c.onClose(a)},b.onError=function(a){c.onError(a)},b.onConnectionUnavailable=function(a){c.onConnectionUnavailable(a)};for(var d in a.Base.NetworkErrorCodes)a.Base.NetworkErrorCodes.hasOwnProperty(d)&&b.on(a.Base.NetworkErrorCodes[d],c._triggerErrors.bind(c))}a.Base.AbstractNetworkProvider.apply(this),this.type=a.Base.ProviderTypes.SSE_PROVIDER,this._restProvider=b,this._sseProvider=c,this._onCredentialsRequired=function(){},d(this._restProvider,this),d(this._sseProvider,this),this._config={},this._credentialProvider={},this._keepAliveTimeout=void 0,this._failoverPingData=void 0}b.prototype=Object.create(a.Base.AbstractNetworkProvider.prototype),b.prototype.onConnectionUnavailable=function(){},b.prototype.start=function(a,b,c,d,e){this._config=a,this._credentialProvider=b,this._failoverPingData=e;var f={message:void 0,options:c};this._credentialProvider&&this._onCredentialsRequired(f);var g=this._sseProvider.start(this._config,this._credentialProvider,f.options,d),h=this._restProvider.start(this._config,this._credentialProvider,f.options,d);return $.when(g,h).done(function(){this._keepAlive()}.bind(this)).fail(function(){this.close(),setTimeout(function(){this.onConnectionUnavailable()}.bind(this))}.bind(this))},b.prototype.send=function(a,b,c){var d={message:a,options:b};return this._credentialProvider&&this._onCredentialsRequired(d),this._restProvider.send(d.message,d.options,c)},b.prototype.close=function(){return $.when(this._restProvider.close(),this._sseProvider.close())},b.prototype.isOpened=function(){return this._sseProvider.isOpened()},b.prototype._triggerErrors=function(a){this.trigger(a._status,[a])},b.prototype._keepAlive=function(){this._keepAliveTimeout&&clearTimeout(this._keepAliveTimeout),this._failoverPingData&&this._failoverPingData.ssePingInterval&&(this._keepAliveTimeout=setTimeout(function(){this.close(),clearTimeout(this._keepAliveTimeout),this.onConnectionUnavailable()}.bind(this),this._failoverPingData.ssePingInterval))},a.Base.SSEIntegrationProvider=b}(AvayaClientServices),function(a){"use strict";function b(b){a.Base.AbstractNetworkProvider.apply(this),this._stream=void 0,this._isOpened=!1,this._isShutdown=!1,this._eventTypes=b||[],this._protocolTypes={secure:"https",nonSecure:"http"}}b.prototype=Object.create(a.Base.AbstractNetworkProvider.prototype),b.prototype.start=function(a,b,c){var d=$.Deferred();return this._isOpened?(this.onOpen(),d.resolve()):(this._maxConnectionErrorCount=a.maxConnectionErrorCount,this._config=a.sseConfig,this._isShutdown=!1,this._credentialProvider=b,this._createStream(c,d)),d.promise()},b.prototype.close=function(){this._isShutdown=!0,this._isOpened?(this._stream.close(),this._isOpened=!1):this.onClose(),this._stream=void 0},b.prototype.isOpened=function(){return this._isOpened&&1===this._stream.readyState},b.prototype._createStream=function(b,c){this._isOpening=!0,this._stream=new EventSource(this._getServerURL(b),{withCredentials:!0}),this._stream.onopen=function(){this._isOpening=!1,this._isShutdown?(this._stream.close(),c.reject()):(this._isOpened=!0,this.onOpen(),c.resolve())}.bind(this),this._stream.onerror=function(b){(a.Base.Utils.isUndefined(b.readyState)||b.readyState===EventSource.CLOSED&&!this._isOpening)&&(this._isOpened=!1,this._stream.close(),this._stream=void 0,this.onClose()),c.reject(),this.onError(b)}.bind(this);for(var d=0;d<this._eventTypes.length;d++)this._stream.addEventListener(this._eventTypes[d],function(a){this.onMessage(a)}.bind(this))},a.Base.SSEProvider=b}(AvayaClientServices),function(a){"use strict";function b(){a.Base.AbstractNetworkProvider.apply(this),this.type=a.Base.ProviderTypes.WEB_SOCKET_PROVIDER,this._socket=void 0,this._isOpened=!1,this._isShutdown=!1,this._isOnConnectionUnavailableShutdown=!1,this._protocolTypes={secure:"wss",nonSecure:"ws"},this._failoverPingData=void 0,this._keepAliveTimeout=void 0,this._keepAliveAnswerWaitingTimeout=void 0}b.prototype=Object.create(a.Base.AbstractNetworkProvider.prototype),b.prototype.onConnectionUnavailable=function(){},b.prototype.start=function(a,b,c,d,e){var f=$.Deferred();return this._failoverPingData=e,this._isOpened?(f.resolve(),this.onOpen()):(this._config=a.webSocketConfig,this._maxConnectionErrorCount=a.maxConnectionErrorCount,this._isShutdown=!1,this._isOnConnectionUnavailableShutdown=!1,this._credentialProvider=b,void 0===window.WebSocket?(f.reject(),setTimeout(function(){this.onConnectionUnavailable()}.bind(this))):this._createSocket(c,d,f)),f.promise()},b.prototype.send=function(a,b,c){var d=$.Deferred();return this.isOpened()?(this._socket.send(a),d.resolve()):d.reject("Socket is not opened!"),d.promise()},b.prototype.close=function(){this._isShutdown=!0,this._isOpened?(this._stopKeepAlive(),this._socket.close(),this._isOpened=!1):this.onClose(),this._socket=void 0},b.prototype.isOpened=function(){return this._isOpened&&1===this._socket.readyState},b.prototype.getBufferedAmount=function(){return this._socket?this._socket.bufferedAmount:0},b.prototype._createSocket=function(b,c,d){this._isOpening=!0;var e=b?b.wsSecureProtocolData:void 0;this._socket=new WebSocket(this._getServerURL(b),e),this._socket.binaryType="arraybuffer",this._socket.onopen=function(){this._isOpening=!1,this._isShutdown?this._socket&&this._socket.close():(this._isOpened=!0,d.resolve(),a.Base.Utils.isDefined(this._failoverPingData)&&this._failoverPingData.wsKeepAliveEnabled&&this._keepAlive(),this.onOpen())}.bind(this),this._socket.onmessage=function(b){a.Base.Utils.isDefined(this._failoverPingData)&&this._failoverPingData.wsKeepAliveEnabled&&this._failoverPingData.wsIsPongMessage(b)&&(clearTimeout(this._keepAliveAnswerWaitingTimeout),this._keepAliveAnswerWaitingTimeout=void 0,this._keepAlive()),this.onMessage(b)}.bind(this),this._socket.onclose=function(b){if(this._stopKeepAlive(),b.code===a.Base.NetworkErrorCodes.WEBSOCKET_UNAUTHORIZED&&this._isOpened&&!this._isOnConnectionUnavailableShutdown)setTimeout(function(){this.onConnectionUnavailable()}.bind(this),0);else if(b.code!==a.Base.NetworkErrorCodes.WEBSOCKET_CLOSE_NORMAL&&!this._isOnConnectionUnavailableShutdown&&this.hasListeners(b.code)){var e=new a.Base.NetworkErrorEvent(c,d,b.code);this.trigger(b.code,[e])}this._isOpening||(d.reject(),this._isOpened=!1,this._socket=void 0,this.onClose()),this._isOpened||this._isShutdown||(d.reject(),setTimeout(function(){this.onConnectionUnavailable()}.bind(this)))}.bind(this),this._socket.onerror=function(a){d.reject(),this.onError(a),this.onConnectionUnavailable(a)}.bind(this)},b.prototype._keepAlive=function(){a.Base.Utils.isDefined(this._failoverPingData)&&a.Base.Utils.isDefined(this._failoverPingData.wsPingInterval)&&(this._keepAliveTimeout=setTimeout(function(){var a=this._failoverPingData.wsGeneratePingMessage();this.send(a),this._keepAliveAnswerWaitingTimeout=setTimeout(function(){this._isOnConnectionUnavailableShutdown=!0,this.close(),this.onConnectionUnavailable()}.bind(this),this._failoverPingData.keepAliveAnswerWaitingTime)}.bind(this),this._failoverPingData.wsPingInterval))},b.prototype._stopKeepAlive=function(){a.Base.Utils.isDefined(this._keepAliveTimeout)&&(clearTimeout(this._keepAliveTimeout),this._keepAliveTimeout=void 0),a.Base.Utils.isDefined(this._keepAliveAnswerWaitingTimeout)&&(clearTimeout(this._keepAliveAnswerWaitingTimeout),this._keepAliveAnswerWaitingTimeout=void 0)},a.Base.WebSocketProvider=b}(AvayaClientServices),function(a){"use strict";function b(){this.defaultMessage="One or more elements in provided array are not compatible with required type."}b.prototype=Object.create(a.Base.Validators.BaseValidator.prototype),b.prototype.validate=function(a,b,c){var d=a.filter(function(a){return typeof a===b.expected||"object"==typeof a&&a instanceof b.expected}),e=d.length===a.length;return this._processCondition(e,a,b,c)},a.Base.Validators.ArrayElementTypeValidator=b}(AvayaClientServices),function(a){"use strict";var b={resolution1080p:new a.Base.VideoResolutionDetails(1920,1080,1792,9999),resolution720p:new a.Base.VideoResolutionDetails(1280,720,1024,1792),resolution480p:new a.Base.VideoResolutionDetails(848,480,640,1024),resolution360p:new a.Base.VideoResolutionDetails(640,360,384,640),resolution240p:new a.Base.VideoResolutionDetails(416,240,256,384),resolution180p:new a.Base.VideoResolutionDetails(320,180,128,256)};a.Base.VideoResolution=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d){a.Providers.Interfaces.AbstractProvider.call(this),this._acsNetworkProvider=b,this._contactsConverter=c,this._requestBuilder=d,this._state=a.Providers.ACS.ACSProviderStates.STOPPED,this._allowedCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._deniedCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._contactsCapability=this._deniedCapability,this._resolveContactsCapability=this._deniedCapability,this._terminalCapability=this._deniedCapability,this._blackListedWords=["userEmail","contactIdentifier","contactUrl","surName","givenName","displayName","asciiGivenName","asciiSurName","asciiDisplayName","isBuddy","favourite","notes","instantConnection","videoCapable","phoneNumberList","emailAddresses","preferredLanguage","type","rank","updatedTimestamp","alias","imaddresses","company","location","streetAddress","city","state","country","postalCode","manager","department","workRoomNo","value","Authorization","editable","isPrimary","searchCriteria","maxResults","data","contacts"]}b.prototype=Object.create(a.Providers.Interfaces.AbstractProvider.prototype),b.prototype.getProviderType=function(){return"ACS"},b.prototype.start=function(b,c){var d=$.Deferred();return this._changeState(a.Providers.ACS.ACSProviderStates.STARTING).then(function(){this._acsNetworkProvider.registerBlackList(this._blackListedWords),this._acsNetworkProvider.on(a.Base.NetworkProviderEvents.UNAUTHORIZED,function(){this.trigger(a.Base.NetworkProviderEvents.UNAUTHORIZED,[])}.bind(this)),this._acsNetworkProvider.on(a.Base.NetworkProviderEvents.AUTHORIZED,function(){this.trigger(a.Base.NetworkProviderEvents.AUTHORIZED,[])}.bind(this)),c.addOnContactsServiceAvailableCallback(function(){this.recalculateCapabilities()}.bind(this)),c.addOnContactsServiceUnavailableCallback(function(){this.recalculateCapabilities()}.bind(this)),this._acsNetworkProvider.start(b.acsConfiguration,c).then(function(){this._changeState(a.Providers.ACS.ACSProviderStates.STARTED).then(function(){this.recalculateCapabilities(),this._acsNetworkProvider.on("acs_availability_changed",this.recalculateCapabilities.bind(this)),d.resolve()}.bind(this),function(a){d.reject(a)})}.bind(this),function(b){a.Base.Logger.error(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Failed to start ACSNetworkProvider",b),d.reject(b)})}.bind(this),function(a){d.reject(a)}),d.promise()},b.prototype.stop=function(){var b=$.Deferred();return this._changeState(a.Providers.ACS.ACSProviderStates.STOPPING).always(function(){this._acsNetworkProvider.stopIfNoSubscriptions().then(function(){
this._changeState(a.Providers.ACS.ACSProviderStates.STOPPED),b.resolve()}.bind(this),function(c){a.Base.Logger.warn(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"acsNetworkProvider stop if no subscriptions was failed",c),b.reject(c)})}.bind(this)),b.promise().always(function(){this.recalculateCapabilities(),this._removeListeners()}.bind(this))},b.prototype._changeState=function(b){return b!==this._state?(this._state=b,this._handleStateChange(b).fail(function(c){a.Base.Logger.warn(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Failed to change state to "+b,c)})):$.Deferred().resolve().promise()},b.prototype._handleStateChange=function(a){return $.Deferred().resolve().promise()},b.prototype.recalculateCapabilities=function(){var b=this._deniedCapability,c=this._deniedCapability,d=this._deniedCapability,e=this._acsNetworkProvider.getResources();this._acsNetworkProvider.isAcsAvailable()&&(e.capabilities&&e.capabilities.indexOf("contacts")>=0&&(b=this._allowedCapability,!0===e.v2MediaType&&(c=this._allowedCapability)),e.contactSearchCapabilities&&e.contactSearchCapabilities.indexOf("terminal")>=0&&(d=this._allowedCapability)),this._contactsCapability===b&&this._resolveContactsCapability===c&&this._terminalCapability===d||(this._contactsCapability=b,this._resolveContactsCapability=c,this._terminalCapability=d,this.trigger(a.Providers.Interfaces.ContactsProviderCallbackIds.CAPABILITIES_CHANGED))},a.Providers.ACS.ACSBaseProviderV1=b}(AvayaClientServices),function(a,b){"use strict";function c(){a.Providers.Interfaces.ContactsProvider.call(this),this._providers={},this._selectedProvider=void 0,this._userConfig={}}c.prototype=b.extend({},a.Providers.Interfaces.ContactsProvider.prototype),c.prototype.registerACSContactsProvider=function(b,c){c.on(a.Base.NetworkProviderEvents.AUTHORIZED,function(){this.trigger(a.Base.NetworkProviderEvents.AUTHORIZED,[])}.bind(this)),c.on(a.Base.NetworkProviderEvents.UNAUTHORIZED,function(){this.trigger(a.Base.NetworkProviderEvents.UNAUTHORIZED,[])}.bind(this)),this._providers[b]=c},c.prototype.start=function(a,c){b.isEmptyObject(a)||this._userConfig===a||(this._userConfig=a);var d=this._determineServerVersion();return this._selectedProvider=this._providers[d],this._selectedProvider.start(a,c)},c.prototype._determineServerVersion=function(){return 1},c.prototype.getProviderType=function(){return this._selectedProvider.getProviderType()},c.prototype.stop=function(){return this._selectedProvider?this._selectedProvider.stop():b.Deferred().resolve().promise()},c.prototype.createContactForAdd=function(){return this._selectedProvider.createContactForAdd()},c.prototype.addContact=function(a){return this._selectedProvider.addContact(a)},c.prototype.updateContact=function(a){return this._selectedProvider.updateContact(a)},c.prototype.deleteContact=function(a){return this._selectedProvider.deleteContact(a)},c.prototype.retrieveAllContacts=function(){return this._selectedProvider.retrieveAllContacts()},c.prototype.getContactsChanges=function(){return this._selectedProvider.getContactsChanges()},c.prototype.getAddContactCapability=function(){return this._selectedProvider.getAddContactCapability()},c.prototype.getUpdateContactCapability=function(){return this._selectedProvider.getUpdateContactCapability()},c.prototype.getDeleteContactCapability=function(){return this._selectedProvider.getDeleteContactCapability()},c.prototype.getExtendedContactDetailsCapability=function(){return this._selectedProvider.getExtendedContactDetailsCapability()},c.prototype.addOnContactAddedCallback=function(a){return this._selectedProvider.addOnContactAddedCallback(a)},c.prototype.removeOnContactAddedCallback=function(a){return this._selectedProvider.removeOnContactAddedCallback(a)},c.prototype.addOnContactUpdatedCallback=function(a){return this._selectedProvider.addOnContactUpdatedCallback(a)},c.prototype.removeOnContactUpdatedCallback=function(a){return this._selectedProvider.removeOnContactUpdatedCallback(a)},c.prototype.addOnContactDeletedCallback=function(a){return this._selectedProvider.addOnContactDeletedCallback(a)},c.prototype.removeOnContactDeletedCallback=function(a){return this._selectedProvider.removeOnContactDeletedCallback(a)},c.prototype.on=function(b,c){return this._selectedProvider?this._selectedProvider.on(b,c):a.Providers.Interfaces.ContactsProvider.prototype.on.call(this,b,c)},c.prototype.off=function(a,b){return this._selectedProvider.off(a,b)},a.Providers.ACS.ACSContactsProvider=c}(AvayaClientServices,jQuery),function(a,b){"use strict";function c(b,c,d){a.Providers.Interfaces.ContactsProvider.call(this),a.Providers.ACS.ACSBaseProviderV1.call(this,b,c,d),this._subscribedForNotifications=!1,this._contactsCache=new a.Base.ElementCache,this._contactsCache.on(a.Base.ElementCacheEvents.ELEMENT_ADDED,function(b){var c=b.map(function(a){return this._contactsConverter.convertACSContactV1toContact(a)}.bind(this));this.trigger(a.Providers.Interfaces.ContactsProviderCallbackIds.CONTACT_ADDED,[c,this])}.bind(this)),this._contactsCache.on(a.Base.ElementCacheEvents.ELEMENT_UPDATED,function(b){this.trigger(a.Providers.Interfaces.ContactsProviderCallbackIds.CONTACT_UPDATED,[this._contactsConverter.convertACSContactV1toContact(b),this])}.bind(this)),this._contactsCache.on(a.Base.ElementCacheEvents.ELEMENT_DELETED,function(b){var c=b.map(function(a){return this._contactsConverter.convertACSContactV1toContact(a)}.bind(this));this.trigger(a.Providers.Interfaces.ContactsProviderCallbackIds.CONTACT_DELETED,[c,this])}.bind(this))}c.prototype=b.extend({},a.Providers.Interfaces.ContactsProvider.prototype,a.Providers.ACS.ACSBaseProviderV1.prototype),c.prototype.createContactForAdd=function(){var b=new a.Services.Contacts.EditableContact,c=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED);return b.getCustom1()._setWriteCapability(c),b.getCustom2()._setWriteCapability(c),b.getCustom3()._setWriteCapability(c),b.getScopiaUserId()._setWriteCapability(c),b.getScopiaLoginId()._setWriteCapability(c),b},c.prototype.addContact=function(a){var b=this._contactsConverter.convertContactToACSContactV1(a),c=this._requestBuilder.buildAddUpdateContactData(b),d=this._requestBuilder.buildAddContactOptions();return this._acsNetworkProvider.send(c,d).then(this._onContactAdded.bind(this))},c.prototype._onContactAdded=function(a){a=this._contactsConverter.extendAcsContact(a),a.contactUrl&&a.contactUrl.value&&this._contactsCache.addElement(a.contactUrl.value,a)},c.prototype.updateContact=function(c){var d=this._contactsCache.getElement(c._uniqueAddressForMatching);if(!d)return a.Base.Logger.error(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Can not update contact because its old version is not found in cache"),b.Deferred().reject(new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.INTERNAL_ERROR));var e=this._contactsConverter.mergeContactWithACSContactV1(c,d),f=this._requestBuilder.buildAddUpdateContactData(e),g=this._requestBuilder.buildUpdateContactOptions();return this._acsNetworkProvider.send(f,g).then(this._onContactUpdated.bind(this))},c.prototype._onContactUpdated=function(a){a=this._contactsConverter.extendAcsContact(a),a.contactUrl&&a.contactUrl.value&&this._contactsCache.updateElement(a.contactUrl.value,a)},c.prototype.deleteContact=function(a){var b=this._requestBuilder.buildDeleteContactOptions(a._uniqueAddressForMatching);return this._acsNetworkProvider.send(null,b).then(function(){this._onContactDeleted(a._uniqueAddressForMatching)}.bind(this))},c.prototype._onContactDeleted=function(a){a&&this._contactsCache.deleteElement(a)},c.prototype.retrieveAllContacts=function(){return this._getContacts().then(function(){this._subscribeForContactChangesNotifications()}.bind(this),function(a){return b.Deferred().reject(a).promise()},function(a){return this._applyContactsToCache(a.contacts,!0),this._contactsConverter.convertACSContactArraytoContactArray(a.contacts)}.bind(this))},c.prototype._subscribeForContactChangesNotifications=function(){if(!this._subscribedForNotifications){this._subscribedForNotifications=!0;var b=this._requestBuilder.buildSubscribeForACSNotifications(a.Providers.ACS.ACSConstants.SVC_GET_CONTACTS);this._acsNetworkProvider.subscribeForNotifications(b,this._onContactChangeNotification.bind(this)).fail(function(b){this._subscribedForNotifications=!1,a.Base.Logger.error(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Failed to subscribe for contact changes notifications",b)}.bind(this))}},c.prototype._unsubscribeFromContactChangesNotifications=function(){var c;if(this._subscribedForNotifications){this._subscribedForNotifications=!1;var d=this._requestBuilder.buildUnsubscribeFromACSNotifications(a.Providers.ACS.ACSConstants.SVC_GET_CONTACTS);c=this._acsNetworkProvider.unsubscribeFromNotifications(d).fail(function(b){this._subscribedForNotifications=!0,a.Base.Logger.warn(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Failed to unsubscribe from contact changes notifications: "+JSON.stringify(b))}.bind(this))}else c=b.Deferred().resolve().promise();return c},c.prototype._onContactChangeNotification=function(b){if(this._isContactChangeNotificationValid(b))if(b.action===a.Providers.ACS.ACSContentsActions.DELETE)this._onContactDeleted(b.url);else if(b.action===a.Providers.ACS.ACSContentsActions.REFRESH)this.retrieveAllContacts();else{var c;if(b.action===a.Providers.ACS.ACSContentsActions.ADD)c=this._onContactAdded;else if(b.action===a.Providers.ACS.ACSContentsActions.UPDATE){var d=this._contactsCache.getElement(b.url);if(!d)return void a.Base.Logger.error(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Received notification for unknown contact");c=this._onContactUpdated}var e=this._requestBuilder.buildGetContactOptions(b.url);this._acsNetworkProvider.send(null,e).then(c.bind(this),function(b){a.Base.Logger.error(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Failed to download contact list updates: "+JSON.stringify(b))})}},c.prototype._isContactChangeNotificationValid=function(b){return b&&b.action&&b.url?""===b.url?(a.Base.Logger.error(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Received notification with empty URL"),!1):!!function(){for(var c in a.Providers.ACS.ACSContentsActions)if(a.Providers.ACS.ACSContentsActions.hasOwnProperty(c)&&b.action===a.Providers.ACS.ACSContentsActions[c])return!0;return!1}()||(a.Base.Logger.error(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Received notification with unknown or empty type: "+b.action),!1):(a.Base.Logger.error(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Received notification in unexpected format: "+JSON.stringify(b)),!1)},c.prototype._applyContactsToCache=function(b,c){for(var d=b.length,e=[],f=0;f<d;f++)b[f].contactUrl&&b[f].contactUrl.value?e.push({elementId:b[f].contactUrl.value,element:this._contactsConverter.extendAcsContact(b[f])}):a.Base.Logger.warn(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Received contact does not have contactUrl set, ignoring it",b[f]);this._contactsCache.applyElements(e,c)},c.prototype._getContacts=function(){var c=b.Deferred(),d=this._requestBuilder.buildGetContactsOptions(),e=function(b){a.Base.Logger.error(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Failed to retrieve contacts",b),c.reject(b)},f=function(b){if(!b)return c.resolve();if(c.notify(b),b.hasMoreResults){var g=b.contacts.length-1,h=b.contacts[g].id.value;if(!h)return a.Base.Logger.warn(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,'Last contact of the partial response to retrieve contacts request does not have "id" property set (required for consequent requests)',b.contacts[g]),c.reject(new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.INVALID_SERVER_RESPONSE));d=this._requestBuilder.buildGetContactsOptions(h),this._acsNetworkProvider.send(null,d).then(f.bind(this),e)}else c.resolve()};return this._acsNetworkProvider.send(null,d).then(f.bind(this),e),c.promise()},c.prototype.getContactsChanges=function(){},c.prototype.getAddContactCapability=function(){return this._contactsCapability},c.prototype.getUpdateContactCapability=function(){return this._contactsCapability},c.prototype.getDeleteContactCapability=function(){return this._contactsCapability},c.prototype.getExtendedContactDetailsCapability=function(){return this._contactsCapability},c.prototype._handleStateChange=function(c){var d;switch(c){case a.Providers.ACS.ACSProviderStates.STOPPING:d=this._unsubscribeFromContactChangesNotifications();break;case a.Providers.ACS.ACSProviderStates.STOPPED:this._contactsCache.empty(),d=b.Deferred().resolve().promise();break;default:d=b.Deferred().resolve().promise()}return d},a.Providers.ACS.ACSContactsProviderV1=c}(AvayaClientServices,jQuery),function(a,b){"use strict";function c(){a.Providers.Interfaces.DirectorySearchProvider.call(this),this._providers={},this._selectedProvider=void 0,this._userConfig={}}c.prototype=b.extend({},a.Providers.Interfaces.DirectorySearchProvider.prototype),c.prototype.registerACSDirectorySearchProvider=function(a,b){this._providers[a]=b},c.prototype.start=function(a,c){b.isEmptyObject(a)||this._userConfig===a||(this._userConfig=a);var d=this._determineServerVersion();return this._selectedProvider=this._providers[d],this._selectedProvider.start(a,c)},c.prototype._determineServerVersion=function(){return 1},c.prototype.getProviderType=function(){return this._selectedProvider.getProviderType()},c.prototype.stop=function(){return this._selectedProvider?this._selectedProvider.stop():b.Deferred().resolve().promise()},c.prototype.startDirectorySearch=function(a){return this._selectedProvider.startDirectorySearch(a)},c.prototype.stopDirectorySearch=function(a){return this._selectedProvider.stopDirectorySearch(a)},c.prototype.startResolvingContacts=function(a,b){return this._selectedProvider.startResolvingContacts(a,b)},c.prototype.getNetworkSearchContactCapability=function(){return this._selectedProvider.getNetworkSearchContactCapability()},c.prototype.getNetworkResolveContactsCapability=function(){return this._selectedProvider.getNetworkResolveContactsCapability()},c.prototype.getNetworkSearchTerminalCapability=function(){return this._selectedProvider.getNetworkSearchTerminalCapability()},c.prototype.on=function(a,b){return this._selectedProvider.on(a,b)},c.prototype.off=function(a,b){return this._selectedProvider.off(a,b)},c.prototype.getSelfContact=function(){return this._selectedProvider.getSelfContact()},a.Providers.ACS.ACSDirectorySearchProvider=c}(AvayaClientServices,jQuery),function(a,b){"use strict";function c(b,c,d,e,f){a.Providers.Interfaces.DirectorySearchProvider.call(this),a.Providers.ACS.ACSBaseProviderV1.call(this,b,c,d),this._activeSearches={},this._searchResultsQueue=new a.Base.ElementCache({maxElements:50}),this._acsContactsCache=f,this._contactsAnalyticsService=e}c.prototype=b.extend({},a.Providers.Interfaces.DirectorySearchProvider.prototype,a.Providers.ACS.ACSBaseProviderV1.prototype),c.prototype.startDirectorySearch=function(c){var d=b.Deferred(),e=this._requestBuilder.buildSearchContactsOptions(),f=this._requestBuilder.buildSearchContactsData(c);return this._acsNetworkProvider.send(f,e).then(function(b){if(!b||!b.searchId)return a.Base.Logger.error(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Server returned invalid response to search contacts request",b),this._contactsAnalyticsService.trackContactProvidersUnavailable(a.Services.Contacts.ContactsErrorReason.INVALID_SERVER_RESPONSE),d.reject(new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.INVALID_SERVER_RESPONSE));this._activeSearches[b.searchId]={searchRequestId:c.getUniqueSearchId(),deferred:d},this.startSearchTimer(b.searchId),this._processQueuedNotifications(b.searchId)}.bind(this),function(b){return a.Base.Logger.error(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Search contacts request failed",b),d.reject(b)}.bind(this)),d.promise()},c.prototype.startResolvingContacts=function(c,d){var e,f=[],g=this._requestBuilder.buildQuickSearchContactsOptions(),h=[],i=[],j=b.Deferred();for(e=0;e<c.length;e++){var k=this._acsContactsCache.getQuickSearchResultsFromCache(c[e],d);if(k.length>0)for(var l=0;l<k.length;l++)i.push(k[l]);else h.push(c[e])}i.length&&j.notify(i),j.resolve(),f.push(j.promise());var m=this._splitQuickSearchCriteriaStrings(h,50);for(e=0;e<m.length;e++){var n=this._sendQuickSearchRequest(m[e],d,g);f.push(n)}return a.Base.Utils.waitForAllPromisesCompletion(f)},c.prototype._sendQuickSearchRequest=function(c,d,e){var f=b.Deferred(),g=this._requestBuilder.buildQuickSearchContactsData(c,d);return this._acsNetworkProvider.send(g,e).then(function(b){var e;try{e=JSON.parse(b).searchId}catch(g){e="string"==typeof b?b:null}return e?this._activeSearches[e]?(a.Base.Logger.error(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Server returned duplicate searchId",e),f.reject(new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.INVALID_SERVER_RESPONSE))):(this._activeSearches[e]={deferred:f,quickSearch:!0,searchStrings:c,searchScope:d},this.startSearchTimer(e),void this._processQueuedNotifications(e)):(a.Base.Logger.error(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Server returned invalid response to quick search contacts request",e),f.reject(new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.INVALID_SERVER_RESPONSE)))}.bind(this),function(b){return a.Base.Logger.error(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Quick search contacts request failed",b),f.reject(b)}),f.promise()},c.prototype._splitQuickSearchCriteriaStrings=function(a,b){for(var c=[],d=0;d<a.length;d+=b)c.push(a.slice(d,d+b));return c},c.prototype.startSearchTimer=function(b){setTimeout(function(){if(this._activeSearches.hasOwnProperty(b)){a.Base.Logger.warn(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Result for search with ID "+b+" wasn't received in time.");var c=this._activeSearches[b].deferred;delete this._activeSearches[b],c.resolve()}}.bind(this),1e4)},c.prototype.stopDirectorySearch=function(b){var c,d;for(var e in this._activeSearches)if(this._activeSearches.hasOwnProperty(e)&&this._activeSearches[e].searchRequestId===b){d=e,c=this._activeSearches[e];break}if(!c)return void a.Base.Logger.warn(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Unable to cancel contact search. Search is already cancelled, completed or doesn't exist.");delete this._activeSearches[d]},c.prototype.getNetworkSearchContactCapability=function(){return this._contactsCapability},c.prototype.getNetworkResolveContactsCapability=function(){return this._resolveContactsCapability},c.prototype.getNetworkSearchTerminalCapability=function(){return this._terminalCapability},c.prototype._subscribeForNotifications=function(){var b=this._requestBuilder.buildSubscribeForACSNotifications(a.Providers.ACS.ACSConstants.SVC_SEARCH_CONTACTS);return this._acsNetworkProvider.subscribeForNotifications(b,this._onSearchNotification.bind(this)).fail(function(b){a.Base.Logger.error(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Failed to subscribe for notifications",b)})},c.prototype._unsubscribeFromNotifications=function(){var b=this._requestBuilder.buildUnsubscribeFromACSNotifications(a.Providers.ACS.ACSConstants.SVC_SEARCH_CONTACTS);return this._acsNetworkProvider.unsubscribeFromNotifications(b).fail(function(b){a.Base.Logger.warn(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Failed to unsubscribe from notifications",b)})},c.prototype._onSearchNotification=function(b){this._isSearchNotificationValid(b)&&(this._activeSearches[b.searchId]?this._processSearchNotification(b):(a.Base.Logger.debug(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Received search notification with unknown ID "+b.searchId+", caching it"),this._searchResultsQueue.getElement(b.searchId)||this._searchResultsQueue.addElement(b.searchId,[]),this._searchResultsQueue.getElement(b.searchId).push(b)))},c.prototype._processSearchNotification=function(b){var c,d=this._activeSearches[b.searchId],e=d.deferred;try{c=JSON.parse(b.data)}catch(error){return a.Base.Logger.error(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Failed to parse search results",error),this._contactsAnalyticsService.trackContactProvidersUnavailable(a.Services.Contacts.ContactsErrorReason.INVALID_SERVER_RESPONSE),void e.reject(new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.INVALID_SERVER_RESPONSE))}if(d.quickSearch){var f=this._contactsConverter.convertQuickSearchResults(c,d.searchStrings,d.searchScope);e.notify(f),this._acsContactsCache.addQuickSearchResultsToCache(f)}else e.notify(this._contactsConverter.convertACSContactArraytoContactArray(c));"false"===b.hasMoreResults&&(delete this._activeSearches[b.searchId],e.resolve())},c.prototype._processQueuedNotifications=function(a){var b=this._searchResultsQueue.getElement(a);if(b){for(var c=0;c<b.length;c++)this._processSearchNotification(b[c]);this._searchResultsQueue.deleteElement(a)}},c.prototype._isSearchNotificationValid=function(b){return!!(b&&b.searchId&&b.data&&b.hasMoreResults)||(a.Base.Logger.error(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Received invalid search results",b),!1)},c.prototype._handleStateChange=function(c){var d;switch(c){case a.Providers.ACS.ACSProviderStates.STARTED:d=this._subscribeForNotifications();break;case a.Providers.ACS.ACSProviderStates.STOPPING:this._activeSearches={},this._searchResultsQueue.empty(),d=this._unsubscribeFromNotifications();break;default:d=b.Deferred().resolve().promise()}return d},c.prototype.getSelfContact=function(){var c=b.Deferred(),d=new a.Services.Contacts.ContactSearchRequest(this._acsNetworkProvider.getResources().self,a.Services.Contacts.SearchFieldType.ALL,a.Services.Contacts.SearchSourceType.NETWORK,1,0);return this.startDirectorySearch(d).then(function(){},function(a){return c.reject(a)},function(b){if(!b||!b[0])return c.reject(new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.INTERNAL_ERROR));c.resolve(b[0])}),c.promise()},a.Providers.ACS.ACSDirectorySearchProviderV1=c}(AvayaClientServices,jQuery),function(a){"use strict";var b=a.Providers.Call;b.StartCallEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.StartCallEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.StartCallEvent.stringValue="START_CALL",b.StartCallResponseEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.StartCallResponseEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.StartCallResponseEvent.stringValue="START_CALL_RESPONSE",b.DeviceRetrievalFailedEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.DeviceRetrievalFailedEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.DeviceRetrievalFailedEvent.stringValue="DEVICE_RETRIEVAL_FAILED",b.GetOfferSDPEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.GetOfferSDPEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.GetOfferSDPEvent.stringValue="GET_OFFER_SDP",b.OfferSDPEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.OfferSDPEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.OfferSDPEvent.stringValue="OFFER_SDP",b.OfferSDPFirefoxMidcallEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.OfferSDPFirefoxMidcallEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.OfferSDPFirefoxMidcallEvent.stringValue="OFFER_SDP_FIREFOX",b.CallRingingEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.CallRingingEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.CallRingingEvent.stringValue="CALL_RINGING",b.AnswerSDPEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.AnswerSDPEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.AnswerSDPEvent.stringValue="ANSWER_SDP",b.CallEstablishedEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.CallEstablishedEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.CallEstablishedEvent.stringValue="CALL_ESTABLISHED",b.EndCallEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.EndCallEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.EndCallEvent.stringValue="END_CALL",b.EndCallResponseEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.EndCallResponseEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.EndCallResponseEvent.stringValue="END_CALL_RESPONSE",b.OnAddStreamEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.OnAddStreamEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.OnAddStreamEvent.stringValue="ON_ADD_STREAM",b.IncomingCallEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.IncomingCallEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.IncomingCallEvent.stringValue="INCOMING_CALL",b.AcceptCallEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.AcceptCallEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.AcceptCallEvent.stringValue="ACCEPT_CALL",b.AcceptSendVideoEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.AcceptSendVideoEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.AcceptSendVideoEvent.stringValue="ACCEPT_SEND_VIDEO",b.MuteAudioEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.MuteAudioEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.MuteAudioEvent.stringValue="MUTE_AUDIO",b.UnmuteAudioEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.UnmuteAudioEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.UnmuteAudioEvent.stringValue="UNMUTE_AUDIO",b.MuteSpeakerEvent=function b(){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,{})},b.MuteSpeakerEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.MuteSpeakerEvent.stringValue="MUTE_SPEAKER",b.UnmuteSpeakerEvent=function b(){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,{})},b.UnmuteSpeakerEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.UnmuteSpeakerEvent.stringValue="UNMUTE_SPEAKER",b.BlockCameraEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.BlockCameraEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.BlockCameraEvent.stringValue="BLOCK_CAMERA",b.UnBlockCameraEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.UnBlockCameraEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.UnBlockCameraEvent.stringValue="UNBLOCK_CAMERA",b.HoldEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.HoldEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.HoldEvent.stringValue="HOLD",b.UnHoldEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.UnHoldEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.UnHoldEvent.stringValue="UNHOLD",b.EscalateVideoEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.EscalateVideoEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.EscalateVideoEvent.stringValue="ESCALATE_VIDEO",b.EscalateVideoAnswerEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.EscalateVideoAnswerEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.EscalateVideoAnswerEvent.stringValue="ESCALATE_VIDEO_GETOFFER",b.EscalateVideoGetOfferEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.EscalateVideoGetOfferEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.EscalateVideoGetOfferEvent.stringValue="ESCALATE_VIDEO_ANSWER",b.EscalateVideoOfferEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.EscalateVideoOfferEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.EscalateVideoOfferEvent.stringValue="ESCALATE_VIDEO_OFFER",b.EscalateVideoRejectedEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.EscalateVideoRejectedEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.EscalateVideoRejectedEvent.stringValue="ESCALATE_VIDEO_REJECTED",b.DeEscalateVideoEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.DeEscalateVideoEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.DeEscalateVideoEvent.stringValue="DEESCALATE_VIDEO",b.AnswerSdpAckEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.AnswerSdpAckEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.AnswerSdpAckEvent.stringValue="ANSWER_SDP_ACK",b.DenySendVideoEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.DenySendVideoEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.DenySendVideoEvent.stringValue="DENY_SEND_VIDEO",b.AcceptVideoTimedOutEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.AcceptVideoTimedOutEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.AcceptVideoTimedOutEvent.stringValue="ACCEPT_VIDEO_TIMED_OUT",b.SendDTMFEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.SendDTMFEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.SendDTMFEvent.stringValue="SEND_DTMF",b.IncomingAddVideoEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.IncomingAddVideoEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.IncomingAddVideoEvent.stringValue="INCOMING_ADD_VIDEO",b.IncomingAddVideoTimedoutEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.IncomingAddVideoTimedoutEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.IncomingAddVideoTimedoutEvent.stringValue="INCOMING_ADD_VIDEO_TIMEDOUT",b.IncomingRemoveVideoEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.IncomingRemoveVideoEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.IncomingRemoveVideoEvent.stringValue="INCOMING_REMOVE_VIDEO",b.IncomingGenericOfferSDPEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.IncomingGenericOfferSDPEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.IncomingGenericOfferSDPEvent.stringValue="INCOMING_GENERIC_OFFER",b.RevertStateEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.RevertStateEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.RevertStateEvent.stringValue="REVERT_STATE",b.OnAddRemoteTrackEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.OnAddRemoteTrackEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.OnAddRemoteTrackEvent.stringValue="ON_ADD_REMOTE_TRACK",b.OnRemoveRemoteTrackEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.OnRemoveRemoteTrackEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.OnRemoveRemoteTrackEvent.stringValue="ON_REMOVE_REMOTE_TRACK",b.UpdateRemoteVideoEvent=function b(c){a.Base.SimpleFsm.SimpleFsmEvent.call(this,b.stringValue,c)},b.UpdateRemoteVideoEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.UpdateRemoteVideoEvent.stringValue="UPDATE_REMOTE_VIDEO",b.UpdateLocalStreamEvent=function b(c){a.Providers.Call.CallFsmEvent.call(this,b.stringValue,c)},b.UpdateLocalStreamEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.UpdateLocalStreamEvent.stringValue="UPDATE_LOCAL_STREAM",b.TransferEvent=function b(c){a.Providers.Call.CallFsmEvent.call(this,b.stringValue,c)
},b.TransferEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.TransferEvent.stringValue="TRANSFER",b.AttendedTransferEvent=function b(c){a.Providers.Call.CallFsmEvent.call(this,b.stringValue,c)},b.AttendedTransferEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.AttendedTransferEvent.stringValue="ATTENDED_TRANSFER",b.AddParticipantFromExistingCallEvent=function b(c){a.Providers.Call.CallFsmEvent.call(this,b.stringValue,c)},b.AddParticipantFromExistingCallEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.AddParticipantFromExistingCallEvent.stringValue="ADD_PARTICIPANT_FROM_EXISTING_CALL",b.JoinRemoteCallEvent=function b(c){a.Providers.Call.CallFsmEvent.call(this,b.stringValue,c)},b.JoinRemoteCallEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.JoinRemoteCallEvent.stringValue="JOIN_REMOTE_CALL",b.CallStateFailureEvent=function b(c){a.Providers.Call.CallFsmEvent.call(this,b.stringValue,c)},b.CallStateFailureEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.CallStateFailureEvent.stringValue="CALL_STATE_FAILURE",b.CallFailureEvent=function b(c){a.Providers.Call.CallFsmEvent.call(this,b.stringValue,c)},b.CallFailureEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.CallFailureEvent.stringValue="CALL_FAILURE",b.StartRingingEvent=function b(c){a.Providers.Call.CallFsmEvent.call(this,b.stringValue,c)},b.StartRingingEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.StartRingingEvent.stringValue="START_RINGING",b.AcceptCallRequestEvent=function b(c){a.Providers.Call.CallFsmEvent.call(this,b.stringValue,c)},b.AcceptCallRequestEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.AcceptCallRequestEvent.stringValue="ACCEPT_CALL_REQUEST",b.RejectCallRequestEvent=function b(c){a.Providers.Call.CallFsmEvent.call(this,b.stringValue,c)},b.RejectCallRequestEvent.prototype=Object.create(a.Base.SimpleFsm.SimpleFsmEvent.prototype),b.RejectCallRequestEvent.stringValue="REJECT_CALL_REQUEST"}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a,b){"use strict";function c(b,c,d){a.Base.Observable.call(this),this._csgProvider=b,this._callProvider=void 0,this._messageBuilder=c,this._host=d,this._startPromise=void 0,this._stopPromise=void 0,this._onNetworkAvailable=void 0,this._onNetworkUnavailable=void 0,this._started=!1,this._isNetworkAvailable=!1,this._isServiceAvailable=void 0,this._parsers=[],this._registerParsers(),this._ringbackToneURLs=void 0}var d=a.Providers.CallServiceGateway.Constants,e={CallInfo:"0",ClientCalls:"1",UserClients:"2",Notification:"3",Configuration:"4"};c.prototype=Object.create(a.Base.Observable.prototype),c.prototype.getCallProvider=function(){return this._callProvider},c.prototype.isServiceAvailable=function(){return this._isServiceAvailable},c.prototype.start=function(c,e,f,g){if(this._startPromise)return this._startPromise;this._callProvider=c;var h=b.Deferred();return this._started=!0,this._onNetworkAvailable&&this._onNetworkUnavailable||(this._onNetworkAvailable=function(){a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Network is available. Subscribing for notifications"),this._isNetworkAvailable=!0,this._csgProvider.restProviderOnErrorHandler(function(b){a.Base.Logger.warn(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"REST provider error: "+b)}.bind(this)),this._subscribeForNotifications().then(function(){return this._csgProvider.activateService(d.CALLS,f,g)}.bind(this)).then(function(){this._isServiceAvailable=!0,this.trigger(a.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_AVAILABLE,[this._host]),this._setRingbackToneList(),a.Base.Utils.isDefined(h)&&(h.state()===a.Base.DeferredStates.PENDING?h.resolve(this._csgProvider.getResourceHrefs()[a.Providers.CallServiceGateway.ResourceType.iViewToken]):h.state()===a.Base.DeferredStates.RESOLVED&&this.trigger(a.Providers.CallServiceGateway.ObservableEvents.IVIEW_TOKEN_UPDATE,[this._csgProvider.getResourceHrefs()[a.Providers.CallServiceGateway.ResourceType.iViewToken]]))}.bind(this),function(c){return h.state()===a.Base.DeferredStates.PENDING&&h.reject(c),b.Deferred().reject(c).promise()}.bind(this))}.bind(this),this._onNetworkUnavailable=function(b,c){a.Base.Logger.error(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Network is unavailable"),this._isNetworkAvailable=!1,this._isServiceAvailable=!1,this.trigger(a.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,[this._host,b,c])}.bind(this),this._csgProvider.on(a.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_AVAILABLE,this._onNetworkAvailable),this._csgProvider.on(a.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,this._onNetworkUnavailable),this._csgProvider.on(a.Providers.CallServiceGateway.ObservableEvents.ICE_CONFIG_UPDATES,function(b){this.trigger(a.Providers.CallServiceGateway.ObservableEvents.ICE_CONFIG_UPDATES,[b])}.bind(this)),this._stopPromise=void 0),this._startPromise=b.when(h,this._csgProvider.start(e)),this._startPromise},c.prototype.stop=function(){if(!this._started)return b.Deferred().resolve().promise();if(this._stopPromise)return this._stopPromise;var c=function(){this._started=!1,this._removeListeners(),this._onNetworkAvailable=void 0,this._onNetworkUnavailable=void 0,this._startPromise=void 0}.bind(this);this._stopPromise=b.Deferred();var e=function(){this._csgProvider.stop().always(c).then(function(){this._stopPromise.resolve()}.bind(this),function(b){a.Base.Logger.error(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"stop error.",b),this._stopPromise.reject(b)}.bind(this))}.bind(this);return this._isNetworkAvailable?this._unsubscribeFromNotifications().always(function(){this._csgProvider.deactivateService(d.CALLS).always(e)}.bind(this)):e(),this._isNetworkAvailable=!1,this._isServiceAvailable=!1,this._stopPromise.promise()},c.prototype.stopImmediately=function(){return this._started?this._stopPromise?this._stopPromise:(this._stopPromise=b.Deferred(),this._csgProvider.stopImmediately().then(function(){this._stopPromise.resolve()}.bind(this),function(a){this._stopPromise.reject(a)}.bind(this)),this._stopPromise.promise()):b.Deferred().resolve().promise()},c.prototype._subscribeForNotifications=function(){var c=this._messageBuilder.buildSubscribeRequest(a.Providers.CallServiceGateway.Constants.TELEPHONY_SERVICE,this._csgProvider.getResourceHrefs()[a.Providers.CallServiceGateway.ResourceType.Calls]),d=this._parsers[e.Notification],f=d.parse.bind(d),g=this._csgProvider.subscribeForNotifications(c,f).then(function(){a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Subscribed for calls notifications")},function(c){return a.Base.Logger.error(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Failed to subscribe for calls notifications: "+JSON.stringify(c)),b.Deferred().reject(c).promise()}.bind(this));return a.Base.Utils.rejectIfPromiseNotResolvedInTime(g,3e4,new a.Services.Call.CallException(a.Services.Call.CallError.TIMEOUT),function(){a.Base.Logger.error(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Calls subscription confirmation was not received in time"),this.trigger(a.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,[this._host,"Notification","Unavailable"])}.bind(this))},c.prototype._unsubscribeFromNotifications=function(){var c=this._messageBuilder.buildUnsubscribeRequest(a.Providers.CallServiceGateway.Constants.TELEPHONY_SERVICE,this._csgProvider.getResourceHrefs()[a.Providers.CallServiceGateway.ResourceType.Calls]);return this._csgProvider.unsubscribeFromNotifications(c).then(function(){a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Unsubscribed from calls notifications")},function(c){return a.Base.Logger.error(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Failed to unsubscribe from calls notifications: "+JSON.stringify(c)),b.Deferred().reject(c).promise()}.bind(this))},c.prototype.getCalls=function(){var c=b.Deferred(),d=this._messageBuilder.buildGetCallsOptions(this._csgProvider.getResourceHrefs()[a.Providers.CallServiceGateway.ResourceType.Calls]);return this._csgProvider.send(void 0,d).then(function(b){a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Received get calls response");var d=this._parsers[e.ClientCalls].parse(b);c.resolve(d)}.bind(this),function(a){this._handleError("getCalls() network provider failed - "+a.statusText),c.reject(a)}.bind(this)),c.promise()},c.prototype.getCall=function(c){var d=b.Deferred(),f=this._messageBuilder.buildGetCallOptions(this._csgProvider.getResourceHrefs()[a.Providers.CallServiceGateway.ResourceType.Calls],c);return this._csgProvider.send(null,f).then(function(b){a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Received get call response");var c=this._parsers[e.CallInfo].parse(b);d.resolve(c)}.bind(this),function(a){this._handleError("getCall() network provider failed - "+a.statusText),d.reject(a)}.bind(this)),d.promise()},c.prototype.getClients=function(){var c=b.Deferred(),d=this._messageBuilder.buildGetClientsOptions(this._csgProvider.getResourceHrefs()[a.Providers.CallServiceGateway.ResourceType.Clients]);return this._csgProvider.send(null,d).then(function(b){a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Received get clients response");var d=this._parsers[e.UserClients].parse(b);c.resolve(d)}.bind(this),function(a){this._handleError("getClients() network provider failed - "+a.statusText),c.reject(a)}.bind(this)),c.promise()},c.prototype.getClient=function(c){var d=b.Deferred(),f=this._messageBuilder.buildGetClientOptions(this._csgProvider.getResourceHrefs()[a.Providers.CallServiceGateway.ResourceType.Clients],c);return this._csgProvider.send(null,f).then(function(b){a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Received get client response");var c=this._parsers[e.UserClients].parseClient(b);d.resolve(c)}.bind(this),function(a){this._handleError("getClient() network provider failed - "+a.statusText),d.reject(a)}.bind(this)),d.promise()},c.prototype.startCall=function(c,d,f,g,h,i,j,k,l){var m=b.Deferred(),n=this._messageBuilder.buildStartCallOptions(this._csgProvider.getResourceHrefs()[a.Providers.CallServiceGateway.ResourceType.Calls]),o="";this._csgProvider.getCredentials().isGuest&&(o=this._csgProvider.getCredentials().displayName);var p={subject:"",priority:null,privacy:null,participants:[{participantId:null,remoteDisplayName:o,remoteAddress:c}],conferenceData:{userAgentCalling:null,video:g,webCollaboration:h}};if(a.Base.Utils.isDefined(d)&&d.length>0&&(p.subject=d),a.Base.Utils.isDefined(l))p.callId=l,p.conferenceData=null;else{var q=!!a.Base.Utils.isDefined(k)&&k;p.conferenceData.uccp=q,f&&(p.conferenceData.ott=f.getCallType()===a.Services.Call.CallType.CallTypeHttpMeetMe,p.conferenceData.meetingToken=f.getPortalToken()||null,p.conferenceData.meetingId=f.getConferenceID()||null,p.conferenceData.meetingPasscode=f.getPasscode()||null)}var r=a.Providers.CallServiceGateway.Utils.convertToAudioChannel(i),s=a.Providers.CallServiceGateway.Utils.convertToVideoChannels(j);return p=b.extend({},p,{audioChannel:r},{videoChannels:s}),a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"StartCall sending: "+JSON.stringify(p)),this._csgProvider.send(JSON.stringify(p),n).then(function(b){a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Received make call response");var c=this._parsers[e.CallInfo].parse(b);m.resolve(c)}.bind(this),function(a){this._handleError("startCall() network provider failed - "+a.statusText);var b=this._handleCsgProviderSendError(a);m.reject({errorCode:b.errorCode,protocolType:b.protocolType,protocolErrorCode:b.protocolErrorCode,errorMsg:b.errorMsg})}.bind(this)),m.promise()},c.prototype.offerSDPResponse=function(c,d,e,f,g){var h=b.Deferred(),i=this._messageBuilder.buildNotificationsOptions(),j=a.Providers.CallServiceGateway.Utils.convertToAudioChannel(f),k=a.Providers.CallServiceGateway.Utils.convertToVideoChannels(g),l=this._messageBuilder.buildProcessMediaOfferResponseNotification(this._csgProvider.getResourceHrefs()[a.Providers.CallServiceGateway.ResourceType.Calls],c,e,d.type,d.sdp,j,k);a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Sending offer notification");try{this._csgProvider.sendNotification(JSON.stringify(l),i),h.resolve()}catch(m){h.reject(m)}return h.promise()},c.prototype.answerSDPResponse=function(c,d,e){var f=b.Deferred(),g=this._messageBuilder.buildNotificationsOptions(),h=a.Providers.CallServiceGateway.Utils.convertToAudioChannel(d),i=a.Providers.CallServiceGateway.Utils.convertToVideoChannels(e),j=this._messageBuilder.buildProcessMediaAnswerResponseNotification(this._csgProvider.getResourceHrefs()[a.Providers.CallServiceGateway.ResourceType.Calls],c,h,i);a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Sending answer notification");try{this._csgProvider.sendNotification(JSON.stringify(j),g),f.resolve()}catch(k){f.reject(k)}return f.promise()},c.prototype.getOfferSDPResponse=function(c,d,e,f){var g=b.Deferred(),h=this._messageBuilder.buildNotificationsOptions(),i=a.Providers.CallServiceGateway.Utils.convertToAudioChannel(e),j=a.Providers.CallServiceGateway.Utils.convertToVideoChannels(f),k=this._messageBuilder.buildCreateMediaResponseNotification(this._csgProvider.getResourceHrefs()[a.Providers.CallServiceGateway.ResourceType.Calls],c,d.type,d.sdp,i,j);a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Sending getOffer notification:\n"+d.sdp),a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,JSON.stringify(k));try{this._csgProvider.sendNotification(JSON.stringify(k),h),g.resolve()}catch(error){g.reject(error)}return g.promise()},c.prototype.blockUnBlockCamera=function(b,c,d){return this.updateMediaRequest(b,a.Providers.CallServiceGateway.CallActionType.UPDATE_VIDEO,c,d)},c.prototype.updateVideo=function(b,c,d){return this.updateMediaRequest(b,a.Providers.CallServiceGateway.CallActionType.UPDATE_VIDEO,c,d)},c.prototype.escalateVideo=function(b,c,d){return this.updateMediaRequest(b,a.Providers.CallServiceGateway.CallActionType.ADD_VIDEO,c,d)},c.prototype.deEscalateVideo=function(b,c,d){return this.updateMediaRequest(b,a.Providers.CallServiceGateway.CallActionType.REMOVE_VIDEO,c,d)},c.prototype.updateMediaRequest=function(c,d,e,f){var g=b.Deferred(),h=this._messageBuilder.buildNotificationsOptions(),i=a.Providers.CallServiceGateway.Utils.convertToAudioChannel(e),j=a.Providers.CallServiceGateway.Utils.convertToVideoChannels(f),k=this._messageBuilder.buildUpdateMediaRequestNotification(this._csgProvider.getResourceHrefs()[a.Providers.CallServiceGateway.ResourceType.Calls],c,d,i,j);a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Update media request: "+d);try{this._csgProvider.sendNotification(JSON.stringify(k),h),g.resolve()}catch(l){g.reject(l)}return g.promise()},c.prototype.endCall=function(b,c){var d={actionDetails:{targetCallId:null,subject:null,participants:null,conferenceData:null,sdpType:null,sdp:null,audioChannel:null,videoChannels:[]}};return a.Base.Utils.isDefined(c)&&(d.actionDetails.denyCallReason=c),this._updateCall(b,a.Providers.CallServiceGateway.CallActionType.END,d)},c.prototype.transfer=function(b,c,d,e){var f=a.Providers.CallServiceGateway.Utils.convertToAudioChannel(d),g=a.Providers.CallServiceGateway.Utils.convertToVideoChannels(e),h={actionDetails:{targetRemoteAddress:c,targetCallId:null,subject:null,cmLineID:null,participants:null,conferenceData:null,sdpType:null,sdp:null,audioChannel:f,videoChannels:a.Base.Utils.isDefined(g)?g:[]}};return this._updateCall(b,a.Providers.CallServiceGateway.CallActionType.TRANSFER,h)},c.prototype.attendedTransfer=function(b,c,d,e){var f=a.Providers.CallServiceGateway.Utils.convertToAudioChannel(d),g=a.Providers.CallServiceGateway.Utils.convertToVideoChannels(e),h={actionDetails:{targetRemoteAddress:null,targetCallId:c,subject:null,cmLineID:null,participants:null,conferenceData:null,sdpType:null,sdp:null,audioChannel:f,videoChannels:a.Base.Utils.isDefined(g)?g:[]}};return this._updateCall(b,a.Providers.CallServiceGateway.CallActionType.TRANSFER,h)},c.prototype.addParticipantFromCall=function(b,c,d,e){var f=a.Providers.CallServiceGateway.Utils.convertToAudioChannel(d),g=a.Providers.CallServiceGateway.Utils.convertToVideoChannels(e),h={actionDetails:{targetRemoteAddress:null,targetCallId:c,subject:null,cmLineID:null,participants:null,conferenceData:null,sdpType:null,sdp:null,audioChannel:f,videoChannels:a.Base.Utils.isDefined(g)?g:[]}};return this._updateCall(b,a.Providers.CallServiceGateway.CallActionType.ADD_PARTICIPANT,h)},c.prototype.joinRemoteCall=function(b,c,d){var e=a.Providers.CallServiceGateway.Utils.convertToAudioChannel(c),f=a.Providers.CallServiceGateway.Utils.convertToVideoChannels(d),g={actionDetails:{targetRemoteAddress:null,targetCallId:null,subject:null,cmLineID:null,participants:null,conferenceData:null,sdpType:null,sdp:null,audioChannel:e,videoChannels:a.Base.Utils.isDefined(f)?f:[]}};return this._updateCall(b,a.Providers.CallServiceGateway.CallActionType.JOIN,g)},c.prototype.acceptCall=function(b,c,d,e,f){var g=a.Providers.CallServiceGateway.Utils.convertToAudioChannel(e),h=a.Providers.CallServiceGateway.Utils.convertToVideoChannels(f),i={actionDetails:{targetCallId:null,subject:null,participants:null,conferenceData:null,sdpType:c.toUpperCase(),sdp:d,audioChannel:g,videoChannels:a.Base.Utils.isDefined(h)?h:[]}};return this._updateCall(b,a.Providers.CallServiceGateway.CallActionType.ANSWER,i)},c.prototype.holdCall=function(b,c,d){return this.updateMediaRequest(b,a.Providers.CallServiceGateway.CallActionType.HOLD,c,d)},c.prototype.unholdCall=function(b,c,d){return this.updateMediaRequest(b,a.Providers.CallServiceGateway.CallActionType.UNHOLD,c,d)},c.prototype.startRinging=function(b){return this._updateCall(b,a.Providers.CallServiceGateway.CallActionType.RINGING)},c.prototype.acceptCallRequest=function(c,d,e){var f=b.Deferred(),g=this._messageBuilder.buildNotificationsOptions(),h=this._messageBuilder.buildAcceptCallResponse(this._csgProvider.getResourceHrefs()[a.Providers.CallServiceGateway.ResourceType.Calls],c,d);a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"CSGCallProvider: Sending accept call request");try{this._csgProvider.sendNotification(JSON.stringify(h),g).done(function(){f.resolve()}).fail(function(a){f.reject(a)})}catch(i){f.reject(i)}return f.promise()},c.prototype.rejectAnswerCallRequest=function(a,b){return this._rejectCallRequest(a,b)},c.prototype.rejectTerminateCallRequest=function(a,b){return this._rejectCallRequest(a,b)},c.prototype.rejectUpdateCallRequest=function(a,b,c){return this._rejectCallRequest(a,b)},c.prototype.rejectMakeCallRequest=function(a,b){return this._rejectCallRequest(a,b)},c.prototype._rejectCallRequest=function(c,d){var e=b.Deferred(),f=this._messageBuilder.buildNotificationsOptions(),g=this._messageBuilder.buildRejectCallResponse(this._csgProvider.getResourceHrefs()[a.Providers.CallServiceGateway.ResourceType.Calls],c,d);a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"CSGCallProvider: Sending reject call request");try{this._csgProvider.sendNotification(JSON.stringify(g),f).done(function(){e.resolve()}).fail(function(a){e.reject(a)})}catch(h){e.reject(h)}return e.promise()},c.prototype._handleError=function(b){a.Base.Logger.error(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Error detected: "+b)},c.prototype._handleCsgProviderSendError=function(b){var c={};if(b.status>=200&&b.status<300)return c;c.errorCode=a.Services.Call.CallError.TRANSPORT_ERROR,c.protocolType=a.Services.Call.CallProtocolType.HTTP,c.protocolErrorCode=b.getData().getStatus(),c.errorMsg=b.message;var d=a.Base.Utils.queryJSONObject(b,"_data._responseText");if(d){c.protocolType=a.Services.Call.CallProtocolType.APPLICATION;try{var e=JSON.parse(d);e&&(c.errorCode=a.Providers.CallServiceGateway.Utils.convertErrorCode(e.error[0].errorCode),c.errorMsg=e.error[0].errorMsg)}catch(f){}}return c},c.prototype._updateCall=function(c,d,e){var f=b.Deferred(),g=this._messageBuilder.buildUpdateCallOptions(this._csgProvider.getResourceHrefs()[a.Providers.CallServiceGateway.ResourceType.Calls],c),h={action:d};return e&&(h=b.extend(h,e)),this._csgProvider.send(JSON.stringify(h),g).then(function(b){a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Sent call action: "+d),f.resolve()}.bind(this),function(b){var c=this._handleCsgProviderSendError(b);a.Base.Utils.queryJSONObject(c,"errorCode")?(404===c.protocolErrorCode&&c.errorCode===a.Services.Call.CallError.NOT_FOUND?c.errorCode=a.Services.Call.CallError.CALL_NOT_FOUND:this._handleError(d+" call action network provider failed - "+c.errorMsg),f.reject({errorCode:c.errorCode,protocolType:c.protocolType,protocolErrorCode:c.protocolErrorCode,errorMsg:c.errorMsg})):(a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Sent call action: "+d),f.resolve())}.bind(this)),f.promise()},c.prototype.getConfiguration=function(){var c=b.Deferred(),d=this._messageBuilder.buildGetConfigurationOptions(this._csgProvider.getResourceHrefs()[a.Providers.CallServiceGateway.ResourceType.Configuration]);return this._csgProvider.send(null,d).then(function(b){a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Received get configuration response");var d=this._parsers[e.Configuration].parse(b);c.resolve(d)}.bind(this),function(a){this._handleError("getConfiguration() network provider failed - "+a.statusText),c.reject(a)}.bind(this)),c.promise()},c.prototype.getVoicemailNumber=function(){return this.getConfiguration().then(function(b){if(b&&b.vmnumber)return b.vmnumber;a.Base.Logger.info(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Auto-configuration settings don't contain voicemail number")}.bind(this))},c.prototype._registerParsers=function(){this._parsers[e.CallInfo]=new a.Providers.CallServiceGateway.CallInfoParser,this._parsers[e.Notification]=new a.Providers.CallServiceGateway.NotificationParser(this),this._parsers[e.ClientCalls]=new a.Providers.CallServiceGateway.ClientCallsParser(this._parsers[e.CallInfo]),this._parsers[e.UserClients]=new a.Providers.CallServiceGateway.UserClientsParser,this._parsers[e.Configuration]=new a.Providers.CallServiceGateway.ConfigurationParser},c.prototype._setRingbackToneList=function(){var c=a.Providers.CallServiceGateway.CSGToneType,d=this._csgProvider.getRestResources(),e={};d.ringbackTones&&b.each(c,function(a,b){var c=d.ringbackTones[b];c&&c.href&&(e[b]=c.href)});var f=new a.Services.Call.RingbackToneURLs;f._setRingbackToneUrl(e[c.RINGBACK]),f._setInterceptToneUrl(e[c.INTERCEPT]),f._setReorderToneUrl(e[c.REORDER]),f._setFastBusyToneUrl(e[c.FASTBUSY]),this._ringbackToneURLs&&JSON.stringify(this._ringbackToneURLs)===JSON.stringify(f)||(this._ringbackToneURLs=f,this.trigger(a.Providers.CallServiceGateway.ObservableEvents.RINGBACK_TONE_URLS_CHANGED,[f]))},a.Providers.CallServiceGateway.CSGCallsProvider=c}(AvayaClientServices,jQuery),function(a,b){"use strict";function c(b,c){a.Base.Observable.call(this),this._csgProvider=b,this._messageBuilder=c,this._started=!1,this._subscriptionStatusUnknown=!1,this._presenceContainer=void 0,this._presenceContainerExpirationDate=void 0,this._presenceContainerRefreshTimeoutId=void 0,this._userSubscriptions=[],this._subscriptionsDeferredMap={},this._unsubscriptionsDeferredMap={},this._onNetworkAvailable=void 0,this._onNetworkUnavailable=void 0,this._subscribedForPresence=!1,this._deletePresenceContainerPromise=void 0,this._createOrExtendPresenceContainerPromise=void 0,this._timeoutForSubscribe=f,this._timeoutForUnsubscribe=g}var d=a.Providers.CallServiceGateway.ObservableEvents,e=a.Providers.CallServiceGateway.Constants,f=1e3,g=7e3;c.prototype=Object.create(a.Providers.Interfaces.PresenceProvider.prototype),c.prototype.start=function(c){if(this._started)return b.Deferred().resolve();var f=b.Deferred();this._onNetworkAvailable&&this._onNetworkUnavailable||(this._onNetworkAvailable=function(){a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Network is available. Subscribing for notifications"),this._csgProvider.getResourceHrefs()[a.Providers.CallServiceGateway.ResourceType.PresenceSubscriptions]?this._subscribeForNotifications().then(function(){return this._csgProvider.activateService(e.PRESENCE,!0)}.bind(this)).then(function(){this._userSubscriptions.length>0?this.subscribeForPresence(this._userSubscriptions).always(function(){f.resolve()}):f.resolve()}.bind(this),function(a){f.reject(a)}):(a.Base.Logger.error(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Presence subscription URL is not found. Cannot subscribe for presence notifications."),f.reject(new a.Services.Presence.PresenceError(a.Services.Presence.PresenceErrorReason.UNSUPPORTED))),f.state()!==a.Base.DeferredStates.PENDING&&this.trigger(a.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_AVAILABLE)}.bind(this),this._onNetworkUnavailable=function(){a.Base.Logger.warn(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"CSG presence provider is unavailable"),this.trigger(a.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE)}.bind(this),this._csgProvider.on(d.NETWORK_PROVIDER_IS_AVAILABLE,this._onNetworkAvailable),this._csgProvider.on(d.NETWORK_PROVIDER_IS_UNAVAILABLE,this._onNetworkUnavailable),this._csgProvider.on(a.Base.NetworkProviderEvents.UNAUTHORIZED,function(){this.trigger(a.Base.NetworkProviderEvents.UNAUTHORIZED,[])}.bind(this)),this._csgProvider.on(a.Base.NetworkProviderEvents.AUTHORIZED,function(){this.trigger(a.Base.NetworkProviderEvents.AUTHORIZED,[])}.bind(this)));var g=this._csgProvider.start(c.sgConfiguration).then(function(){if(!this._csgProvider.getResourceHrefs()[a.Providers.CallServiceGateway.ResourceType.PresenceSubscriptions])return this._started=!1,a.Base.Logger.warn(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Presence is not supported for this user"),b.Deferred().reject(new a.Services.Presence.PresenceError(a.Services.Presence.PresenceErrorReason.UNSUPPORTED))}.bind(this));return b.when(g,f).then(function(){this._started=!0}.bind(this))},c.prototype.stop=function(){if(!this._started)return b.Deferred().resolve().promise();var c=b.Deferred(),d=function(){this._started=!1,this._presenceContainer=void 0,this._onNetworkAvailable=void 0,this._onNetworkUnavailable=void 0}.bind(this),f=function(){return this._csgProvider.stop().always(function(){d(),this._removeListeners()}.bind(this)).then(function(){c.resolve()},function(b){a.Base.Logger.error(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Failed to stop CSGPresenceProvider",b),c.reject(b)})}.bind(this),g=function(){return clearTimeout(this._presenceContainerRefreshTimeoutId),this._csgProvider.deactivateService(e.PRESENCE)}.bind(this);return this._csgProvider.isNetworkAvailable()?this._unsubscribeFromNotifications().always(function(){this.unsubscribeFromAllAddressesPresence().always(function(){g().always(function(){f()}.bind(this))}.bind(this))}.bind(this)):f(),c.promise()},c.prototype._subscribeForNotifications=function(){var c=this._messageBuilder.buildSubscribeRequest(a.Providers.CallServiceGateway.Constants.SVC_PRESENCE,this._csgProvider.getResourceHrefs()[a.Providers.CallServiceGateway.ResourceType.PresenceSubscriptions]),d=this._csgProvider.subscribeForNotifications(c,this._onNotification.bind(this)).then(function(){a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Subscribed for presence notifications")},function(c){return a.Base.Logger.error(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Failed to subscribe for presence notifications",c),b.Deferred().reject(c).promise()}.bind(this));return a.Base.Utils.rejectIfPromiseNotResolvedInTime(d,3e4,new a.Services.Presence.PresenceError(a.Services.Presence.PresenceErrorReason.TIMEOUT),function(){a.Base.Logger.error(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Presence subscription confirmation was not received in time"),this.trigger(a.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE)}.bind(this))},c.prototype._unsubscribeFromNotifications=function(){var c=this._messageBuilder.buildUnsubscribeRequest(a.Providers.CallServiceGateway.Constants.SVC_PRESENCE,this._csgProvider.getResourceHrefs()[a.Providers.CallServiceGateway.ResourceType.PresenceSubscriptions]);return this._csgProvider.unsubscribeFromNotifications(c).then(function(){a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Unsubscribed from presence notifications")},function(c){return a.Base.Logger.error(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Failed to unsubscribe from presence notifications: "+JSON.stringify(c)),b.Deferred().reject(c).promise()}.bind(this))},c.prototype._onNotification=function(b){if(a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Received notification",b),b&&b.rlPresenceUpdatedEvent){var c;try{c=JSON.parse(b.rlPresenceUpdatedEvent)}catch(error){return void a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Failed to parse notification",error)}this._onPresenceUpdatedEvent(c)}},c.prototype._onPresenceUpdatedEvent=function(b){if(!b.presentities||0===b.presentities.length)return void a.Base.Logger.warn(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Received empty presence updated notification");b.presenceDocuments&&b.presenceDocuments.forEach(this._processPresenceDocument.bind(this))},c.prototype._processPresenceDocument=function(b){var c=a.Base.Utils,d=a.Providers.CallServiceGateway.Utils,e=c.queryJSONObject(b,"presenceDoc.userIdentity.userId").replace("pres:","");a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Processing presence document for User ID",e);var f=this._subscriptionsDeferredMap[e];if(f)f.resolve(),delete this._subscriptionsDeferredMap[e],-1===this._userSubscriptions.indexOf(e)&&this._userSubscriptions.push(e);else if(-1===this._userSubscriptions.indexOf(e))return void a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Subscription list does not include address "+e+", the presence information for this user will be ignored.");var g=new a.Services.Presence.Presence(e),h=c.queryJSONObject(b,"presenceSummary.stateEnum");g._setOverallState(d.convertCSGPresenceStateToPresenceState(h));var i=c.queryJSONObject(b,"manualState.stateEnum");g._setManualState(d.convertCSGPresenceStateToPresenceState(i));var j=c.queryJSONObject(b,"mode.modeEnum");g._setLocationMode(d.convertCSGPresenceModeToPresenceMode(j)),g._setNote(c.queryJSONObject(b,"note.content"));var k=b.channelPresence[0],l=c.queryJSONObject(k,"video.stateEnum");g._setVideoState(d.convertCSGPresenceStateToPresenceState(l)),g._setVideoContact(c.queryJSONObject(k,"video.contact"));var m=c.queryJSONObject(k,"phone.stateEnum");g._setPhoneState(d.convertCSGPresenceStateToPresenceState(m)),g._setPhoneContact(c.queryJSONObject(k,"phone.contact"));var n=c.queryJSONObject(k,"im.stateEnum");g._setEnterpriseIMState(d.convertCSGPresenceStateToPresenceState(n)),g._setEnterpriseIMContact(c.queryJSONObject(k,"im.contact"));var o=c.queryJSONObject(k,"calendar.stateEnum");g._setCalendarState(d.convertCSGPresenceStateToPresenceState(o));var p=c.queryJSONObject(k,"calendar.compoundFrom");p&&g._setCalendarStartTime(new Date(p));var q=c.queryJSONObject(k,"calendar.compoundUntil");q&&g._setCalendarEndTime(new Date(q)),a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Received presence status of "+e),setTimeout(function(){this.trigger(a.Providers.Interfaces.PresenceProviderCallbackIds.PRESENCE_NOTIFICATION,[g])}.bind(this),0)},c.prototype.subscribeForSingleAddressPresence=function(a){var c=this._subscriptionsDeferredMap[a];return c||(c=b.Deferred(),
this._subscriptionsDeferredMap[a]=c,this._sendSubscribeRequest()),c.promise()},c.prototype.subscribeForPresence=function(a){return a.forEach(function(a){this._subscriptionsDeferredMap[a]||(this._subscriptionsDeferredMap[a]=b.Deferred())}.bind(this)),this._sendSubscribeRequest()},c.prototype._sendSubscribeRequest=function(){return Object.keys(this._subscriptionsDeferredMap).forEach(function(a){this._unsubscriptionsDeferredMap[a]&&(this._unsubscriptionsDeferredMap[a].reject(),delete this._unsubscriptionsDeferredMap[a])}.bind(this)),this._dfdPresenceSubscription||(this._dfdPresenceSubscription=b.Deferred(),setTimeout(function(){var b=this._dfdPresenceSubscription;this._dfdPresenceSubscription=void 0;var c=Object.keys(this._subscriptionsDeferredMap);c.length&&this._updatePresenceSubscription(e.SUBSCRIPTION_ADD,c).done(function(){this._subscribedForPresence=!0,this._userSubscriptions=this._userSubscriptions.concat(c),c.forEach(function(b){setTimeout(function(){var c=this._subscriptionsDeferredMap[b];c&&(a.Base.Logger.error(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Presence subscription request has timed out. Provided address might be invalid.",b),c.reject(new a.Services.Presence.PresenceError(a.Services.Presence.PresenceErrorReason.TIMEOUT)),delete this._subscriptionsDeferredMap[b])}.bind(this),32e3)}.bind(this)),b.resolve()}.bind(this)).fail(function(d){c.forEach(function(b){a.Base.Logger.error(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Failed to subscribe for "+b+" presence",d),this._subscriptionsDeferredMap[b].reject(d),delete this._subscriptionsDeferredMap[b]}.bind(this)),b.reject(d)}.bind(this))}.bind(this),this._timeoutForSubscribe)),this._dfdPresenceSubscription.promise()},c.prototype.unsubscribeFromSingleAddressPresence=function(a){var c=this._unsubscriptionsDeferredMap[a];return c||(c=b.Deferred(),this._unsubscriptionsDeferredMap[a]=c,this._sendUnsubscribeRequest()),c.promise()},c.prototype.unsubscribeFromPresence=function(a){return a.forEach(function(a){this._unsubscriptionsDeferredMap[a]||(this._unsubscriptionsDeferredMap[a]=b.Deferred())}.bind(this)),this._sendUnsubscribeRequest()},c.prototype._sendUnsubscribeRequest=function(){return Object.keys(this._unsubscriptionsDeferredMap).forEach(function(a){this._subscriptionsDeferredMap[a]&&(this._subscriptionsDeferredMap[a].reject(),delete this._subscriptionsDeferredMap[a])}.bind(this)),this._dfdPresenceUnsubscription||(this._dfdPresenceUnsubscription=b.Deferred(),setTimeout(function(){var b=this._dfdPresenceUnsubscription;this._dfdPresenceUnsubscription=void 0;var c=Object.keys(this._unsubscriptionsDeferredMap);c.length&&this._updatePresenceSubscription(e.SUBSCRIPTION_REMOVE,c).then(function(){this._userSubscriptions=this._userSubscriptions.filter(function(a){return-1===c.indexOf(a)}),0===this._userSubscriptions.length&&(this._subscribedForPresence=!1),c.forEach(function(a){this._unsubscriptionsDeferredMap[a].resolve(),delete this._unsubscriptionsDeferredMap[a]}.bind(this)),b.resolve()}.bind(this),function(d){c.forEach(function(b){a.Base.Logger.error(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Failed to unsubscribe from "+b+" presence",d),this._unsubscriptionsDeferredMap[b].reject(d),delete this._unsubscriptionsDeferredMap[b]}.bind(this)),b.reject(d)}.bind(this))}.bind(this),this._timeoutForUnsubscribe)),this._dfdPresenceUnsubscription.promise()},c.prototype.unsubscribeFromAllAddressesPresence=function(){return 0===this._userSubscriptions.length?b.Deferred().resolve():this._updatePresenceSubscription(e.SUBSCRIPTION_REMOVE,this._userSubscriptions).then(function(){this._userSubscriptions=[],this._subscribedForPresence=!1}.bind(this))},c.prototype._updatePresenceSubscription=function(c,d){a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Updating presence subscriptions list",[c,d]);var e,f=b.Deferred(),g=function(a){this._onSubscriptionSucceeded(),f.resolve(a)}.bind(this),h=function(b){a.Base.Utils.queryJSONObject(b,"_data._status")===a.Base.NetworkErrorCodes.HTTP_SERVICE_UNAVAILABLE?setTimeout(function(){this._onSubscriptionFailed(),e()}.bind(this),0):f.reject(b)}.bind(this),i=function(b){b===a.Base.NetworkProviderEvents.RETRYING&&this._onSubscriptionFailed()}.bind(this);return e=function(){this._getContainerAndSend(function(a){var b=this._messageBuilder.buildPresenceSubscriptionData(c,d),e=this._messageBuilder.buildPresenceSubscriptionOptions(a.additionalResources.presenceSubscriptions[0].replace.href);return this._csgProvider.send(b,e)}.bind(this)).done(g).fail(h).progress(i)}.bind(this),e(),f.promise()},c.prototype._onSubscriptionFailed=function(){this._subscriptionStatusUnknown||(this._subscriptionStatusUnknown=!0,this._userSubscriptions.forEach(function(b){var c=this._buildUnknownPresence(b);this.trigger(a.Providers.Interfaces.PresenceProviderCallbackIds.PRESENCE_NOTIFICATION,[c])}.bind(this)))},c.prototype._onSubscriptionSucceeded=function(){if(this._subscriptionStatusUnknown&&(this._subscriptionStatusUnknown=!1,this._userSubscriptions.length>0)){var b=this._userSubscriptions.slice(0),c=function(){return this.unsubscribeFromAllAddressesPresence().then(function(){this.subscribeForPresence(b)}.bind(this))}.bind(this);a.Base.Utils.connectionBackoffAlgorithm(c)}},c.prototype.publishAutomaticPresence=function(a){return this._getContainerAndSend(function(b){var c=b.additionalResources.presencePublication.replace.href,d=this._messageBuilder.buildPublishPresenceOptions(c),e=this._messageBuilder.buildPublishAutoPresenceData(a);return this._csgProvider.send(e,d)}.bind(this))},c.prototype.publishManualState=function(b){var c,d,f;return b&&b!==a.Services.Presence.PresenceState.PRESENCE_STATE_UNSPECIFIED?(f=this._csgProvider.getResourceHrefs()[a.Providers.CallServiceGateway.ResourceType.PublishPresenceState],c=this._messageBuilder.buildPublishPresenceOptions(f),d=this._messageBuilder.buildPublishManualPresenceData(e.MANUAL_STATE,b)):(f=this._csgProvider.getResourceHrefs()[a.Providers.CallServiceGateway.ResourceType.DeletePresenceState],c=this._messageBuilder.buildDeleteManualPresenceOptions(f)),this._getContainerAndSend(function(){return this._csgProvider.send(d,c)}.bind(this))},c.prototype.publishLocationMode=function(b){var c,d,f;return b&&b!==a.Services.Presence.PresenceLocationMode.PRESENCE_LOCATION_MODE_UNSPECIFIED?(f=this._csgProvider.getResourceHrefs()[a.Providers.CallServiceGateway.ResourceType.PublishPresenceMode],c=this._messageBuilder.buildPublishPresenceOptions(f),d=this._messageBuilder.buildPublishManualPresenceData(e.MODE,b)):(f=this._csgProvider.getResourceHrefs()[a.Providers.CallServiceGateway.ResourceType.DeletePresenceMode],c=this._messageBuilder.buildDeleteManualPresenceOptions(f)),this._getContainerAndSend(function(){return this._csgProvider.send(d,c)}.bind(this))},c.prototype.publishNote=function(b){var c,d,f;return b&&""!==b?(f=this._csgProvider.getResourceHrefs()[a.Providers.CallServiceGateway.ResourceType.PublishPresenceNote],c=this._messageBuilder.buildPublishPresenceOptions(f),d=this._messageBuilder.buildPublishManualPresenceData(e.NOTE,b)):(f=this._csgProvider.getResourceHrefs()[a.Providers.CallServiceGateway.ResourceType.DeletePresenceNote],c=this._messageBuilder.buildDeleteManualPresenceOptions(f)),this._getContainerAndSend(function(){return this._csgProvider.send(d,c)}.bind(this))},c.prototype._getContainerAndSend=function(a){var c=b.Deferred(),d=function(){this._getPresenceContainer().then(a).then(function(a){c.resolve(a)},function(a){this._onErrorGetPresenceContainer(a).then(function(){setTimeout(d,0)}.bind(this),function(a){c.reject(a)}.bind(this))}.bind(this),function(a){c.notify(a)})}.bind(this);return d(),c.promise()},c.prototype._onErrorGetPresenceContainer=function(c){var d=b.Deferred();this._createOrExtendPresenceContainerPromise=void 0;var e=a.Base.Utils.queryJSONObject(c,"_data._status");if(e===a.Base.NetworkErrorCodes.HTTP_NOT_FOUND||e===a.Base.NetworkErrorCodes.HTTP_BAD_REQUEST||e===a.Base.NetworkErrorCodes.HTTP_UNPROCESSABLE_ENTITY)switch(this._parseErrorCode(c.getData().getResponseText())){case 404001:case 4000004:return a.Base.Logger.warn(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Presence container expired/invalidated"),this._recreatePresenceContainer();case 4040012:return a.Base.Logger.warn(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Presence subscription is unknown"),a.Base.Utils.queryJSONObject(this._presenceContainer,"additionalResources.presenceSubscriptions[0]")&&(this._presenceContainer.additionalResources.presenceSubscriptions[0]=void 0),d.resolve().promise();case 4040011:case 4220085:return a.Base.Logger.warn(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Presence session is invalid"),this._createContainerAndSubscribe()}return d.reject(c).promise()},c.prototype._recreatePresenceContainer=function(){return this._deletePresenceContainer().then(this._createContainerAndSubscribe.bind(this))},c.prototype._createContainerAndSubscribe=function(){return this._presenceContainer=void 0,this._createOrExtendPresenceContainer(!0,!0).then(function(){this.subscribeForPresence(this._userSubscriptions)}.bind(this))},c.prototype._parseErrorCode=function(b){var c;try{if(b.length>0){var d=JSON.parse(b),e=typeof d;"object"===e?c=a.Base.Utils.queryJSONObject(d,"error[0].errorCode"):"string"===e&&(d=JSON.parse(d),c=a.Base.Utils.queryJSONObject(d,"error[0].serviceErrorCode"))}}catch(f){a.Base.Logger.warn(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Failed to parse error response",f)}return c},c.prototype._getPresenceContainer=function(){var c=!1,d=!1;if(this._presenceContainer){if(Date.now()<this._presenceContainerExpirationDate.getTime()&&(c=!a.Base.Utils.queryJSONObject(this._presenceContainer,"additionalResources.presenceSubscriptions[0]"),d=!a.Base.Utils.queryJSONObject(this._presenceContainer,"additionalResources.presencePublication"),!c&&!d))return a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Current presence subscription container should be valid, using it"),b.Deferred().resolve(this._presenceContainer)}else c=d=!0;return this._createOrExtendPresenceContainer(d,c)},c.prototype._createOrExtendPresenceContainer=function(c,d){if(!this._createOrExtendPresenceContainerPromise){var e=b.Deferred(),f=a.Base.Utils.queryJSONObject(this._presenceContainer,"containerResources.container.updateOrExtend.href")||this._csgProvider.getResourceHrefs()[a.Providers.CallServiceGateway.ResourceType.CreatePresenceContainer];a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Creating/updating presence container. Container exists: "+!!this._presenceContainer+", Publication resource needed: "+c+", Subscription resource needed: "+d),this._createOrExtendPresenceContainerPromise=e.promise();var g=this._messageBuilder.buildCreatePubSubContainerOptions(f),h=this._messageBuilder.buildCreateOrExtendPubSubContainerData(!!this._presenceContainer,c,d);this._csgProvider.send(h,g).then(function(c){if(this._presenceContainer=this._parsePresenceContainerResponse(c)||this._presenceContainer,!this._presenceContainer)return b.Deferred().reject(new a.Services.Presence.PresenceError(a.Services.Presence.PresenceErrorReason.INVALID_RESPONSE,"Received invalid response from server to create presence container request"));this._presenceContainerRefreshTimeoutId=setTimeout(this._createOrExtendPresenceContainer.bind(this),.8*this._presenceContainer.expires*1e3),this._createOrExtendPresenceContainerPromise=void 0,e.resolve(this._presenceContainer)}.bind(this),function(a){this._createOrExtendPresenceContainerPromise=void 0,e.reject(a)}.bind(this))}return this._createOrExtendPresenceContainerPromise},c.prototype._deletePresenceContainer=function(){if(!this._deletePresenceContainerPromise){a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Deleting presence container");var c=b.Deferred(),d=a.Base.Utils.queryJSONObject(this._presenceContainer,"containerResources.container.delete.href");this._deletePresenceContainerPromise=c.promise();var e=function(){this._presenceContainer=void 0,this._deletePresenceContainerPromise=void 0,c.resolve(),a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Deleted presence container")}.bind(this);if(d){var f=this._messageBuilder.buildDeletePubSubContainerOptions(d);this._csgProvider.send(void 0,f).then(e,e)}else e()}return this._deletePresenceContainerPromise},c.prototype._parsePresenceContainerResponse=function(c){var d;try{d=JSON.parse(c)}catch(f){}if(d&&d.pubSubContainer){var e=b.extend(new a.Providers.CallServiceGateway.CSGPresenceContainer,d.pubSubContainer);if(e.expires&&e.containerResources.container.updateOrExtend.href&&e.additionalResources.presencePublication.replace.href&&e.additionalResources.presenceSubscriptions[0].replace.href)return this._presenceContainerExpirationDate=new Date(Date.now()+1e3*e.expires),e}},c.prototype._buildUnknownPresence=function(b){var c=new a.Services.Presence.Presence(b);return c._setOverallState(a.Services.Presence.PresenceState.PRESENCE_STATE_UNKNOWN),c._setManualState(a.Services.Presence.ManualPresenceState.PRESENCE_STATE_UNKNOWN),c._setVideoState(a.Services.Presence.VideoPresenceState.PRESENCE_STATE_UNKNOWN),c._setVideoContact(void 0),c._setPhoneState(a.Services.Presence.PhonePresenceState.PRESENCE_STATE_UNKNOWN),c._setPhoneContact(void 0),c._setEnterpriseIMState(a.Services.Presence.IMPresenceState.PRESENCE_STATE_UNKNOWN),c._setEnterpriseIMContact(void 0),c._setCalendarState(a.Services.Presence.CalendarPresenceState.PRESENCE_STATE_UNKNOWN),c._setCalendarStartTime(void 0),c._setCalendarEndTime(void 0),c},a.Providers.CallServiceGateway.CSGPresenceProvider=c}(AvayaClientServices,jQuery),function(a,b){"use strict";function c(b,c){a.Providers.Interfaces.AbstractProvider.call(this),this._callProvider=b,this._ownerCallId=c,this._isVideoAllowed=!1;var d=this._callProvider.lookupCall(this._ownerCallId);if(d){var e=d._callService.getVideoCapability();this._isVideoAllowed=e.isAllowed,e.addOnChangedCallback(this._monitorVideoCapability.bind(this))}}c.prototype=Object.create(a.Providers.Interfaces.AbstractProvider.prototype),c.prototype.start=function(c,d){return c._isVideoAllowed=this._isVideoAllowed,a.Base.Logger.info(a.Base.LoggerTags.CM_CONFERENCE_PROVIDER,"started..."),b.Deferred().resolve()},c.prototype.stop=function(){var c=this._callProvider.lookupCall(this._ownerCallId);return c&&c._callService.getVideoCapability().removeOnChangedCallback(this._monitorVideoCapability.bind(this)),a.Base.Logger.info(a.Base.LoggerTags.CM_CONFERENCE_PROVIDER,"stopped..."),b.Deferred().resolve()},c.prototype._monitorVideoCapability=function(a){this._isVideoAllowed=a.isAllowed},c.prototype.observeConference=function(c){return b.Deferred().reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"observeConference method is not implemented"})},c.prototype.disconnectParticipant=function(c){return b.Deferred().reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"disconnectParticipant method is not implemented"})},c.prototype.setAsLecturer=function(c){return b.Deferred().reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"setAsLecturer method is not implemented"})},c.prototype.setLocked=function(c){return b.Deferred().reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"setLocked method is not implemented"})},c.prototype.setVideoLayoutTextOverlay=function(c){return b.Deferred().reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"setVideoLayoutTextOverlay method is not implemented"})},c.prototype.setVideoLayoutSelfSee=function(c){return b.Deferred().reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"setVideoLayoutSelfSee method is not implemented"})},c.prototype.setVideoLayout=function(c){return b.Deferred().reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"setVideoLayout method is not implemented"})},c.prototype.terminateConference=function(){return a.Base.Logger.info(a.Base.LoggerTags.CM_CONFERENCE_PROVIDER,"terminated..."),b.Deferred().resolve()},c.prototype.removeLastParticipant=function(){return b.Deferred().reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"removeLastParticipant method is not implemented"})},c.prototype.requestToBecomeModerator=function(c){return b.Deferred().reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"requestToBecomeModerator method is not implemented"})},c.prototype.signIn=function(c){return b.Deferred().reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"signIn method is not implemented"})},c.prototype.videoPin=function(c,d,e,f,g){return b.Deferred().reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"videoPin method is not implemented"})},c.prototype.extendMeeting=function(c){return b.Deferred().reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"extendMeeting method is not implemented"})},c.prototype.addParticipant=function(c){return b.Deferred().reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"addParticipant method is not implemented"})},c.prototype.addParticipantFromCall=function(a){return this._callProvider.addParticipantFromCall(this._ownerCallId,a)},c.prototype.cancelDialoutParticipant=function(c){return b.Deferred().reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"cancelDialoutParticipant method is not implemented"})},c.prototype.startRecording=function(c,d,e){return b.Deferred().reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"startRecording method is not implemented"})},c.prototype.stopRecording=function(c){return b.Deferred().reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"stopRecording method is not implemented"})},c.prototype.pauseRecording=function(c){return b.Deferred().reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"pauseRecording method is not implemented"})},c.prototype.resumeRecording=function(c){return b.Deferred().reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"resumeRecording method is not implemented"})},c.prototype.unsetAsLecturer=function(){return b.Deferred().reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"unsetAsLecturer method is not implemented"})},c.prototype.controlRemoteCamera=function(c,d){return b.Deferred().reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"controlRemoteCamera method is not implemented"})},c.prototype.muteUnmute=function(c,d,e){return b.Deferred().reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"muteUnmute method is not implemented"})},c.prototype.sendChatMessage=function(c,d){return b.Deferred().reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"sendChatMessage method is not implemented"})},c.prototype.muteUnmuteAll=function(c){return b.Deferred().reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"muteUnmuteAll method is not implemented"})},c.prototype.raiseLowerHand=function(c){return b.Deferred().reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"raiseLowerHand method is not implemented"})},c.prototype.moderatorLowerHand=function(c,d){return b.Deferred().reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"moderatorLowerHand method is not implemented"})},c.prototype.getDialInInfo=function(){return b.Deferred().reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"getDialInInfo method is not implemented"})},c.prototype.sendDisconnectEvent=function(c){return b.Deferred().reject({name:a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,message:"sendDisconnectEvent method is not implemented"})},c.prototype.recalculateAddParticipantFromCallCapability=function(b,c){var d,e,f=this._callProvider.lookupCall(this._ownerCallId);f&&f.getState()===a.Services.Call.CallStates.ESTABLISHED?c.isConference()&&f.getConference()._isAvailable?f.getConference()._getType()!==c.getConference()._getType()?(d=!0,e=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(d=!1,e=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(d=!0,e=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(d=!1,e=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),b._addParticipantFromCallCapabilities[c.getCallId()]._updateIfChanged(d,e)},c.prototype.recalculateAddParticipantFromCallCapabilityByCallId=function(a,b){var c=this._callProvider.lookupCall(b);c&&this.recalculateAddParticipantFromCallCapability(a,c)},c.prototype.sendLocalMuteEvent=function(a,c){return b.Deferred().resolve().promise()},a.Providers.CM.CMConferenceProvider=c}(AvayaClientServices,jQuery),function(a,b,c){"use strict";function d(b,c,d,e,f,g,h){a.Providers.Interfaces.AbstractProvider.call(this),this._collaborationProvider=b,this._networkProvider=h,this._screenCapturer=c,this._sharingCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._contentSharingTagBuilder=d,this._bandwidthManager=e,this._screenSharingTagEncoder=f,this._startDeferred=void 0,this._maxQueueDelay=3,this._browser=void 0,this._config=g,h&&this._networkProvider.addOnCapabilityChange(this._capabilityUpdate())}d.prototype=Object.create(a.Providers.Interfaces.AbstractProvider.prototype),d.prototype.start=function(){this._networkProvider&&this._networkProvider.start()},d.prototype.stop=function(){this._networkProvider&&this._networkProvider.stop()},d.prototype.startScreenSharing=function(){return this._screenCapturer.on(a.Providers.ContentSharing.ScreenCapturerEvents.BLOCKS_CHANGED,function(a,b){this.sendFrame(a,b)}.bind(this)),this._screenCapturer.on(a.Providers.ContentSharing.ScreenCapturerEvents.WINDOW_CLOSED,function(){this.stopScreenSharing()}.bind(this)),this._updateServerCapabilities=function(a){this._screenCapturer.setServerCapabilities(a)}.bind(this),this._collaborationProvider.on(a.Providers.Interfaces.CollaborationProviderCallbackIds.SERVER_CAPABILITIES,this._updateServerCapabilities),this._startScreenSharing()},d.prototype.sendFrame=function(b,c){var d=new a.Providers.ContentSharing.FrameBlocks(c),e=this._contentSharingTagBuilder.createStartTag(c,c?this._screenCapturer.getWidth():0,c?this._screenCapturer.getHeight():0);e=this._screenSharingTagEncoder.encodeTag(e),d.addBlock(e),b.forEach(function(a){var b=this._contentSharingTagBuilder.createBlockTag(a);b=this._screenSharingTagEncoder.encodeTag(b),d.addBlock(b)}.bind(this)),d.addBlock(this._screenSharingTagEncoder.encodeTag(this._contentSharingTagBuilder.createEndTag())),this._bandwidthManager.addToQueue(d);var f=this._bandwidthManager.getQueueDelay();f>this._maxQueueDelay&&(a.Base.Logger.debug(a.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Screen sharing queue is longer that "+this._maxQueueDelay+" seconds. Delay is in process. Resuming in "+f+" seconds."),this._screenCapturer.delayCapturing(1e3*f))},d.prototype.startFullScreen=function(){throw a.Base.Logger.debug(a.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"MUST override AbstractScreenSharingProvider.startFullScreen()"),new Error("Cannot start fullscreen sharing. Unknown provider.")},d.prototype.startApplicationWindow=function(){throw a.Base.Logger.debug(a.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"MUST override AbstractScreenSharingProvider.startApplicationWindow()"),new Error("Cannot start window sharing. Unknown provider.")},d.prototype.stopScreenSharing=function(b){return this._bandwidthManager.stop().then(function(){return this.stopScreenCapturer()}.bind(this)).then(function(){if(!b)return this._stopScreenSharing()}.bind(this)).always(function(){this._collaborationProvider.off(a.Providers.Interfaces.CollaborationProviderCallbackIds.SERVER_CAPABILITIES,this._updateServerCapabilities)}.bind(this))},d.prototype.stopScreenCapturer=function(){return this._screenCapturer.stop()},d.prototype.pause=function(){return a.Base.Logger.info(a.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Pause sharing..."),this._screenCapturer.pause().then(function(a){return a||this._pauseScreenSharing()}.bind(this))},d.prototype.resume=function(){return a.Base.Logger.info(a.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Resume sharing..."),this._screenCapturer.resume().then(function(a){return a?this._startScreenSharing():a}.bind(this))},d.prototype.getShareApplicationWindowCapability=function(){return this._sharingCapability},d.prototype.getShareFullScreenCapability=function(){return this._sharingCapability},d.prototype.isOpened=function(){return this._collaborationProvider.isOpened()},d.prototype._capabilityUpdate=function(){return function(b,c){if(a.Base.Logger.debug(a.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Extension: "+b+" is installed? "+c),!(a.Base.Utils.isDefined(this._config)&&a.Base.Utils.isDefined(this._config.contentSharingWorkerPath)&&""!==this._config.contentSharingWorkerPath))return void this._sharingCapability._updateIfChanged(!1,"Content sharing worker path is missing");c?this._sharingCapability._updateIfChanged(c,b+" extension was installed or enabled"):this._sharingCapability._updateIfChanged(c,b+" extension was uninstalled or disabled")}.bind(this)},d.prototype._startScreenSharing=function(){return this._collaborationProvider.startScreenSharing()},d.prototype._stopScreenSharing=function(){return this._collaborationProvider.stopScreenSharing()},d.prototype._pauseScreenSharing=function(){return this._collaborationProvider.pauseScreenSharing()},d.prototype._getUserMedia=function(b){navigator.mediaDevices.getUserMedia(b).then(function(b){var d=c.extend(new a.Providers.ContentSharing.ScreenCapturerConfig,this._config,this._collaborationProvider.getServerCapabilities());this._screenCapturer.start(b,d,this._browser).then(function(){return this._bandwidthManager.start(this._screenCapturer._config),a.Providers.ContentSharing.AbstractScreenSharingProvider.prototype.startScreenSharing.call(this)}.bind(this)).then(function(){"pending"===this._startDeferred.state()&&this._startDeferred.resolve()}.bind(this),function(a){"pending"===this._startDeferred.state()&&this._startDeferred.reject(a)}.bind(this))}.bind(this),function(b){a.Base.Logger.error(a.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Failed to retrieve stream",b),"pending"===this._startDeferred.state()&&this._startDeferred.reject(b)}.bind(this))},a.Providers.ContentSharing.AbstractScreenSharingProvider=d}(AvayaClientServices,window,jQuery),function(a,b,c){"use strict";function d(b,c,d,e,f,g,h,i){a.Providers.ContentSharing.AbstractScreenSharingProvider.call(this,b,c,d,e,f,g,h),this._extensionRequestBuilder=i,this._mediaSourceId=void 0,this._browser=a.Base.BrowserType.CHROME}d.prototype=Object.create(a.Providers.ContentSharing.AbstractScreenSharingProvider.prototype),d.prototype.startFullScreen=function(){return a.Base.Logger.info(a.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Chrome: Start full screen sharing..."),this._startDeferred=c.Deferred(),this._startEventListener(),this._networkProvider.send(this._extensionRequestBuilder.createStartSharingRequest("screen")),this._startDeferred.promise()},d.prototype.startApplicationWindow=function(){return a.Base.Logger.info(a.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Chrome: Start appl window sharing..."),this._startDeferred=c.Deferred(),this._startEventListener(),this._networkProvider.send(this._extensionRequestBuilder.createStartSharingRequest("window")),this._startDeferred.promise()},d.prototype.stopScreenSharing=function(b){return a.Base.Logger.info(a.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Chrome: Stop sharing..."),a.Providers.ContentSharing.AbstractScreenSharingProvider.prototype.stopScreenSharing.call(this,b).then(function(){this._networkProvider.send(this._extensionRequestBuilder.createStopSharingRequest(this._mediaSourceId)),this._mediaSourceId=void 0,this._removeEventListener()}.bind(this))},d.prototype.stopScreenCapturer=function(){return this._removeEventListener(),this._screenCapturer.stop()},d.prototype._startEventListener=function(){this._networkProvider.addOnMediaAvailableCallback(this._handleMediaAvailableEvent.bind(this)),this._networkProvider.addOnMediaCancelledCallback(this._handleMediaCanceledEvent.bind(this))},d.prototype._removeEventListener=function(){this._networkProvider._onMediaAvailableCallbacks.empty(),this._networkProvider._onMediaCancelledCallbacks.empty()},d.prototype._handleMediaAvailableEvent=function(c){a.Base.Logger.debug(a.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"User enabled screen sharing"),this._mediaSourceId=c.data.mediaSourceId;var d={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:this._mediaSourceId,maxWidth:b.screen.width,maxHeight:b.screen.height,maxFrameRate:3}}};this._getUserMedia(d),this._removeEventListener()},d.prototype._handleMediaCanceledEvent=function(b){a.Base.Logger.error(a.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,b),this._removeEventListener(),"pending"===this._startDeferred.state()&&this._startDeferred.reject(b)},a.Providers.ContentSharing.ChromeScreenSharingProvider=d}(AvayaClientServices,window,jQuery),function(a,b,c){"use strict";function d(b,c,d,e,f,g){a.Providers.ContentSharing.AbstractScreenSharingProvider.call(this,b,c,d,e,f,g),this._startDeferred=void 0,this._browser=a.Base.BrowserType.FIREFOX}d.prototype=Object.create(a.Providers.ContentSharing.AbstractScreenSharingProvider.prototype),d.prototype.start=function(){this._sharingCapability._updateIfChanged(!0,"Firefox extension was enabled")},d.prototype.stop=function(){this._sharingCapability._updateIfChanged(!1,"Firefox extension was disabled")},d.prototype.startFullScreen=function(){return a.Base.Logger.info(a.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Firefox: Start full screen sharing..."),this._startDeferred=c.Deferred(),this._getScreenStream("screen"),this._startDeferred.promise()},d.prototype.startApplicationWindow=function(){return a.Base.Logger.info(a.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Firefox: Start appl window sharing..."),this._startDeferred=c.Deferred(),this._getScreenStream("window"),this._startDeferred.promise()},d.prototype.stopScreenSharing=function(b){return a.Base.Logger.info(a.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Firefox: Stop sharing..."),a.Providers.ContentSharing.AbstractScreenSharingProvider.prototype.stopScreenSharing.call(this,b)},d.prototype._getScreenStream=function(c){a.Base.Logger.debug(a.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"User enabled screen sharing: "+c);var d={audio:!1,video:{mediaSource:c,mandatory:{maxWidth:b.screen.width,maxHeight:b.screen.height,maxFrameRate:3}}};this._getUserMedia(d)},a.Providers.ContentSharing.FirefoxScreenSharingProvider=d}(AvayaClientServices,window,jQuery),function(a){"use strict";function b(b){a.Providers.UCCP.UCCPMessage.call(this,"activeTalkerChangedEvent"),this.participantId=b}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPActiveTalkerChangedEvent=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.ADMISSION_RESPONSE),this.transId=b,this.responseCode=c}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPAdmissionResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d,e){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.AVAILABLE_LAYOUTS_CHANGED_EVENT),this.textOverlay=b,this.noSelfSee=c,this.videoPin=d,
this.geometries=e}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPAvailableLayoutsChangedEvent=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.CHANGE_LAYOUT_GEOMETRY_RESPONSE),this.transId=b,this.responseCode=c}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPChangeLayoutGeometryResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.CHANGE_LAYOUT_NO_SELF_SEE_RESPONSE),this.transId=b,this.responseCode=c}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPChangeLayoutNoSelfSeeResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.CHANGE_LAYOUT_OVERLAY_RESPONSE),this.transId=b,this.responseCode=c}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPChangeLayoutTextOverlayResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d,e){a.Providers.UCCP.UCCPMessage.call(this,"chatEvent"),this.participantId=b,this.type=c,this.text=e,this.time=d}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPChatEvent=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.CHAT_RESPONSE),this.transId=b,this.responseCode=c}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPChatResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.CURRENT_LAYOUT_CHANGED_EVENT),this.textOverlay=b,this.noSelfSee=c,this.geometry=d}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPCurrentLayoutChangedEvent=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d,e,f){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.CURRENT_LAYOUT_RESPONSE),this.transId=b,this.responseCode=c,this.textOverlay=d,this.noSelfSee=e,this.geometry=f}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPCurrentLayoutResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d,e,f){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.DIAL_IN_INFO_RESPONSE),this.transId=b,this.responseCode=c,this.webLink=d,this.streamingLink=e,this.dialInInformation=f}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPDialInInfoResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.DIALOUT_CANCEL_RESPONSE),this.transId=b,this.responseCode=c}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPDialoutCancelResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.UCCP.UCCPMessage.call(this,"dialoutCompletedEvent"),this.participantId=b,this.result=c}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPDialoutCompletedEvent=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.DIALOUT_RESPONSE),this.transId=b,this.responseCode=c,this.participantId=d}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPDialoutResponse=b}(AvayaClientServices),function(a){"use strict";function b(b){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.DISCONNECT_EVENT),this.reason=b}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPDisconnectEvent=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.UCCP.UCCPMessage.call(this,"disconnectParticipantResponse"),this.transId=b,this.responseCode=c}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPDisconnectParticipantResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.EXTEND_MEETING_RESPONSE),this.transId=b,this.responseCode=c}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPExtendMeetingResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.FECC_RESPONSE),this.transId=b,this.responseCode=c}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPFeccResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d,e,f,g,h,i,j){a.Providers.UCCP.UCCPMessage.call(this,"handshakeResponse"),this.transId=b,this.responseCode=c,this.version=d,this.participantId=e,this.externalAdmissionNeeded=f,this.admissionPasscodeNeeded=g,this.admissionPermissionNeeded=h,this.commands=i,this.currentTime=j}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPHandshakeResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.LECTURE_MODE_START_RESPONSE),this.transId=b,this.responseCode=c}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPLectureModeStartResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.LECTURE_MODE_STOP_RESPONSE),this.transId=b,this.responseCode=c}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPLectureModeStopResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.UCCP.UCCPMessage.call(this,"lockMeetingResponse"),this.transId=b,this.responseCode=c}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPLockMeetingResponse=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d,e,f,g,h,i,j,k,l,m){a.Providers.UCCP.UCCPMessage.call(this,"meetingInfoChangedEvent"),this.media=b,this.locked=c,this.mediaStatus=d,this.lecturerId=e,this.lecturerName=f,this.presenterId=g,this.presenterName=h,this.recording=i,this.streaming=j,this.encrypted=k,this.slidesAvailable=l,this.terminationTime=m}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPMeetingInfoChangedEvent=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Providers.UCCP.UCCPMessage.call(this,"meetingTerminationInProgressEvent"),this.reason=b,this.userName=c}b.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPMeetingTerminationInProgressEvent=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){var c={};b.note&&(c.type=a.Base.Utils.queryJSONObject(b,"note[0]._attr.type._value"),c.text=a.Base.Utils.queryJSONObject(b,"note[0]._text")),c.meetingOwner="Y"===a.Base.Utils.queryJSONObject(b,"_attr.meeting_owner._value"),b._attr.target_id?(c.targetId=a.Base.Utils.queryJSONObject(b,"_attr.target_id._value"),c.personal=!0):c.personal=!1;var d=new a.Providers.WCS.AddNoteEventData(c.type,c.text,c.meetingOwner,c.personal,c.targetId);return new a.Providers.WCS.AddNoteEvent(this.stripCommonData(b),d)},a.Providers.WCS.AddNoteParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){return new a.Providers.WCS.AddWhiteboardEvent(this.stripCommonData(b))},a.Providers.WCS.AddWhiteboardParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){var c={};c.targetId=a.Base.Utils.queryJSONObject(b,"_attr.target_id._value");var d=new a.Providers.WCS.AllowPresentingEventData(c.targetId);return new a.Providers.WCS.AllowPresentingEvent(this.stripCommonData(b),d)},a.Providers.WCS.AllowPresentingParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){var c={};if(b.selection[0]._attr&&$.each(b.selection[0]._attr,function(a,b){c[this.stringToCamel(a)]=b._value}.bind(this)),c.group){var d=this.convertGroup(c.group);c.layerType=d.layerType,c.groupId=d.groupId,delete c.group}var e=new a.Providers.WCS.ClearDrawingEventData(c.groupId,c.layerType);return new a.Providers.WCS.ClearDrawingEvent(this.stripCommonData(b),e)},a.Providers.WCS.ClearDrawingParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){var c={};b.note&&(c.event_id=a.Base.Utils.queryJSONObject(b,"note[0]._attr.event_id._value"));var d=new a.Providers.WCS.DeleteNoteEventData(c.event_id);return new a.Providers.WCS.DeleteNoteEvent(this.stripCommonData(b),d)},a.Providers.WCS.DeleteNoteParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){var c={};if(b.selection[0]._attr&&$.each(b.selection[0]._attr,function(a,b){c[this.stringToCamel(a)]=b._value}.bind(this)),c.group){var d=this.convertGroup(c.group);c.layerType=d.layerType,c.groupId=d.groupId,delete c.group}var e=new a.Providers.WCS.DeleteSelectionEventData(c.groupId,c.layerType,c.id,c.selectionX,c.selectionY);return new a.Providers.WCS.DeleteSelectionEvent(this.stripCommonData(b),e)},a.Providers.WCS.DeleteSelectionParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){var c=a.Base.Utils.queryJSONObject(b,"whiteboard[0]._attr.index._value"),d=new a.Providers.WCS.DeleteWhiteboardEventData(c);return new a.Providers.WCS.DeleteWhiteboardEvent(this.stripCommonData(b),d)},a.Providers.WCS.DeleteWhiteboardParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){return new a.Providers.WCS.DenyControlEvent(this.stripCommonData(b))},a.Providers.WCS.DenyControlParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){var c={};c.targetId=a.Base.Utils.queryJSONObject(b,"_attr.target_id._value"),c.targetName=a.Base.Utils.queryJSONObject(b,"_attr.target_name._value");var d=new a.Providers.WCS.DenyPresentingEventData(c.targetId,c.targetName);return new a.Providers.WCS.DenyPresentingEvent(this.stripCommonData(b),d)},a.Providers.WCS.DenyPresentingParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){var c={};if(b.circle[0]._attr&&$.each(b.circle[0]._attr,function(a,b){c[this.stringToCamel(a)]=b._value}.bind(this)),a.Base.Utils.isDefined(c.fillColor)&&(c.fillColor=a.Base.Utils.colorIntToHex(c.fillColor),c.filled=!0),a.Base.Utils.isDefined(c.color)&&(c.color=a.Base.Utils.colorIntToHex(c.color),c.contour=!0),c.group){var d=this.convertGroup(c.group);c.layerType=d.layerType,c.groupId=d.groupId,delete c.group}var e=new a.Providers.WCS.DrawCircleEventData(c.alpha,c.fillColor,c.color,c.groupId,c.layerType,c.width,c.x0,c.x1,c.y0,c.y1,c.filled,c.contour);return new a.Providers.WCS.DrawCircleEvent(this.stripCommonData(b),e)},a.Providers.WCS.DrawCircleParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){var c={},d=[],e=[];if(b.m)e.push({x:a.Base.Utils.queryJSONObject(b,"m[0]._attr.x._value"),y:a.Base.Utils.queryJSONObject(b,"m[0]._attr.y._value")});else{if(b.lines&&b.lines[0]._attr&&$.each(b.lines[0]._attr,function(a,b){c[this.stringToCamel(a)]=b._value}.bind(this)),a.Base.Utils.isDefined(c.fillColor)&&(c.fillColor=a.Base.Utils.colorIntToHex(c.fillColor),c.filled=!0),a.Base.Utils.isDefined(c.color)&&(c.color=a.Base.Utils.colorIntToHex(c.color),c.contour=!0),c.group){var f=this.convertGroup(c.group);c.layerType=f.layerType,c.groupId=f.groupId,delete c.group}b.lines&&b.lines[0].l&&$.each(b.lines[0].l,function(a,b){d.push({x:b._attr.x._value,y:b._attr.y._value})}.bind(this)),b.lines&&b.lines[0].m&&$.each(b.lines[0].m,function(a,b){e.push({x:b._attr.x._value,y:b._attr.y._value})}.bind(this))}var g=new a.Providers.WCS.DrawShapeEventData(c.alpha,c.fillColor,c.color,c.groupId,c.layerType,c.width,d,e,c.filled,c.contour);return new a.Providers.WCS.DrawShapeEvent(this.stripCommonData(b),g)},a.Providers.WCS.DrawShapeParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){var c={};if(b.drawText[0]._attr&&$.each(b.drawText[0]._attr,function(a,b){c[this.stringToCamel(a)]=b._value}.bind(this)),a.Base.Utils.isDefined(c.fillColor)&&(c.fillColor=a.Base.Utils.colorIntToHex(c.fillColor)),c.group){var d=this.convertGroup(c.group);c.layerType=d.layerType,c.groupId=d.groupId,delete c.group}var e=new a.Providers.WCS.DrawTextEventData(c.fillColor,c.fontSize,c.groupId,c.layerType,c.text,c.x,c.y);return new a.Providers.WCS.DrawTextEvent(this.stripCommonData(b),e)},a.Providers.WCS.DrawTextParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){var c={};c.targetId=a.Base.Utils.queryJSONObject(b,"_attr.target_id._value"),c.targetName=a.Base.Utils.queryJSONObject(b,"_attr.target_name._value"),c.targetParticipantId=a.Base.Utils.queryJSONObject(b,"_attr.targetParticipantId._value");var d=new a.Providers.WCS.EjectParticipantEventData(c.targetId,c.targetName,c.targetParticipantId);return new a.Providers.WCS.EjectParticipantEvent(this.stripCommonData(b),d)},a.Providers.WCS.EjectParticipantParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){return new a.Providers.WCS.EndControlEvent(this.stripCommonData(b))},a.Providers.WCS.EndControlParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){var c={};if(b.lines[0]._attr&&$.each(b.lines[0]._attr,function(a,b){c[this.stringToCamel(a)]=b._value}.bind(this)),c.group){var d=this.convertGroup(c.group);c.layerType=d.layerType,c.groupId=d.groupId,delete c.group}var e=new a.Providers.WCS.EndDrawShapeEventData(c.groupId,c.layerType);return new a.Providers.WCS.EndDrawShapeEvent(this.stripCommonData(b),e)},a.Providers.WCS.EndDrawShapeParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){return new a.Providers.WCS.EndMeetingEvent(this.stripCommonData(b))},a.Providers.WCS.EndMeetingParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){return new a.Providers.WCS.EndScreenSharingEvent(this.stripCommonData(b))},a.Providers.WCS.EndScreenSharingParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){return new a.Providers.WCS.EndWhiteboardEvent(this.stripCommonData(b))},a.Providers.WCS.EndWhiteboardParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.AbstractParser.prototype),b.prototype.parse=function(b){var c={code:a.Base.Utils.queryJSONObject(b,"code[0]._text"),message:a.Base.Utils.queryJSONObject(b,"message[0]._text"),request_id:a.Base.Utils.queryJSONObject(b,"request_id[0]._text"),ws_connection_id:a.Base.Utils.queryJSONObject(b,"ws_connection_id[0]._text")},d=new a.Providers.WCS.ErrorEventData(c.code,c.message,c.request_id,c.ws_connection_id);return new a.Providers.WCS.ErrorEvent(d)},a.Providers.WCS.ErrorParser=b}(AvayaClientServices),function(a){"use strict";function b(){}b.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype),b.prototype.parse=function(b){var c=a.Base.Utils.queryJSONObject(b,"os_type[0]._text"),d=new a.Providers.WCS.GrantControlEventData(c);return new a.Providers.WCS.GrantControlEvent(this.stripCommonData(b),d)},a.Providers.WCS.GrantControlParser=b}(AvayaClientServices),function(a){"use strict";function b(){a.Providers.WCS.WCSSharingTag.call(this,a.Providers.WCS.WCSScreenSharingTagTypes.BLOCK_TAG),this.width=0,this.height=0,this.x=0,this.y=0,this.imageType=0,this.length=0,this.data=[]}b.prototype=Object.create(a.Providers.WCS.WCSSharingTag.prototype),a.Providers.WCS.ScreenSharingBlockTag=b}(AvayaClientServices),function(a){"use strict";function b(){a.Providers.WCS.WCSSharingTag.call(this,a.Providers.WCS.WCSScreenSharingTagTypes.CURSOR_TAG),this.x=0,this.y=0,this.creationTime=0}b.prototype=Object.create(a.Providers.WCS.WCSSharingTag.prototype),a.Providers.WCS.ScreenSharingCursorTag=b}(AvayaClientServices),function(a){"use strict";function b(){a.Providers.WCS.WCSSharingTag.call(this,a.Providers.WCS.WCSScreenSharingTagTypes.END_TAG)}b.prototype=Object.create(a.Providers.WCS.WCSSharingTag.prototype),a.Providers.WCS.ScreenSharingEndTag=b}(AvayaClientServices),function(a){"use strict";function b(){a.Providers.WCS.WCSSharingTag.call(this,a.Providers.WCS.WCSScreenSharingTagTypes.START_TAG),this.isKeyFrame=!1,this.width=0,this.height=0,this.creationTime=0}b.prototype=Object.create(a.Providers.WCS.WCSSharingTag.prototype),a.Providers.WCS.ScreenSharingStartTag=b}(AvayaClientServices),function(a){"use strict";function b(b){a.Base.RESTProvider.apply(this),this.type=a.Base.ProviderTypes.WCS_COMET_PROVIDER,this._connectionId=void 0,this._isOpened=!1,this._polling=!1,this._options={},this._parser=b,this._keepAliveTimeout=void 0,this._keepAliveTimer=3e4}b.prototype=Object.create(a.Base.RESTProvider.prototype),b.prototype.onConnectionUnavailable=function(){},b.prototype.close=function(){this._isOpened?(a.Base.RESTProvider.prototype.close.call(this),this._polling=!1,this._isOpened=!1,this._parser.removeOnMessageParsedCallback(this.onMessage)):this.onClose()},b.prototype.run=function(a){this._options=a,this._isOpened&&(this._polling=!0,this._poll(),this._parser.addOnMessageParsedCallback(this.onMessage))},b.prototype.start=function(b,c){return this._isOpened?(this.onOpen(),$.Deferred().resolve().promise()):(this._isOpened=!0,this._maxConnectionErrorCount=b.maxConnectionErrorCount,a.Base.RESTProvider.prototype.start.call(this,b,c))},b.prototype.send=function(b,c,d){return a.Base.Utils.isDefined(this._connectionId)&&(c.query="connection_id="+this._connectionId,c.sendType&&"POST"!==c.sendType||(b=this._addWCSHeader(b),c.processData=!1,c.dataType="binary",c.contentType="application/octet-stream")),d||(d=new a.Base.NetworkRequestRetryHelper(function(){return this.send(b,c,d)}.bind(this))),this._keepAlive(),c.keepAliveCallback=this._keepAlive.bind(this),a.Base.RESTProvider.prototype.send.call(this,b,c,d).then(function(b){var c=xmlToJSON.parseString(b);return a.Base.Utils.isUndefined(this._connectionId)&&(this._connectionId=a.Base.Utils.queryJSONObject(c,"response[0].live_session[0].ws_connection_id[0]._text")),c}.bind(this),function(a){a&&(this._keepAliveTimeout&&clearTimeout(this._keepAliveTimeout),this._connectionId=void 0,this._isOpened=!1,this._polling=!1,this.onConnectionUnavailable())}.bind(this))},b.prototype.isOpened=function(){return this._isOpened},b.prototype._ajaxOnSuccess=function(a,b,c,d){return this._removeXhrFromPool(c),d.resolve(a),a},b.prototype._poll=function(){this._polling&&(this._options.sendType="GET",this._options.dataType="binary",this._options.responseType="arraybuffer",this._options.binaryProgressCallback=this._parser.parse.bind(this._parser),this.send(void 0,this._options).done(function(){this._poll()}.bind(this)))},b.prototype._addWCSHeader=function(b){b=a.Base.Utils.stringToArrayBuffer(b);var c=a.Base.Utils.stringToArrayBuffer(this._parser.msgHeaderDetails.msgTxt),d=new ArrayBuffer(this._parser.msgHeaderDetails.flagSize);new DataView(d).setUint8(0,this._parser.msgHeaderDetails.binaryFlagValue);var e=new ArrayBuffer(this._parser.msgHeaderDetails.lengthIndicatorSize);return new DataView(e).setUint32(0,b.byteLength),b=a.Base.Utils.concatArrayBuffers(a.Base.Utils.concatArrayBuffers(a.Base.Utils.concatArrayBuffers(c,d),e),b)},b.prototype._keepAlive=function(a){this._keepAliveTimeout&&clearTimeout(this._keepAliveTimeout),4!==a&&(this._keepAliveTimeout=setTimeout(function(){this._connectionId=void 0,this.close(),this.onConnectionUnavailable()}.bind(this),this._keepAliveTimer))},a.Providers.WCS.WCSCometProvider=b}(AvayaClientServices),function(a,b){"use strict";function c(c){this._callService=c,this._conference=void 0,this._remoteAddress="",this._remoteDisplayName="",this._callId=void 0,this._incoming=!1,this._subject="",this._dataOnly=!1,this._establishedTime=void 0,this._heldTime=void 0,this._remoteParticipant=new a.Services.Participant,this._activeParticipants=[],this._callState=a.Services.Call.CallStates.IDLE,this._confEntryOptions=void 0,this._callCreationInfo=void 0,this._videoChannels=[],this._incomingVideoOffered=a.Services.Call.VideoNetworkSignalingType.INDEFINITE,this._isServiceAvailable=!1,this._isPrivateCallerID=!1,this._isAuraAsserted=!1,this._alertType=a.Services.Call.AlertType.UNSPECIFIED,this._heldRemotely=!1,this._remote=!1,this._isMissed=!1,this._modes=[],this._dtmfString=void 0,this._isEarlyMedia=!1,this._participantDroppedCallbacks=b.Callbacks(),this._onCallStartedCallbacks=b.Callbacks(),this._onCallRemoteAlertingCallbacks=b.Callbacks(),this._onCallRedirectedCallbacks=b.Callbacks(),this._onCallQueuedCallbacks=b.Callbacks(),this._onCallIgnoredCallbacks=b.Callbacks(),this._onCallEstablishedCallbacks=b.Callbacks(),this._onCallEstablishingCallbacks=b.Callbacks(),this._onCallRemoteAddressChangedCallbacks=b.Callbacks(),this._onCallHeldCallbacks=b.Callbacks(),this._onCallUnheldCallbacks=b.Callbacks(),this._onCallHeldRemotelyCallbacks=b.Callbacks(),this._onCallUnheldRemotelyCallbacks=b.Callbacks(),this._onCallJoinedCallbacks=b.Callbacks(),this._onCallEndedCallbacks=b.Callbacks(),this._onCallAudioMuteStatusChangedCallbacks=b.Callbacks(),this._onCallSpeakerMuteStatusChangedCallbacks=b.Callbacks(),this._onCallIncomingVideoAddRequestReceivedCallbacks=b.Callbacks(),this._onCallIncomingVideoAddRequestAcceptedCallbacks=b.Callbacks(),this._onCallIncomingVideoAddRequestDeniedCallbacks=b.Callbacks(),this._onCallIncomingVideoAddRequestTimedOutCallbacks=b.Callbacks(),this._onCallVideoChannelsUpdatedCallback=b.Callbacks(),this._onCallConferenceStatusChangedCallbacks=b.Callbacks(),this._remoteVideoAddedCallbacks=b.Callbacks(),this._remoteVideoRemovedCallbacks=b.Callbacks(),this._callFailedCallbacks=b.Callbacks(),this._callServiceAvailableCallbacks=b.Callbacks(),this._callServiceUnavailableCallbacks=b.Callbacks(),this._callVideoChannelsUpdatedCallbacks=b.Callbacks(),this._callStateChangedCallBacks=b.Callbacks(),this._answerCallRequestedCallbacks=b.Callbacks(),this._terminateCallRequestedCallbacks=b.Callbacks(),this._updateCallRequestedCallbacks=b.Callbacks(),this._isAudioMuted=!1,this._muteCapability=new a.Services.Call.Capabilities.MuteCapability(this),this._unmuteCapability=new a.Services.Call.Capabilities.UnmuteCapability(this),this._isSpeakerMuted=!1,this._ucid=void 0,this._muteSpeakerCapability=new a.Services.Call.Capabilities.MuteSpeakerCapability(this),this._unmuteSpeakerCapability=new a.Services.Call.Capabilities.UnmuteSpeakerCapability(this),this._videoChannelsCapability=new a.Services.Call.Capabilities.UpdateVideoChannelsCapability(this,c.getVideoCapability()),this._sendDTMFCapability=new a.Services.Call.Capabilities.SendDTMFCapability(this),this._holdCapability=new a.Services.Call.Capabilities.HoldCapability(this),this._unholdCapability=new a.Services.Call.Capabilities.UnholdCapability(this),this._joinCapability=new a.Services.Call.Capabilities.JoinCapability(this),this._transferCapability=new a.Services.Call.Capabilities.TransferCapability(this),this._transferToCapability=new a.Services.Call.Capabilities.TransferToCapability(this),this._updateVideoModeSendReceiveCapability=new a.Services.Call.Capabilities.UpdateVideoModeSendReceiveCapability(this,c.getVideoCapability()),this._updateVideoModeSendOnlyCapability=new a.Services.Call.Capabilities.UpdateVideoModeSendOnlyCapability(this,c.getVideoCapability()),this._updateVideoModeReceiveOnlyCapability=new a.Services.Call.Capabilities.UpdateVideoModeReceiveOnlyCapability(this,c.getVideoCapability()),this._updateVideoModeInactiveCapability=new a.Services.Call.Capabilities.UpdateVideoModeInactiveCapability(this,c.getVideoCapability()),this._updateVideoModeDisableCapability=new a.Services.Call.Capabilities.UpdateVideoModeDisableCapability(this,c.getVideoCapability())}c.prototype={_setRemoteAddress:function(a){this._remoteAddress=a,this._remoteParticipant.setAddress(a),this._callService._updateMatchedContactsForCall(this)},getRemoteAddress:function(){return this._remoteAddress},_setDtmfString:function(a){this._dtmfString=a},getRemoteDisplayName:function(){return this._remoteDisplayName},isIncoming:function(){return this._incoming},getEstablishedTime:function(){return this._establishedTime},getHeldTime:function(){return this._heldTime},_setRemoteDisplayName:function(a){this._remoteDisplayName=a,this._remoteParticipant.setDisplayName(a)},getRemoteParticipant:function(){return this._remoteParticipant},start:function(){this._setState(a.Services.Call.CallStates.INITIATING),this._callService.startCall(this)},end:function(){this._setState(a.Services.Call.CallStates.ENDING),this._callService.endCall(this)},getConference:function(){return a.Base.Utils.isUndefined(this._conference)&&(a.Base.Logger.info(a.Base.LoggerTags.CALL_SERVICE,"getConference(): Creating new CM Conference"),this._createCMConference()),this._conference},hold:function(){return this._callService.hold(this)},unhold:function(){return this._callService.unhold(this)},ignore:function(){return this._callService.ignore(this)},accept:function(){return this._callService.accept(this)},deny:function(){return this._setState(a.Services.Call.CallStates.ENDING),this._callService.endCall(this,a.Services.Call.CallDenialReason.BUSY)},denyWithReason:function(b){this._setState(a.Services.Call.CallStates.ENDING);var c=a.Services.Call.CallDenialReason.TEMPORARILY_UNAVAILABLE;for(var d in a.Services.Call.CallDenialReason)if(a.Services.Call.CallDenialReason[d]===b){c=b;break}return this._callService.endCall(this,c)},sendDTMF:function(a){return this._callService.sendDTMF(this,a)},getState:function(){return this._callState},getRemoteNumber:function(){return this._remoteAddress},isConference:function(){return void 0!==this._conference},isIgnored:function(){return this.getState()===a.Services.Call.CallStates.IGNORED},isRemote:function(){return this._remote},_setRemote:function(a){this._remote=a},isHeldRemotely:function(){return this._heldRemotely},isMissed:function(){return this._isMissed},_setIsMissed:function(a){this._isMissed=a},isCallerIdentityPrivate:function(){return this._isPrivateCallerID},isServiceAvailable:function(){return this._isServiceAvailable},getAlertType:function(){return this._alertType},getSubject:function(){return this._subject},join:function(){return this._callService.join(this)},acceptSendVideo:function(a){return this._callService.acceptSendVideo(this,a)},denySendVideo:function(){return this._callService.denySendVideo(this)},getVideoChannels:function(){return this._videoChannels},setVideoChannels:function(a){return this._callService.setVideoChannels(this,a)},removeAllVideoChannels:function(){return this._callService.setVideoMode(this,a.Services.Call.VideoMode.DISABLE)},setVideoMode:function(a){return this._callService.setVideoMode(this,a)},getIncomingVideoOffered:function(){return this._incomingVideoOffered},getCallId:function(){return this._callId},_setCallId:function(a){this._callId=a},isAudioMuted:function(){return this._isAudioMuted},muteAudio:function(){if(this._isAudioMuted){var c=b.Deferred();return c.reject(new a.Services.Call.CallException(a.Services.Call.CallError.MUTE_STATE_MISMATCH)),c.promise()}return this._callService.mute(this).then(function(){this._isAudioMuted=!0,this._muteCapability._recalculate(),this._unmuteCapability._recalculate()}.bind(this))},unmuteAudio:function(){if(this._isAudioMuted)return this._callService.unmute(this).then(function(){this._isAudioMuted=!1,this._muteCapability._recalculate(),this._unmuteCapability._recalculate()}.bind(this));var c=b.Deferred();return c.reject(new a.Services.Call.CallException(a.Services.Call.CallError.MUTE_STATE_MISMATCH)),c.promise()},isSpeakerMuted:function(){return this._isSpeakerMuted},muteSpeaker:function(){if(this._isSpeakerMuted){var c=b.Deferred();return c.reject(new a.Services.Call.CallException(a.Services.Call.CallError.MUTE_STATE_MISMATCH)),c.promise()}return this._callService.muteSpeaker(this).then(function(){this._isSpeakerMuted=!0,this._muteSpeakerCapability._recalculate(),this._unmuteSpeakerCapability._recalculate()}.bind(this))},unmuteSpeaker:function(){if(this._isSpeakerMuted)return this._callService.unmuteSpeaker(this).then(function(){this._isSpeakerMuted=!1,this._muteSpeakerCapability._recalculate(),this._unmuteSpeakerCapability._recalculate()}.bind(this));var c=b.Deferred();return c.reject(new a.Services.Call.CallException(a.Services.Call.CallError.MUTE_STATE_MISMATCH)),c.promise()},transfer:function(a){return this._callService.transfer(this,a)},attendedTransfer:function(a){return this._callService.attendedTransfer(this,a)},setConferenceEntryOptions:function(b){this._confEntryOptions=b,a.Base.Utils.isDefined(this._callCreationInfo)||(this._callCreationInfo=new a.Services.Call.CallCreationInfo),this._callCreationInfo.setConferenceID(b.getMeetingId()),this._callCreationInfo.setPortalToken(b.getToken()),this._callCreationInfo.setPasscode(b.getPasscode()),b.isOTT()?this._callCreationInfo.setCallType(a.Services.Call.CallType.CallTypeHttpMeetMe):this._callCreationInfo.setCallType(a.Services.Call.CallType.CallTypeDefaultRegisteredService)},getConferenceEntryOptions:function(){return this._confEntryOptions},getAudioDetails:function(){return this._callService.getAudioDetails(this)},getVideoDetails:function(){return this._callService.getVideoDetails(this)},_setState:function(a){var b=a!==this._callState;this._callState=a,b&&this._callStateChangedCallBacks.fire()},_setServiceAvailability:function(a){this._isServiceAvailable=a},_isDataOnly:function(){return this._dataOnly},_hasCallMode:function(a){return this._modes.filter(function(b){return b.id===a}).length>0},_removeCallMode:function(a){this.modes=this._modes.filter(function(b){return b.id!==a})},_createCMConference:function(){this._conference=this._callService.createCMConference(this)},_setConference:function(a){this._conference=a},_setUserToUserInfo:function(a){this._userToUserInfo=a},getUserToUserInfo:function(){return this._userToUserInfo},startRinging:function(){return this._callService.startRinging(this)},acceptAnswerCallRequest:function(){return this._callService.acceptAnswerCallRequest(this)},acceptTerminateCallRequest:function(){return this._callService.acceptTerminateCallRequest(this)},acceptUpdateCallRequest:function(a){return this._callService.acceptUpdateCallRequest(this,a)},
acceptMakeCallRequest:function(){return this._callService.acceptMakeCallRequest(this)},rejectAnswerCallRequest:function(){return this._callService.rejectAnswerCallRequest(this)},rejectTerminateCallRequest:function(){return this._callService.rejectTerminateCallRequest(this)},rejectUpdateCallRequest:function(a){return this._callService.rejectUpdateCallRequest(this,a)},rejectMakeCallRequest:function(){return this._callService.rejectMakeCallRequest(this)}},a.Base.AOPTools.addAdvices(c,"Call",["start","end","getConference","setVideoMode","setConferenceEntryOptions"],[a.Base.AOPCommonAdvices.LOG_CALL_API_CALLS]),a.Base.AOPTools.addAdvices(c,"Call",["hold","unhold","ignore","accept","deny","denyWithReason","sendDTMF","join","acceptSendVideo","denySendVideo","setVideoChannels","removeAllVideoChannels","muteAudio","unmuteAudio","muteSpeaker","unmuteSpeaker","transfer","attendedTransfer","startRinging","acceptAnswerCallRequest","acceptTerminateCallRequest","acceptUpdateCallRequest","acceptMakeCallRequest","rejectAnswerCallRequest","rejectTerminateCallRequest","rejectUpdateCallRequest","rejectMakeCallRequest"],[a.Base.AOPCommonAdvices.LOG_CALL_API_CALLS,a.Base.AOPCommonAdvices.WRAP_CAUGHT_CALL_ERROR]),a.Services.Call.Call=c}(AvayaClientServices,jQuery),function(a,b){"use strict";function c(c,d){this._callManager=c,this._isAvailable=void 0,this._callService=d,this._callCreatedCallbacks=b.Callbacks(),this._callRemovedCallbacks=b.Callbacks(),this._incomingCallCallbacks=b.Callbacks(),this._undeliveredCallCallbacks=b.Callbacks(),this._callsServiceAvailableCallbacks=b.Callbacks(),this._callsServiceUnavailableCallbacks=b.Callbacks(),this._makeCallRequestedCallbacks=b.Callbacks(),this._voipCallingCapability=new a.Services.Call.Capabilities.VoipCallingCapability(this),this._callService.on(a.Providers.Interfaces.CallServiceCallbackIds.INCOMING_CALL,function(a){this._incomingCallCallbacks.fire(a)}.bind(this)),this._callService.on(a.Providers.Interfaces.CallServiceCallbackIds.MAKE_CALL_REQUESTED,function(a){this._makeCallRequestedCallbacks.fire(a)}.bind(this)),this._voipCallingCapability._recalculate(),this._callManager.setCalls(this),this._onIviewTokenChanged=function(){},this._onRingbackToneURLsChangedCallback=b.Callbacks()}c.prototype={createCall:function(b){if(!b.isPresentationModeOnly()&&!this.getVoipCallingCapability().isAllowed)throw new a.Services.Call.CallException(this.getVoipCallingCapability().denialReason);var c=this._callManager.createCall(this._callService);if(c._remoteAddress=b.getRemoteAddress(),c._subject=b.getSubject(),c._dataOnly=b.isPresentationModeOnly(),c._callCreationInfo=b,c._dataOnly){var d=new a.Services.Call.Modes.ConferenceCallMode(c,a.Services.Call.CallModes.CONFERENCE_CALL,this._callService._contactsIntegrationService);this._callManager.setCallMode(c,d)}return c},getCalls:function(){return this._callManager.getAllCalls()},getCallCount:function(){return this._callManager.getCallCount()},getActiveCall:function(){return this._callManager.getActiveCall()},getIgnoredCalls:function(){return this._callManager.getIgnoredCalls()},getVideoCapability:function(){return this._callService.getVideoCapability()},hasHeldCall:function(){return this._callManager.hasHeldCall()},hasInitiatingCall:function(){return this._callManager.hasInitiatingCall()},getVoipCallingCapability:function(){return this._voipCallingCapability},_start:function(){return this._callService.start(this)},_stop:function(){return this._callService.stop().always(function(){this._cleanupAndTriggerServiceUnavailable()}.bind(this))},_stopImmediately:function(){return this._callService.stopImmediately().always(function(){this._cleanupAndTriggerServiceUnavailable()}.bind(this))},_cleanupAndTriggerServiceUnavailable:function(){this._callsServiceUnavailableCallbacks.fire(this),this._isAvailable=void 0,this._callManager._calls=[],this._resetCallbacks()},_resetCallbacks:function(){this._callRemovedCallbacks.empty(),this._incomingCallCallbacks.empty(),this._undeliveredCallCallbacks.empty(),this._callsServiceAvailableCallbacks.empty(),this._callsServiceUnavailableCallbacks.empty(),this._callCreatedCallbacks.empty()}},a.Base.AOPTools.addAdvices(c,"Calls",["createCall"],[a.Base.AOPCommonAdvices.LOG_CALL_API_CALLS]),a.Services.Call.Calls=c}(window.AvayaClientServices=window.AvayaClientServices||{},window.jQuery=window.jQuery||{}),function(a){"use strict";function b(b){var c=[a.Services.Call.CallStates.ESTABLISHED,a.Services.Call.CallStates.HELD,a.Services.Call.CallStates.HOLDING,a.Services.Call.CallStates.UNHOLDING,a.Services.Call.CallStates.RENEGOTIATING,a.Services.Call.CallStates.FAR_END_RENEGOTIATING,a.Services.Call.CallStates.REMOTE_ALERTING];a.Services.Call.Capabilities.AbstractCallStateCapability.call(this,b,c,!0,!1,!0)}b.prototype=Object.create(a.Services.Call.Capabilities.AbstractCallStateCapability.prototype),a.Services.Call.Capabilities.AbstractCallMuteCapability=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){a.Services.Call.Capabilities.AbstractCallMuteCapability.call(this,b)}b.prototype=Object.create(a.Services.Call.Capabilities.AbstractCallMuteCapability.prototype),b.prototype._recalculate=function(){var b=a.Services.Call.Capabilities.AbstractCallMuteCapability.prototype._recalculateDenialReason.call(this),c=b===a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED;c&&this._call.isAudioMuted()&&(c=!1,b=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateIfChanged(c,b)},a.Services.Call.Capabilities.MuteCapability=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){a.Services.Call.Capabilities.AbstractCallMuteCapability.call(this,b)}b.prototype=Object.create(a.Services.Call.Capabilities.AbstractCallMuteCapability.prototype),b.prototype._recalculate=function(){var b=a.Services.Call.Capabilities.AbstractCallMuteCapability.prototype._recalculateDenialReason.call(this),c=b===a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED;c&&this._call.isSpeakerMuted()&&(c=!1,b=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateIfChanged(c,b)},a.Services.Call.Capabilities.MuteSpeakerCapability=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){a.Services.Call.Capabilities.AbstractCallMuteCapability.call(this,b)}b.prototype=Object.create(a.Services.Call.Capabilities.AbstractCallMuteCapability.prototype),b.prototype._recalculate=function(){var b=a.Services.Call.Capabilities.AbstractCallStateCapability.prototype._recalculateDenialReason.call(this),c=b===a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED;c&&!this._call.isAudioMuted()&&(c=!1,b=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateIfChanged(c,b)},a.Services.Call.Capabilities.UnmuteCapability=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a){"use strict";function b(b){a.Services.Call.Capabilities.AbstractCallMuteCapability.call(this,b)}b.prototype=Object.create(a.Services.Call.Capabilities.AbstractCallMuteCapability.prototype),b.prototype._recalculate=function(){var b=a.Services.Call.Capabilities.AbstractCallMuteCapability.prototype._recalculateDenialReason.call(this),c=b===a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED;c&&!this._call.isSpeakerMuted()&&(c=!1,b=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateIfChanged(c,b)},a.Services.Call.Capabilities.UnmuteSpeakerCapability=b}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a,b){"use strict";function c(c,d,e,f,g){this._collaborationService=c,this._whiteboard=d,this._contentSharing=e,this._collaborationId=f,this._callId=g,this._isAvailable=void 0,this._participants=new a.Base.DataSet,this._selfParticipant=void 0,this._supportedFeatures=[a.Services.Collaboration.FeaturesAvailable.SCREEN_SHARING,a.Services.Collaboration.FeaturesAvailable.WHITEBOARD],this._onCollaborationStartedCallbacks=b.Callbacks(),this._onCollaborationEndedCallbacks=b.Callbacks("unique"),this._onCollaborationServiceAvailableCallbacks=b.Callbacks("unique"),this._onCollaborationServiceUnavailableCallbacks=b.Callbacks("unique"),this._onCollaborationNearEndByEjectCallbacks=b.Callbacks("unique"),this._onCollaborationPresenterPrivilegeChangedCallbacks=b.Callbacks("unique"),this._onCollaborationModeratorPrivilegeChangedCallbacks=b.Callbacks("unique"),this._onCollaborationInitializedCallbacks=b.Callbacks("unique"),this._isPaused=!1,this._chatCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._meetingMinutesCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._contentSharingCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._networkLibraryCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._librarySharingCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._whiteboardCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._retrieveParticipantListCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._isStarted=!1,this._isStopped=!0,this._config=void 0,this._meetingId=void 0}c.prototype={start:function(c,d){if(a.Base.Utils.isDefined(c)&&a.Base.Utils.isDefined(d)&&(this._config=c,this._meetingId=d),!a.Base.Utils.isDefined(this._config)||!a.Base.Utils.isDefined(this._meetingId)){a.Base.Logger.error(a.Base.LoggerTags.COLLABORATION_SERVICE,"Configuration or meeting Id is missing");var e=a.Services.Collaboration.CollaborationErrorReason.COLLABORATION_START_FAILURE;return b.Deferred().reject(new a.Services.Collaboration.CollaborationError(e)).promise()}return this._collaborationService.start(this,this._config,this._meetingId).then(function(){this._contentSharing._start()}.bind(this))},stop:function(){return this._contentSharing._collaborationEnd=!0,this._contentSharing.end().always(function(){this._contentSharing._stop()}.bind(this)),this._whiteboard.stop(),this._collaborationService.stop(this)},getContentSharing:function(){return this._contentSharing},getWhiteboard:function(){return this._whiteboard},getParticipants:function(){return this._collaborationService.getParticipants(this)},getCallId:function(){return this._callId},getCollaborationId:function(){return this._collaborationId},hasPresenterPrivilege:function(){},isEjected:function(){},hasModeratorPrivilege:function(){},pause:function(){return this._collaborationService.pause(this)},resume:function(){return this._collaborationService.resume(this)},_setConfiguration:function(a,b){this._config=a,this._meetingId=b}},a.Base.AOPTools.addAdvices(c,"Collaboration",["getParticipants"],[a.Base.AOPCommonAdvices.LOG_COLLABORATION_API_CALLS]),a.Base.AOPTools.addAdvices(c,"Collaboration",["start","stop","pause","resume"],[a.Base.AOPCommonAdvices.LOG_COLLABORATION_API_CALLS,a.Base.AOPCommonAdvices.WRAP_CAUGHT_COLLABORATION_ERROR]),a.Services.Collaboration.Collaboration=c}(AvayaClientServices,jQuery),function(a){"use strict";function b(a){this._factory=a,this._collaborationsStore={},this._onActiveContentSharingChangedCallback=$.Callbacks(),this._activeContentSharing=void 0}b.prototype={getCollaborationForCall:function(b){a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:"string"}]});for(var c in this._collaborationsStore)if(this._collaborationsStore.hasOwnProperty(c)&&this._collaborationsStore[c].getCallId()===b)return this._collaborationsStore[c];return this._createAndSaveCollaboration(b)},getCollaborationById:function(a){return this._collaborationsStore.hasOwnProperty(a)?this._collaborationsStore[a]:this._createAndSaveCollaboration(a)},_generateUniqueIdForCollaboration:function(){var b=a.Base.Utils.makeId();return this._collaborationsStore.hasOwnProperty(b)?this._generateUniqueIdForCollaboration():b},_createAndSaveCollaboration:function(a){var b=this._factory.create(this,this._generateUniqueIdForCollaboration(),a);return this._collaborationsStore[b.getCollaborationId()]=b,b},_isCollaborationForCall:function(b){var c=!1;if(a.Base.Utils.isUndefined(b))return c;for(var d in this._collaborationsStore)this._collaborationsStore.hasOwnProperty(d)&&this._collaborationsStore[d].getCallId()===b&&(c=!0);return c},_deleteCollaboration:function(a){this._collaborationsStore[a]&&delete this._collaborationsStore[a]},_stopAndDeleteAllCollaborations:function(){for(var a in this._collaborationsStore)this._collaborationsStore.hasOwnProperty(a)&&(this._collaborationsStore[a].stop(),this._deleteCollaboration(a));return this._collaborationsStore={},$.Deferred().resolve().promise()}},a.Base.AOPTools.addAdvices(b,"Collaborations",["getCollaborationById","getCollaborationForCall"],[a.Base.AOPCommonAdvices.LOG_COLLABORATION_API_CALLS]),a.Services.Collaboration.Collaborations=b}(AvayaClientServices),function(a,b){"use strict";function c(c,d){this._contentSharingService=c,this._collaborations=d,this._collaborations._onActiveContentSharingChangedCallback.add(this._onActiveContentSharingChanged.bind(this)),this._collaborationEnd=!1,this._onContentSharingStartedCallbacks=b.Callbacks(),this._onContentSharingEndedCallbacks=b.Callbacks(),this._onContentSharingPausedCallbacks=b.Callbacks(),this._onContentSharingResumedCallbacks=b.Callbacks(),this._onCursorReceivedCallbacks=b.Callbacks(),this._onFrameStartReceivedCallbacks=b.Callbacks(),this._onFrameEndReceivedCallbacks=b.Callbacks(),this._onFrameReceivedCallbacks=b.Callbacks(),this._onFrameChangedCallbacks=b.Callbacks(),this._onBlockReceivedCallbacks=b.Callbacks(),this._onFrameReportReceivedCallbacks=b.Callbacks(),this._shareApplicationWindowCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._shareFullScreenCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._contentSharingService.getShareFullScreenCapability()._onChangedCallbacks.add(function(){this._recalculateShareFullScreenCapability()}.bind(this)),this._contentSharingService.getShareApplicationWindowCapability()._onChangedCallbacks.add(function(){this._recalculateShareApplicationWindowCapability()}.bind(this))}c.prototype={_start:function(){this._contentSharingService.start(this)},_stop:function(){this._contentSharingService.stop(this)},startScreenSharingFullScreen:function(){return this._contentSharingService.startScreenSharingFullScreen(this)},isSharingFullScreen:function(){return this._contentSharingService.isSharingFullScreen()},getReceivingBitrate:function(){return this._contentSharingService.getReceivingBitrate()},startSharingApplicationWindow:function(){return this._contentSharingService.startSharingApplicationWindow(this)},isSharingApplicationWindow:function(){return this._contentSharingService.isSharingApplicationWindow()},end:function(){var a=this._collaborationEnd&&!(this.isSharingFullScreen()||this.isSharingApplicationWindow());return this._collaborationEnd=!1,this._contentSharingService.end(a,this)},isPresenting:function(){return this._contentSharingService.isPresenting()},isContentSharingActive:function(){return this._contentSharingService.isContentSharingActive()},pause:function(){return this._contentSharingService.pause()},resume:function(){return this._contentSharingService.resume()},_onActiveContentSharingChanged:function(){this._contentSharingService._recalculateAllContentSharingCapabilities(this)},_getCollaborations:function(){return this._collaborations},_clearActiveContentSharing:function(){var a=this._collaborations._activeContentSharing;a&&a===this&&(this._collaborations._activeContentSharing=void 0)}},a.Base.AOPTools.addAdvices(c,"ContentSharing",["startScreenSharingFullScreen","startSharingApplicationWindow","end","pause","resume"],[a.Base.AOPCommonAdvices.LOG_COLLABORATION_API_CALLS,a.Base.AOPCommonAdvices.WRAP_CAUGHT_COLLABORATION_ERROR]),a.Services.Collaboration.ContentSharing=c}(AvayaClientServices,jQuery),function(a){"use strict";function b(b,c){a.Services.Participant.call(this),this._participantId=b,this._displayName=c}b.prototype=Object.create(a.Services.Participant.prototype),a.Services.Collaboration.Participant=b}(AvayaClientServices),function(a){"use strict";function b(){this.possibleColors=["#cd2029","#f58521","#f3e913","#652d90","#3659a7","#2a8b45","#211e1e","#ffffff","#959595"],this._whiteboard=void 0,this._collaboration=void 0,this._ended=!1,this._callbacks={},this._onShowShapeAnnotationCallbacks=$.Callbacks()}b.prototype={init:function(b,c){this._whiteboard=b,b.addOnWhiteboardStartedCallback(function(b,d){a.Base.Utils.isDefined(d)&&(this._ended=!1,this.start(c))}.bind(this)),b.addOnWhiteboardEndedCallback(function(a){this._ended=!0,this.end(c)}.bind(this)),b.addOnWhiteboardSurfaceAddedCallback(function(a,b){var c=[{name:"OnShapeAddedCallback",callback:function(a,b){this.drawShape(b)}.bind(this)},{name:"OnShapeDeletedCallback",callback:function(a,b){this.removeShape(b)}.bind(this)},{name:"OnShapeUpdatedCallback",callback:function(a,b){this.updateShape(b)}.bind(this)},{name:"OnSurfaceClearedCallback",callback:function(a){this.clearContent()}.bind(this)}];c.forEach(function(a){b["add"+a.name](a.callback)}),this._callbacks[b.getSurfaceId()]=c}.bind(this)),b.addOnWhiteboardSurfaceRemovedCallback(function(a,b){this._callbacks[b.getSurfaceId()].forEach(function(a){b["remove"+a.name](a.callback)}),this._callbacks[b.getSurfaceId()]=void 0}.bind(this)),b.addOnWhiteboardSurfaceSetActiveCallback(function(a,b){if(this._ended&&this.start(c),this.clearContent(),b){var d=b.getShapes();for(var e in d)b.getShapes().hasOwnProperty(e)&&this.drawShape(b.getShapes()[e])}}.bind(this))},start:function(){},end:function(){},drawShape:function(a){},removeShape:function(a){},updateShape:function(a){},clearContent:function(){},addOnShowShapeAnnotationCallback:function(a){this._onShowShapeAnnotationCallbacks.add(a)},removeOnShowShapeAnnotationCallback:function(a){this._onShowShapeAnnotationCallbacks.remove(a)}},a.Base.AOPTools.addAdvices(b,"WhiteboardRenderer",["init"],[a.Base.AOPCommonAdvices.LOG_COLLABORATION_API_CALLS]),a.Services.Collaboration.WhiteboardRenderer=b}(AvayaClientServices),function(a){"use strict";function b(a,b){this._whiteboard=a,this._whiteboardService=b,this._shapes={},this._surfaceId=void 0,this._isDrawing=!1,this._active=!1,this._onShapeAddedCallbacks=$.Callbacks(),this._onShapeDeletedCallbacks=$.Callbacks(),this._onShapeUpdatedCallbacks=$.Callbacks(),this._onSurfaceClearedCallbacks=$.Callbacks()}b.prototype={getSurfaceId:function(){return this._surfaceId},setAsActive:function(){return this._whiteboardService.start(this._whiteboard,this)},addCircle:function(a){return this._appendShape(a._id,a),this._whiteboardService.addCircle(this,a)},addShape:function(a){return this._appendShape(a._id,a),a._onShapeFinished=function(){return this._whiteboardService.endDrawShape(this,a)}.bind(this),this._whiteboardService.addShape(this,a)},addText:function(a){return this._appendShape(a._id,a),this._whiteboardService.addText(this,a)},getShapes:function(){return this._shapes},isActive:function(){return this._active},clearContent:function(){return this._whiteboardService.clearContent(this)},updateShape:function(a){return this._whiteboardService.moveSelection(this,a)},removeShape:function(a){return this._removeShapeById(a._id),this._whiteboardService.removeShape(this,a)},finishShape:function(a){return a.finishDrawing()},_appendShape:function(a,b){this._shapes[a]||(this._shapes[a]=b)},_getShapeById:function(b){if(a.Base.Utils.isDefined(this._shapes[b]))return this._shapes[b]},_removeShapeById:function(a){delete this._shapes[a]},_clearShapes:function(){this._shapes={}}},a.Base.AOPTools.addAdvices(b,"WhiteboardSurface",["finishShape","removeShape","updateShape","clearContent","addText","addShape","addCircle","setAsActive"],[a.Base.AOPCommonAdvices.LOG_COLLABORATION_API_CALLS,a.Base.AOPCommonAdvices.WRAP_CAUGHT_COLLABORATION_ERROR]),a.Services.Collaboration.WhiteboardSurface=b}(AvayaClientServices),function(a){"use strict";function b(b){this._whiteboardService=b,this._activeSurface=void 0,this._currentLiveDrawingWhiteboardIds=[],this._currentLiveDrawingShapes=[],this._onWhiteboardStartedCallbacks=$.Callbacks(),this._onWhiteboardEndedCallbacks=$.Callbacks(),this._onWhiteboardSurfaceAddedCallbacks=$.Callbacks(),this._onWhiteboardSurfaceRemovedCallbacks=$.Callbacks(),this._onWhiteboardSurfaceSetActiveCallbacks=$.Callbacks(),this._recentlyActiveSurface=void 0,this._surfaces=new a.Base.DataSet,this._removeWhiteboardCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._drawingCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE)}b.prototype={start:function(){return this._whiteboardService.start(this)},end:function(){return this._whiteboardService.end(this)},stop:function(){return this._whiteboardService.stop(this)},requestNewSurface:function(){return this._whiteboardService.requestNewSurface()},removeSurface:function(a){return this._whiteboardService.removeSurface(this,a)},getSurfaces:function(){return this._surfaces},getSurfaceById:function(a){return this._surfaces.filter(function(b){return b.getSurfaceId()===a})[0]},getActiveSurface:function(){return this._activeSurface}},a.Base.AOPTools.addAdvices(b,"Whiteboard",["start","stop","end","requestNewSurface","removeSurface"],[a.Base.AOPCommonAdvices.LOG_COLLABORATION_API_CALLS,a.Base.AOPCommonAdvices.WRAP_CAUGHT_COLLABORATION_ERROR]),a.Services.Collaboration.Whiteboard=b}(AvayaClientServices),function(a){"use strict";function b(b){this._chatService=b,this._selfParticipant=void 0,this._privateMessages=new a.Base.DataSet,this._publicMessages=new a.Base.DataSet,this._allMessages=new a.Base.DataSet,this._onChatMessageReceivedCallbacks=$.Callbacks(),this._onChatServiceAvailableCallbacks=$.Callbacks(),this._onChatServiceUnavailableCallbacks=$.Callbacks()}b.prototype={sendPrivateMessage:function(b,c){return a.Base.Utils.validate(c,{validators:[{type:"defined"},{type:"type",expected:"string"}]}),a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:a.Services.Conference.Participant}]}),this._chatService.sendMessage(this,c,b)},sendPublicMessage:function(b){return a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:"string"}]}),this._chatService.sendMessage(this,b)},getAllPrivateMessages:function(){return this._privateMessages},getAllPublicMessages:function(){return this._publicMessages},getAllMessages:function(){return this._allMessages},_setSelfParticipant:function(b){a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:a.Services.Conference.Participant}]}),this._selfParticipant=b},_addMessage:function(b){a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:a.Services.Conference.ChatMessage}]}),this._chatService.addMessage(this,b)}},a.Base.AOPTools.addAdvices(b,"Chat",["sendPrivateMessage","sendPublicMessage"],[a.Base.AOPCommonAdvices.LOG_CONFERENCE_API_CALLS,a.Base.AOPCommonAdvices.WRAP_CAUGHT_CONFERENCE_ERROR]),a.Services.Conference.Chat=b}(AvayaClientServices),function(a,b){"use strict";function c(c,d,e){this._id=a.Base.Utils.generateUUID(),this._conferenceService=c,this._participantService=d,this._chat=e,this._selfParticipantId="",this._selfParticipant=void 0,this._activeTalkerId="",this._recentTalkersList=new a.Base.DataSet,this._dialoutPermissions=void 0,this._recordingPermissions=void 0,this._lecturerId="",this._presenterId="",this._mediaStatus="",this._activeParticipants=new a.Base.DataSet,this._droppedParticipants=[],this._pendingParticipants=[],this._isLectureModeActive=!1,this._isUccpConference=!1,this._isHandRaised=!1,this._recorderStatus=a.Services.Conference.RecorderStatus.NONE,this._recordingStatus=a.Services.Conference.RecordingStatus.OFF,this._isVideoAllowed=!1,this._encryptionStatus=a.Services.Conference.MeetingEncryptionStatus.NO,this._isWebCollaborationActive=!1,this._isLocked=!1,this._isPasscodeRequiredToBecomeModerator=!1,this._isVideoParticipantNameDisplayActive=!1,this._isVideoSelfSeeActive=!1,this._currentVideoLayout=void 0,this._supportedVideoLayouts=[],this._isVideoSelfSeeChangeAllowed=!1,this._isVideoPinAllowed=!1,this._isVideoParticipantNameDisplayChangeAllowed=!1,this._isStreamingActive=!1,this._terminationTime=void 0,this._subject="",this._webURI="",this._sipURI="",this._isApplicationSharingActive=!1,this._brandName="",this._collaborationURI="",this._admissionPermissionNeeded=!1,this._admissionPasscodeNeeded=!1,this._streamingURI="",this._joinMeetingURI="",this._dialInInformation="",this._isAvailable=void 0,this._collaboration=void 0,this._uccpConfig=void 0,this._isStarted=!1,this._onConferenceLockStatusChangedCallbacks=b.Callbacks(),this._onConferenceDisplayVideoParticipantNameChangedCallbacks=b.Callbacks(),this._onConferenceVideoSelfSeeChangedCallbacks=b.Callbacks(),this._onConferenceVideoLayoutChangedCallbacks=b.Callbacks(),this._onConferenceDisplayParticipantNameOnVideoAllowedCallbacks=b.Callbacks(),this._onConferenceVideoSelfSeeAllowedCallbacks=b.Callbacks(),this._onConferenceVideoPinAllowedCallbacks=b.Callbacks(),this._onConferenceAvailableVideoLayoutsChangedCallbacks=b.Callbacks(),this._onConferenceSubjectChangedCallbacks=b.Callbacks(),this._onConferenceContinuationStatusChangedCallbacks=b.Callbacks(),this._onConferenceRecordingStatusChangedCallbacks=b.Callbacks(),this._onConferenceRecordingFailedCallbacks=b.Callbacks(),this._onConferenceVideoStatusChangedCallbacks=b.Callbacks(),this._onConferenceLectureModeStatusChangedCallbacks=b.Callbacks(),this._onConferenceEntryExitToneChangedCallbacks=b.Callbacks(),this._onConferencePresentationModeStatusChangedCallbacks=b.Callbacks(),this._onConferenceActiveTalkersChangedCallbacks=b.Callbacks(),this._onConferenceActiveVideoParticipantsChangedCallbacks=b.Callbacks(),this._onConferenceParticipantRoleChangedCallbacks=b.Callbacks(),this._onConferenceParticipantAudioMuteStatusChangedCallbacks=b.Callbacks(),this._onConferenceParticipantVideoBlockStatusChangedCallbacks=b.Callbacks(),this._onConferenceAllParticipantsMutedCallbacks=b.Callbacks(),this._onConferenceAllParticipantsUnmutedCallbacks=b.Callbacks(),this._onConferenceEncryptionStatusChangedCallbacks=b.Callbacks(),this._onConferenceStreamingStatusChangedCallbacks=b.Callbacks(),this._onConferenceParticipantRaiseHandStatusChangedCallbacks=b.Callbacks(),this._onConferencePendingParticipantCallbacks=b.Callbacks(),this._onConferencePendingParticipantRemovedCallbacks=b.Callbacks(),this._onConferenceDroppedParticipantAddedCallbacks=b.Callbacks(),this._onConferenceDroppedParticipantRemovedCallbacks=b.Callbacks(),this._onConferenceServiceAvailableCallbacks=b.Callbacks(),this._onConferenceServiceUnavailableCallbacks=b.Callbacks(),this._onConferenceParticipantsAddedCallbacks=b.Callbacks(),this._onConferenceParticipantsRemovedCallbacks=b.Callbacks(),this._onConferenceMeetingTerminationTimeChangedCallbacks=b.Callbacks(),this._onConferenceMeetingTerminationInProgressCallbacks=b.Callbacks(),this._onConferenceCollaborationURIChangedCallbacks=b.Callbacks(),this._onConferenceConnectionEndedCallbacks=b.Callbacks(),this._onConferenceStartingCallbacks=b.Callbacks(),this._onConferenceWaitingToStartCallbacks=b.Callbacks(),this._setLectureModeCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._muteUnmuteParticipantCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._blockUnblockParticipantVideoCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._setLockCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeLastParticipantCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._denyPendingParticipantCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._acceptPendingParticipantCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._terminateConferenceCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._unmuteSelfAudioCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._muteSelfAudioCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._activeTalkerCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._supportMeetingMinutesCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._moderateConferenceCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._startRecordingCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._stopRecordingCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._pauseRecordingCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._resumeRecordingCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._muteUnmuteAllCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._raiseHandSupportCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._lowerHandSupportCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._setDisplayVideoParticipantNameCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._setVideoSelfSeeCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._setVideoLayoutCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._setRequestToBecomeModeratorCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._setVideoPinCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeSelectParticipantCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._addParticipantViaDialoutCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._signInCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._extendMeetingCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._retrieveParticipantListCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._addParticipantFromCallCapabilities={}}c.prototype={start:function(b){return a.Base.Utils.isDefined(b)&&(this._uccpConfig=b),this._conferenceService.start(this,this._uccpConfig)},stop:function(){return this._addParticipantFromCallCapabilities={},this._conferenceService.stop(this)},getInConferenceChat:function(){return this._chat},getRecentTalkers:function(){return this._recentTalkersList},getMeetingMinutes:function(){},getCollaborationURI:function(){return this._collaborationURI},isLocked:function(){return this._isLocked},setLocked:function(a){return this._conferenceService.setLocked(this,a)},isConferenceWaitingToStart:function(){return this._mediaStatus===a.Services.Conference.MediaStatus.WAITING_ROOM},isVideoSelfSeeActive:function(){return this._isVideoSelfSeeActive},setVideoSelfSee:function(a){return this._conferenceService.setVideoLayoutSelfSee(this,a)},isVideoParticipantNameDisplayActive:function(){return this._isVideoParticipantNameDisplayActive},setDisplayVideoParticipantName:function(a){return this._conferenceService.setVideoLayoutTextOverlay(this,a)},getSupportedVideoLayoutList:function(){return this._supportedVideoLayouts},isLectureModeActive:function(){return this._isLectureModeActive},startRecording:function(a,b){
return this._conferenceService.startRecording(this,a,b)},stopRecording:function(){return this._conferenceService.stopRecording(this)},pauseRecording:function(){return this._conferenceService.pauseRecording(this)},resumeRecording:function(){return this._conferenceService.resumeRecording(this)},isVideoAllowed:function(){return this._isVideoAllowed},getCurrentVideoLayout:function(){return this._currentVideoLayout},setVideoLayout:function(a){return this._conferenceService.setVideoLayout(this,a)},getActiveParticipants:function(){return this._activeParticipants},getDroppedParticipants:function(){return this._droppedParticipants},getPendingParticipants:function(){return this._pendingParticipants},muteAllParticipants:function(){return this._conferenceService.muteAllParticipants(this)},unmuteAllParticipants:function(){return this._conferenceService.unmuteAllParticipants(this)},addParticipant:function(a){return this._conferenceService.addParticipant(this,a)},addParticipantFromCall:function(c){return this.getAddParticipantFromCallCapability(c).isAllowed?this._conferenceService.addParticipantFromCall(c):b.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.CAPABILITY_NOT_ALLOWED))},removeParticipant:function(b){return b._connectionStatus===a.Services.Conference.ParticipantConnectionStatus.CONNECTION_STATUS_CONNECTING?this._conferenceService.cancelDialoutParticipant(this,b):this._conferenceService.disconnectParticipant(b)},removeLastParticipant:function(){return this._conferenceService.removeLastParticipant()},terminateConference:function(){return this._conferenceService.terminateConference(this)},sendPasscode:function(a){return this._conferenceService.sendAdmissionRequest(this,a)},sendRequestToEnterLockedConference:function(){return this._conferenceService.sendAdmissionRequest(this)},isPasscodeRequiredToBecomeModerator:function(){return this._isPasscodeRequiredToBecomeModerator},requestToBecomeModerator:function(a){return this._conferenceService.requestToBecomeModerator(this,a)},signIn:function(a){return this._conferenceService.signIn(this,a)},pinVideoByParticipant:function(a,b,c){return this._conferenceService.videoPin(a,0,0,b,c)},pinVideoByCoordinates:function(a,b,c,d){var e;return this._conferenceService.videoPin(e,a,b,c,d)},extendMeeting:function(a){return this._conferenceService.extendMeeting(a)},raiseHand:function(){return this._conferenceService.raiseLowerHand(!0)},lowerHand:function(){return this._conferenceService.raiseLowerHand(!1)},_recalculateAllCapabilities:function(){this._conferenceService._recalculateAllCapabilities(this)},_recalculate:function(){this._conferenceService._recalculateAllCapabilities(this),this._activeParticipants.forEach(function(a){a._recalculateAllCapabilities()})},getSelfParticipant:function(){return this._selfParticipant},isRecordingActive:function(){return this._recordingStatus===a.Services.Conference.RecordingStatus.ON||this._recordingStatus===a.Services.Conference.RecordingStatus.PAUSE},isRecordingPaused:function(){return this._recordingStatus===a.Services.Conference.RecordingStatus.PAUSE},getEncryptionStatus:function(){return this._encryptionStatus},getSubject:function(){return this._subject},isStreamingActive:function(){return this._isStreamingActive},isApplicationSharingActive:function(){return this._isApplicationSharingActive},getStreamingURI:function(){return this._streamingURI},getJoinMeetingURI:function(){return this._joinMeetingURI},getDialInInformation:function(){return this._dialInInformation},_disconnect:function(){return this._conferenceService.sendDisconnectEvent()},_getType:function(){return this._conferenceService.getType()},_sendLocalMuteEvent:function(a,b){return this._conferenceService.sendLocalMuteEvent(a,b)},_setConfiguration:function(a){this._uccpConfig=a},_setCollaboration:function(a){this._collaboration=a},_setConferenceStarted:function(b){this._isStarted=b,a.Base.Logger.debug(a.Base.LoggerTags.CONFERENCE_SERVICE,"_setConferenceStarted: "+b)},_isConferenceStarted:function(){return this._isStarted}},a.Base.AOPTools.addAdvices(c,"Conference",["start","stop","setLocked","setVideoSelfSee","setDisplayVideoParticipantName","startRecording","stopRecording","pauseRecording","resumeRecording","setVideoLayout","muteAllParticipants","unmuteAllParticipants","addParticipant","addParticipantFromCall","removeParticipant","removeLastParticipant","terminateConference","sendPasscode","sendRequestToEnterLockedConference","requestToBecomeModerator","signIn","pinVideoByParticipant","pinVideoByCoordinates","extendMeeting","raiseHand","lowerHand","_setConferenceStarted"],[a.Base.AOPCommonAdvices.LOG_CONFERENCE_API_CALLS,a.Base.AOPCommonAdvices.WRAP_CAUGHT_CONFERENCE_ERROR]),a.Services.Conference.Conference=c}(AvayaClientServices,jQuery),function(a){"use strict";function b(b,c){a.Services.Participant.call(this),this._participantService=b,this._conference=c,this._onParticipantStatusChangedCallbacks=$.Callbacks(),this._setUnsetAsLecturerCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._muteAudioCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._unmuteAudioCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._blockVideoCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._unblockVideoCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._remoteCameraControlCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._lowerHandCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE)}b.prototype=Object.create(a.Services.Participant.prototype),b.prototype.getParticipantAuthorizationStatus=function(){return this._status},b.prototype.isPendingParticipant=function(){return this._status===a.Services.Conference.ParticipantAuthorizationStatus.AUTHORIZING},b.prototype.isActiveParticipant=function(){return this._status===a.Services.Conference.ParticipantAuthorizationStatus.ACTIVE},b.prototype._recalculateAllCapabilities=function(){this._participantService.recalculateAllCapabilities(this)},a.Services.Conference.Participant=b}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Services.Conference.Participant.call(this,b,c),this._onPendingParticipantAcceptedCallbacks=$.Callbacks(),this._onPendingParticipantCancelledCallbacks=$.Callbacks(),this._onPendingParticipantDeniedCallbacks=$.Callbacks()}b.prototype=Object.create(a.Services.Conference.Participant.prototype),b.prototype.accept=function(){return this._participantService.accept(this)},b.prototype.deny=function(){return this._participantService.deny(this)},a.Base.AOPTools.addAdvices(b,"PendingParticipant",["accept","deny"],[a.Base.AOPCommonAdvices.LOG_CONFERENCE_API_CALLS,a.Base.AOPCommonAdvices.WRAP_CAUGHT_CONFERENCE_ERROR]),a.Services.Conference.PendingParticipant=b}(AvayaClientServices),function(a){"use strict";function b(){a.Services.Contacts.ContactField.call(this),this._value=!1}b.prototype=Object.create(a.Services.Contacts.ContactField.prototype),b.prototype.getValue=function(){return this._value},a.Services.Contacts.ContactBooleanField=b}(AvayaClientServices),function(a){"use strict";function b(){a.Services.Contacts.ContactField.call(this),this._address=void 0,this._emailAddressType=a.Services.Contacts.ContactEmailAddressType.EMAIL_ADDRESS_OTHER,this._default=!1}b.prototype=Object.create(a.Services.Contacts.ContactField.prototype),b.prototype.getAddress=function(){return this._address},b.prototype.getEmailAddressType=function(){return this._emailAddressType},b.prototype.isDefault=function(){return this._default},a.Services.Contacts.ContactEmailAddressField=b}(AvayaClientServices),function(a){"use strict";function b(){a.Services.Contacts.ContactField.call(this),this._values=[]}b.prototype=Object.create(a.Services.Contacts.ContactField.prototype),b.prototype.getValues=function(){return this._values},b.prototype.isEmpty=function(){return!this._values||0===this._values.length},b.prototype.getSize=function(){return this._values?this._values.length:0},a.Services.Contacts.ContactFieldList=b}(AvayaClientServices),function(a){"use strict";function b(){a.Services.Contacts.ContactBooleanField.call(this)}b.prototype=Object.create(a.Services.Contacts.ContactBooleanField.prototype),b.prototype.setValue=function(a){this._value=a},a.Services.Contacts.EditableContactBooleanField=b}(AvayaClientServices),function(a){"use strict";function b(){a.Services.Contacts.ContactEmailAddressField.call(this)}b.prototype=Object.create(a.Services.Contacts.ContactEmailAddressField.prototype),b.prototype.setAddress=function(a){this._address=a},b.prototype.setEmailAddressType=function(b){this._emailAddressType=b,this._default=this._emailAddressType===a.Services.Contacts.ContactEmailAddressType.EMAIL_ADDRESS_WORK},a.Services.Contacts.EditableContactEmailAddressField=b}(AvayaClientServices),function(a,b){"use strict";function c(){this._uniqueAddressForMatching=void 0,this._firstName=new a.Services.Contacts.ContactStringField,this._lastName=new a.Services.Contacts.ContactStringField,this._displayName=new a.Services.Contacts.ContactStringField,this._asciiFirstName=new a.Services.Contacts.ContactStringField,this._asciiLastName=new a.Services.Contacts.ContactStringField,this._asciiDisplayName=new a.Services.Contacts.ContactStringField,this._alias=new a.Services.Contacts.ContactStringField,this._company=new a.Services.Contacts.ContactStringField,this._location=new a.Services.Contacts.ContactStringField,this._workRoomNumber=new a.Services.Contacts.ContactStringField,this._streetAddress=new a.Services.Contacts.ContactStringField,this._city=new a.Services.Contacts.ContactStringField,this._state=new a.Services.Contacts.ContactStringField,this._country=new a.Services.Contacts.ContactStringField,this._postalCode=new a.Services.Contacts.ContactStringField,this._manager=new a.Services.Contacts.ContactStringField,this._department=new a.Services.Contacts.ContactStringField,this._language=new a.Services.Contacts.ContactStringField,this._emailAddresses=new a.Services.Contacts.ContactFieldList,this._phoneNumbers=new a.Services.Contacts.ContactFieldList,this._imAddresses=new a.Services.Contacts.ContactFieldList,this._buddy=new a.Services.Contacts.ContactBooleanField,this._favorite=new a.Services.Contacts.ContactBooleanField,this._videoCapable=new a.Services.Contacts.ContactBooleanField,this._rank=new a.Services.Contacts.ContactNumberField,this._notes=new a.Services.Contacts.ContactStringField,this._custom1=new a.Services.Contacts.ContactFieldList,this._custom2=new a.Services.Contacts.ContactFieldList,this._custom3=new a.Services.Contacts.ContactFieldList,this._terminal=new a.Services.Contacts.Terminal,this._scopiaUserId=new a.Services.Contacts.ContactStringField,this._scopiaLoginId=new a.Services.Contacts.ContactStringField,this._inContactList=!1,this._pictureUrlMap={},this._selfContact=!1,this._presenceService=void 0,this._contactsService=void 0,this._presence=void 0,this._presenceAddress=void 0,this._presenceAddressCandidates=void 0,this._onPresenceReceived=void 0,this._getPresenceCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._onPresenceChangedCallbacks=b.Callbacks(),this._onContactChangedCallbacks=b.Callbacks()}c.prototype={getUniqueAddressForMatching:function(){return this._uniqueAddressForMatching},_setUniqueAddressForMatching:function(a){this._uniqueAddressForMatching=a},getFirstName:function(){return this._firstName},getLastName:function(){return this._lastName},getDisplayName:function(){return this._displayName},getASCIIFirstName:function(){return this._asciiFirstName},getASCIILastName:function(){return this._asciiLastName},getASCIIDisplayName:function(){return this._asciiDisplayName},getAlias:function(){return this._alias},getLocation:function(){return this._location},getWorkRoomNumber:function(){return this._workRoomNumber},getStreetAddress:function(){return this._streetAddress},getCity:function(){return this._city},getState:function(){return this._state},getCountry:function(){return this._country},getPostalCode:function(){return this._postalCode},getCompany:function(){return this._company},getManager:function(){return this._manager},getDepartment:function(){return this._department},getPictureUrl:function(b){return b&&a.Services.Contacts.ContactPictureSize[b]||(b=a.Services.Contacts.ContactPictureSize.MEDIUM),this._pictureUrlMap[b]},addPictureUrl:function(b,c){b&&a.Services.Contacts.ContactPictureSize[b]&&c&&(this._pictureUrlMap[b]=c)},getLanguage:function(){return this._language},getEmailAddresses:function(){return this._emailAddresses},getPhoneNumbers:function(){return this._phoneNumbers},getIMAddresses:function(){return this._imAddresses},isBuddy:function(){return this._buddy},isFavorite:function(){return this._favorite},isVideoCapable:function(){return this._videoCapable},getNotes:function(){return this._notes},getRank:function(){return this._rank},getCustom1:function(){return this._custom1},getCustom2:function(){return this._custom2},getCustom3:function(){return this._custom3},getScopiaUserId:function(){return this._scopiaUserId},getScopiaLoginId:function(){return this._scopiaLoginId},getTerminal:function(){return this._terminal},_isInContactList:function(){return this._inContactList},_setInContactList:function(a){this._inContactList=a},getPresence:function(){return this._presence},startPresence:function(){if(!this._getPresenceCapability.isAllowed)return b.Deferred().reject(new a.Services.Presence.PresenceError(a.Services.Presence.PresenceErrorReason.UNSUPPORTED)).promise();this._onPresenceReceived=function(c){if(c.getPresentity()===this._presenceAddress){if(this._selfContact){c=b.extend(new a.Services.Presence.SelfPresence,c);var d=a.Services.Contacts.ContactsUtils.getPhoneAndVideoChannelPresenceAddress(this);this._presenceService._setSelfPresence(c,this._presenceAddress,d.getPhoneNumber())}this._presence=c,this._onPresenceChangedCallbacks.fire(this,c)}}.bind(this);var c=this._presenceService.getPresenceListSubscription();c._addOnInternalPresenceReceivedCallback(this._onPresenceReceived);var d=b.Deferred(),e=function(){var f=this._getPresenceAddress()||this._getNextPresenceAddressCandidate();if(!f)return a.Base.Logger.error(a.Base.LoggerTags.CONTACTS_SERVICE,"No IM addresses available for contact's presence subscription"),c._removeOnInternalPresenceReceivedCallback(this._onPresenceReceived),b.Deferred().reject(new a.Services.Presence.PresenceError(a.Services.Presence.PresenceErrorReason.UNSUPPORTED)).promise();a.Base.Logger.debug(a.Base.LoggerTags.CONTACTS_SERVICE,"Attempting to subscribe for contact's presence using IM address",f),c._addInternalAddress(f).done(function(){this._presenceAddress=f,d.resolve()}.bind(this)).fail(function(b){b instanceof a.Services.Presence.PresenceError&&b.getReason()===a.Services.Presence.PresenceErrorReason.TIMEOUT?(a.Base.Logger.warn(a.Base.LoggerTags.CONTACTS_SERVICE,"Unable to subscribe for contact's presence using "+f+" IM address. Trying next one."),setTimeout(e,0)):(a.Base.Logger.error(a.Base.LoggerTags.CONTACTS_SERVICE,"Failed to subscribe for contact's presence",b),c._removeOnInternalPresenceReceivedCallback(this._onPresenceReceived),d.reject(b))}.bind(this))}.bind(this);return e(),d.promise()},stopPresence:function(){if(!this._getPresenceCapability.isAllowed)return b.Deferred().reject(new a.Services.Presence.PresenceError(a.Services.Presence.PresenceErrorReason.UNSUPPORTED));if(!this.getPresence())return a.Base.Logger.warn(a.Base.LoggerTags.CONTACTS_SERVICE,"Cannot stop monitoring presence of this contact as it was not started"),b.Deferred().reject(new a.Services.Presence.PresenceError(a.Services.Presence.PresenceErrorReason.INVALID_STATE));var c=this._presenceService.getPresenceListSubscription();return c._removeInternalAddress(this._getPresenceAddress()).then(function(){c._removeOnInternalPresenceReceivedCallback(this._onPresenceReceived),this._presence=void 0}.bind(this))},_setPresenceService:function(a){this._presenceService=a,this._presenceService&&(this._presenceService.addOnPresenceServiceAvailableCallback(this._recalculateCapabilities.bind(this)),this._presenceService.addOnPresenceServiceUnavailableCallback(this._recalculateCapabilities.bind(this))),this._recalculateCapabilities()},_setContactsService:function(a){this._contactsService=a},_getPresenceAddress:function(){return this._presenceAddress},_getNextPresenceAddressCandidate:function(){if(!this._presenceAddressCandidates){var b=this._imAddresses.getValues();b=b.slice(0,b.length),b.sort(function(b,c){return b.isAvayaAdministered()&&!c.isAvayaAdministered()||b.getIMAddressType()===a.Services.Contacts.ContactIMAddressType.IM_ADDRESS_WORK&&c.getIMAddressType()!==a.Services.Contacts.ContactIMAddressType.IM_ADDRESS_WORK?-1:!b.isAvayaAdministered()&&c.isAvayaAdministered()||b.getIMAddressType()!==a.Services.Contacts.ContactIMAddressType.IM_ADDRESS_WORK&&c.getIMAddressType()===a.Services.Contacts.ContactIMAddressType.IM_ADDRESS_WORK?1:0}),this._presenceAddressCandidates=b}var c=this._presenceAddressCandidates.shift();if(c)return c.getAddress()},_recalculateCapabilities:function(){var b;b=this._presenceService&&this._imAddresses.getValues().length>0&&this._presenceService._available?a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED:a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED,this._getPresenceCapability._updateIfChanged(b===a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED,b)},_setSelfContact:function(a){this._selfContact=a}},a.Base.AOPTools.addAdvices(c,"Contact",["startPresence","stopPresence"],[a.Base.AOPCommonAdvices.LOG_CONTACTS_API_CALLS,a.Base.AOPCommonAdvices.WRAP_CAUGHT_CONTACTS_ERROR]),a.Services.Contacts.Contact=c}(AvayaClientServices,jQuery),function(a,b){"use strict";function c(a){this._contactsService=a,this._isAvailable=!1,this._onCapabilitiesChangedCallbacks=b.Callbacks(),this._onContactsServiceUnavailableCallbacks=b.Callbacks(),this._onContactsServiceAvailableCallbacks=b.Callbacks()}c.prototype={createEditableContact:function(){return this._contactsService.createEditableContact()},createEditableContactFromContact:function(a){return this._contactsService.createEditableContactFromContact(a)},addContact:function(c){return a.Base.Utils.isUndefined(c)||!c.getContactSavableCapability().isAllowed?b.Deferred().reject(new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.REQUIRED_DATA_MISSING)):this._contactsService.getAddContactCapability(c).isAllowed?this._contactsService.addContact(c):b.Deferred().reject(new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.ADD_CONTACT_NOT_AVAILABLE))},updateContact:function(c){return a.Base.Utils.isUndefined(c)||!c.getContactSavableCapability().isAllowed?b.Deferred().reject(new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.REQUIRED_DATA_MISSING)):this._contactsService.isContactInCache(c)?this._contactsService.getUpdateContactCapability(c).isAllowed?this._contactsService.updateContact(c):b.Deferred().reject(new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.UPDATE_CONTACT_NOT_AVAILABLE)):b.Deferred().reject(new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.CONTACT_NOT_FOUND))},deleteContact:function(c){return a.Base.Utils.isUndefined(c)||!this._contactsService.isContactInCache(c)?b.Deferred().reject(new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.CONTACT_NOT_FOUND)):this._contactsService.getDeleteContactCapability(c).isAllowed?this._contactsService.deleteContact(c):b.Deferred().reject(new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.DELETE_CONTACT_NOT_AVAILABLE))},getContacts:function(){return this._contactsService.getContacts()},searchContacts:function(b){if(!b)throw a.Base.Logger.error(a.Base.LoggerTags.CONTACTS_SERVICE,"Invalid search request"),new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.INVALID_SEARCH_REQUEST);var c=b.getSearchField();if(c){if(!a.Services.Contacts.SearchFieldType.hasOwnProperty(c))throw a.Base.Logger.error(a.Base.LoggerTags.CONTACTS_SERVICE,"Invalid search field"),new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.INVALID_SEARCH_FIELD)}else b._searchField=a.Services.Contacts.SearchFieldType.ALL;if(!this._contactsService.getNetworkSearchContactCapability().isAllowed&&b.getSearchField()!==a.Services.Contacts.SearchFieldType.TERMINAL)throw a.Base.Logger.error(a.Base.LoggerTags.CONTACTS_SERVICE,"Search contacts is not available"),new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.SEARCH_CONTACTS_NOT_AVAILABLE);if(!this._contactsService.getNetworkSearchTerminalCapability().isAllowed&&b.getSearchField()===a.Services.Contacts.SearchFieldType.TERMINAL)throw a.Base.Logger.error(a.Base.LoggerTags.CONTACTS_SERVICE,"Search terminals is not available"),new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.SEARCH_TERMINALS_NOT_AVAILABLE);var d=b.getSearchString();if(!d||""===d)throw a.Base.Logger.error(a.Base.LoggerTags.CONTACTS_SERVICE,"Invalid search string"),new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.INVALID_SEARCH_STRING);var e=b.getSearchSource();if(e){if(!a.Services.Contacts.SearchSourceType.hasOwnProperty(e))throw a.Base.Logger.error(a.Base.LoggerTags.CONTACTS_SERVICE,"Invalid search source"),new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.INVALID_SEARCH_SOURCE)}else b._searchSource=a.Services.Contacts.SearchSourceType.NETWORK;var f=b.getMaxResults();(!f||f<0)&&(b._maxResults=0);var g=b.getMaxChunkSize();return(!g||g<0)&&(b._maxChunkSize=0),this._contactsService.searchContacts(b)},resolveContacts:function(b){if(!b)throw a.Base.Logger.error(a.Base.LoggerTags.CONTACTS_SERVICE,"Invalid search request"),new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.INVALID_SEARCH_REQUEST);var c=b.getSearchStrings();if(!c||!c.length)throw a.Base.Logger.error(a.Base.LoggerTags.CONTACTS_SERVICE,"Invalid search strings"),new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.INVALID_SEARCH_STRINGS);if(c.length>500)throw a.Base.Logger.error(a.Base.LoggerTags.CONTACTS_SERVICE,"Count of search strings is too large"),new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.SEARCH_STRINGS_TOO_LARGE);var d=b.getSearchField();if(d){if(!a.Services.Contacts.ResolveContactsFieldType.hasOwnProperty(d))throw a.Base.Logger.error(a.Base.LoggerTags.CONTACTS_SERVICE,"Invalid search field"),new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.INVALID_SEARCH_FIELD)}else b._setSearchField(a.Services.Contacts.ResolveContactsFieldType.PHONE_NUMBER);var e=a.Services.Contacts.SearchSourceType,f=this._contactsService.getNetworkResolveContactsCapability(),g=b.getSearchSource();if(g||(g=e.NETWORK,b._setSearchSource(e.NETWORK)),!f.isAllowed)switch(g){case e.NETWORK:throw a.Base.Logger.error(a.Base.LoggerTags.CONTACTS_SERVICE,"Contact resolution over the network is currently unavailable"),new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.SEARCH_CONTACTS_NOT_AVAILABLE);case e.ALL:a.Base.Logger.warn(a.Base.LoggerTags.CONTACTS_SERVICE,"Contact resolution over the network is currently unavailable, searching in local cache"),g=e.LOCAL,b._setSearchSource(e.LOCAL)}if(!e.hasOwnProperty(g))throw a.Base.Logger.error(a.Base.LoggerTags.CONTACTS_SERVICE,"Invalid search source"),new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.INVALID_SEARCH_SOURCE);return this._contactsService.resolveContacts(b)},changeSearchContactsRequest:function(a,b){this._contactsService.changeSearchContactsRequest(a,b)},findLocalMatchingContacts:function(a,b){this._contactsService.findLocalMatchingContacts(a,b)},start:function(a){return this._startDfd=b.Deferred(),this._contactsService.start(this,a),this._startDfd.promise()},stop:function(){var a=function(){this._onCapabilitiesChangedCallbacks.empty(),this._onContactsServiceAvailableCallbacks.empty(),this._onContactsServiceUnavailableCallbacks.empty()}.bind(this);return this._contactsService.stop(this).always(a)},_fireContactsAvailableCallback:function(){!this._isAvailable&&this._contactsService.isStarted()&&(this._isAvailable=!0,a.Base.Logger.info(a.Base.LoggerTags.CONTACTS_SERVICE,"Service is available"),this._startDfd.state()===a.Base.DeferredStates.PENDING&&this._startDfd.resolve(),this._onContactsServiceAvailableCallbacks.fire(this))},_fireContactsUnavailableCallback:function(){(this._isAvailable||this._contactsService.isStarting())&&(this._isAvailable=!1,a.Base.Logger.info(a.Base.LoggerTags.CONTACTS_SERVICE,"Service is unavailable"),this._contactsService.isStarting()&&(this._contactsService._starting=!1),this._startDfd.state()===a.Base.DeferredStates.PENDING&&this._startDfd.reject(),this._onContactsServiceUnavailableCallbacks.fire(this))}},a.Base.AOPTools.addAdvices(c,"Contacts",["createEditableContact","createEditableContactFromContact","getContacts","searchContacts","resolveContacts","changeSearchContactsRequest","findLocalMatchingContacts"],[a.Base.AOPCommonAdvices.LOG_CONTACTS_API_CALLS]),a.Base.AOPTools.addAdvices(c,"Contacts",["addContact","updateContact","deleteContact"],[a.Base.AOPCommonAdvices.LOG_CONTACTS_API_CALLS,a.Base.AOPCommonAdvices.WRAP_CAUGHT_CONTACTS_ERROR]),a.Services.Contacts.Contacts=c}(AvayaClientServices,jQuery),function(a,b){"use strict";var c={getUpdateContactCapability:function(){return this._contactsService.getUpdateContactCapability(this)},getDeleteContactCapability:function(){return this._contactsService.getDeleteContactCapability(this)},getContactSavableCapability:function(){var b=this.getLastName()&&this.getLastName().getValue()&&""!==this.getLastName().getValue().trim(),c=this.getFirstName()&&this.getFirstName().getValue()&&""!==this.getFirstName().getValue().trim(),d=this.getPhoneNumbers().getValues()[0]&&this.getPhoneNumbers().getValues()[0].getPhoneNumber()&&""!==this.getPhoneNumbers().getValues()[0].getPhoneNumber().trim(),e=this.getEmailAddresses().getValues()[0]&&this.getEmailAddresses().getValues()[0].getAddress()&&""!==this.getEmailAddresses().getValues()[0].getAddress().trim(),f=c&&b&&(d||e),g=f?a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED:a.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED;return new a.Base.Capability(g)}};b.extend(a.Services.Contacts.EditableContact.prototype,c)}(AvayaClientServices,jQuery),function(a,b){"use strict";function c(c){this._thumbnailCreator=c,this.disposition="",this.duration=-1,this.mimeType="",this.id="",this.size=-1,this.file=void 0,this.status="",this.name="",this.location="",this.thumbnail=void 0,this._onNameChangedCallbacks=b.Callbacks(),this._onMimeTypeChangedCallbacks=b.Callbacks(),this._onDurationChangedCallbacks=b.Callbacks(),this._onSizeChangedCallbacks=b.Callbacks(),this._onStatusChangedCallbacks=b.Callbacks(),this._onConsumptionStatusChangedCallbacks=b.Callbacks(),this._onTypeChangedCallbacks=b.Callbacks(),this._onHasThumbnailChangedCallbacks=b.Callbacks(),this._onIsSelfGeneratedCallbacks=b.Callbacks(),this._updateNameCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateMimeTypeCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateDurationCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateSizeCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateLocationCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateIsSelfGeneratedCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._createThumbnailCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeThumbnailCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE)}c.prototype={_getStatus:function(){return this.status},getName:function(){if(this.name)return this.name;if(this.disposition&&-1!==this.disposition.search("filename"))try{return this.name=new RegExp("filename=(?:[\"']?)([^\"';]+)","i").exec(this.disposition)[1],this.name}catch(b){a.Base.Logger.error(a.Base.LoggerTags.MESSAGING_SERVICE,"Could not retrieve attachment name: "+b)}},getMimeType:function(){return this.mimeType},getDuration:function(){return this.duration},getSize:function(){return this.size},_isThumbnail:function(){return-1!==this.disposition.indexOf("inline")},getThumbnail:function(){return this.thumbnail},setName:function(b){a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:"string"}]}),this.name=b},setMimeType:function(b){a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:"string"}]}),this.mimeType=b},setDuration:function(b){a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:"number"}]}),this.duration=b},getDownloadURL:function(){return this.location},createThumbnail:function(){return!!this.getCreateThumbnailCapability().isAllowed&&this._thumbnailCreator.create(this)},removeThumbnail:function(){this.thumbnail=void 0},_setStatus:function(a){this.status=a,this._onStatusChangedCallbacks.fire(a)}},a.Base.AOPTools.addAdvices(c,"Attachment",["createThumbnail"],[a.Base.AOPCommonAdvices.LOG_MESSAGING_API_CALLS,a.Base.AOPCommonAdvices.WRAP_CAUGHT_MESSAGING_ERROR]),a.Services.Messaging.Attachment=c}(AvayaClientServices,jQuery),function(a,b){"use strict";function c(c){this._conversationService=c,this.attachmentCount=0,this.totalMessageCount=0,this.active=!1,this.closed=!1,this.sensitivity=a.Services.Messaging.SensitivityLevel.NORMAL,this.href="",this.id="",this.lastAccessTime=void 0,this.lastUpdated=void 0,this.latestEntryTimestamp=void 0,this.subject="",this.totalCount=0,this.type=a.Services.Messaging.ConversationType.THREAD,this.unreadAttachmentCount=0,this.unreadCount=0,this.unreadContentSinceLastAccess=0,this.resourceStatus=a.Services.Messaging.ResourceStatus.PUBLISHED,this.messages=new a.Base.DataSet,this.previewText="",this.participants=[],this.composingParticipants=new a.Base.DataSet,this.multiparty=!1,this._draftMessages=[],this._draftEscalations=[],this._counts={eventCount:0,eventUnreadMessage:0,messageAttachment:0,messageCount:0,messageUnreadAttachment:0,messageUnreadMessage:0},this._isSubscribed=!1,this._onMessagesAddedCallbacks=b.Callbacks(),this._onSubjectChangedCallbacks=b.Callbacks(),this._onParticipantsAddedCallbacks=b.Callbacks(),this._onParticipantsRemovedCallbacks=b.Callbacks(),this._onActiveStatusChangedCallbacks=b.Callbacks(),this._onClosedStatusChangedCallbacks=b.Callbacks(),this._onMultiPartyStatusChangedCallbacks=b.Callbacks(),this._onIsComposingStatusChangedCallbacks=b.Callbacks(),this._onLastAccessTimeChangedCallbacks=b.Callbacks(),this._onLastUpdatedTimeChangedCallbacks=b.Callbacks(),this._onLatestEntryTimeChangedCallbacks=b.Callbacks(),this._onStatusChangedCallbacks=b.Callbacks(),this._onPreviewTextChangedCallbacks=b.Callbacks(),this._onTotalMessagesCountChangedCallbacks=b.Callbacks(),this._onTotalUnreadMessageCountChangedCallbacks=b.Callbacks(),this._onTotalAttachmentCountChangedCallbacks=b.Callbacks(),this._onTotalUnreadAttachmentCountChangedCallbacks=b.Callbacks(),this._onTotalEventCountChangedCallbacks=b.Callbacks(),this._onTotalUnreadEventCountChangedCallbacks=b.Callbacks(),this._onSensitivityChangedCallbacks=b.Callbacks(),this._onTypeChangedCallbacks=b.Callbacks(),this._onMessagesRemovedCallbacks=b.Callbacks(),this._onOtherMessagesAddedCallbacks=b.Callbacks(),
this._updateSubjectCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateLastAccessTimeCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateSensitivityCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._retrieveMessagesCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._addParticipantsCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeParticipantsCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._createMessageCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._createEscalationCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._markAllContentAsReadCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._leaveCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._startCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._isTypingCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE)}c.prototype={getSensitivity:function(){return this.sensitivity},isActive:function(){return this.active},isClosed:function(){return this.closed},isMultiParty:function(){return this.multiparty},isPrivate:function(){return this.sensitivity===a.Services.Messaging.SensitivityLevel.PRIVATE},hasUnreadMessagesSinceLastAccess:function(){return this._conversationService.getNumberOfMessagesWithUnreadContentSinceLastAccess(this)>0},hasUnreadAttachments:function(){return this._counts.messageUnreadAttachment>0},hasAttachments:function(){return this._counts.messageAttachment>0},isParticipantActive:function(a){},getLastAccessTime:function(){return this.lastAccessTime},getLastUpdatedTime:function(){return this.lastUpdated},getLastEntryTime:function(){return this.latestEntryTimestamp},getComposingParticipants:function(){return this.composingParticipants},getParticipants:function(){return this.participants},getActiveParticipants:function(){return this.getParticipants()},getType:function(){return this.type},getTotalMessageCount:function(){return this._counts.messageCount},getAttachmentCount:function(){return this._counts.messageAttachment},getUnreadAttachmentCount:function(){return this._counts.messageUnreadAttachment},getUnreadMessageCount:function(){return this._counts.messageUnreadMessage},getPreviewText:function(){return this.previewText},getSubject:function(){return this.subject},getLastUpdatedByParticipant:function(){var a=this._getLastMessage();if(void 0!==a)return this.participants.filter(function(b){return b.address===a.from.address})[0]},getStatus:function(){return this.resourceStatus},setSensitivity:function(b){a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:"string"}]}),this.sensitivity!==b&&(this.sensitivity=b,this._onSensitivityChangedCallbacks.fire(this,b))},_setStatus:function(b){a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:"string"}]}),this.resourceStatus!==b&&(this.resourceStatus=b,this._onStatusChangedCallbacks.fire(this,b))},setLastAccessTime:function(){this._conversationService.setLastAccessTime(this)},setSubject:function(b){a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:"string"}]}),this.subject!==b&&(this.getStatus()===a.Services.Messaging.ResourceStatus.PUBLISHED&&this._conversationService.changeSubject(this,b),this.subject=b,this._onSubjectChangedCallbacks.fire(this,this.subject))},_getLastMessage:function(){return this.messages.filter(function(b){return b.getType()===a.Services.Messaging.MessageType.MESSAGE})[0]},createMessage:function(){return this._conversationService.createMessage(this)},createEscalation:function(){var a=this._conversationService.createEscalation(this);return this._draftEscalations.push(a),a},removeEscalation:function(b){return a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:a.Services.Messaging.Escalation}]}),this._conversationService.removeEscalation(b,this._draftEscalations)},getMessages:function(){return this.messages},retrieveMessagesAfter:function(b,c){return a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:a.Services.Messaging.Message}]}),a.Base.Utils.validate(c,{optional:!0,validators:[{type:"type",expected:"number"}]}),this._conversationService.getOtherMessages(null,b,c,this)},retrieveMessagesBefore:function(b,c){return a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:a.Services.Messaging.Message}]}),a.Base.Utils.validate(c,{optional:!0,validators:[{type:"type",expected:"number"}]}),this._conversationService.getOtherMessages(b,null,c,this)},markAllContentAsRead:function(){return this._conversationService.markAllAsRead(this)},subscribeForTypingEvents:function(a){return this._conversationService.subscribeForTypingEvents(this,a)},unsubscribeForTypingEvents:function(){return this._conversationService.unsubscribeForTypingEvents(this)},addParticipantAddresses:function(b){return a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:Array},{type:"arrayElementType",expected:"string"}]}),this._conversationService.addParticipantAddresses(this,b)},removeParticipantAddresses:function(b){return a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:Array},{type:"arrayElementType",expected:"string"}]}),this._conversationService.removeParticipantAddresses(this,b)},removeMessage:function(b){return a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:a.Services.Messaging.Message}]}),this._conversationService.removeMessage(this.messages,this._draftMessages,b)},start:function(){var a=b.Deferred();return setTimeout(function(){a.resolve()}),a.promise()},leave:function(){return this._conversationService.leave(this)},_updateParticipantsList:function(a){this._conversationService._updateParticipantsList(this,a)},getId:function(){return this.id}},a.Base.AOPTools.addAdvices(c,"Conversation",["setSubject","createMessage","createEscalation","retrieveMessagesAfter","retrieveMessagesBefore"],[a.Base.AOPCommonAdvices.LOG_MESSAGING_API_CALLS]),a.Base.AOPTools.addAdvices(c,"Conversation",["markAllContentAsRead","removeEscalation","subscribeForTypingEvents","unsubscribeForTypingEvents","addParticipantAddresses","removeParticipantAddresses","removeMessage","start","leave"],[a.Base.AOPCommonAdvices.LOG_MESSAGING_API_CALLS,a.Base.AOPCommonAdvices.WRAP_CAUGHT_MESSAGING_ERROR]),a.Services.Messaging.Conversation=c}(AvayaClientServices,jQuery),function(a,b){"use strict";function c(c,d){this._messageService=c,this.conversation=d,this.resourceStatus=a.Services.Messaging.ResourceStatus.PUBLISHED,this.body="",this.type=a.Services.Messaging.MessageType.MESSAGE,this.sensitivity=a.Services.Messaging.SensitivityLevel.NORMAL,this.importance=a.Services.Messaging.MessageImportance.NORMAL,this.read=!1,this.doNotForward=!1,this.from=void 0,this.href="",this.id="",this.lastModifiedDate=void 0,this.receivedDate=void 0,this.subject="",this.threadId="",this.to=void 0,this.parts=new a.Base.DataSet,this._attachments=[],this.coalesced=!1,this.inReplyTo=void 0,this._sessionType=void 0,this._onTypeChangedCallbacks=b.Callbacks(),this._onBodyChangedCallbacks=b.Callbacks(),this._onInReplyToChangedCallbacks=b.Callbacks(),this._onLastModifiedDateChangedCallbacks=b.Callbacks(),this._onIsCoalescedStatusChangedCallbacks=b.Callbacks(),this._onHasAttachmentStatusChangedCallbacks=b.Callbacks(),this._onHasUnreadAttachmentStatusChangedCallbacks=b.Callbacks(),this._onIsPrivateStatusChangedCallbacks=b.Callbacks(),this._onDoNotForwardStatusChangedCallbacks=b.Callbacks(),this._onIsReadStatusChangedCallbacks=b.Callbacks(),this._onStatusChangedCallbacks=b.Callbacks(),this._onImportanceChangedCallbacks=b.Callbacks(),this._onSensitivityChangedCallbacks=b.Callbacks(),this._updateBodyCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateSensitivityCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateInReplyToCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateDoNotForwardCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateImportanceCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._createAttachmentCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._sendCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._markAsReadCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE)}c.prototype={getType:function(){return this.type},getBody:function(){return this.body},getConversationId:function(){return this.conversation.getId()},getId:function(){return this.id},getInReplyTo:function(){return this.inReplyTo},getSessionType:function(){return this._sessionType},getLastModifiedDate:function(){return this.lastModifiedDate},getReceivedDate:function(){return this.receivedDate},isCoalesced:function(){return this.coalesced},hasAttachment:function(){return this.parts.length>0},hasUnreadAttachment:function(){return this.parts.reduce(function(a,b){return a||!b.isRead()},!1)},isPrivate:function(){return this.sensitivity===a.Services.Messaging.SensitivityLevel.PRIVATE},isDoNotForward:function(){return this.doNotForward},isRead:function(){return this.read},getFromParticipant:function(){return this.from},getAttachments:function(){return this.parts},getStatus:function(){return this.resourceStatus},getImportance:function(){return this.importance},getSensitivity:function(){return this.sensitivity},setBodyAndReportTyping:function(b){return a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:"string"}]}),this._messageService.setBodyAndReportTyping(this,this.conversation,b)},reportTyping:function(b){this.conversation.getStatus()===a.Services.Messaging.ResourceStatus.PUBLISHED&&this.conversation.getIsTypingCapability().isAllowed&&this.conversation._conversationService.reportTyping(this,b)},setSensitivity:function(b){a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:"string"}]}),this.sensitivity!==b&&(this.sensitivity=b,this._onSensitivityChangedCallbacks.fire(this,b))},_setIsCoalesced:function(b){a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:"boolean"}]}),this.coalesced!==b&&(this.coalesced=b,this._onIsCoalescedStatusChangedCallbacks.fire(this,b))},isFromMe:function(){return!!this.from&&this.from.isSelf()},setInReplyTo:function(b){a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:a.Services.Messaging.Message}]}),b instanceof a.Services.Messaging.Message&&void 0!==b.getId()&&this.inReplyTo!==b&&(this.inReplyTo=b.getId(),this._onInReplyToChangedCallbacks.fire(this,this.inReplyTo))},setDoNotForward:function(b){a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:"boolean"}]}),this.doNotForward!==b&&(this.doNotForward=b,this._onDoNotForwardStatusChangedCallbacks.fire(this,b))},_setStatus:function(b){a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:"string"}]}),this.resourceStatus!==b&&(this.resourceStatus=b,this._onStatusChangedCallbacks.fire(this,b))},setImportance:function(b){a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:"string"}]}),this.importance!==b&&(this.importance=b,this._onImportanceChangedCallbacks.fire(this,b))},markAsRead:function(){return this._messageService.markAsRead(this)},send:function(){return this._messageService.send(this)},createAttachment:function(b){return a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:File}]}),this._messageService.createAttachment(this,b)},removeDraftAttachment:function(b){a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:a.Services.Messaging.Attachment}]}),this._messageService.removeDraftAttachment(this,b)}},a.Base.AOPTools.addAdvices(c,"Message",["removeDraftAttachment","createAttachment","reportTyping"],[a.Base.AOPCommonAdvices.LOG_MESSAGING_API_CALLS]),a.Base.AOPTools.addAdvices(c,"Message",["send","markAsRead","setBodyAndReportTyping"],[a.Base.AOPCommonAdvices.LOG_MESSAGING_API_CALLS,a.Base.AOPCommonAdvices.WRAP_CAUGHT_MESSAGING_ERROR]),a.Services.Messaging.Message=c}(AvayaClientServices,jQuery),function(a,b){"use strict";function c(c){this._messagingService=c,this._isAvailable=void 0,this._onMessagingLimitsChangedCallbacks=b.Callbacks(),this._onRoutableDomainsChangedCallbacks=b.Callbacks(),this._onNumberOfConversationsWithUnreadContentChangedCallbacks=b.Callbacks(),this._onNumberOfConversationsWithUnreadContentSinceLastAccessChangedCallbacks=b.Callbacks(),this._onMessagingServiceUnavailableCallbacks=b.Callbacks(),this._onMessagingServiceAvailableCallbacks=b.Callbacks(),this._retrieveConversationsCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._startServiceCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._createConversationCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._searchConversationsCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateRefreshIntervalCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._validateParticipantAddressesCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._markContentAsReadCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._clearLocalDataCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._messagingUnavailableReason=void 0}c.prototype={getRoutableDomains:function(){return this._messagingService.getRoutableDomains()},getSelfAddress:function(){return this._messagingService.getSelfAddress()},getNumberOfConversationsWithUnreadContentSinceLastAccess:function(){return this._messagingService.getNumberOfConversationsWithUnreadContentSinceLastAccess()},getNumberOfConversationsWithUnreadContent:function(){return this._messagingService.getNumberOfConversationsWithUnreadContent()},createConversation:function(){return this._messagingService.createConversation(this)},getActiveConversations:function(){return this._messagingService.getActiveConversations(this)},getDraftConversations:function(){return this._messagingService.getDraftConversations()},getConversationIds:function(){return this._messagingService.getConversationIds()},searchConversations:function(b){return a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:a.Services.Messaging.MessagingQuery}]}),this._messagingService.searchConversations(b,this)},getAllActiveConversationsForContact:function(a){},validateAddresses:function(b){return a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:Array},{type:"arrayElementType",expected:"string"}]}),this._messagingService.validateUsers(b)},leaveConversations:function(b){return a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:Array},{type:"arrayElementType",expected:a.Services.Messaging.Conversation}]}),this._messagingService.leaveConversations(b)},leaveAllConversations:function(){return this._messagingService.leaveAllConversations()},start:function(a){return this._startDfd=b.Deferred(),this._messagingService.start(this,a),this._startDfd.promise()},stop:function(){return this._messagingService.stop(this)},removeConversation:function(b){return a.Base.Utils.validate(b,{validators:[{type:"defined"},{type:"type",expected:a.Services.Messaging.Conversation}]}),this._messagingService.removeConversation(b)},_fireMessagingAvailableCallback:function(){!a.Base.Utils.isUndefined(this._isAvailable)&&this._isAvailable||(this._isAvailable=!0,this._messagingUnavailableReason=void 0,this._startDfd.state()===a.Base.DeferredStates.PENDING&&this._startDfd.resolve(),this._onMessagingServiceAvailableCallbacks.fire(this))},_fireMessagingUnavailableCallback:function(b){(a.Base.Utils.isUndefined(this._isAvailable)||this._isAvailable)&&(this._isAvailable=!1,this._messagingUnavailableReason=b,this._startDfd.state()===a.Base.DeferredStates.PENDING&&this._startDfd.reject(),this._onMessagingServiceUnavailableCallbacks.fire(this))}},a.Base.AOPTools.addAdvices(c,"Messaging",["createConversation","getActiveConversations","searchConversations"],[a.Base.AOPCommonAdvices.LOG_MESSAGING_API_CALLS]),a.Base.AOPTools.addAdvices(c,"Messaging",["validateAddresses","leaveConversations","leaveAllConversations","removeConversation"],[a.Base.AOPCommonAdvices.LOG_MESSAGING_API_CALLS,a.Base.AOPCommonAdvices.WRAP_CAUGHT_MESSAGING_ERROR]),a.Services.Messaging.Messaging=c}(AvayaClientServices,jQuery),function(a){"use strict";function b(b,c){a.Services.Participant.call(this),this._address=b._address,this._localUser=c,this.type=b.type,this.givenName=b.givenName,this.language=b.language,this.modalities=b.modalities,this.nativeGivenName=b.nativeGivenName,this.nativeSurname=b.nativeSurname,this.surname=b.surname}b.prototype=Object.create(a.Services.Participant.prototype),b.prototype.getType=function(){return this.type},b.prototype.getAddress=function(){return this._address},b.prototype.getGivenName=function(){return this.givenName},b.prototype.getSurname=function(){return this.nativeSurname},b.prototype.getDisplayName=function(){return this._displayName&&""!==this._displayName?this._displayName:this.givenName||this.surname?this.surname?this.givenName?this.givenName+" "+this.surname:this.surname:this.givenName:this._address},b.prototype.getSupportedModalities=function(){return this.modalities},b.prototype.isSelf=function(){return this.self},a.Services.Messaging.Participant=b}(AvayaClientServices),function(a){"use strict";var b={addOnParticipantMatchedContactsChangedCallback:function(a){this._onParticipantMatchedContactsChangedCallbacks.add(a)},removeOnParticipantMatchedContactsChangedCallback:function(a){this._onParticipantMatchedContactsChangedCallbacks.remove(a)}};$.extend(a.Services.Participant.prototype,b)}(AvayaClientServices),function(a,b){"use strict";function c(a){this._presenceProvider=a,this._userAddresses=[],this._internalAddresses=[],this._selfAddress=void 0,this._onPresenceNotification=void 0,this._onStartedCallbacks=b.Callbacks(),this._onStoppedCallbacks=b.Callbacks(),this._onPresenceReceivedCallbacks=b.Callbacks(),this._onInternalPresenceReceivedCallbacks=b.Callbacks(),this._onSelfPresenceReceivedCallbacks=b.Callbacks()}c.prototype={addAddress:function(a){return this._subscribe(a).then(function(){this._userAddresses.push(a)}.bind(this))},_addInternalAddress:function(a){return this._subscribe(a).then(function(){this._internalAddresses.push(a)}.bind(this))},_subscribe:function(c){return c&&""!==c.trim()?(a.Base.Logger.debug(a.Base.LoggerTags.PRESENCE_SERVICE,"Subscribing for presence",c),this._presenceProvider.subscribeForSingleAddressPresence(c)):(a.Base.Logger.error(a.Base.LoggerTags.PRESENCE_SERVICE,"Subscription was requested for empty/undefined address",c),b.Deferred().reject(new a.Services.Presence.PresenceError(a.Services.Presence.PresenceErrorReason.INVALID_REQUEST)).promise())},_setSelfAddress:function(a){this._selfAddress=a},removeAddress:function(a){return this._userAddresses=this._userAddresses.filter(function(b){return a!==b},this),this._presenceProvider.unsubscribeFromSingleAddressPresence(a)},_removeInternalAddress:function(a){return this._internalAddresses=this._internalAddresses.filter(function(b){return a!==b},this),this._presenceProvider.unsubscribeFromSingleAddressPresence(a)},_start:function(){return this._onPresenceNotification=function(c){var d=c.getPresentity();a.Base.Logger.debug(a.Base.LoggerTags.PRESENCE_SERVICE,"Received presence information",d),this._selfAddress===d&&(c=b.extend(new a.Services.Presence.SelfPresence,c),this._onSelfPresenceReceivedCallbacks.fire(c)),-1!==this._userAddresses.indexOf(d)&&this._onPresenceReceivedCallbacks.fire(this,c),-1!==this._internalAddresses.indexOf(d)&&this._onInternalPresenceReceivedCallbacks.fire(c)}.bind(this),this._presenceProvider.on(a.Providers.Interfaces.PresenceProviderCallbackIds.PRESENCE_NOTIFICATION,this._onPresenceNotification),this._presenceProvider.subscribeForPresence([this._selfAddress]).then(function(){this._onStartedCallbacks.fire()}.bind(this))},_stop:function(){return this._presenceProvider.unsubscribeFromAllAddressesPresence().always(function(){this._onStoppedCallbacks.fire(),this._onStartedCallbacks.empty(),this._onStoppedCallbacks.empty(),this._onPresenceReceivedCallbacks.empty(),this._onInternalPresenceReceivedCallbacks.empty(),this._onSelfPresenceReceivedCallbacks.empty()}.bind(this))}},a.Base.AOPTools.addAdvices(c,"PresenceListSubscription",["addAddress","removeAddress"],[a.Base.AOPCommonAdvices.LOG_PRESENCE_API_CALLS,a.Base.AOPCommonAdvices.WRAP_CAUGHT_PRESENCE_ERROR]),a.Services.Presence.PresenceListSubscription=c}(AvayaClientServices,$),function(a,b){"use strict";function c(c){this._presenceProvider=c,this._selfPresenceManagedExternally=!1,this._selfPresence=void 0,this._selfAddress=void 0,this._phoneAndVideoChannelAddress=void 0,this._presenceSubscriptions=new a.Services.Presence.PresenceListSubscription(this._presenceProvider),this._onSelfPresenceNotification=void 0,this._onNetworkAvailable=void 0,this._onNetworkUnavailable=void 0,this._available=void 0,this._starting=!1,this._started=!1,this._onSelfPresenceReceivedCallbacks=b.Callbacks(),this._onPresenceServiceAvailableCallbacks=b.Callbacks(),this._onPresenceServiceUnavailableCallbacks=b.Callbacks()}c.prototype={publishAutomaticPresence:function(){return this._selfPresence?(this._selfPresence._setPhoneContact(this._phoneAndVideoChannelAddress),this._selfPresence._setVideoContact(this._phoneAndVideoChannelAddress),this._selfPresence._setEnterpriseIMContact(this._selfAddress),this._presenceProvider.publishAutomaticPresence(this._selfPresence)):b.Deferred().reject(new a.Services.Presence.PresenceError(a.Services.Presence.PresenceErrorReason.INVALID_STATE))},publishManualState:function(a){return this._presenceProvider.publishManualState(a)},publishLocationMode:function(a){return this._presenceProvider.publishLocationMode(a)},publishNote:function(a){return this._presenceProvider.publishNote(a)},getPresenceListSubscription:function(){return this._presenceSubscriptions},getSelfPresence:function(){return a.Base.Logger.warn(a.Base.LoggerTags.PRESENCE_SERVICE,"Deprecated function is called: getSelfPresence()"),this._selfPresence},start:function(c){return this._startDfd=b.Deferred(),a.Base.Logger.info(a.Base.LoggerTags.PRESENCE_SERVICE,"Starting the service"),this._onSelfPresenceNotification=function(a){this._selfPresenceManagedExternally||(this._selfPresence=a,this._onSelfPresenceReceivedCallbacks.fire(this,a))}.bind(this),this._subscribeForProvidersNotifications(),this._starting=!0,this._presenceProvider.start(c).then(function(){return this._selfPresenceManagedExternally||(this._selfAddress=this._phoneAndVideoChannelAddress=c.sgConfiguration.credentialProvider.username),this._presenceSubscriptions._addOnSelfPresenceReceivedCallback(this._onSelfPresenceNotification),this._presenceSubscriptions._setSelfAddress(this._selfAddress),this._presenceSubscriptions._start()}.bind(this)).then(function(){this._starting=!1,this._started=!0,this._onServiceAvailable(),a.Base.Logger.info(a.Base.LoggerTags.PRESENCE_SERVICE,"Service started successfully")}.bind(this),function(b){this._starting=!1,a.Base.Logger.error(a.Base.LoggerTags.PRESENCE_SERVICE,"Failed to start service",b)}.bind(this)),this._startDfd.promise()},stop:function(){a.Base.Logger.info(a.Base.LoggerTags.PRESENCE_SERVICE,"Stopping the service"),this._unsubscribeFromProvidersNotifications(),this._onServiceUnavailable();var c=b.Deferred();return this._presenceSubscriptions._stop().always(function(){this._presenceProvider.stop().then(function(){a.Base.Logger.info(a.Base.LoggerTags.PRESENCE_SERVICE,"Service stopped successfully"),c.resolve()},function(b){a.Base.Logger.error(a.Base.LoggerTags.PRESENCE_SERVICE,"Failed to stop service",b),c.reject(b)}).always(function(){this._onSelfPresenceReceivedCallbacks.empty(),this._onPresenceServiceAvailableCallbacks.empty(),this._onPresenceServiceUnavailableCallbacks.empty(),this._presenceSubscriptions._removeOnSelfPresenceReceivedCallback(this._onSelfPresenceNotification),this._started=!1}.bind(this))}.bind(this)),c.promise()},_setSelfPresence:function(a,b,c){this._selfPresenceManagedExternally=!0,this._selfPresence=a,this._selfAddress=b,this._phoneAndVideoChannelAddress=c},_onServiceAvailable:function(){!this._available&&this._started&&(this._available=!0,a.Base.Logger.info(a.Base.LoggerTags.PRESENCE_SERVICE,"Service is available"),this._startDfd.state()===a.Base.DeferredStates.PENDING&&this._startDfd.resolve(),this._onPresenceServiceAvailableCallbacks.fire(this))},_onServiceUnavailable:function(){(this._available||this._starting)&&(this._available=!1,a.Base.Logger.info(a.Base.LoggerTags.PRESENCE_SERVICE,"Service is unavailable"),this._starting&&(this._starting=!1),this._startDfd.state()===a.Base.DeferredStates.PENDING&&this._startDfd.reject(),this._onPresenceServiceUnavailableCallbacks.fire(this))},_subscribeForProvidersNotifications:function(){this._started||this._starting||(this._onNetworkAvailable=this._onServiceAvailable.bind(this),this._onNetworkUnavailable=this._onServiceUnavailable.bind(this),this._presenceProvider.on(a.Base.NetworkProviderEvents.UNAUTHORIZED,this._onNetworkUnavailable),this._presenceProvider.on(a.Base.NetworkProviderEvents.AUTHORIZED,this._onNetworkAvailable),this._presenceProvider.on(a.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,this._onNetworkUnavailable),this._presenceProvider.on(a.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_AVAILABLE,this._onNetworkAvailable))},_unsubscribeFromProvidersNotifications:function(){this._started&&(this._presenceProvider.off(a.Base.NetworkProviderEvents.UNAUTHORIZED,this._onNetworkUnavailable),this._presenceProvider.off(a.Base.NetworkProviderEvents.AUTHORIZED,this._onNetworkAvailable),this._presenceProvider.off(a.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,this._onNetworkUnavailable),this._presenceProvider.off(a.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_AVAILABLE,this._onNetworkAvailable),this._onNetworkAvailable=void 0,this._onNetworkUnavailable=void 0)}},a.Base.AOPTools.addAdvices(c,"PresenceService",["publishAutomaticPresence","publishManualState","publishLocationMode","publishNote"],[a.Base.AOPCommonAdvices.LOG_PRESENCE_API_CALLS,a.Base.AOPCommonAdvices.WRAP_CAUGHT_PRESENCE_ERROR]),a.Services.Presence.PresenceService=c}(AvayaClientServices,$),function(a,b){"use strict";var c={addOnVoiceMessagingServiceUnavailableCallback:function(a){this._onVoiceMessagingServiceUnavailableCallbacks.add(a)},removeOnVoiceMessagingServiceUnavailableCallback:function(a){this._onVoiceMessagingServiceUnavailableCallbacks.remove(a)},addOnVoiceMessagingServiceAvailableCallback:function(a){this._onVoiceMessagingServiceAvailableCallbacks.add(a)},removeOnVoiceMessagingServiceAvailableCallback:function(a){this._onVoiceMessagingServiceAvailableCallbacks.remove(a)},addOnVoicemailNumberChangedCallback:function(a){this._onVoicemailNumberChangedCallbacks.add(a)},removeOnVoicemailNumberChangedCallback:function(a){this._onVoicemailNumberChangedCallbacks.remove(a)},addOnVoiceMessagingStatusChangedCallback:function(a){this._onVoiceMessagingStatusChangedCallbacks.add(a)},removeVoiceMessagingStatusChangedCallback:function(a){this._onVoiceMessagingStatusChangedCallbacks.remove(a)}};b.extend(a.Services.VoiceMessaging.VoiceMessaging.prototype,c)}(AvayaClientServices,$),function(a,b){"use strict";var c={getSubscribeForVoicemailNumberChangesCapability:function(){return this._serviceAvailableCapability},getSubscribeForVoiceMessagingStatusChangesCapability:function(){return this._serviceAvailableCapability}};b.extend(a.Services.VoiceMessaging.VoiceMessaging.prototype,c)}(AvayaClientServices,jQuery),function(a){"use strict";function b(){a.Base.WebSocketProvider.apply(this),this._deferreds={},this._transactionIDLocation=""}b.prototype=Object.create(a.Base.WebSocketProvider.prototype),b.prototype.start=function(b,c,d,e,f){return d&&d.transactionIDLocation&&(this._transactionIDLocation=d.transactionIDLocation),a.Base.WebSocketProvider.prototype.start.call(this,b,c,d,e,f).then(function(){this._socket.onmessage=this._handleOnMessage.bind(this)}.bind(this))},b.prototype._handleOnMessage=function(b){var c,d,e,f=!0;try{c=this.parseResponse(b.data),a.Base.Utils.isDefined(this._failoverPingData)&&this._failoverPingData.wsKeepAliveEnabled&&this._failoverPingData.wsIsPongMessage(c)&&(clearTimeout(this._keepAliveAnswerWaitingTimeout),this._keepAliveAnswerWaitingTimeout=void 0,this._keepAlive()),d=this.getTransactionIDFromResponse(c,this._transactionIDLocation),e=this._deferreds[d]}catch(g){"string"==typeof b.data&&a.Base.Logger.error(a.Base.LoggerTags.WEBSOCKET_NETWORK_PROVIDER,g)}d&&e&&(a.Base.Logger.debug(a.Base.LoggerTags.WEBSOCKET_NETWORK_PROVIDER,"Resolving message "+c.name+" with transId "+d),delete this._deferreds[d],f=!1,e.resolve(c)),f&&this.onMessage(b)},b.prototype.parseMessage=function(a){return JSON.parse(a)},b.prototype.send=function(b,c,d){var e=$.Deferred(),f=this.getTransactionIDFromRequest(this.parseRequest(b),this._transactionIDLocation);return f&&(this._deferreds[f]=e),a.Base.WebSocketProvider.prototype.send.call(this,b,c,d).then(function(){f||e.resolve()},function(a){e.reject(a)}),e.promise()},b.prototype.close=function(){for(var b in this._deferreds)if(this._deferreds.hasOwnProperty(b)){var c=this._deferreds[b];a.Base.Utils.isDefined(c)&&c.reject({message:"Request aborted due to close request"})}return this._deferreds={},a.Base.WebSocketProvider.prototype.close.call(this)},b.prototype._getTransactionID=function(b,c){return a.Base.Utils.queryJSONObject(b,c)},b.prototype.getTransactionIDFromResponse=function(a,b){return this._getTransactionID(a,b)},b.prototype.getTransactionIDFromRequest=function(a,b){return this._getTransactionID(a,b)},b.prototype.parseRequest=function(a){return this.parseMessage(a)},b.prototype.parseResponse=function(a){return this.parseMessage(a)},a.Base.TransactionalWebSocketProvider=b}(AvayaClientServices),function(a,b){"use strict";var c=[];c.type=new a.Base.Validators.TypeValidator,c.arrayElementType=new a.Base.Validators.ArrayElementTypeValidator,c.defined=new a.Base.Validators.DefinedValidator;var d=window.crypto||window.msCrypto;a.Base.Utils={isUndefined:function(a){return void 0===a},isDefined:function(a){return void 0!==a},validate:function(b,d,e){if(d.optional&&void 0===b)return!1;var f=!0;return d.validators.forEach(function(d){if(a.Base.Utils.isUndefined(c[d.type]))throw new Error("Validator of specified type does not exist.");f=f&&c[d.type].validate(b,d,e)}.bind(this)),f},makeId:function(a,b){var c;a||(a=10),c=b||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var d="",e=0;e<a;e++)d+=c.charAt(Math.floor(Math.random()*c.length));return d},clean:function(a,b){for(var c=0;c<a.length;c++)a[c]===b&&(a.splice(c,1),c--);return a},queryJSONObject:function(b,c){if(void 0!==b&&null!==b){var d=b,e=c.match(/(\w+)/g);if(e){
for(var f=0;f<e.length;f++){var g=d[e[f]];if(!a.Base.Utils.isDefined(g)||null===g)return;d=g}return d}}},getBrowserType:function(){var b=a.Base.BrowserType.UNKNOWN;if(window.chrome&&window.chrome.webstore)b=a.Base.BrowserType.CHROME;else if(window.chrome&&document.location.href.indexOf("chrome-extension")>-1)b=a.Base.BrowserType.CHROME_EXTENSION;else if("undefined"!=typeof InstallTrigger)b=a.Base.BrowserType.FIREFOX;else if(window.chrome&&document.location.href.indexOf("moz-extension")>-1)b=a.Base.BrowserType.FIREFOX_EXTENSION;else if(Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0)b=a.Base.BrowserType.SAFARI;else{var c=!!document.documentMode;!c&&window.StyleMedia?b=a.Base.BrowserType.EDGE:c&&(b=a.Base.BrowserType.IE)}return b},removeDuplicatesFromArray:function(a){if(Array.isArray(a))return a.filter(function(a,b,c){return c.indexOf(a)===b})},parseUrl:function(a){if(a){var b=a.match(/^(?:([^:/?#]+):)?\/\/(([^:\/?#]+\:\w*\@)??([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(?:\?)?([^#]*|)(?:#)?(.*|)$/),c=b[4];b[5]&&(c+=":"+b[5]);var d;return b[3]&&(d=b[3].slice(0,-1)),{url:b[0],protocol:b[1],host:c,credentials:d,hostname:b[4],port:parseInt(b[5]),path:b[6],query:b[7],hash:b[8],isSecure:!!b[1]&&("https"===b[1]||"wss"===b[1])}}},callFunction:function(c,d,e,f,g){var h=b.Deferred(),i=0;g=g||1e3,a.Base.Logger.debug(a.Base.LoggerTags.UTILS,"callFunction",arguments);var j=function(a){setTimeout(function(){d.apply(c,e).then(function(){h.resolve()},function(a){i++,f&&f<i?h.reject(a):j(g)})},a)};return j(0),h.promise()},connectionBackoffAlgorithm:function(c,d){var e,f=b.Deferred(),g=0,h=-1,i=d||15e3,j=12e4,k=1,l=.8,m=!1,n={dfdPromise:f.promise(),cancel:function(){m=!0,a.Base.Utils.isDefined(e)&&clearTimeout(e),a.Base.Utils.isDefined(f)&&f.state()===a.Base.DeferredStates.PENDING&&f.reject("Backoff Algorithm canceled.")}},o=function(){m||c().then(function(a){f.resolve(a)},function(b){b&&b.message===a.Base.ErrorReasons.NETWORK_AUTHORIZATION_CANCELED?f.reject(b):(h++,p(h))})},p=function(b){if(b<0)a.Base.Logger.debug(a.Base.LoggerTags.UTILS,"BackoffAlgorithm, ConsecutiveFailures: "+b+" Timeout: 0msec"),o();else{var c=i*Math.pow(2,b);g=c>j?j:Math.min(j,(Math.random()*(k-l)+l)*c),a.Base.Logger.debug(a.Base.LoggerTags.UTILS,"BackoffAlgorithm, ConsecutiveFailures: "+b+" Timeout: "+g+"msec"),e=setTimeout(function(){o()},g)}};return p(h),n},colorIntToHex:function(a){var b=parseInt(a).toString(16);return b="#000000".substr(0,7-b.length)+b,b.toUpperCase()},concatArrayBuffers:function(a,b){var c=new Uint8Array(a.byteLength+b.byteLength);return c.set(new Uint8Array(a),0),c.set(new Uint8Array(b),a.byteLength),c.buffer},stringToArrayBuffer:function(a){for(var b=new ArrayBuffer(a.length),c=new Uint8Array(b),d=0,e=a.length;d<e;d++)c[d]=a.charCodeAt(d);return b},createLocalMediaStream:function(b,c,d,e,f,g,h,i){a.Base.Logger.debug(a.Base.LoggerTags.UTILS,"The video resolution of the localStream has to be changed due to bandwidth management.");var j=d.localStream.getVideoTracks()[0];if(!j||"function"!=typeof j.applyConstraints){var k=b?b.getDeviceId():void 0,l=this.getVideoOptions(d.call.getVideoChannels(),c);return d._rtConnection.stopStream(d.localStream),e.getMediaServicesService().createLocalMediaStream(!0,l.enable,k,l.videoDeviceId,l.videoChannelId,f).then(function(b){var c=b.stream;d._updateVideoResolution(b.videoResolution);var e=d.getAudioStream(),f=[];return c.getTracks().forEach(function(b){if(b.kind===a.Providers.Call.CallProvider.Constants.VIDEO_TRACK){var c=d.getVideoStreams()[0],e=c?c.direction:a.Services.Call.MediaDirection.INACTIVE;f.push(new a.Providers.Interfaces.VideoStream(b.id,e))}}),d.setAVStreams(e,f),d._rtConnection.removeStream(d.localStream),d.localStream=c,d._rtConnection.addStream(d.localStream),g.call(void 0,d,i),b.videoResolution},function(a){h.call(void 0,d,a)})}e.getMediaServicesService().getUserMedia().updateStreamUsingApplyConstraints(j,f,d).always(function(){g.call(void 0,d,i)})},getVideoOptions:function(b,c){var d,e,f=!1;if(a.Base.Utils.isDefined(b))for(var g=0;g<b.length;g++)b[g].getRequestedDirection()!==a.Services.Call.MediaDirection.INACTIVE&&(f=!0,d=b[g].getChannelId(),c&&(e=c.getDeviceId()));return{enable:f,videoChannelId:d,videoDeviceId:e}},getBytesCount:function(a){for(var b,c=function(a,b){b=b||0;var c,d,e=a.charCodeAt(b);if(55296<=e&&e<=56319){if(c=e,d=a.charCodeAt(b+1),isNaN(d))throw"High surrogate not followed by low surrogate in fixedCharCodeAt()";return 1024*(c-55296)+(d-56320)+65536}return!(56320<=e&&e<=57343)&&e},d=0,e=0;e<a.length;e++){try{b=c(a,e)}catch(f){return 0}!1!==b&&(b<=127?d++:d+=b<=2047?2:b<=65535?3:b<=2097151?4:b<=67108863?5:6)}return d},isInteger:function(a){return(0^a)===a},generateUUID:void 0!==d&&void 0!==d.getRandomValues?function(){var a=new Uint16Array(8);d.getRandomValues(a);var b=function(a){for(var b=a.toString(16);b.length<4;)b="0"+b;return b};return b(a[0])+b(a[1])+"-"+b(a[2])+"-"+b(a[3])+"-"+b(a[4])+"-"+b(a[5])+b(a[6])+b(a[7])}:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"===a?b:3&b|8).toString(16)})},deepMerge:function(b,c){for(var d in c)try{c[d].constructor===Object?b[d]=a.Base.Utils.deepMerge(b[d],c[d]):b[d]=c[d]}catch(e){b[d]=c[d]}return b},rejectIfPromiseNotResolvedInTime:function(c,d,e,f){var g=b.Deferred(),h=setTimeout(function(){g.state()===a.Base.DeferredStates.PENDING&&(a.Base.Logger.warn(a.Base.LoggerTags.UTILS,"cancelIfPromiseNotResolvedInTime - Promise was not resolved in time"),g.reject(e),f&&f())},d);return c.then(function(b){g.state()===a.Base.DeferredStates.PENDING&&(g.resolve(b),clearInterval(h))},function(b){g.state()===a.Base.DeferredStates.PENDING&&(g.reject(b),clearInterval(h))},function(b){g.state()===a.Base.DeferredStates.PENDING&&g.notify(b)}),g.promise()},waitForAllPromisesCompletion:function(a){for(var c,d=b.Deferred(),e=0,f=function(){},g=function(a){return c||(c=a),b.Deferred().reject(a).promise()},h=function(a){d.notify(a)},i=function(){++e===a.length&&(c?d.reject(c):d.resolve())},j=0;j<a.length;j++)a[j].then(f,g,h).always(i);return d.promise()},isNotEmptyString:function(a){return!(!a||!a.trim())}},"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(a){var b=this;return function(){var c=Array.prototype.slice.call(arguments);return b.apply(a||null,c)}}),void 0===FileReader.prototype.readAsBinaryString&&(FileReader.prototype.readAsBinaryString=function(a){var c="",d=this,e=new FileReader;e.onload=function(a){for(var f=new Uint8Array(e.result),g=f.byteLength,h=0;h<g;h++)c+=String.fromCharCode(f[h]);d.content=c,b(d).trigger("onload")},e.readAsArrayBuffer(a)})}(AvayaClientServices,jQuery),function(a,b){"use strict";function c(c,d,e,f){a.Base.Observable.call(this),this._requestBuilder=c,this._restProvider=d,this._restProvider._onCredentialsRequired=this.onCredentialsRequired.bind(this),this._notificationProvider=e,this._notificationProvider._onCredentialsRequired=this.onCredentialsRequired.bind(this),this._started=!1,this._acsAvailable=!1,this._acsConfig={},this._acsResources={},this._acsNotificationResources={},this._maxConnectionErrorCount=5,this._notificationsConfiguration=void 0,this._notificationPromises={},this._notificationHandlers={},this._eTag=null,this._refreshRestSessionIntervalId=void 0,this._refreshNotificationSessionIntervalId=void 0,this._startPromise=b.Deferred(),this._stopPromise=b.Deferred(),this._subscriptions={},this._failoverPingData={wsKeepAliveEnabled:!0,wsPingInterval:3e4,wsGeneratePingMessage:function(){var b=a.Base.Utils.makeId(32,"0123456789abcdef");this._failoverPingData.wsPingMessageRequestId=b;var c={ping:{requestId:b,version:"1"}};return JSON.stringify(c)}.bind(this),wsIsPongMessage:function(b){var c=JSON.parse(b.data);return a.Base.Utils.isDefined(c.pong)&&this._failoverPingData.wsPingMessageRequestId===c.pong.requestId}.bind(this),wsPingMessageRequestId:"",keepAliveAnswerWaitingTime:5e3,ssePingInterval:65e3},this._blackList=[],this._discoveryBackoffDataObject=void 0,this._contactsAnalyticsService=f,this._invalidateBackoffDataObject=void 0}var d=.8,e=900,f=3e4;c.prototype=b.extend({},a.Base.Observable.prototype),c.prototype.start=function(c,d){if(!1===this._started){this._started=!0,this._startPromise=b.Deferred(),this._acsConfig=c,this._restProvider.onMessage=function(a,b){if(this._setAcsAvailable(!0),void 0!==b){var c=b.getResponseHeader("ETag");null!==c&&void 0!==c&&(this._eTag=c)}}.bind(this),this._restProvider.onError=function(){this._setAcsAvailable(!1),d._fireContactsUnavailableCallback(d)}.bind(this),this._restProvider.on(a.Base.NetworkProviderEvents.UNAUTHORIZED,function(){this.trigger(a.Base.NetworkProviderEvents.UNAUTHORIZED,[])}.bind(this)),this._notificationProvider.on(a.Base.NetworkProviderEvents.UNAUTHORIZED,function(){this.trigger(a.Base.NetworkProviderEvents.UNAUTHORIZED,[])}.bind(this)),this._restProvider.on(a.Base.NetworkProviderEvents.AUTHORIZED,function(){this.trigger(a.Base.NetworkProviderEvents.AUTHORIZED,[])}.bind(this)),this._notificationProvider.on(a.Base.NetworkProviderEvents.AUTHORIZED,function(){this.trigger(a.Base.NetworkProviderEvents.AUTHORIZED,[])}.bind(this)),this._restProvider.registerBlackList(this._blackList),this._notificationProvider.registerBlackList(this._blackList),this._restProvider.start(this._acsConfig.networkProviderConfiguration,this._acsConfig.credentialProvider);var e=function(){this.sendDiscoverResources().then(function(){this.createNotificationsConfig(),this.startNotificationProvider(d).then(function(){this._startRefreshingRestSession(),this._startRefreshingNotificationSession(),this._startPromise.resolve()}.bind(this),function(b){a.Base.Logger.error(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Failed to start notification provider",b),this._started=!1,this._startPromise.reject(b)}.bind(this))}.bind(this))}.bind(this);this.sendInvalidateSession().then(e,function(b){a.Base.Logger.error(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Invalidate session request failed",b),this._startPromise.reject(b)}.bind(this))}return this._startPromise.promise()},c.prototype.registerBlackList=function(a){this._blackList=a},c.prototype.stop=function(){if(!0===this._started){this._started=!1,this._stopPromise=b.Deferred(),a.Base.Utils.isDefined(this._discoveryBackoffDataObject)&&(this._discoveryBackoffDataObject.cancel(),this._discoveryBackoffDataObject=void 0),a.Base.Utils.isDefined(this._invalidateBackoffDataObject)&&(this._invalidateBackoffDataObject.cancel(),this._invalidateBackoffDataObject=void 0),this._restProvider.onClose=function(){this._setAcsAvailable(!1),this._stopRefreshingRestSession(),this._stopRefreshingNotificationSession(),this._acsResources={},this._eTag=null,this._stopPromise.resolve()}.bind(this),this._notificationProvider.onClose=function(){this._notificationPromises={},this._notificationHandlers={};try{this._restProvider.close()}catch(error){this._stopPromise.reject(error)}}.bind(this);try{this._notificationProvider.close()}catch(error){this._stopPromise.reject(error)}}return this._stopPromise.promise()},c.prototype.stopIfNoSubscriptions=function(){return Object.keys(this._subscriptions).length?b.Deferred().resolve().promise():this.stop()},c.prototype._startRefreshingRestSession=function(){if(void 0!==this._refreshRestSessionIntervalId)return void a.Base.Logger.warn(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Auth session refreshing is already active");this._refreshRestSessionIntervalId=setInterval(function(){this.sendRefreshRestSession().then(function(){a.Base.Logger.info(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Successfully refreshed auth session")},function(b){a.Base.Logger.warn(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Failed to refresh auth session",b)})}.bind(this),1e3*(this._acsResources.sessionManagement.timeout||e)*d)},c.prototype._stopRefreshingRestSession=function(){if(void 0===this._refreshRestSessionIntervalId)return void a.Base.Logger.warn(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Auth session refreshing is not active");clearInterval(this._refreshRestSessionIntervalId),this._refreshRestSessionIntervalId=void 0},c.prototype._startRefreshingNotificationSession=function(){if(void 0!==this._refreshNotificationSessionIntervalId)return void a.Base.Logger.warn(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Notification session refreshing is already active");this._refreshNotificationSessionIntervalId=setInterval(function(){this.sendRefreshNotificationSession().then(function(){a.Base.Logger.info(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Successfully refreshed notification session")},function(b){a.Base.Logger.warn(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Failed to refresh notification session",b)})}.bind(this),1e3*(this._notificationResources.sessionManagement.timeout||e)*d)},c.prototype._stopRefreshingNotificationSession=function(){if(void 0===this._refreshNotificationSessionIntervalId)return void a.Base.Logger.warn(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Notification session refreshing is not active");clearInterval(this._refreshNotificationSessionIntervalId),this._refreshNotificationSessionIntervalId=void 0},c.prototype.sendDiscoverResources=function(){var b="",c=function(){return this.send(null,this._requestBuilder.buildResourcesOptions()).then(function(a,c){return b=c.getResponseHeader("Content-Type"),a})}.bind(this);return this._discoveryBackoffDataObject=a.Base.Utils.connectionBackoffAlgorithm(c),this._discoveryBackoffDataObject.dfdPromise.then(function(a){this._restProvider.onError=function(){},this._discoveryBackoffDataObject=void 0,this._parseResources(a,b)}.bind(this))},c.prototype.sendInvalidateSession=function(){var b=function(){return this.send(null,this._requestBuilder.buildInvalidateSessionOptions())}.bind(this);return this._invalidateBackoffDataObject=a.Base.Utils.connectionBackoffAlgorithm(b),this._invalidateBackoffDataObject.dfdPromise.then(function(){this._invalidateBackoffDataObject=void 0}.bind(this))},c.prototype.sendRefreshRestSession=function(){return this.send(null,this._requestBuilder.buildRefreshRestSessionOptions())},c.prototype.sendRefreshNotificationSession=function(){return this.send(null,this._requestBuilder.buildRefreshNotificationSessionOptions())},c.prototype.send=function(a,b){return this._restProvider.send(a,b).catch(function(a){return this._handleError(a)}.bind(this))},c.prototype._handleError=function(c){c instanceof a.Base.NetworkError&&c.getData()instanceof a.Base.NetworkErrorEvent&&(c=c.getData());var d,e;if(c instanceof a.Base.NetworkErrorEvent){var f=c.getStatus();switch(this._setAcsAvailable(!0),f){case 400:d=a.Services.Contacts.ContactsErrorReason.INVALID_CONTACT,e="Contact is invalid";break;case 401:d=a.Services.Contacts.ContactsErrorReason.AUTHENTICATION_FAILED,e="Authentication failed";break;case 404:d=a.Services.Contacts.ContactsErrorReason.CONTACT_NOT_FOUND,e="Contact was not found";break;case 408:case 504:d=a.Services.Contacts.ContactsErrorReason.REQUEST_TIMEOUT,e="Request to server has timed out",this._contactsAnalyticsService.trackContactProvidersUnavailable(d);break;case 409:d=a.Services.Contacts.ContactsErrorReason.DUPLICATE_CONTACT,e="Contact already exists";break;case 503:d=a.Services.Contacts.ContactsErrorReason.RETRY,e="Server is busy",this._contactsAnalyticsService.trackContactProvidersUnavailable(d);break;default:f>=400&&f<500?e="Unknown Client Error":f>=500&&f<600&&(this._setAcsAvailable(!1),d=a.Services.Contacts.ContactsErrorReason.SERVER_UNAVAILABLE,e="Unknown ACS Server Error",this._contactsAnalyticsService.trackContactProvidersUnavailable(d))}}else c instanceof a.Base.NetworkError?(d=a.Services.Analytics.AnalyticsErrorCode.NETWORK_ERROR,e=d,this._contactsAnalyticsService.trackContactProvidersUnavailable(d)):(d=a.Services.Contacts.ContactsErrorReason.UNKNOWN_REASON,e=["Unknown error",c],this._contactsAnalyticsService.trackContactProvidersUnavailable(d));a.Base.Logger.warn(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Request failed",e);var g=new a.Services.Contacts.ContactsError(d);return b.Deferred().reject(g).promise()},c.prototype.onCredentialsRequired=function(b,c){var d;c&&c!==this._acsConfig.credentialProvider&&a.Base.Utils.deepMerge(this._acsConfig.credentialProvider,c),this._acsConfig.credentialProvider.onAuthenticationChallenge(d,function(a){this.onCredentialsRetrieved(a,b)}.bind(this))},c.prototype.onCredentialsRetrieved=function(b,c){var d=b.token||btoa(b.username+":"+b.password);a.Base.Utils.isDefined(c.options)&&(c.options.headers=c.options.headers||{},b.token?(c.options.wsSecureProtocolData=[a.Providers.ACS.ACSConstants.UPTOKEN,b.token],c.options.headers.Authorization=a.Providers.ACS.ACSConstants.BEARER_AUTHORIZATION_WITH_SPACE+d):c.options.headers.Authorization=a.Providers.ACS.ACSConstants.BASIC_AUTHORIZATION_WITH_SPACE+d)},c.prototype._parseResources=function(c,d){var e;switch(d){case this._requestBuilder._contentTypes.resourcesV2:e=new a.Providers.ACS.ResourcesV2;break;case this._requestBuilder._contentTypes.resourcesV1:e=new a.Providers.ACS.ResourcesV1;break;default:a.Base.Logger.error(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Unknown version of AADS was discovered. Returned Content-Type:",d),e=new a.Providers.ACS.ResourcesV2}this._acsResources=b.extend({},e,c),this._requestBuilder.setResources(this._acsResources)},c.prototype.createNotificationsConfig=function(){var b=a.Base.Utils.parseUrl(this._acsResources.resources.notification.websocket.href),c=new a.Config.ServerInfo(b.hostname,b.port,b.isSecure,b.path),d=a.Base.Utils.parseUrl(this._acsResources.resources.notification.sse.href),e=new a.Config.ServerInfo(d.hostname,d.port,d.isSecure,d.path),f=new a.Config.ServerInfo;this._notificationsConfiguration=new a.Config.NetworkProviderConfiguration(f,c,e,this._maxConnectionErrorCount)},c.prototype.getETag=function(){return this._eTag},c.prototype.getResources=function(){return this._acsResources},c.prototype.startNotificationProvider=function(c){var d=b.Deferred();if(this._notificationProvider.isOpened())return d.resolve().promise();if(!this._notificationsConfiguration)return a.Base.Logger.error(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Notifications provider configuration is absent"),this._contactsAnalyticsService.trackContactProvidersUnavailable(a.Services.Contacts.ContactsErrorReason.INTERNAL_ERROR),d.reject(new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.INTERNAL_ERROR)).promise();this._notificationProvider.onOpen=function(){a.Base.Logger.debug(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Notifications provider has been started"),this._notificationProvider.onMessage=function(b){var e;e=b.data&&b.type!==a.Base.ProvidersEventTypes.PING?JSON.parse(b.data):b,e.notification?this._onNotification(e.notification):e.discovery?(this._onNotificationDiscovery(e.discovery),d.resolve(),this._setAcsAvailable(!0),c._fireContactsAvailableCallback(c)):e.subscribed&&this._onSubscribed(e.subscribed)}.bind(this)}.bind(this),this._notificationProvider.onError=function(b){a.Base.Logger.error(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Notification provider connection failed",b),this._setAcsAvailable(!1),c._fireContactsUnavailableCallback(c)}.bind(this);var e=function(){var a=b.Deferred();return this._setAcsAvailable(!1),c._fireContactsUnavailableCallback(c),this._stopRefreshingRestSession(),this._stopRefreshingNotificationSession(),this.sendDiscoverResources().then(function(){this.createNotificationsConfig(),this.startNotificationProvider(c).then(function(){a.resolve(),this._startPromise.resolve(),this._startRefreshingRestSession(),this._startRefreshingNotificationSession(),this._resubscribeNotifications()}.bind(this),function(){a.reject()})}.bind(this),function(){a.reject()}.bind(this)),a.promise()}.bind(this);return this._notificationProvider.start(this._notificationsConfiguration,this._acsConfig.credentialProvider,void 0,void 0,e,this._failoverPingData).then(function(){return a.Base.Utils.rejectIfPromiseNotResolvedInTime(d.promise(),f,new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.REQUEST_TIMEOUT),function(){a.Base.Logger.error(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Notification discovery was not received in time"),c._fireContactsUnavailableCallback(c)})},function(){this._contactsAnalyticsService.trackContactProvidersUnavailable(a.Services.Contacts.ContactsErrorReason.CONTACTS_NOTIFICATIONS_CHANNEL_FAILED),a.Base.Logger.error(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Start notification channel failed.")}.bind(this))},c.prototype._onNotificationDiscovery=function(c){if(this._notificationResources=b.extend({},new a.Providers.ACS.NotificationResourcesV1,c),this._notificationResources.commandURL){var d=a.Base.Utils.parseUrl(this._notificationResources.commandURL);this._notificationsConfiguration.restConfig.hostName=d.hostname,this._notificationsConfiguration.restConfig.port=d.port,this._notificationsConfiguration.restConfig.isSecure=d.isSecure,this._notificationsConfiguration.restConfig.path=d.path}},c.prototype._resubscribeNotifications=function(){this._subscriptions[a.Providers.ACS.ACSConstants.SVC_GET_CONTACTS]&&this.sendNotification(JSON.stringify(this._subscriptions[a.Providers.ACS.ACSConstants.SVC_GET_CONTACTS]),this._requestBuilder.buildNotificationsOptions()),this._subscriptions[a.Providers.ACS.ACSConstants.SVC_SEARCH_CONTACTS]&&this.sendNotification(JSON.stringify(this._subscriptions[a.Providers.ACS.ACSConstants.SVC_SEARCH_CONTACTS]),this._requestBuilder.buildNotificationsOptions())},c.prototype._onSubscribed=function(b){if(b.requestId&&b.results){var c=this._notificationPromises[b.requestId];if(c)if("acs"===a.Base.Utils.queryJSONObject(b,"results.successful[0].application"))c.resolve(),a.Base.Logger.debug(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Subscribed to "+a.Base.Utils.queryJSONObject(b,"results.successful[0].resource"));else if("acs"===a.Base.Utils.queryJSONObject(b,"results.failed[0].application")){var d=a.Base.Utils.queryJSONObject(b,"results.failed[0].error.description");a.Base.Logger.error(a.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Failed to subscribe for notifications",d),this._contactsAnalyticsService.trackContactProvidersUnavailable(a.Services.Contacts.ContactsErrorReason.SERVER_UNAVAILABLE),c.reject(new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.SERVER_UNAVAILABLE))}}},c.prototype._onNotification=function(a){if("acs"===a.application&&a.resource){var b=this._notificationHandlers[a.resource];b&&b(a.contents)}},c.prototype.subscribeForNotifications=function(c,d){var e=b.Deferred(),g=e.promise();return g.then(function(){this._notificationHandlers[c.subscribe.resources[0].resource]=d,this._subscriptions[c.subscribe.resources[0].service]=c}.bind(this)),this._notificationPromises[c.subscribe.requestId]=e,this.sendNotification(JSON.stringify(c),this._requestBuilder.buildNotificationsOptions()),a.Base.Utils.rejectIfPromiseNotResolvedInTime(g,f,new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.REQUEST_TIMEOUT),function(){a.Base.Logger.error(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Subscription confirmation was not received in time",c.subscribe.resources[0].resource)})},c.prototype.unsubscribeFromNotifications=function(a){return this.sendNotification(JSON.stringify(a),this._requestBuilder.buildNotificationsOptions()).always(function(){delete this._notificationHandlers[a.unsubscribe.resources[0].resource],delete this._subscriptions[a.unsubscribe.resources[0].service]}.bind(this))},c.prototype.sendNotification=function(c,d){return this._notificationProvider.isOpened()?this._notificationProvider.send(c,d).then(function(a){return a},function(a){return this._handleError(a)}.bind(this)):b.Deferred().reject(new a.Services.Contacts.ContactsError(a.Services.Contacts.ContactsErrorReason.CONTACTS_NOTIFICATIONS_CHANNEL_FAILED)).promise()},c.prototype.isAcsAvailable=function(){return this._acsAvailable},c.prototype.isStarted=function(){return this._started},c.prototype._setAcsAvailable=function(a){this._acsAvailable!==a&&(this._acsAvailable=a,this.trigger("acs_availability_changed"))},a.Providers.ACS.ACSNetworkProvider=c}(AvayaClientServices,jQuery),function(a,b){"use strict";function c(b,c){a.Providers.Interfaces.MessagingProvider.call(this),this._eTag="",this._conversationsLastModified=void 0,this._isStarted=!1,this._networkProvider=b,this._resources={},this._credentials=void 0,this._config={},this._ammMessagesParser=c,this._resourcesTypes={conversations:"application/vnd.avaya.aem.conversations.v1+json",error:"application/vnd.avaya.aem.error.v1+json",resources:"application/vnd.avaya.aem.resources.v1+json",validatedAddresses:"application/vnd.avaya.aem.validatedAddresses.v2+json",participants:"application/vnd.avaya.aem.participants.v1+json",message:"application/vnd.avaya.aem.message.v1+json",messageFlags:"application/vnd.avaya.aem.message.v1+json",messageIds:"application/vnd.avaya.aem.messageIds.v1+json",event:"application/vnd.avaya.aem.event.v1+json",conversation:"application/vnd.avaya.aem.conversation.v1+json",conversationIds:"application/vnd.avaya.aem.conversations.ids.v1+json",conversationAccessTime:"application/vnd.avaya.aem.conversation.access.time.v1+json",conversationFlags:"application/vnd.avaya.aem.conversation.flags.v1+json"},this._endpoints={conversations:"",validateAddresses:"",messages:"",outbox:"",markAsReadIf:"",markAsReadBatch:"",addresses:""}}c.prototype=Object.create(a.Providers.Interfaces.MessagingProvider.prototype),c.prototype.onCredentialsRequired=function(b,c){var d;c&&c!==this._config.credentialProvider&&a.Base.Utils.deepMerge(this._config.credentialProvider,c),this._config.credentialProvider.onAuthenticationChallenge(d,function(a){this.onCredentialsRetrieved(a,b)}.bind(this))},c.prototype.onCredentialsRetrieved=function(a,b){this._credentials=a;var c=btoa(a.username+":"+a.password);b.options.headers=b.options.headers||{},b.options.headers.Authorization="Basic "+c},c.prototype.start=function(a){this._config=a,this._isStarted=!0},c.prototype.getConversations=function(c){var d=b.extend(c,{headers:{}});return d.url=this._endpoints.conversations,d.sendType="GET",d.dataType="JSON",d.headers.Accept=[this._resourcesTypes.conversations,this._resourcesTypes.error].join(", "),this._networkProvider.send(null,d).then(function(b){return this._ammMessagesParser.parse(a.Providers.AMM.AMMResponsesTypes.GET_CONVERSATIONS,b)}.bind(this),this._handleError.bind(this))},c.prototype.getConversationIds=function(){var c=b.Deferred();return c.reject(new a.Services.Messaging.MessagingError(a.Services.Messaging.MessagingErrorReason.MESSAGING_FEATURE_NOT_AVAILABLE)),c.promise()},c.prototype.getConversationsByQuery=function(a,c,d){var e=b.extend(d,{headers:{}});return e.url=this._endpoints.conversations,e.sendType="GET",e.dataType="JSON",e.headers={Accept:[this._resourcesTypes.conversations,this._resourcesTypes.error].join(", ")},c?this._getConversationsByIds(c,e):this._getConversationsByQuery(a,e)},c.prototype._getConversationsByIds=function(b,c){var d=b.map(function(a){return"id="+a}).join("&");return c.url+="?"+d,this._networkProvider.send(null,c).then(function(b){return this._ammMessagesParser.parse(a.Providers.AMM.AMMResponsesTypes.GET_CONVERSATIONS,b)}.bind(this),this._handleError.bind(this))},c.prototype._getConversationsByQuery=function(b,c){return this._networkProvider.send(b,c).then(function(b){return this._ammMessagesParser.parse(a.Providers.AMM.AMMResponsesTypes.GET_CONVERSATIONS,b)}.bind(this),this._handleError.bind(this))},c.prototype.parseResources=function(a){this._resources=a,this._config.endpoints={}},c.prototype.discoverResources=function(b){var c={};return c.urlSuffix="/aem/resources",c.sendType="GET",c.dataType="JSON",c.headers={Accept:[this._resourcesTypes.resources,this._resourcesTypes.error].join(", ")},this._networkProvider.send(null,c).then(function(b){var c=this._ammMessagesParser.parse(a.Providers.AMM.AMMResponsesTypes.DISCOVERY,b);return this.parseResources(c),this._resources}.bind(this),this._handleError.bind(this))},c.prototype.getResources=function(){return this._resources},c.prototype.validateUsers=function(b){var c={},d=b.map(function(a){return"address="+a}).join("&");return c.sendType="GET",c.dataType="JSON",c.headers={Accept:[this._resourcesTypes.validatedAddresses,this._resourcesTypes.error].join(", ")},c.url=this._endpoints.validateAddresses,c.url+="?"+d,this._networkProvider.send(null,c).then(function(b){return this._ammMessagesParser.parse(a.Providers.AMM.AMMResponsesTypes.VALIDATE_USERS,b)}.bind(this),this._handleError.bind(this))},c.prototype.getRoutableDomains=function(){return this._resources.domains},c.prototype.getSelfAddress=function(){return this._resources.self},c.prototype.getParticipants=function(a,b){var c=b||{};return c.url=this._endpoints.conversations+"/"+a+"/participants",c.sendType="GET",c.dataType="JSON",c.headers={Accept:[this._resourcesTypes.participants,this._resourcesTypes.error].join(", ")},this._networkProvider.send(null,c).catch(this._handleError.bind(this))},c.prototype.setLastAccessTime=function(a,b){var c=b||{};return c.url=this._endpoints.conversations+"/"+a,c.sendType="POST",c.headers={"Content-Type":[this._resourcesTypes.conversationAccessTime].join(", "),Accept:[this._resourcesTypes.conversationAccessTime,this._resourcesTypes.error].join(", ")},this._networkProvider.send(null,c).catch(this._handleError.bind(this))},c.prototype.sendMessage=function(b,c){var d=c||{};return d.url=this._endpoints.outbox,d.dataType=null,d.headers={Accept:[this._resourcesTypes.message,this._resourcesTypes.error].join(", "),"Content-Type":this._resourcesTypes.message},this._networkProvider.send(JSON.stringify(b),d).then(function(b){return this._ammMessagesParser.parse(a.Providers.AMM.AMMResponsesTypes.SEND,b)}.bind(this),this._handleError.bind(this))},c.prototype._handleError=function(c){var d=new a.Services.Messaging.MessagingError(a.Services.Messaging.MessagingErrorReason.MESSAGING_SERVER_ERROR,c);return b.Deferred().reject(d).promise()},c.prototype.sendMessageWithAttachments=function(c,d,e){var f=e||{},g="boundary";f.url=this._endpoints.outbox,f.dataType=null,f.headers={Accept:[this._resourcesTypes.message,this._resourcesTypes.error].join(", "),"Content-Type":'multipart/related;boundary="'+g+'"'},f.processData=!1;var h=b.Deferred();return this._createThumbnailsPromises(d).then(function(){return this._createAttachmentsPromises(d)}.bind(this),function(a){return b.Deferred().reject(a).promise()}).then(function(){var b=this._prepareRawBody(g,c,arguments[0]);this._networkProvider.send(b,f).then(function(b){var c=this._ammMessagesParser.parse(a.Providers.AMM.AMMResponsesTypes.SEND,b);h.resolve(c)}.bind(this),function(a){this._handleError(a).fail(function(a){h.reject(a)})}.bind(this))}.bind(this),function(b){var c=new a.Services.Messaging.MessagingError(a.Services.Messaging.MessagingErrorReason.MESSAGING_CREATE_ATTACHMENT_FAILED,b);h.reject(c)}),h.promise()},c.prototype._createThumbnailsPromises=function(a){var c=b.Deferred(),d=[];return a.forEach(function(a){d.push(a.createThumbnail())}),b.when.apply(this,d).then(function(){c.resolve(a)}),c.promise()},c.prototype._createAttachmentsPromises=function(a){var c=b.Deferred(),d=[];return a.forEach(function(a){d.push(this._readAttachment(a)),a.getCreateThumbnailCapability().isAllowed&&d.push(this._readAttachment(a.getThumbnail()))}.bind(this)),b.when.apply(this,d).then(function(){c.resolve(arguments)},c.reject),c.promise()},c.prototype._readAttachment=function(c){var d=b.Deferred(),e=new FileReader;return e.onload=function(b){var f;c.disposition&&(f=-1!==c.disposition.indexOf("inline")?a.Services.Messaging.AttachmentType.THUMBNAIL:a.Services.Messaging.AttachmentType.MAIN);var g={name:c.getName(),mime:c.getMimeType(),type:f,data:""},h="base64,"
;b&&b.target?f===a.Services.Messaging.AttachmentType.THUMBNAIL&&-1!==b.target.result.indexOf(h)?g.data=atob(b.target.result.slice(b.target.result.indexOf(h)+h.length)):g.data=b.target.result:f===a.Services.Messaging.AttachmentType.THUMBNAIL&&-1!==e.content.indexOf(h)?g.data=atob(e.content.slice(e.content.indexOf(h)+h.length)):g.data=e.content,d.resolve(g)},e.onerror=function(a){d.reject(a)},e.readAsBinaryString(c.file),d.promise()},c.prototype._prepareRawBody=function(b,c,d){for(var e=JSON.stringify(c),f=["--boundary\n","Content-Type:application/vnd.avaya.aem.message.v1+json;\n\n",e,"\n"],g=0;g<d.length;g++){var h=d[g].type===a.Services.Messaging.AttachmentType.THUMBNAIL?"inline":"attachment";f.push("--"+b+"\n"),f.push("Content-Type:"+d[g].mime+"\n"),f.push("Content-Transfer-Encoding:binary\n"),f.push("Content-Disposition:"+h+'; filename="'+d[g].name+'"\n\n'),f.push(d[g].data+"\n")}f.push("--"+b+"--\n"),f=f.join("");for(var i=new Uint8Array(f.length),j=0;j<f.length;j++)i[j]=255&f.charCodeAt(j);return i},c.prototype.leaveConversation=function(a){var b={};return b.url=this._endpoints.conversations+"/"+a,b.sendType="DELETE",b.headers={Accept:[this._resourcesTypes.error].join(", ")},this._networkProvider.send(null,b).catch(this._handleError.bind(this))},c.prototype.markAllAsRead=function(a,b,c){var d={};return d.url=this._endpoints.markAsReadIf,d.url+="?conversationId="+a,void 0!==b&&(d.url+="&hasAttachment="+!!b),c&&(d.url+="&upTo="+c),d.sendType="POST",d.headers={Accept:[this._resourcesTypes.error].join(", ")},this._networkProvider.send(null,d).catch(this._handleError.bind(this))},c.prototype.changeSubject=function(a){var b={};return b.url=this._endpoints.outbox,b.dataType="JSON",b.headers={"Content-Type":this._resourcesTypes.message},this._networkProvider.send(JSON.stringify(a),b).catch(this._handleError.bind(this))},c.prototype.markAsReadBatch=function(b){var c={};if(c.url=this._endpoints.markAsReadBatch,""===c.url)throw new a.Services.Messaging.MessagingError(a.Services.Messaging.MessagingErrorReason.MESSAGING_FEATURE_NOT_AVAILABLE);c.sendType="POST",c.headers={Accept:[this._resourcesTypes.error].join(", "),"Content-Type":this._resourcesTypes.messageIds};var d=JSON.stringify({messageIds:b});return this._networkProvider.send(d,c).catch(this._handleError.bind(this))},c.prototype.getMessages=function(c,d,e,f,g){var h=b.extend(c,{headers:{}});h.url=this._endpoints.conversations+"/"+d;var i="?";return f&&(h.url+=i+"beforeId="+f.id,i="&"),g&&(h.url+=i+"afterId="+g.id,i="&"),a.Base.Utils.isDefined(e)&&(h.url+=i+"messageCount="+e),h.sendType="GET",h.dataType="JSON",h.headers={Accept:[this._resourcesTypes.conversation,this._resourcesTypes.error].join(", ")},this._networkProvider.send(null,h).then(function(b){return this._ammMessagesParser.parse(a.Providers.AMM.AMMResponsesTypes.GET_MESSAGES,b)}.bind(this),this._handleError.bind(this))},c.prototype.reportTyping=function(){},c.prototype.reportCustomChatNotification=function(){var c=b.Deferred();return c.reject(new a.Services.Messaging.MessagingError(a.Services.Messaging.MessagingErrorReason.MESSAGING_FEATURE_NOT_AVAILABLE)),c.promise()},c.prototype.observeConversations=function(){var c=b.Deferred();return c.reject(new a.Services.Messaging.MessagingError(a.Services.Messaging.MessagingErrorReason.MESSAGING_FEATURE_NOT_AVAILABLE)),c.promise()},c.prototype.startNotificationProvider=function(){var c=b.Deferred();return c.reject(new a.Services.Messaging.MessagingError(a.Services.Messaging.MessagingErrorReason.MESSAGING_FEATURE_NOT_AVAILABLE)),c.promise()},c.prototype.subscribeForTypingEventsInConversation=function(){var c=b.Deferred();return c.reject(new a.Services.Messaging.MessagingError(a.Services.Messaging.MessagingErrorReason.MESSAGING_FEATURE_NOT_AVAILABLE)),c.promise()},c.prototype.unsubscribeForTypingEventsInConversation=function(){var c=b.Deferred();return c.reject(new a.Services.Messaging.MessagingError(a.Services.Messaging.MessagingErrorReason.MESSAGING_FEATURE_NOT_AVAILABLE)),c.promise()},c.prototype.callEscalationEvent=function(a,b){var c={};return c.url=this._endpoints.conversations+"/"+b+"/events",c.sendType="POST",c.headers={"Content-Type":this._resourcesTypes.event},this._networkProvider.send(JSON.stringify(a),c).catch(this._handleError.bind(this))},c.prototype.addParticipantsToConversation=function(c,d,e){var f=b.extend(e,{headers:{}});return f.url=this._endpoints.conversations+"/"+c+"/participants",f.sendType="POST",f.dataType="JSON",f.headers={"Content-Type":this._resourcesTypes.participants},this._networkProvider.send(JSON.stringify(d),f).then(function(b){return this._ammMessagesParser.parse(a.Providers.AMM.AMMResponsesTypes.ADD_PARTICIPANTS,b)}.bind(this),this._handleError.bind(this))},c.prototype.close=function(b){var c={};return c.url=this._endpoints.conversations+"/"+b+"/flags",c.sendType="POST",c.dataType="JSON",c.headers={"Content-Type":this._resourcesTypes.conversationFlags},this._networkProvider.send(JSON.stringify({closed:!0}),c).then(function(b){return this._ammMessagesParser.parse(a.Providers.AMM.AMMResponsesTypes.CLOSE,b)}.bind(this),this._handleError.bind(this))},c.prototype.stop=function(){this._isStarted=!1,this._eTag="";var c=b.Deferred();return this._networkProvider.onClose=function(){this._resources={},c.resolve()}.bind(this),this._networkProvider.onError=function(b){if("abort"===b.statusText)c.resolve();else{var d=new a.Services.Messaging.MessagingError(a.Services.Messaging.MessagingErrorReason.MESSAGING_CLOSE_FAILED);c.reject(d)}}.bind(this),this._networkProvider.close(),c.promise()},c.prototype.logout=function(){var c=b.Deferred();return c.reject(new a.Services.Messaging.MessagingError(a.Services.Messaging.MessagingErrorReason.MESSAGING_FEATURE_NOT_AVAILABLE)),c.promise()},c.prototype.isUpdateSubjectSupported=function(){return!1},c.prototype.isMarkAllContentAsReadSupported=function(){return!1},c.prototype.getMaxImageSize=function(){return 0},c.prototype.getMaxVideoSize=function(){return 0},c.prototype.getMaxAudioSize=function(){return 0},c.prototype.getMaxTextLength=function(){return 0},c.prototype.getMaxGenericAttachmentSize=function(){return 0},c.prototype.getConversationResource=function(){return this._resources.conversationsResource.href},c.prototype.getValidateAddressResource=function(){return this._resources.services.validateAddresses},c.prototype.getMarkAsReadResource=function(){return this._resources.services.markAsReadIf},c.prototype.isOpened=function(){return!1},c.prototype.getMaxMessageCount=function(){return 15},c.prototype.isStarted=function(){return this._isStarted},a.Providers.AMM.AbstractAMMProvider=c}(AvayaClientServices,jQuery);!function(a,b){"use strict";function c(b,c){a.Providers.AMM.AbstractAMMProvider.call(this,b,c),this._networkProvider._onCredentialsRequired=this.onCredentialsRequired.bind(this),this._resources={},this._resourcesTypes.resources="application/vnd.avaya.aem.resources.v2+json",this._blackListedWords=["subject","message","body","mimeType","size","disposition","mediaUrl","media","givenName","href","nativeGivenName","nativeSurname","surname","address","duration"]}c.prototype=Object.create(a.Providers.AMM.AbstractAMMProvider.prototype),c.prototype.start=function(b,c){return this._config=b,this._isStarted=!0,this._networkProvider.onMessage=function(a,b){if(void 0!==b){var c=b.getResponseHeader("ETag");a&&a.conversations&&(a.lastUpdated?this._conversationsLastModified=new Date(new Date(a.lastUpdated).getTime()+1):this._conversationsLastModified=new Date(new Date(b.getResponseHeader("Last-Modified")).getTime()+1)),null!==c&&void 0!==c&&(this._eTag=c)}}.bind(this),this._networkProvider.onError=function(b){return c._fireMessagingUnavailableCallback(a.Services.Analytics.AnalyticsErrorCode.NOTIFICATION_ERROR),this._handleError(b)}.bind(this),this._networkProvider.on(a.Base.NetworkProviderEvents.UNAUTHORIZED,function(){this.trigger(a.Base.NetworkProviderEvents.UNAUTHORIZED,[])}.bind(this)),this._networkProvider.on(a.Base.NetworkProviderEvents.AUTHORIZED,function(){this.trigger(a.Base.NetworkProviderEvents.AUTHORIZED,[])}.bind(this)),this._networkProvider.registerBlackList(this._blackListedWords),this._networkProvider.start(this._config.networkProviderConfiguration,this._config.credentialProvider)},c.prototype._longPollConversations=function(){if(!b.isEmptyObject(this._resources)){var a=30;this._resources.avayaRequestTimeout&&this._resources.avayaRequestTimeout.recommended&&(a=this._resources.avayaRequestTimeout.recommended);var c={headers:{"If-None-Match":this._eTag,"Avaya-Request-Timeout":a}};return this.getConversations(c)}},c.prototype.observeConversations=function(){return this._longPollConversations().then(function(a){if(this._isStarted)return a&&a.conversations&&a.conversations.length>0&&this.trigger("conversations.update",[a]),this.observeConversations()}.bind(this))},c.prototype.isUpdateSubjectSupported=function(){return!0},c.prototype.isMarkAllContentAsReadSupported=function(){return!!this._resources&&!!this._resources.services&&!!this._resources.services.markAsReadIf},c.prototype.parseResources=function(c){this._resources=b.extend(new a.Providers.AMM.ResourcesV2,c),this._endpoints.conversations=this._resources.conversationsResource.href,this._endpoints.validateAddresses=this._resources.services.validateAddresses,this._endpoints.messages=this._resources.messages,this._endpoints.outbox=this._resources.outbox,this._endpoints.markAsReadIf=this._resources.services.markAsReadIf,this._endpoints.addresses=this._resources.addresses},c.prototype.getMaxImageSize=function(){return a.Base.Utils.queryJSONObject(this,"_resources.limits.maxImageSize")},c.prototype.getMaxVideoSize=function(){return a.Base.Utils.queryJSONObject(this,"_resources.limits.maxVideoSize")},c.prototype.getMaxAudioSize=function(){return a.Base.Utils.queryJSONObject(this,"_resources.limits.maxAudioSize")},c.prototype.getMaxTextLength=function(){return a.Base.Utils.queryJSONObject(this,"_resources.limits.maxTextLength")},c.prototype.getMaxGenericAttachmentSize=function(){return a.Base.Utils.queryJSONObject(this,"_resources.limits.maxGenericAttachmentSize")},a.Providers.AMM.AMM2Provider=c}(AvayaClientServices,jQuery),function(a,b){"use strict";function c(b,c,d,e){a.Providers.AMM.AMM2Provider.call(this,b,e),this._networkProvider._onCredentialsRequired=this.onCredentialsRequired.bind(this),this._resources={},this._notificationResources={},this._maxConnectionErrorCount=5,this._notificationsConfiguration={},this._notificationProvider=c,this._notificationProvider._onCredentialsRequired=this.onCredentialsRequired.bind(this),this._resourcesTypes.resources="application/vnd.avaya.aem.resources.v4+json",this._resourcesTypes.conversations="application/vnd.avaya.aem.conversations.v2+json",this._resourcesTypes.subject="application/vnd.avaya.aem.subject.v1+json",this._previousETag=void 0,this._isListening=!1,this._requests={},this._callbacksForTypingEvents={},this._identity={},this._onCredentialsRequired=this.onCredentialsRequired.bind(this),this._dfdSubscribed={},this._dfdUnsubscribed={},this._dfdConversationsSubscribed={},this._chatStateNotifications=d,this._conversationsSubscribed=!1,this._failoverPingData={wsKeepAliveEnabled:!0,wsPingInterval:3e4,wsGeneratePingMessage:function(){var b=a.Base.Utils.makeId(32,"0123456789abcdef");this._failoverPingData.wsPingMessageRequestId=b;var c={ping:{requestId:b,version:"1"}};return JSON.stringify(c)}.bind(this),wsIsPongMessage:function(b){var c=JSON.parse(b.data);return a.Base.Utils.isDefined(c.pong)&&this._failoverPingData.wsPingMessageRequestId===c.pong.requestId}.bind(this),wsPingMessageRequestId:"",keepAliveAnswerWaitingTime:5e3,ssePingInterval:65e3},this._discoveryBackoffDataObject=void 0}c.prototype=Object.create(a.Providers.AMM.AMM2Provider.prototype),c.prototype.start=function(b,c){return this._notificationProvider.registerBlackList(this._blackListedWords),a.Providers.AMM.AMM2Provider.prototype.start.call(this,b,c)},c.prototype.startNotificationProvider=function(c){var d=b.Deferred();if(!this.getResources().notificationService||!this.getResources().notificationService.websocket.href&&!this.getResources().notificationService.sse.href||this._notificationProvider.isOpened())d.reject(new a.Services.Messaging.MessagingError(a.Services.Messaging.MessagingErrorReason.MESSAGING_NOTIFICATIONS_CHANNEL_FAILED));else{this._notificationProvider.onOpen=function(){this._notificationProvider.onMessage=function(e){var f;f=e.data&&e.type!==a.Base.ProvidersEventTypes.PING?JSON.parse(e.data):e;var g,h;if(f.notification){var i=this._ammMessagesParser.parse(a.Providers.AMM.AMMResponsesTypes.NOTIFICATION,f.notification);switch(i.service){case a.Providers.AMM.MessagesService.CONVERSATION:this._previousETag=this._eTag,this._eTag=a.Base.Utils.queryJSONObject(i,"contents.entityTag"),this.getConversationsByQuery({after:this._conversationsLastModified.toISOString()}).then(function(b){b&&b.conversations&&b.conversations.length>0&&this.trigger(a.Providers.Interfaces.MessagingProviderHandlers.CONVERSATIONS_UPDATE,[b])}.bind(this));break;case a.Providers.AMM.MessagesService.CHAT_STATE:var j=b.extend(new a.Providers.AMM.NotificationContentsV1,i.contents),k=j.address===this._resources.self;this._chatStateNotifications.setChatStateNotification(j,k,this._callbacksForTypingEvents[i.resource]),this._callbacksForTypingEvents[i.resource].fire(j);break;default:a.Base.Logger.warn(a.Base.LoggerTags.AMM_MESSAGING_PROVIDER,"Unknown notification service value received: {0}",i.service)}}else if(f.notified){var l=this._ammMessagesParser.parse(a.Providers.AMM.AMMResponsesTypes.NOTIFIED,f.notified);this._handleNotificationResponse(l)}else if(f.discovery){var m=this._ammMessagesParser.parse(a.Providers.AMM.AMMResponsesTypes.DISCOVERY_NOTIFICATION,f.discovery);if(this._notificationResources=b.extend(new a.Providers.AMM.NotificationResourcesV1,m),this._notificationResources.commandURL){var n=a.Base.Utils.parseUrl(this._notificationResources.commandURL);this._notificationsConfiguration.restConfig.hostName=n.hostname,this._notificationsConfiguration.restConfig.port=n.port,this._notificationsConfiguration.restConfig.isSecure=n.isSecure,this._notificationsConfiguration.restConfig.path=n.path}d.resolve(),this.trigger(a.Providers.AMM.ProviderStates.AVAILABLE,[]),c._fireMessagingAvailableCallback()}else if(f.subscribed){var o=this._ammMessagesParser.parse(a.Providers.AMM.AMMResponsesTypes.SUBSCRIBED,f.subscribed);g=a.Base.Utils.queryJSONObject(o,"results.successful[0].service"),h=a.Base.Utils.queryJSONObject(o,"results.successful[0].resource"),g===a.Providers.AMM.MessagesService.CHAT_STATE&&void 0!==this._dfdSubscribed[h]&&this._dfdSubscribed[h].state()===a.Base.DeferredStates.PENDING?this._dfdSubscribed[h].resolve(o):g===a.Providers.AMM.MessagesService.CONVERSATION&&void 0!==this._dfdConversationsSubscribed&&this._dfdConversationsSubscribed.state()===a.Base.DeferredStates.PENDING&&(this._dfdConversationsSubscribed.resolve(o),this._conversationsSubscribed=!0)}else if(f.unsubscribed){var p=this._ammMessagesParser.parse(a.Providers.AMM.AMMResponsesTypes.UNSUBSCRIBED,f.unsubscribed);g=a.Base.Utils.queryJSONObject(p,"results.successful[0].service"),h=a.Base.Utils.queryJSONObject(p,"results.successful[0].resource"),g===a.Providers.AMM.MessagesService.CHAT_STATE&&void 0!==this._dfdUnsubscribed[h]&&this._dfdUnsubscribed[h].state()===a.Base.DeferredStates.PENDING&&(this._dfdUnsubscribed[h].resolve(p),this._chatStateNotifications.clearChatStateNotifications())}}.bind(this)}.bind(this),this._chatStateNotifications.onPauseChatState=function(a,b){return this._reportChatState(a,b,!1)}.bind(this),this._notificationProvider.on(a.Base.NetworkProviderEvents.UNAUTHORIZED,function(){this.trigger(a.Base.NetworkProviderEvents.UNAUTHORIZED,[])}.bind(this)),this._notificationProvider.on(a.Base.NetworkProviderEvents.AUTHORIZED,function(){this.trigger(a.Base.NetworkProviderEvents.AUTHORIZED,[])}.bind(this));var e=function(){var d=b.Deferred();return this.trigger(a.Providers.AMM.ProviderStates.UNAVAILABLE,[]),c._fireMessagingUnavailableCallback(a.Services.Analytics.AnalyticsErrorCode.NOTIFICATION_ERROR),this._discoverResources(c).then(function(){return this.startNotificationProvider(c).then(function(){if(this._conversationsSubscribed)return this.observeConversations().then(function(){d.resolve(),this._resubscribeForTypingEvents()}.bind(this));d.resolve()}.bind(this),function(){d.reject()}.bind(this))}.bind(this)),d.promise()}.bind(this);this._notificationProvider.start(this._notificationsConfiguration,this._config.credentialProvider,void 0,void 0,e,this._failoverPingData).fail(function(){a.Base.Logger.error(a.Base.LoggerTags.AMM_MESSAGING_PROVIDER,"Start notification channel failed."),d.reject(new a.Services.Messaging.MessagingError(a.Services.Messaging.MessagingErrorReason.MESSAGING_NOTIFICATION_FAILED))})}return a.Base.Utils.rejectIfPromiseNotResolvedInTime(d.promise(),3e4,new a.Services.Messaging.MessagingError(a.Services.Messaging.MessagingErrorReason.MESSAGING_TIMEOUT),function(){a.Base.Logger.error(a.Base.LoggerTags.AMM_MESSAGING_PROVIDER,"Notification discovery was not received in time"),c._fireMessagingUnavailableCallback(a.Services.Analytics.AnalyticsErrorCode.NOTIFICATION_ERROR)})},c.prototype.stop=function(){var c=b.Deferred();return a.Base.Utils.isDefined(this._discoveryBackoffDataObject)&&(this._discoveryBackoffDataObject.cancel(),this._discoveryBackoffDataObject=void 0),a.Providers.AMM.AMM2Provider.prototype.stop.call(this).then(function(){this._notificationProvider.onClose=function(){this._previousETag=void 0,this._conversationsLastModified=void 0,this._isListening=!1,c.resolve()}.bind(this);try{this._notificationProvider.close()}catch(b){c.reject(new a.Services.Messaging.MessagingError(a.Services.Messaging.MessagingErrorReason.MESSAGING_CLOSE_FAILED))}}.bind(this),c.reject),c.promise()},c.prototype.logout=function(){var a={};return a.url=this._resources.sessionManagement.href,a.sendType="DELETE",a.headers={Accept:this._resourcesTypes.error},this._networkProvider.send(null,a)},c.prototype.discoverResources=function(b){return this._discoverResources(b).then(function(c){var d=c.sessionManagement.username;return this._credentials.username!==d?(a.Base.Logger.warn(a.Base.LoggerTags.AMM_MESSAGING_PROVIDER,"Deleting session due to mismatch username"),this.logout().then(function(){return this.discoverResources(b)}.bind(this))):c}.bind(this))},c.prototype._discoverResources=function(b){var c=function(){var a={};return a.urlSuffix="/aem/resources",a.sendType="GET",a.dataType="JSON",a.crossDomain=!0,a.headers={Accept:[this._resourcesTypes.resources,this._resourcesTypes.error].join(", ")},this._networkProvider.send(null,a)}.bind(this);return this._discoveryBackoffDataObject=a.Base.Utils.connectionBackoffAlgorithm(c),this._discoveryBackoffDataObject.dfdPromise.then(function(b){var c=this._ammMessagesParser.parse(a.Providers.AMM.AMMResponsesTypes.DISCOVERY,b);return this._discoveryBackoffDataObject=void 0,this.parseResources(c)}.bind(this),function(c){return this.trigger(a.Providers.AMM.ProviderStates.UNAVAILABLE,[]),b._fireMessagingUnavailableCallback(a.Services.Analytics.AnalyticsErrorCode.CONNECTION_BACKOFF_ALGORITHM_ERROR),this._handleError(c)}.bind(this))},c.prototype.parseResources=function(c){this._resources=b.extend(new a.Providers.AMM.ResourcesV4,c),this._endpoints.conversations=this._resources.conversationsResource.href,this._endpoints.validateAddresses=this._resources.services.validateAddresses.href,this._endpoints.messages=this._resources.messages.href,this._endpoints.outbox=this._resources.outbox.href,this._endpoints.markAsReadIf=this._resources.services.markAsReadIf.href,this._endpoints.markAsReadBatch=this._resources.services.markAsReadBatch.href;var d=a.Base.Utils.parseUrl(this._resources.notificationService.websocket.href),e=new a.Config.ServerInfo(d.hostname,d.port,d.isSecure,d.path),f=a.Base.Utils.parseUrl(this._resources.notificationService.sse.href),g=new a.Config.ServerInfo(f.hostname,f.port,f.isSecure,f.path),h=new a.Config.ServerInfo;return this._notificationsConfiguration=new a.Config.NetworkProviderConfiguration(h,e,g,this._maxConnectionErrorCount),this._resources},c.prototype.getConversations=function(b){return this._previousETag&&(b=b||{},b.headers=b.headers||{},b.headers["If-None-Match"]=this._previousETag),a.Providers.AMM.AMM2Provider.prototype.getConversations.call(this,b)},c.prototype.getConversationIds=function(a){var b=a||{headers:{}};return b.url=this._endpoints.conversations,b.sendType="GET",b.dataType="JSON",b.headers["If-None-Match"]=this._previousETag,b.headers.Accept=[this._resourcesTypes.conversationIds,this._resourcesTypes.error].join(", "),this._networkProvider.send(null,b).then(function(a){return a},this._handleError.bind(this))},c.prototype.observeConversations=function(){this._dfdConversationsSubscribed=b.Deferred();var a={subscribe:{resources:[{application:"AMM",service:"conversation",resource:this._resources.conversationsResource.href}],version:"1"}},c={dataType:"JSON",headers:{"Content-Type":"application/json"}};return this._notificationProvider.send(JSON.stringify(a),c),this._dfdConversationsSubscribed.promise()},c.prototype.reportTyping=function(c,d){var e,f=this._chatStateNotifications.getChatNotification(this._resources.self);if(f&&f.action!==a.Providers.AMM.ChatStateActions.TYPING&&(this._reportChatState(f.action,c,!1),this._chatStateNotifications.clearChatStateRefreshTimeout()),this._chatStateNotifications.isChatStateAdded()){var g=b.Deferred();g.resolve(),e=g.promise()}else this._chatStateNotifications.setChatStateRefreshTimeout(),e=this._reportChatState(a.Providers.AMM.ChatStateActions.TYPING,c,d);return e},c.prototype.reportCustomChatNotification=function(c,d,e){var f,g=this._chatStateNotifications.getChatNotification(this._resources.self);if(g&&g.action===a.Providers.AMM.ChatStateActions.TYPING&&(this._reportChatState(a.Providers.AMM.ChatStateActions.TYPING,c,!1),this._chatStateNotifications.clearChatStateRefreshTimeout()),this._chatStateNotifications.isChatStateAdded()){var h=b.Deferred();h.resolve(),f=h.promise()}else this._chatStateNotifications.setChatStateRefreshTimeout(),f=this._reportChatState(d,c,e);return f},c.prototype.subscribeForTypingEventsInConversation=function(a,c){var d=this._resources.conversationsResource.href+"/"+a;this._chatStateNotifications.setConversationId(a),this._dfdSubscribed[d]=b.Deferred();var e={subscribe:{resources:[{application:"AMM",service:"chatState",resource:d}]}},f={dataType:"JSON",headers:{"Content-Type":"application/json"}},g=!1;return this._callbacksForTypingEvents[d]||(this._callbacksForTypingEvents[d]=b.Callbacks()),this._callbacksForTypingEvents[d].has()||(g=!0),this._callbacksForTypingEvents[d].has(c)||this._callbacksForTypingEvents[d].add(c),g&&this._notificationProvider.send(JSON.stringify(e),f),this._dfdSubscribed[d].promise()},c.prototype.unsubscribeForTypingEventsInConversation=function(a){var c=this._resources.conversationsResource.href+"/"+a;this._chatStateNotifications.setConversationId(""),this._dfdUnsubscribed[c]=b.Deferred();var d={unsubscribe:{resources:[{application:"AMM",service:"chatState",resource:c}]}};this._callbacksForTypingEvents[c]&&this._callbacksForTypingEvents[c].has()&&this._callbacksForTypingEvents[c].empty();var e={dataType:"JSON",headers:{"Content-Type":"application/json"}};return this._notificationProvider.send(JSON.stringify(d),e),this._dfdUnsubscribed[c].promise()},c.prototype._resubscribeForTypingEvents=function(){var a=this._chatStateNotifications.getConversationId();if(""!==a){var c=this._resources.conversationsResource.href+"/"+a;this._chatStateNotifications.setConversationId(a),this._dfdSubscribed[c]=b.Deferred();var d={subscribe:{resources:[{application:"AMM",service:"chatState",resource:c}]}},e={dataType:"JSON",headers:{"Content-Type":"application/json"}};return this._notificationProvider.send(JSON.stringify(d),e),this._dfdSubscribed[c].promise()}},c.prototype._sendNotification=function(b,c){for(var d=a.Base.Utils.makeId();a.Base.Utils.isDefined(this._requests[d]);)d=a.Base.Utils.makeId();var e={notify:{requestId:d,notifications:[b]}};this._requests[d]=c;var f={dataType:"JSON",headers:{"Content-Type":"application/json"}};this._notificationProvider.send(JSON.stringify(e),f)},c.prototype._handleNotificationResponse=function(b){if(b.results.successful&&a.Base.Utils.isDefined(this._requests[b.requestId]))this._requests[b.requestId].resolve(b.results.successful[0]),delete this._requests[b.requestId];else if(b.results.failed&&a.Base.Utils.isDefined(this._requests[b.requestId])){var c=new a.Services.Messaging.MessagingError(a.Base.ErrorReasons.AMM_NOTIFICATION_FAILED,a.Base.Utils.queryJSONObject(b,"results.failed"));this._requests[b.requestId].reject(c),delete this._requests[b.requestId]}},c.prototype.isUpdateSubjectSupported=function(){return!!(this._resources&&this._resources.conversationsResource&&this._resources.conversationsResource.capabilities&&this._resources.conversationsResource.capabilities.subjectChange)},c.prototype.isMarkAllContentAsReadSupported=function(){return!!this._resources&&!!this._resources.services&&!!this._resources.services.markAsReadIf},c.prototype._reportChatState=function(c,d,e){var f=b.Deferred(),g={application:"AMM",service:"chatState",resource:this._resources.conversationsResource.href+"/"+d,contents:{state:a.Providers.AMM.ChatStates.PAUSED}};return e&&(g.contents={action:c,state:a.Providers.AMM.ChatStates.COMPOSING}),this._sendNotification(g,f),f.promise()},c.prototype.isOpened=function(){return this._notificationProvider.isOpened()},c.prototype.getMaxMessageCount=function(){return this._resources.conversationsResource.limits.maxMessageCount},c.prototype.getMaxImageSize=function(){return a.Base.Utils.queryJSONObject(this,"_resources.outbox.limits.maxImageSize")},c.prototype.getMaxVideoSize=function(){return a.Base.Utils.queryJSONObject(this,"_resources.outbox.limits.maxVideoSize")},c.prototype.getMaxAudioSize=function(){return a.Base.Utils.queryJSONObject(this,"_resources.outbox.limits.maxAudioSize")},c.prototype.getMaxTextLength=function(){return a.Base.Utils.queryJSONObject(this,"_resources.outbox.limits.maxTextLength")},c.prototype.getMaxGenericAttachmentSize=function(){return a.Base.Utils.queryJSONObject(this,"_resources.outbox.limits.maxGenericAttachmentSize")},c.prototype.changeSubject=function(a){var b={},c={subject:a.subject};return b.url=this._endpoints.conversations+"/"+a.threadId,b.sendType="POST",b.headers={"Content-Type":this._resourcesTypes.subject},this._networkProvider.send(JSON.stringify(c),b).catch(this._handleError.bind(this))},a.Providers.AMM.AMM3Provider=c}(AvayaClientServices,jQuery),function(a,b){"use strict";function c(){a.Providers.AMM.AbstractAMMProvider.call(this),this._providers=[],this._selectedProvider=void 0,this._config={},this._isAvailable=!1}c.prototype=Object.create(a.Providers.AMM.AbstractAMMProvider.prototype),c.prototype.registerAMMProvider=function(b,c){c.on(a.Base.NetworkProviderEvents.AUTHORIZED,function(){this.trigger(a.Base.NetworkProviderEvents.AUTHORIZED,[])}.bind(this)),c.on(a.Base.NetworkProviderEvents.UNAUTHORIZED,function(){this.trigger(a.Base.NetworkProviderEvents.UNAUTHORIZED,[])}.bind(this)),c.on(a.Providers.AMM.ProviderStates.AVAILABLE,function(){this.trigger(a.Providers.AMM.ProviderStates.AVAILABLE,[])}.bind(this)),c.on(a.Providers.AMM.ProviderStates.UNAVAILABLE,function(){this.trigger(a.Providers.AMM.ProviderStates.UNAVAILABLE,[])}.bind(this)),this._providers.push({version:b,provider:c})},c.prototype.start=function(a,c){return b.isEmptyObject(a)||this._config===a||(this._config=a),this.determineServerVersion(c)},c.prototype.determineServerVersion=function(a){var c=b.Deferred();return this._providers.sort(function(a,b){return b.version-a.version}),this._checkServer(0,c,this._config,a),c.promise()},c.prototype._checkServer=function(b,c,d,e){this._isProperVersion(b,d,e).then(function(){this._selectedProvider=this._providers[b].provider,a.Base.Logger.info(a.Base.LoggerTags.AMM_MESSAGING_PROVIDER,"Determined AMM server version: "+this._selectedProvider._resourcesTypes.resources),this._selectedProvider.startNotificationProvider(e),c.resolve()}.bind(this),function(e){b+=1;var f=e.getData()&&e.getData().message===a.Base.ErrorReasons.NETWORK_AUTHORIZATION_CANCELED;406!==e.statusCode&&b!==this._providers.length-1||f?c.reject(e):this._checkServer(b,c,d)}.bind(this))},c.prototype._isProperVersion=function(a,b,c){return this._providers[a].provider.start(b,c),this._providers[a].provider.discoverResources(c).then(function(){this._isAvailable=!0}.bind(this))},c.prototype.getRoutableDomains=function(){return this._selectedProvider.getRoutableDomains()},c.prototype.getSelfAddress=function(){return this._selectedProvider.getSelfAddress()},c.prototype.getConversations=function(a){return this._selectedProvider.getConversations(a)},c.prototype.getConversationIds=function(b){return this._selectedProvider.getConversationIds(b).then(function(b){for(var c=[],d=0;d<b.conversationIds.length;d++)c.push(new a.Services.Messaging.ConversationId(b.conversationIds[d]));return c})},c.prototype.getConversationsByQuery=function(a,b,c){return this._selectedProvider.getConversationsByQuery(a,b,c)},c.prototype.discoverResources=function(){return this._selectedProvider.discoverResources()},c.prototype.getResources=function(){return this._selectedProvider.getResources()},c.prototype.validateUsers=function(a){return this._selectedProvider.validateUsers(a)},c.prototype.getParticipants=function(a,b){return this._selectedProvider.getParticipants(a,b)},c.prototype.sendMessage=function(a,b){return this._selectedProvider.sendMessage(a,b)},c.prototype.sendMessageWithAttachments=function(a,b,c){return this._selectedProvider.sendMessageWithAttachments(a,b,c)},c.prototype.leaveConversation=function(a){return this._selectedProvider.leaveConversation(a)},c.prototype.markAllAsRead=function(a){return this._selectedProvider.markAllAsRead(a)},c.prototype.changeSubject=function(a){return this._selectedProvider.changeSubject(a)},c.prototype.markAsReadBatch=function(a){return this._selectedProvider.markAsReadBatch(a)},c.prototype.getMessages=function(a,b,c,d,e){return this._selectedProvider.getMessages(a,b,c,d,e)},c.prototype.reportTyping=function(a,b){return this._selectedProvider.reportTyping(a,b)},c.prototype.reportCustomChatNotification=function(a,b,c){return this._selectedProvider.reportCustomChatNotification(a,b,c)},c.prototype.observeConversations=function(){return this._selectedProvider.observeConversations()},c.prototype.callEscalationEvent=function(a,b){return this._selectedProvider.callEscalationEvent(a,b)},c.prototype.setLastAccessTime=function(a,b){return this._selectedProvider.setLastAccessTime(a,b)},c.prototype.addParticipantsToConversation=function(a,b){return this._selectedProvider.addParticipantsToConversation(a,b)},c.prototype.subscribeForTypingEventsInConversation=function(a,b){return this._selectedProvider.subscribeForTypingEventsInConversation(a,b)},c.prototype.unsubscribeForTypingEventsInConversation=function(a){return this._selectedProvider.unsubscribeForTypingEventsInConversation(a)},c.prototype.close=function(a){return this._selectedProvider.close(a)},c.prototype.stop=function(){return this._selectedProvider.stop().then(function(){this._isAvailable=!1}.bind(this))},c.prototype.logout=function(){return this._selectedProvider.logout()},c.prototype.on=function(b,c){return this._selectedProvider?this._selectedProvider.on(b,c):a.Providers.AMM.AbstractAMMProvider.prototype.on.call(this,b,c)},c.prototype.off=function(a,b){return this._selectedProvider.off(a,b)},c.prototype.isUpdateSubjectSupported=function(){return this._selectedProvider.isUpdateSubjectSupported()},c.prototype.isMarkAllContentAsReadSupported=function(){return this._selectedProvider.isMarkAllContentAsReadSupported()},c.prototype.isOpened=function(){return this._selectedProvider.isOpened()},
c.prototype.getMaxMessageCount=function(){return this._selectedProvider.getMaxMessageCount()},c.prototype.getMaxImageSize=function(){return this._selectedProvider.getMaxImageSize()},c.prototype.getMaxVideoSize=function(){return this._selectedProvider.getMaxVideoSize()},c.prototype.getMaxAudioSize=function(){return this._selectedProvider.getMaxAudioSize()},c.prototype.getMaxTextLength=function(){return this._selectedProvider.getMaxTextLength()},c.prototype.getMaxGenericAttachmentSize=function(){return this._selectedProvider.getMaxGenericAttachmentSize()},c.prototype.getConversationResource=function(){return this._selectedProvider.getConversationResource()},c.prototype.getValidateAddressResource=function(){return this._selectedProvider.getValidateAddressResource()},c.prototype.getMarkAsReadResource=function(){return this._selectedProvider.getMarkAsReadResource()},c.prototype.isAvailable=function(){return this._isAvailable&&!!this._selectedProvider&&!!this._selectedProvider.isStarted()&&this.isOpened()},a.Providers.AMM.AMMProvider=c}(AvayaClientServices,jQuery),function(a){"use strict";var b=1,c={VERSION:"v",TRACKINGID:"tid",CLIENTID:"cid",HITTYPE:"t",APPNAME:"an",APPVERSION:"av"},d={EVENT:"event",TIMING:"timing"},e="Client SDK Communications Package",f="UA-83552596-1",g=!1,h=[],i={BUCKET_DEFINITIONS:{OPERATIONS_TIMING:{LESS_100:"<100 msec",MORE_100:"100-999 msec",MORE_1000:"1000-4999 msec",MORE_5000:"5000-9999 msec",MORE_10000:">=10000 msec"},SERVICE_OUTAGE:{LESS_1000:"<1 sec",MORE_1000:"1-59 sec",MORE_60000:"1-10 min",MORE_600000:"10-59 min",MORE_3600000:">=1 hour"},CALL_DURATION:{LESS_10000:"<10 sec",MORE_10000:"10-59 sec",MORE_60000:"1-5 min",MORE_300000:"5-10 min",MORE_600000:"10-60 min",MORE_3600000:">=60 min"},CONTACT_COUNT:{LESS_10:"<10",MORE_10:"10-99",MORE_100:"100-499",MORE_500:"500-999",MORE_1000:"1000-1999",MORE_2000:"2000-2999",MORE_3000:"3000-3999",MORE_4000:"4000-4999",MORE_5000:">=5000"},ATTACHMENT_SIZE:{LESS_100:"<100 KB",MORE_100:"100-999 KB",MORE_1000:"1000-4999 KB",MORE_5000:"5000-9999 KB",MORE_10000:"10000-29999 KB",MORE_30000:">=30000 KB"},CALL_PRESERVATION:{LESS_1000:"<1 sec",MORE_1000:"1-5 sec",MORE_5000:"5-10 sec",MORE_10000:"10-30 sec",MORE_30000:"30-60 sec",MORE_60000:">=60 sec"}}},j=a.Base.Utils;a.Providers.Analytics.AnalyticsStatistic={CONSTANTS:i,setCollectionEnabledState:function(a){(g=a)||(h.length=0)},isCollectionEnabled:function(){return g},queueCollectedHits:function(){this._hitTransmissionQueue=this._hitTransmissionQueue.concat(h),h.length=0},addHit:function(a){g&&h.push(a)},getCommonRequestsParams:function(a,d){for(var g="",h=[[c.VERSION,b],[c.TRACKINGID,f],[c.CLIENTID,d],[c.APPNAME,e],[c.APPVERSION,a]],i=0;i<h.length;i++)g+=this.addURIParam(h[i][0],h[i][1],!g);return g},addHitTypeParameter:function(b){var e="";switch(b){case"event":e=d.EVENT;break;case"timing":e=d.TIMING;break;default:a.Base.Logger.warn(a.Base.LoggerTags.ANALYTICS_PROVIDER,"Unknown type",b)}return this.addURIParam(c.HITTYPE,e)},addCustomDimensionsParameters:function(a){var b="";for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];"string"==typeof d&&""!==d&&j.getBytesCount(encodeURIComponent(d))<=150&&(b+=this.addURIParam("cd"+c,d))}return b},addURIParam:function(a,b,c){var d="";return d+=c?"":"&",d+=a+"="+encodeURIComponent(b)},getOperationTimingLabel:function(a){var b=i.BUCKET_DEFINITIONS.OPERATIONS_TIMING;return a<100?b.LESS_100:a<1e3?b.MORE_100:a<5e3?b.MORE_1000:a<1e4?b.MORE_5000:b.MORE_10000},getServiceOutageLabel:function(a){var b=i.BUCKET_DEFINITIONS.SERVICE_OUTAGE;return a<1e3?b.LESS_1000:a<6e4?b.MORE_1000:a<6e5?b.MORE_60000:a<36e5?b.MORE_600000:b.MORE_3600000},getCallDurationLabel:function(a){var b=i.BUCKET_DEFINITIONS.CALL_DURATION;return a<1e4?b.LESS_10000:a<6e4?b.MORE_10000:a<3e5?b.MORE_60000:a<6e5?b.MORE_300000:a<36e5?b.MORE_600000:b.MORE_3600000},getContactCountLabel:function(a){var b=i.BUCKET_DEFINITIONS.CONTACT_COUNT;return a<10?b.LESS_10:a<100?b.MORE_10:a<500?b.MORE_100:a<1e3?b.MORE_500:a<2e3?b.MORE_1000:a<3e3?b.MORE_2000:a<4e3?b.MORE_3000:a<5e3?b.MORE_4000:b.MORE_5000},getAttachmentSizeLabel:function(a){var b=i.BUCKET_DEFINITIONS.ATTACHMENT_SIZE;return a/=1024,a<100?b.LESS_100:a<1e3?b.MORE_100:a<5e3?b.MORE_1000:a<1e4?b.MORE_5000:a<3e4?b.MORE_10000:b.MORE_30000},getCallPreservation:function(a){var b=i.BUCKET_DEFINITIONS.CALL_PRESERVATION;return a<1e3?b.LESS_1000:a<5e3?b.MORE_1000:a<1e4?b.MORE_5000:a<3e4?b.MORE_10000:a<6e4?b.MORE_30000:b.MORE_60000}}}(AvayaClientServices),function(a){"use strict";var b={CATEGORY:"utc",VARIABLE:"utv",TIME:"utt",LABEL:"utl"},c=a.Base.Utils,d=a.Providers.Analytics.AnalyticsStatistic;a.Providers.Analytics.AnalyticsTimingStatistic={send:function(a,b,c,e,f){if(d.isCollectionEnabled()){var g=this._getTimingParams.apply(this,arguments);g&&d.addHit(g)}},_getTimingParams:function(a,e,f,g,h){if(!c.isInteger(f))return null;var i=d.addHitTypeParameter("timing"),j=[[b.CATEGORY,a],[b.VARIABLE,e],[b.TIME,f]];g&&j.push([b.LABEL,g]);for(var k=0;k<j.length;k++)i+=d.addURIParam(j[k][0],j[k][1]);return i+=d.addCustomDimensionsParameters(h)}}}(AvayaClientServices),function(a,b){"use strict";function c(b,c,d,e,f){a.Base.Observable.call(this),this._restProvider=c,this._notificationProvider=d,this._restKeepAliveProvider=e,this._messageBuilder=b,this._csgConfig=void 0,this._notificationsConfig=void 0,this._maxConnectionErrorCount=5,this._credentials=void 0,this._started=!1,this._isNetworkAvailable=!1,this._startPromise=void 0,this._eTag=void 0,this._resourceHrefs={},this._restResources={},this._notificationResources={},this._activeServices=[],this._notificationPromises={},this._notificationHandlers={},this._failoverPingData={wsKeepAliveEnabled:!0,wsPingInterval:3e4,wsGeneratePingMessage:function(){var b=a.Base.Utils.makeId(32,"0123456789abcdef");this._failoverPingData.wsPingMessageRequestId=b;var c={ping:{requestId:b,version:"1"}};return JSON.stringify(c)}.bind(this),wsIsPongMessage:function(b){var c=JSON.parse(b.data);return a.Base.Utils.isDefined(c.pong)&&this._failoverPingData.wsPingMessageRequestId===c.pong.requestId}.bind(this),wsPingMessageRequestId:"",keepAliveAnswerWaitingTime:5e3,ssePingInterval:65e3},this._blackListedWords=["remoteDisplayName","Authorization","authentication","meetingToken","meetingPasscode","meetingId","userIdentity","rlPresenceUpdatedEvent","contact","remoteAddress","targetRemoteAddress","targetCallId","participantId","webCollaborationUrl","callInfo"],this._discoveryBackoffDataObject=void 0,this._clientId=void 0}var d=.8;c.prototype=Object.create(a.Base.Observable.prototype),c.prototype.start=function(c){if(!this._started&&!this._startPromise){this._started=!0,this._csgConfig=c,this._startPromise=b.Deferred();var d=function(){this._discoverResources().then(this._startNotificationProvider.bind(this),function(b){b===a.Providers.CallServiceGateway.Constants.RESOURCE_DISCOVERY_USERNAME_MISMATCH?d.call(this):this._startPromise.reject(b)}.bind(this)).then(function(){this._restProvider.onError=function(){},this._startRefreshingClientSession(),a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Provider has been started successfully"),this._startPromise.resolve()}.bind(this),function(a){this._startPromise.reject(a)}.bind(this))}.bind(this);this._startRestProvider().then(d.bind(this))}return this._startPromise.promise()},c.prototype.stop=function(){if(!this._started&&this._isNetworkAvailable)return b.Deferred().reject("CSGProvider: Provider is not started").promise();if(this._activeServices.length>0)return b.Deferred().resolve().promise();a.Base.Utils.isDefined(this._discoveryBackoffDataObject)&&this._discoveryBackoffDataObject.cancel();var c,d=b.Deferred(),e=function(a){c||(c=a)};return this._isNetworkAvailable?this._stopNotificationProvider().then(function(){return this._stopRefreshingClientAndRestSession()}.bind(this),function(a){return e(a),this._stopRefreshingClientAndRestSession()}.bind(this)).then(function(){return this._stopRestProvider()}.bind(this),function(a){return e(a),this._stopRestProvider()}.bind(this)).fail(function(a){e(a)}).always(function(){this._cleanupAfterStop(),c?d.reject(c):d.resolve()}.bind(this)):(this._restKeepAliveProvider.stopPolling(),this._stopNotificationProvider().always(function(){this._stopRestProvider().always(function(){this._cleanupAfterStop()}.bind(this)),d.reject(new a.Base.NetworkError(a.Base.ErrorReasons.NETWORK_ERROR))}.bind(this))),d.promise().then(function(){a.Base.Logger.debug("CSGProvider: Provider has been stopped successfully")})},c.prototype.stopImmediately=function(){if(!this._started)return b.Deferred().reject("CSGProvider: Provider is not started");var c,d=b.Deferred(),e=function(a){c||(c=a)};return this._restKeepAliveProvider.stopPolling(),this._stopNotificationProvider().then(function(){return this._stopRefreshingClientSessionSynchronously()}.bind(this),function(a){return e(a),this._stopRefreshingClientSessionSynchronously()}.bind(this)).then(function(){return this._stopRestProvider()}.bind(this),function(a){return e(a),this._stopRestProvider()}.bind(this)).fail(function(a){e(a)}.bind(this)).always(function(){this._cleanupAfterStop(),c?d.reject(c):d.resolve()}.bind(this)),d.promise().then(function(){a.Base.Logger.debug("CSGProvider: Provider has been stopped successfully")})},c.prototype._cleanupAfterStop=function(){this._removeListeners(),this._started=!1,this._notificationsConfig=void 0,this._credentials=void 0,this._startPromise=void 0,this._eTag=void 0,this._clientId=void 0,this._resourceHrefs={},this._restResources={},this._notificationResources={},this._activeServices=[],this._notificationPromises={},this._notificationHandlers={},a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Provider has been stopped successfully")},c.prototype._startRestProvider=function(){var c=b.Deferred();return this._restProvider._onCredentialsRequired=this._onCredentialsRequired.bind(this),this._restProvider.registerBlackList(this._blackListedWords),this._restProvider.onMessage=function(a,b){if(void 0!==b){var c=b.getResponseHeader("ETag");null!==c&&void 0!==c&&(this._eTag=c)}}.bind(this),this._restProvider.onConnectionUnavailable=function(b){this._handleError("Unable to communicate with REST server"),this.trigger(a.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,["REST",b])}.bind(this),this._restProvider.onOpen=function(){this._restProvider.onError=function(b){this.trigger(a.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,["REST",b])}.bind(this),c.resolve()}.bind(this),this._restProvider.on(a.Base.NetworkProviderEvents.UNAUTHORIZED,function(){c.reject(a.Base.NetworkProviderEvents.UNAUTHORIZED),this.trigger(a.Base.NetworkProviderEvents.UNAUTHORIZED,[])}.bind(this)),this._restProvider.on(a.Base.NetworkProviderEvents.AUTHORIZED,function(){this.trigger(a.Base.NetworkProviderEvents.AUTHORIZED,[])}.bind(this)),this._restProvider.start(this._csgConfig.networkProviderConfiguration,this._csgConfig.credentialProvider),c.promise()},c.prototype._stopNotificationProvider=function(){var c=b.Deferred();return this._notificationProvider.onClose=function(){c.resolve(),a.Base.Logger.warn("CSGProvider: Notification service websocket connection is closed")},this._notificationProvider.stopMonitorFallback(),this._isNetworkAvailable?(this._notificationProvider.onError=function(b){a.Base.Logger.warn("CSGProvider: Notification service websocket connection is closed with error",b),c.resolve()},this._notificationProvider.close()):c.reject(new a.Base.NetworkError(a.Base.ErrorReasons.NETWORK_ERROR)),c.promise()},c.prototype._stopRestProvider=function(){return this._restProvider.close()},c.prototype.activateService=function(c,d,e){var f=this._messageBuilder.buildActivateServiceOptions(this._resourceHrefs[a.Providers.CallServiceGateway.ResourceType.Services]),g=JSON.stringify(this._messageBuilder.buildActivateServiceData(c,d,e));return a.Base.Utils.callFunction(this._restProvider,this._restProvider.send,[g,f],5,3200).then(function(){var b=this._activeServices.indexOf(c);b>-1?this._activeServices[b]=c:this._activeServices.push(c),a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Service activated",c)}.bind(this),function(d){return a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Failed to activate service",c),b.Deferred().reject(d).promise()}.bind(this))},c.prototype._reactivateService=function(){this._activeServices.indexOf(a.Providers.CallServiceGateway.Constants.CALLS)>-1&&this.activateService(a.Providers.CallServiceGateway.Constants.CALLS,!0),this._activeServices.indexOf(a.Providers.CallServiceGateway.Constants.PRESENCE)>-1&&this.activateService(a.Providers.CallServiceGateway.Constants.PRESENCE,!0)},c.prototype.deactivateService=function(c){var d=this._messageBuilder.buildDeactivateServiceOptions(this._resourceHrefs[a.Providers.CallServiceGateway.ResourceType.Services]),e=JSON.stringify(this._messageBuilder.buildDeactivateServiceData(c)),f=b.Deferred();return a.Base.Utils.callFunction(this._restProvider,this._restProvider.send,[e,d],2,2500).then(function(){var b=this._activeServices.indexOf(c);b>-1&&this._activeServices.splice(b,1),a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Service deactivated: "+c+"; active service count: "+this._activeServices.length),f.resolve()}.bind(this),function(d){a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Failed to deactivate service: "+c);var e=this._activeServices.indexOf(c);return e>-1&&this._activeServices.splice(e,1),f.reject(d),b.Deferred().reject(d).promise()}.bind(this)),f.promise()},c.prototype._deactivateServicesImmediately=function(){var b=this._messageBuilder.buildDeactivateServiceOptions(this._resourceHrefs[a.Providers.CallServiceGateway.ResourceType.Services]);b.async=!1;var c=JSON.stringify(this._messageBuilder.buildDeactivateServiceData(a.Providers.CallServiceGateway.Constants.CALLS));this._restProvider.send(c,b);var d=JSON.stringify(this._messageBuilder.buildDeactivateServiceData(a.Providers.CallServiceGateway.Constants.PRESENCE));this._restProvider.send(d,b)},c.prototype._discoverResources=function(){var c=b.Deferred(),d=function(){var a=this._messageBuilder.buildResourceDiscoveryOptions(),b=this._messageBuilder.buildResourceDiscoveryData(this._clientId);return this._restProvider.send(b,a)}.bind(this);return this._discoveryBackoffDataObject=a.Base.Utils.connectionBackoffAlgorithm(d),this._discoveryBackoffDataObject.dfdPromise.then(function(d){if(this._discoveryBackoffDataObject=void 0,null!==d){if(this._restResources=b.extend({},new a.Providers.CallServiceGateway.RestResources,d),d.resources)for(var e=0;e<d.resources.length;e++)this._resourceHrefs[d.resources[e].name]=d.resources[e].serviceReference.href;if(d.clientId&&(this._clientId=d.clientId),d.sessionManagement){this._resourceHrefs[a.Providers.CallServiceGateway.ResourceType.RestSessionMgmt]=d.sessionManagement.href;var f=a.Base.Utils.queryJSONObject(d,"sessionManagement.username"),g=this._credentials.username;g.indexOf("csaGuest/")>=0&&(g=g.substring("csaGuest/".length)),a.Base.Utils.isDefined(f)&&f!==g&&(a.Base.Logger.warn(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Rediscovering resources due to mismatch username"),this._credentials.isGuest&&0===f.indexOf("jsg-")?(this._credentials.username="csaGuest/"+f,this._csgConfig.credentialProvider.username=this._credentials.username):this._deleteRestSession(),c.reject(a.Providers.CallServiceGateway.Constants.RESOURCE_DISCOVERY_USERNAME_MISMATCH))}d.clientManagement&&(this._resourceHrefs[a.Providers.CallServiceGateway.ResourceType.ClientKeepAlive]=d.clientManagement.refreshClient.href,this._resourceHrefs[a.Providers.CallServiceGateway.ResourceType.ClientTerminate]=d.clientManagement.terminateClient.href),d.stunServers&&this.trigger(a.Providers.CallServiceGateway.ObservableEvents.ICE_CONFIG_UPDATES,[d.stunServers]),d.presence&&(this._resourceHrefs[a.Providers.CallServiceGateway.ResourceType.PublishPresenceMode]=d.presence.manualMode.set.href,this._resourceHrefs[a.Providers.CallServiceGateway.ResourceType.PublishPresenceState]=d.presence.manualPresenceState.set.href,this._resourceHrefs[a.Providers.CallServiceGateway.ResourceType.PublishPresenceNote]=d.presence.manualNote.set.href,this._resourceHrefs[a.Providers.CallServiceGateway.ResourceType.DeletePresenceMode]=d.presence.manualMode.delete.href,this._resourceHrefs[a.Providers.CallServiceGateway.ResourceType.DeletePresenceState]=d.presence.manualPresenceState.delete.href,this._resourceHrefs[a.Providers.CallServiceGateway.ResourceType.DeletePresenceNote]=d.presence.manualNote.delete.href),d.pubSubContainers&&(this._resourceHrefs[a.Providers.CallServiceGateway.ResourceType.CreatePresenceContainer]=d.pubSubContainers.create.href),d.notificationService?(this._resourceHrefs[a.Providers.CallServiceGateway.ResourceType.Websocket]=d.notificationService.websocket.href,this._resourceHrefs[a.Providers.CallServiceGateway.ResourceType.SSE]=d.notificationService.sse.href,this._createNotificationsConfig(),c.resolve()):c.reject("Notification service is undefined")}}.bind(this),function(a){this._handleError("_discoverResources() network provider failed - "+a),c.reject(a)}.bind(this)),c.promise()},c.prototype._createNotificationsConfig=function(){var b=a.Base.Utils.parseUrl(this._restResources.notificationService.websocket.href),c=new a.Config.ServerInfo(b.hostname,b.port,b.isSecure,b.path),d=a.Base.Utils.parseUrl(this._restResources.notificationService.sse.href),e=new a.Config.ServerInfo(d.hostname,d.port,d.isSecure,d.path),f=new a.Config.ServerInfo;this._notificationsConfig=new a.Config.NetworkProviderConfiguration(f,c,e,this._maxConnectionErrorCount)},c.prototype._startNotificationProvider=function(){var c=b.Deferred();if(this._notificationProvider.isOpened())return c.resolve().promise();if(!this._notificationsConfig)return c.reject(new Error("Unable to start notifications service - Notifications provider configuration is absent")).promise();this._notificationProvider.onOpen=function(){a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Notifications provider has been started"),this._isNetworkAvailable=!0,this._notificationProvider.onMessage=function(b){var d;d=b.data&&b.type!==a.Base.ProvidersEventTypes.PING?JSON.parse(b.data):b,d.notification?this._onNotification(d.notification):d.subscribed?this._onSubscribed(d.subscribed):d.discovery&&(this._onNotificationDiscovery(d.discovery),this.trigger(a.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_AVAILABLE),c.resolve())}.bind(this)}.bind(this),this._notificationProvider.onError=function(b){a.Base.Logger.warn(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Notification service websocket connection failed: "+b),this._isNetworkAvailable=!1,this.trigger(a.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,["Notification",b])}.bind(this),this._notificationProvider.on(a.Base.NetworkProviderEvents.UNAUTHORIZED,function(){this.trigger(a.Base.NetworkProviderEvents.UNAUTHORIZED,[])}.bind(this)),this._notificationProvider.on(a.Base.NetworkProviderEvents.AUTHORIZED,function(){this.trigger(a.Base.NetworkProviderEvents.AUTHORIZED,[])}.bind(this));var d=function(){return this._isNetworkAvailable=!1,this._pauseRefreshingClientSession(),this.trigger(a.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,["Notification","Unavailable"]),this._activeServices=[],this._discoverResources().then(function(){this._startNotificationProvider().then(function(){this._reactivateService(),this._startRefreshingClientSession()}.bind(this))}.bind(this))}.bind(this);return this._notificationProvider.registerBlackList(this._blackListedWords),this._notificationProvider.start(this._notificationsConfig,void 0,void 0,void 0,d,this._failoverPingData).then(function(){return a.Base.Utils.rejectIfPromiseNotResolvedInTime(c.promise(),3e4,new a.Base.BaseError(a.Base.ErrorReasons.TIMEOUT),function(){a.Base.Logger.error(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Notification discovery was not received in time"),this.trigger(a.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,["Notification","Unavailable"])}.bind(this))},function(){a.Base.Logger.error(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Start notification channel failed.")})},c.prototype._onNotificationDiscovery=function(c){if(this._notificationResources=b.extend({},new a.Providers.CallServiceGateway.NotificationResources,c),!this._notificationResources.commandURL)return void a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"SSE is not supported by the server");var d=a.Base.Utils.parseUrl(this._notificationResources.commandURL);this._notificationsConfig.restConfig.hostName=d.hostname,this._notificationsConfig.restConfig.port=d.port,this._notificationsConfig.restConfig.isSecure=d.isSecure,this._notificationsConfig.restConfig.path=d.path},c.prototype._onSubscribed=function(b){if(b.requestId&&b.results){var c=this._notificationPromises[b.requestId];if(c)if(a.Base.Utils.queryJSONObject(b,"results.successful[0].application")===a.Providers.CallServiceGateway.Constants.CSA_APPLICATION)c.resolve(),a.Base.Logger.debug(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Subscribed",a.Base.Utils.queryJSONObject(b,"results.successful[0].resource"));else if(a.Base.Utils.queryJSONObject(b,"results.failed[0].application")===a.Providers.CallServiceGateway.Constants.CSA_APPLICATION){var d=a.Base.Utils.queryJSONObject(b,"results.failed[0].error.description");c.reject({message:"Failed to subscribe for notifications",details:d})}}},c.prototype._onNotification=function(b){if(b.application===a.Providers.CallServiceGateway.Constants.CSA_APPLICATION&&b.resource){var c=this._notificationHandlers[b.resource];c&&c(b.contents)}},c.prototype.subscribeForNotifications=function(a,c){var d=b.Deferred(),e=d.promise();return e.then(function(){this._notificationHandlers[a.subscribe.resources[0].resource]=c}.bind(this)),this._notificationPromises[a.subscribe.requestId]=d,this.sendNotification(JSON.stringify(a),this._messageBuilder.buildNotificationsOptions()),e},c.prototype.unsubscribeFromNotifications=function(a){return this.sendNotification(JSON.stringify(a),this._messageBuilder.buildNotificationsOptions()).always(function(){delete this._notificationHandlers[a.unsubscribe.resources[0].resource]}.bind(this))},c.prototype.send=function(b,c){return this._restProvider.send(b,c).fail(function(b){var c=this._parseNetworkError(b);if(c){a.Base.Utils.queryJSONObject(c,"error[0].errorCode")!==a.Providers.CallServiceGateway.Constants.CALL_DOES_NOT_EXISTS&&this._handleError(JSON.stringify(b))}}.bind(this))},c.prototype.sendNotification=function(a,b){return this._notificationProvider.send(a,b).fail(function(a){this._handleError(JSON.stringify(a))}.bind(this))},c.prototype.getRestResources=function(){return this._restResources},c.prototype.getNotificationResources=function(){return this._restResources},c.prototype.getResourceHrefs=function(){return this._resourceHrefs},c.prototype.getCredentials=function(){return this._credentials},c.prototype.restProviderOnErrorHandler=function(a){this._restProvider.onError=a},c.prototype._onCredentialsRequired=function(b,c){var d;c&&c!==this._csgConfig.credentialProvider&&a.Base.Utils.deepMerge(this._csgConfig.credentialProvider,c),this._csgConfig.credentialProvider.onAuthenticationChallenge(d,function(a){this._onCredentialsRetrieved(a,b)}.bind(this))},c.prototype._onCredentialsRetrieved=function(b,c){(a.Base.Utils.isUndefined(this._credentials)||this._credentials.username!==b.username||this._credentials.password!==b.password)&&(this._credentials=b,this._messageBuilder.updateCredentials(this._credentials)),c.options&&c.options.authentication&&(c.options.authentication.username=b.username,c.options.authentication.password=b.password)},c.prototype._startRefreshingRestSession=function(){var b=this._messageBuilder.buildKeepAliveOptions();this._restKeepAliveProvider.startPolling(this._resourceHrefs[a.Providers.CallServiceGateway.ResourceType.RestSessionMgmt],1e3*this._restResources.sessionManagement.timeout*d,{},b)},c.prototype._pauseRefreshingRestSession=function(){return this._restKeepAliveProvider.stopPolling()},c.prototype._startRefreshingClientSession=function(){var b=this._messageBuilder.buildKeepAliveOptions(),c=this._resourceHrefs[a.Providers.CallServiceGateway.ResourceType.ClientKeepAlive];a.Base.Utils.isDefined(c)?this._restKeepAliveProvider.startPolling(c,1e3*this._restResources.clientManagement.timeout*d,{},b):this._startRefreshingRestSession()},c.prototype._pauseRefreshingClientSession=function(){return this._restKeepAliveProvider.stopPolling()},c.prototype._stopRefreshingClientAndRestSession=function(){return this._restKeepAliveProvider.stopPolling(),this._invokeIfNetworkIsAvailable(function(){return this._invokeIfNetworkIsAvailable(this._deleteClientSession.bind(this)).then(function(){return this._invokeIfNetworkIsAvailable(this._deleteRestSession.bind(this))}.bind(this),function(a){return this._invokeIfNetworkIsAvailable(this._deleteRestSession.bind(this))}.bind(this))}.bind(this))},c.prototype._stopRefreshingClientSessionSynchronously=function(){return this._restKeepAliveProvider.stopPolling(),this._deleteClientSession(!1)},c.prototype._deleteClientSession=function(c){var d=this._resourceHrefs[a.Providers.CallServiceGateway.ResourceType.ClientTerminate];if(this._isNetworkAvailable&&a.Base.Utils.isDefined(d)){var e=this._messageBuilder.buildDeleteSessionOptions(d);return a.Base.Utils.isDefined(c)&&(e.async=c),this._restProvider.send(null,e)}return b.Deferred().resolve().promise()},c.prototype._deleteRestSession=function(b){var c=this._messageBuilder.buildDeleteSessionOptions(this._resourceHrefs[a.Providers.CallServiceGateway.ResourceType.RestSessionMgmt]);return a.Base.Utils.isDefined(b)&&(c.async=b),this._restProvider.send(null,c)},c.prototype._invokeIfNetworkIsAvailable=function(a){return this._isNetworkAvailable?a():b.Deferred().reject("Network is unavailable").promise()},c.prototype._handleError=function(b){a.Base.Logger.error(a.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Error detected: "+b)},c.prototype._parseNetworkError=function(b){var c=a.Base.Utils.queryJSONObject(b,"_data._responseText");if(c)try{return JSON.parse(c)}catch(d){}},c.prototype.isNetworkAvailable=function(){return this._isNetworkAvailable},a.Providers.CallServiceGateway.CSGProvider=c}(AvayaClientServices,jQuery),function(a,b){"use strict";function c(b,c,d){a.Providers.Interfaces.ConferenceDataProvider.call(this),this._networkProvider=b,this._config=void 0,this._messageBuilder=c,this._messageParser=d,this._isStarted=!1}c.prototype=Object.create(a.Providers.Interfaces.ConferenceDataProvider.prototype),c.prototype.start=function(a){var c=b.Deferred();return this._config=a,this._isStarted=!0,c.resolve(),c.promise()},c.prototype.onCredentialsRequired=function(b,c){var d;c&&c!==this._config.credentialProvider&&a.Base.Utils.deepMerge(this._config.credentialProvider,c),this._config.credentialProvider.onAuthenticationChallenge(d,function(a){this.onCredentialsRetrieved(a,b)}.bind(this))},c.prototype.onCredentialsRetrieved=function(a,b){},c.prototype.sendHandshake=function(a){var b=this._messageBuilder.buildHandshakeRequest(a);return this._sendMessage(b,"success")},c.prototype.subscribeMeetingInfo=function(a){var b=this._messageBuilder.buildSubscribeMeetingInfoRequest(a);return this._sendMessage(b,"success")},c.prototype.startRecording=function(b,c,d){var e=this._messageBuilder.buildSetRecordingRequest(b,a.Services.Conference.RecordingOperation.START,c,d);return this._sendMessage(e,"success")},c.prototype.stopRecording=function(b){var c=this._messageBuilder.buildSetRecordingRequest(b,a.Services.Conference.RecordingOperation.STOP);return this._sendMessage(c,"success")},c.prototype.pauseRecording=function(b){var c=this._messageBuilder.buildSetRecordingRequest(b,a.Services.Conference.RecordingOperation.PAUSE);return this._sendMessage(c,"success")},c.prototype.resumeRecording=function(b){var c=this._messageBuilder.buildSetRecordingRequest(b,a.Services.Conference.RecordingOperation.RESUME);return this._sendMessage(c,"success")},c.prototype.subscribeRoster=function(a){var b=this._messageBuilder.buildSubscribeRosterRequest(a);return this._sendMessage(b,"success")},c.prototype.subscribeActiveTalker=function(a){var b=this._messageBuilder.buildSubscribeActiveTalkerRequest(a);return this._sendMessage(b,"success")},c.prototype.subscribePermissions=function(a){var b=this._messageBuilder.buildSubscribePermissionsRequest(a);return this._sendMessage(b,"success")},c.prototype.subscribeSlider=function(a){var b=this._messageBuilder.buildSubscribeSliderRequest(a);return this._sendMessage(b,"success")},c.prototype.subscribeMeetingNote=function(a){var b=this._messageBuilder.buildSubscribeMeetingNoteRequest(a);return this._sendMessage(b,"success")},c.prototype.subscribeWebCollab=function(a){var b=this._messageBuilder.buildSubscribeWebCollabRequest(a);return this._sendMessage(b,"success")},c.prototype.subscribeAvailableLayouts=function(a){var b=this._messageBuilder.buildSubscribeAvailableLayoutsRequest(a);return this._sendMessage(b,"success")},c.prototype.setAsLecturer=function(a,b){var c=this._messageBuilder.buildSetAsLecturerRequest(a,b);return this._sendMessage(c,"success")},c.prototype.unsetAsLecturer=function(a){var b=this._messageBuilder.buildUnsetAsLecturerRequest(a);return this._sendMessage(b,"success")},c.prototype.disconnectParticipant=function(a,b){var c=this._messageBuilder.buildDisconnectParticipantRequest(a,b._participantId);return this._sendMessage(c,"success")},c.prototype.setLocked=function(a,b){var c=this._messageBuilder.buildLockMeetingRequest(a,b);return this._sendMessage(c,"success")},c.prototype.muteUnmute=function(a,b,c,d){var e=this._messageBuilder.buildModeratorMuteRequest(a,b,c,d);return this._sendMessage(e,"success")},c.prototype.controlRemoteCamera=function(a,b,c){var d=this._messageBuilder.buildFeccRequest(a,b,c);return this._sendMessage(d,"success")},c.prototype.muteUnmuteAll=function(a,b){var c=this._messageBuilder.buildMuteAllRequest(a,b);return this._sendMessage(c,"success")},c.prototype.sendLocalMuteEvent=function(a,b,c){var d=this._messageBuilder.buildLocalMuteEvent(a,b,c);return this._networkProvider.send(JSON.stringify(d))},c.prototype.sendDisconnectEvent=function(a,b){var c=this._messageBuilder.buildDisconnectEvent(a,b);return this._networkProvider.send(JSON.stringify(c))},c.prototype.terminateConference=function(a){var b=this._messageBuilder.buildTerminateMeetingRequest(a);return this._sendMessage(b,"success")},c.prototype.requestToBecomeModerator=function(a,b){var c=this._messageBuilder.buildStartModerationRequest(a,b);return this._sendMessage(c,"success")},c.prototype.signIn=function(a,b){var c=this._messageBuilder.buildUpdateCredentialsTokenRequest(a,b);return this._sendMessage(c,"success")},c.prototype.videoPin=function(a,b,c,d,e,f){var g=this._messageBuilder.buildVideoPinRequest(a,b,c,d,e,f);return this._sendMessage(g,"success")},c.prototype.extendMeeting=function(a,b){var c=this._messageBuilder.buildExtendMeetingRequest(a,b);return this._sendMessage(c,"success")},c.prototype.addParticipant=function(b,c){var d=this._messageBuilder.buildDialoutRequest(b,c);return this._sendMessage(d,a.Services.Conference.DialoutStatus.DIALING)},c.prototype.cancelDialoutParticipant=function(a,b){var c=this._messageBuilder.buildCancelDialoutRequest(a,b);return this._sendMessage(c,"success")},c.prototype.sendChatMessage=function(a,b,c){var d=this._messageBuilder.buildSendChatMessage(a,b,c);return this._sendMessage(d,"success")},c.prototype.setVideoLayout=function(a,b){var c=this._messageBuilder.buildChangeLayoutGeometryRequest(a,b);return this._sendMessage(c,"success")},c.prototype.setVideoLayoutSelfSee=function(a,b){var c=this._messageBuilder.buildChangeLayoutNoSelfSeeRequest(a,!b)
;return this._sendMessage(c,"success")},c.prototype.setVideoLayoutTextOverlay=function(a,b){var c=this._messageBuilder.buildChangeLayoutTextOverlayRequest(a,b);return this._sendMessage(c,"success")},c.prototype.getCurrentVideoLayout=function(a){var b=this._messageBuilder.buildCurrentLayoutRequest(a);return this._sendMessage(b,"success")},c.prototype.raiseLowerHand=function(a,b){var c=this._messageBuilder.buildRaiseHandRequest(a,b);return this._sendMessage(c,"success")},c.prototype.moderatorLowerHand=function(a,b,c){var d=this._messageBuilder.buildModeratorLowerHandRequest(a,b,c);return this._sendMessage(d,"success")},c.prototype.moderatorAdmission=function(a,b,c){var d=this._messageBuilder.buildModeratorAdmissionRequest(a,b,c);return this._sendMessage(d,"success")},c.prototype.sendAdmissionRequest=function(c,d){var e=b.Deferred(),f=this._messageBuilder.buildAdmissionRequest(c,d);return this._sendMessage(f,[a.Services.Conference.AdmissionResponseCode.SUCCESS,a.Services.Conference.AdmissionResponseCode.INCORRECT_PASSCODE_TRY_AGAIN,a.Services.Conference.AdmissionResponseCode.PENDING_APPROVAL,a.Services.Conference.AdmissionResponseCode.INCORRECT_PASSCODE_DISCONNECTING,a.Services.Conference.AdmissionResponseCode.REJECTED]).then(function(a){this._resolveAdmissionResponse(e,a)}.bind(this),function(a){e.reject(a)}),this.on(a.Providers.UCCP.UCCPMessageTypes.ADMISSION_RESPONSE,function(a){this._resolveAdmissionResponse(e,a)}.bind(this)),e.promise()},c.prototype._resolveAdmissionResponse=function(b,c){switch(c.responseCode){case a.Services.Conference.AdmissionResponseCode.SUCCESS:b.resolve(c);break;case a.Services.Conference.AdmissionResponseCode.INCORRECT_PASSCODE_DISCONNECTING:case a.Services.Conference.AdmissionResponseCode.REJECTED:case a.Services.Conference.AdmissionResponseCode.INCORRECT_PASSCODE_TRY_AGAIN:b.reject({name:"UCCPServerError",code:c.responseCode,message:"UCCP server responded with "+c.responseCode});break;case a.Services.Conference.AdmissionResponseCode.PENDING_APPROVAL:break;default:a.Base.Logger.warn(a.Base.LoggerTags.UCCP_CONFERENCE_PROVIDER,"Unknown response code received: {0}",c.responseCode)}},c.prototype.getDialInInfo=function(a){var b=this._messageBuilder.buildDialInInfoRequest(a);return this._sendMessage(b,"success")},c.prototype._sendMessage=function(a,c){var d=b.Deferred();return this._networkProvider.send(JSON.stringify(a)).then(function(a){this._resolveResponse(d,a,c)}.bind(this),function(a){d.reject(a)}),d.promise()},c.prototype._resolveResponse=function(a,b,c){var d;try{d=this._messageParser.parse(b)}catch(f){return void a.reject(f)}if(d&&d.responseCode&&(c.indexOf?c.indexOf(d.responseCode)>-1:d.responseCode===c))a.resolve(d);else{var e=400;b&&b.params&&b.params.responseCode&&(e=b.params.responseCode),a.reject({name:"UCCPServerError",code:e,message:"UCCP server responded with "+e})}},a.Providers.UCCP.AbstractUCCPProvider=c}(AvayaClientServices,jQuery),function(a,b){"use strict";function c(b,c,d){a.Providers.UCCP.AbstractUCCPProvider.call(this),this._networkProvider=b,this._config=void 0,this._messageBuilder=c,this._messageParser=d,this._networkRequestRetryHelper=void 0,this._reconnectCount=0,this._isReconnecting=!1,this._isStarted=!1,this._fallbackPromise=void 0,this._blackListedWords=["participantId","text","lecturerName","presenterName","participantName","videoPin","participantDisplayName"],this._failoverPingData={wsKeepAliveEnabled:!0,wsPingInterval:3e4,wsGeneratePingMessage:function(){var b=a.Base.Utils.makeId(32,"0123456789abcdef");this._failoverPingData.wsPingMessageRequestId=b;var c=this._messageBuilder.buildKeepaliveRequest(b);return JSON.stringify(c)}.bind(this),wsIsPongMessage:function(b){return a.Base.Utils.isDefined(b.name)&&b.name===a.Providers.UCCP.UCCPMessageTypes.KEEPALIVE_RESPONSE&&this._failoverPingData.wsPingMessageRequestId===b.params.transId}.bind(this),wsPingMessageRequestId:"",keepAliveAnswerWaitingTime:5e3}}c.prototype=Object.create(a.Providers.UCCP.AbstractUCCPProvider.prototype),c.prototype.start=function(c,d){this._config=c;var e=b.Deferred();this._networkProvider._onCredentialsRequired=this.onCredentialsRequired.bind(this),this._networkProvider.onOpen=function(){this._networkProvider.onClose=function(){e.reject()},this._networkProvider.isOpened()?(this._isReconnecting&&this.handleAfterReconnect(d),this._isStarted=!0,e.resolve()):this._waitForSocketConnection(this._networkProvider,function(){this._isReconnecting&&this.handleAfterReconnect(d),this._isStarted=!0,e.resolve()}.bind(this),function(a){e.reject("Failed to open")}.bind(this))}.bind(this),this._networkProvider.onClose=function(){e.reject()},this._networkProvider.onMessage=function(b){var c=JSON.parse(b.data),d=this._messageParser.parse(c);d instanceof a.Providers.UCCP.UCCPMessage&&(a.Base.Logger.debug(a.Base.LoggerTags.UCCP_CONFERENCE_PROVIDER,"Received message "+d.name),this.trigger(d.name,[d]))}.bind(this);var f={urlSuffix:"/uwd/ws",transactionIDLocation:"params.transId"};a.Base.Utils.queryJSONObject(c,"networkProviderConfiguration.webSocketConfig.query")&&c.networkProviderConfiguration.webSocketConfig.query.indexOf("ticket=")>-1&&(f.alreadyApplied=!0);var g=function(){return this._isReconnecting||d._conferenceService._isDisconnecting?b.Deferred().resolve().promise():(this._isReconnecting=!0,this.trigger(a.Providers.Interfaces.ConferenceCallbackIds.NETWORK_PROVIDER_IS_UNAVAILABLE),this._handleReconnect().dfdPromise.then(function(){this._isReconnecting=!1,this.handleAfterReconnect()}.bind(this)))}.bind(this);return this._networkRequestRetryHelper=new a.Base.NetworkRequestRetryHelper(function(){return this._networkProvider.start(c.networkProviderConfiguration,c.credentialProvider,f,this._networkRequestRetryHelper,g,this._failoverPingData)}.bind(this)),this._networkProvider.on(a.Base.NetworkProviderEvents.UNAUTHORIZED,function(){this.trigger(a.Base.NetworkProviderEvents.UNAUTHORIZED,[])}.bind(this)),this._networkProvider.on(a.Base.NetworkProviderEvents.AUTHORIZED,function(){this.trigger(a.Base.NetworkProviderEvents.AUTHORIZED,[])}.bind(this)),this._networkProvider.registerBlackList(this._blackListedWords),this._networkProvider.start(c.networkProviderConfiguration,c.credentialProvider,f,this._networkRequestRetryHelper,g,this._failoverPingData),e.promise()},c.prototype._waitForSocketConnection=function(a,b,c){var d=10,e=function(f){f<d?setTimeout(function(){a.isOpened()?b():e(f+1)}.bind(this),100):c("Max retry reached")};e(0)},c.prototype._handleReconnect=function(){var b=this._networkRequestRetryHelper.getRetryCallback();return this._fallbackPromise=a.Base.Utils.connectionBackoffAlgorithm(b),this._fallbackPromise},c.prototype.handleAfterReconnect=function(){this._fallbackPromise=void 0,this.trigger(a.Providers.Interfaces.ConferenceCallbackIds.NETWORK_PROVIDER_IS_AVAILABLE)},c.prototype.stop=function(){this._isStarted=!1,this._removeListeners(),a.Base.Utils.isDefined(this._fallbackPromise)&&this._fallbackPromise.cancel();var c=b.Deferred();return this._networkProvider.onClose=function(){c.resolve()},this._networkProvider.onError=function(a){c.reject(a)},this._networkProvider.close(),c.promise()},a.Providers.UCCP.UCCP1Provider=c}(AvayaClientServices,jQuery),function(a,b){"use strict";function c(){a.Providers.UCCP.AbstractUCCPProvider.call(this),this._config=void 0,this._providers=[],this._selectedProvider=void 0}c.prototype=Object.create(a.Providers.UCCP.AbstractUCCPProvider.prototype),c.prototype.start=function(a,c){return b.isEmptyObject(a)||this._config===a||(this._config=a),this._selectedProvider=this._determineServerVersion(),this._selectedProvider.start(a,c)},c.prototype.stop=function(){return this._selectedProvider?this._selectedProvider.stop():b.Deferred().reject().promise()},c.prototype._determineServerVersion=function(){return this._providers[0].provider},c.prototype.getSelectedProvider=function(){return this._selectedProvider},c.prototype.registerUCCPProvider=function(a,b){return this._providers.push({version:a,provider:b})},c.prototype.sendHandshake=function(a){return this._selectedProvider.sendHandshake(a)},c.prototype.subscribeMeetingInfo=function(a){return this._selectedProvider.subscribeMeetingInfo(a)},c.prototype.startRecording=function(a,b,c){return this._selectedProvider.startRecording(a,b,c)},c.prototype.stopRecording=function(a){return this._selectedProvider.stopRecording(a)},c.prototype.pauseRecording=function(a){return this._selectedProvider.pauseRecording(a)},c.prototype.resumeRecording=function(a){return this._selectedProvider.resumeRecording(a)},c.prototype.subscribeRoster=function(a){return this._selectedProvider.subscribeRoster(a)},c.prototype.subscribeActiveTalker=function(a){return this._selectedProvider.subscribeActiveTalker(a)},c.prototype.subscribePermissions=function(a){return this._selectedProvider.subscribePermissions(a)},c.prototype.subscribeSlider=function(a){return this._selectedProvider.subscribeSlider(a)},c.prototype.subscribeMeetingNote=function(a){return this._selectedProvider.subscribeMeetingNote(a)},c.prototype.subscribeWebCollab=function(a){return this._selectedProvider.subscribeWebCollab(a)},c.prototype.subscribeAvailableLayouts=function(a){return this._selectedProvider.subscribeAvailableLayouts(a)},c.prototype.raiseHand=function(a){return this._selectedProvider.raiseHand(a)},c.prototype.setAsLecturer=function(a,b){return this._selectedProvider.setAsLecturer(a,b)},c.prototype.unsetAsLecturer=function(a){return this._selectedProvider.unsetAsLecturer(a)},c.prototype.disconnectParticipant=function(a,b){return this._selectedProvider.disconnectParticipant(a,b)},c.prototype.setLocked=function(a,b){return this._selectedProvider.setLocked(a,b)},c.prototype.setVideoLayout=function(a,b){return this._selectedProvider.setVideoLayout(a,b)},c.prototype.setVideoLayoutSelfSee=function(a,b){return this._selectedProvider.setVideoLayoutSelfSee(a,b)},c.prototype.setVideoLayoutTextOverlay=function(a,b){return this._selectedProvider.setVideoLayoutTextOverlay(a,b)},c.prototype.getCurrentVideoLayout=function(a){return this._selectedProvider.getCurrentVideoLayout(a)},c.prototype.muteUnmute=function(a,b,c,d){return this._selectedProvider.muteUnmute(a,b,c,d)},c.prototype.controlRemoteCamera=function(a,b,c){return this._selectedProvider.controlRemoteCamera(a,b,c)},c.prototype.muteUnmuteAll=function(a,b){return this._selectedProvider.muteUnmuteAll(a,b)},c.prototype.sendLocalMuteEvent=function(a,b,c){return this._selectedProvider.sendLocalMuteEvent(a,b,c)},c.prototype.sendDisconnectEvent=function(a,b){return this._selectedProvider.sendDisconnectEvent(a,b)},c.prototype.terminateConference=function(a){return this._selectedProvider.terminateConference(a)},c.prototype.requestToBecomeModerator=function(a,b){return this._selectedProvider.requestToBecomeModerator(a,b)},c.prototype.signIn=function(a,b){return this._selectedProvider.signIn(a,b)},c.prototype.videoPin=function(a,b,c,d,e,f){return this._selectedProvider.videoPin(a,b,c,d,e,f)},c.prototype.extendMeeting=function(a,b){return this._selectedProvider.extendMeeting(a,b)},c.prototype.addParticipant=function(a,b){return this._selectedProvider.addParticipant(a,b)},c.prototype.cancelDialoutParticipant=function(a,b){return this._selectedProvider.cancelDialoutParticipant(a,b)},c.prototype.sendChatMessage=function(a,b,c){return this._selectedProvider.sendChatMessage(a,b,c)},c.prototype.raiseLowerHand=function(a,b){return this._selectedProvider.raiseLowerHand(a,b)},c.prototype.moderatorLowerHand=function(a,b,c){return this._selectedProvider.moderatorLowerHand(a,b,c)},c.prototype.sendAdmissionRequest=function(a,b){return this._selectedProvider.sendAdmissionRequest(a,b)},c.prototype.moderatorAdmission=function(a,b,c){return this._selectedProvider.moderatorAdmission(a,b,c)},c.prototype.getDialInInfo=function(a){return this._selectedProvider.getDialInInfo(a)},a.Providers.UCCP.UCCPProvider=c}(AvayaClientServices,jQuery),function(a){"use strict";function b(b,c,d,e){a.Providers.Interfaces.CollaborationProvider.call(this),this._networkProvider=b,this._wcsEventsParser=c,this._wcsBinaryParser=d,this._wcsMessageBuilder=e,this._config={}}b.prototype=Object.create(a.Providers.Interfaces.CollaborationProvider.prototype),b.prototype.onCredentialsRequired=function(b,c){var d;c&&c!==this._config.credentialProvider&&a.Base.Utils.deepMerge(this._config.credentialProvider,c),this._config.credentialProvider.onAuthenticationChallenge(d,function(a){this.onCredentialsRetrieved(a,b)}.bind(this))},b.prototype.onCredentialsRetrieved=function(a,b){},b.prototype.addShape=function(a){},b.prototype.addCircle=function(a){},b.prototype.getParticipants=function(){},b.prototype.discoverResources=function(){},b.prototype.run=function(){},a.Providers.WCS.AbstractWCSProvider=b}(AvayaClientServices),function(a,b){"use strict";function c(){a.Base.TransactionalWebSocketProvider.apply(this),this._transactionIDLocation="request_id"}c.prototype=Object.create(a.Base.TransactionalWebSocketProvider.prototype),c.prototype.getTransactionIDFromRequest=function(a,b){return!(void 0===a||a instanceof ArrayBuffer||a instanceof Blob)&&a.match(b+"=(\\w*)&?")[1]},c.prototype.getTransactionIDFromResponse=function(a,b){if(void 0===a)return!1;var c=this._getTransactionID(a,"response[0].live_session[0].request_id[0]._text"),d=this._getTransactionID(a,"response[0].live_event[0].request_id[0]._text"),e=this._getTransactionID(a,"response[0].live_attendees[0].request_id[0]._text");return d||c||e},c.prototype.parseRequest=function(a){return a},c.prototype.parseResponse=function(a){return b.parseString(a)},a.Providers.WCS.WCSTransactionalWebSocketProvider=c}(AvayaClientServices,xmlToJSON),function(a){"use strict";function b(b,c,d,e,f,g,h,i){a.Providers.WCS.AbstractWCSProvider.call(this,b,c,d,e),this._meetingId=void 0,this._wcsContentSharingHandler=f,this._wcsWhiteboardHandler=g,this._version="1.1",this._bytesReceivedLastSecond=0,this._notificationsProvider=h,this._resources=void 0,this._isWhiteboardActive=!1,this._isScreenSharingActive=!1,this._notificationPromise=void 0,this._discoveryBackoffDataObject=void 0,this._urlSuffixes={comet:{startLiveSession:"/wcsws/Comet/StartLiveSession",endLiveSession:"/wcsws/Comet/EndLiveSession",data:"/wcsws/Comet/Data"}},this._blackListedWords=["username","token","participant_id","meeting_id","fromname","sender_id","sender_name","from"],this._failoverPingData={wsKeepAliveEnabled:!0,wsPingInterval:3e4,wsGeneratePingMessage:function(){var b=a.Base.Utils.makeId(32,"0123456789abcdef");return this._failoverPingData.wsPingMessageRequestId=b,"live_ping?request_id="+b+"&ws_connection_id="+this._wsConnectionId}.bind(this),wsIsPongMessage:function(b){var c=a.Base.Utils.queryJSONObject(b,"response[0].live_ping[0]"),d=a.Base.Utils.queryJSONObject(b,"response[0].live_ping[0].request_id[0]._text"),e=a.Base.Utils.queryJSONObject(b,"response[0].live_ping[0].ws_connection_id[0]._text");return a.Base.Utils.isDefined(c)&&this._failoverPingData.wsPingMessageRequestId===d&&this._wsConnectionId===e}.bind(this),wsPingMessageRequestId:"",keepAliveAnswerWaitingTime:5e3},this._isShutdown=!1,this._wsConnectionId="",this._supportedFeatures={},this._supportedFeatures[a.Services.Collaboration.FeaturesAvailable.LIBRARY]=!1,this._supportedFeatures[a.Services.Collaboration.FeaturesAvailable.POLLING]=!1,this._supportedFeatures[a.Services.Collaboration.FeaturesAvailable.MINUTES]=!1,this._supportedFeatures[a.Services.Collaboration.FeaturesAvailable.WHITEBOARD]=!1,this._supportedFeatures[a.Services.Collaboration.FeaturesAvailable.MESSAGES]=!1,this._supportedFeatures[a.Services.Collaboration.FeaturesAvailable.REPORTS]=!1,this._supportedFeatures[a.Services.Collaboration.FeaturesAvailable.SCREEN_SHARING]=!1,this._supportedFeatures[a.Services.Collaboration.FeaturesAvailable.SLIDER]=!1,this._supportedFeatures[a.Services.Collaboration.FeaturesAvailable.REMOTE_CONTROL]=!1,this._colaborationsAnalyticsService=i,this._serverCapabilities={}}b.prototype=Object.create(a.Providers.WCS.AbstractWCSProvider.prototype),b.prototype.start=function(a,b){var c=$.Deferred();return this._isShutdown=!1,this._config=a,this._meetingId=b,this._credentials=void 0,this._participant=void 0,this._networkProvider._onCredentialsRequired=this._onCredentialsRequired.bind(this),this._networkProvider.onOpen=function(){c.resolve()},this._networkProvider.registerBlackList(this._blackListedWords),this._networkProvider.start(a.networkProviderConfiguration,a.credentialProvider),c.promise()},b.prototype.stop=function(){var b=$.Deferred();return this._isShutdown=!0,a.Base.Utils.isDefined(this._discoveryBackoffDataObject)&&(this._discoveryBackoffDataObject.cancel(),this._discoveryBackoffDataObject=void 0),this._notificationsProvider.onClose=function(){this._colaborationsAnalyticsService.sendStopEvent(!0),b.resolve()}.bind(this),this._notificationsProvider.onError=function(c){this._colaborationsAnalyticsService.sendStopEvent(!1),this._colaborationsAnalyticsService.sendFailureStopEvent(a.Services.Collaboration.CollaborationErrorReason.COLLABORATION_STOP_FAILURE),b.reject(new a.Services.Collaboration.CollaborationError(a.Services.Collaboration.CollaborationErrorReason.COLLABORATION_STOP_FAILURE,c))}.bind(this),this._notificationsProvider.close(),b.promise()},b.prototype.pause=function(){var a=this._wcsMessageBuilder.buildPauseMessage(),b=$.Deferred();return this._notificationsProvider.send(a),b.resolve(),b.promise()},b.prototype.resume=function(){var a=this._wcsMessageBuilder.buildResumeMessage(),b=$.Deferred();return this._notificationsProvider.send(a),b.resolve(),b.promise()},b.prototype._getFullUrlSuffix=function(a){return this._config.networkProviderConfiguration.restConfig&&this._config.networkProviderConfiguration.restConfig.path?this._config.networkProviderConfiguration.restConfig.path+a:a},b.prototype._getCometDataUrlSuffix=function(){return this._getFullUrlSuffix(this._urlSuffixes.comet.data)},b.prototype._sendLiveSession=function(){var b=Date.now(),c={urlSuffix:this._getFullUrlSuffix(this._urlSuffixes.comet.startLiveSession)},d=a.Base.Utils.makeId(32,"abcdefgijklmnopqrstuvwxyz0123456789"),e="live_session?token="+this._credentials.token+"&brand="+this._resources.brandId+"&meeting_id="+this._meetingId+"&participant_id="+this._credentials.participantId+"&username="+this._credentials.username+"&last_event_offset=0&local_time="+b+"&ejected=false&session_id="+this._credentials.sessionId+"&remote_control_enabled=false&webserver_id=1000&private_chat_enabled=true&user_agent="+navigator.userAgent+"&client_version=PC;WebCollab;local_version&request_id="+d;return this._notificationsProvider.send(e,c)},b.prototype._onCredentialsRequired=function(b,c,d){if(a.Base.Utils.isUndefined(this._credentials)){var e;d&&d!==this._config.credentialProvider&&a.Base.Utils.deepMerge(this._config.credentialProvider,d),this._config.credentialProvider.onAuthenticationChallenge(e,function(a){this._onCredentialsRetrieved(a,c)}.bind(this))}},b.prototype._onCredentialsRetrieved=function(a,b){this._credentials=a},b.prototype.observeCollaboration=function(b){this._networkProvider.on(a.Base.NetworkProviderEvents.UNAUTHORIZED,function(){(a.Base.Utils.isUndefined(b._isAvailable)||b._isAvailable)&&(b._isAvailable=!1,b._onCollaborationServiceUnavailableCallbacks.fire(b))}.bind(this)),this._notificationsProvider.on(a.Base.NetworkProviderEvents.UNAUTHORIZED,function(){(a.Base.Utils.isUndefined(b._isAvailable)||b._isAvailable)&&(b._isAvailable=!1,b._onCollaborationServiceUnavailableCallbacks.fire(b))}.bind(this)),this._notificationsProvider.on(a.Base.NetworkProviderEvents.AUTHORIZED,function(){!a.Base.Utils.isUndefined(b._isAvailable)&&b._isAvailable||(b._isAvailable=!0,b._onCollaborationServiceAvailableCallbacks.fire(b))}.bind(this)),this._networkProvider.on(a.Base.NetworkProviderEvents.AUTHORIZED,function(){!a.Base.Utils.isUndefined(b._isAvailable)&&b._isAvailable||(b._isAvailable=!0,b._onCollaborationServiceAvailableCallbacks.fire(b))}.bind(this));var c={urlSuffix:this._getCometDataUrlSuffix()};this._notificationsProvider.run(c),this._notificationsProvider.onMessage=function(a){var c=[];if(a.data instanceof ArrayBuffer)this._updateReceivingBitrate(a.data.byteLength),c.push(this._wcsBinaryParser.parse(a.data));else for(var d=this._wcsEventsParser.parse(a.data),e=d.length,f=0;f<e;f++)c.push(d[f]);for(var g=c.length,h=0;h<g;h++)this._delegateEvent(c[h],b)}.bind(this)},b.prototype.startDrawShape=function(a,b){var c={urlSuffix:this._getCometDataUrlSuffix()},d=this._wcsMessageBuilder.buildStartDrawShapeMessage(a,b,this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._notificationsProvider.send(d,c).then(this._getEventIdFromResponse)},b.prototype._discoverResourcesFnc=function(){var a=this._wcsMessageBuilder.buildResourceDiscoveryMessage(this._credentials.mode,this._meetingId,this._credentials.participantId,this._credentials.username,this._credentials.token),b={urlSuffix:this._getFullUrlSuffix("/viewer/rest/live_viewer/"),method:"POST"};return this._networkProvider.send(a,b)},b.prototype.discoverResources=function(b){return this._discoveryBackoffDataObject=a.Base.Utils.connectionBackoffAlgorithm(this._discoverResourcesFnc.bind(this)),this._discoveryBackoffDataObject.dfdPromise.then(this._parseResources.bind(this)).then(function(){return this._discoveryBackoffDataObject=void 0,this._startNotificationProvider(b)}.bind(this))},b.prototype._parseResources=function(a){var b=this._wcsEventsParser.parse(a);return this._resources=b[0].data,this._resources},b.prototype._startNotificationProvider=function(b){var c=$.Deferred();this._notificationPromise||(this._notificationPromise=c),this._notificationsProvider.onOpen=function(){this._sendLiveSession().done(function(c){var d=a.Base.Utils.queryJSONObject(c,"response[0].live_session[0].live_attendee[0].attendee_id[0]._text");if(d){var e=a.Base.Utils.queryJSONObject(c,"response[0].live_session[0].live_attendee[0].user_name[0]._text");this._participant=new a.Services.Collaboration.Participant(d,e)}this._wsConnectionId=a.Base.Utils.queryJSONObject(c,"response[0].live_session[0].ws_connection_id[0]._text");for(var f=a.Base.Utils.queryJSONObject(c,"response[0].live_session[0].features[0].feature"),g=f.length-1;g>=0;g--){var h=a.Base.Utils.queryJSONObject(f[g],"type[0]._text");a.Base.Utils.isDefined(a.Services.Collaboration.FeaturesAvailable[h])&&(this._supportedFeatures[h]=a.Base.Utils.queryJSONObject(f[g],"enabled[0]._text"))}this._notificationPromise&&(this._notificationPromise.resolve(this._participant),this._notificationPromise=void 0),b._isAvailable||(b._isAvailable=!0,b._onCollaborationServiceAvailableCallbacks.fire())}.bind(this)).fail(function(d){c.reject(new a.Services.Collaboration.CollaborationError(a.Services.Collaboration.CollaborationErrorReason.COLLABORATION_START_FAILURE,d)),b._isAvailable&&(b._isAvailable=!1,b._onCollaborationServiceUnavailableCallbacks.fire())}.bind(this))}.bind(this),this._notificationsProvider._onCredentialsRequired=this._onCredentialsRequired.bind(this),this._notificationsProvider.onClose=function(){this._isShutdown||(b._isAvailable&&(b._isAvailable=!1,b._onCollaborationServiceUnavailableCallbacks.fire(b)),this._notificationPromise&&(this._notificationPromise.reject(new a.Services.Collaboration.CollaborationError(a.Services.Collaboration.CollaborationErrorReason.COLLABORATION_NOTIFICATIONS_CHANNEL_FAILED)),this._notificationPromise=void 0)),a.Base.Logger.info(a.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"Socket was closed")}.bind(this),this._notificationsProvider.onError=function(d){a.Base.Logger.info(a.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"Error on socket: ",d),c.reject(new a.Services.Collaboration.CollaborationError(a.Services.Collaboration.CollaborationErrorReason.COLLABORATION_START_FAILURE,d)),b._isAvailable&&(b._isAvailable=!1,b._onCollaborationServiceUnavailableCallbacks.fire(b))},this._notificationsProvider.onMessage=function(b){a.Base.Logger.warn(a.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"WCS sent some events before the live session response:",b,"These events will not be parsed.")};var d=new a.Config.ServerInfo(this._config.networkProviderConfiguration.restConfig.hostName,this._config.networkProviderConfiguration.restConfig.port,this._config.networkProviderConfiguration.restConfig.isSecure),e=new a.Config.ServerInfo(this._config.networkProviderConfiguration.restConfig.hostName,this._config.networkProviderConfiguration.restConfig.port,this._config.networkProviderConfiguration.restConfig.isSecure,this._getFullUrlSuffix("/"+this._resources.websocketPath)),f=function(){var c=$.Deferred();return b._isStopped||this._isShutdown?c.resolve().promise():(b._isAvailable&&(b._isAvailable=!1,b._onCollaborationServiceUnavailableCallbacks.fire(b)),this._discoveryBackoffDataObject=a.Base.Utils.connectionBackoffAlgorithm(this._discoverResourcesFnc.bind(this)),this._discoveryBackoffDataObject.dfdPromise.then(this._parseResources.bind(this)).then(function(){return this._discoveryBackoffDataObject=void 0,this._startNotificationProvider(b).then(function(){this.observeCollaboration(b),c.resolve()}.bind(this),function(){c.reject()})}.bind(this)),c.promise())}.bind(this),g=new a.Config.NetworkProviderConfiguration(d,e);return this._notificationsProvider.registerBlackList(this._blackListedWords),this._notificationsProvider.start(g,this._config.credentialProvider,void 0,void 0,f,this._failoverPingData).fail(function(){this._notificationPromise.reject(new a.Services.Collaboration.CollaborationError(a.Services.Collaboration.CollaborationErrorReason.COLLABORATION_NOTIFICATIONS_CHANNEL_FAILED)),this._notificationPromise=void 0}.bind(this)),c.promise()},b.prototype.liveDrawShape=function(a,b){var c,d={urlSuffix:this._getCometDataUrlSuffix()},e=a._getPointsToSend();return e&&e[0]&&e[0].isMove?(c=this._wcsMessageBuilder.buildFirstPointLiveDrawShapeMessage(e[0].point,this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName()),a._markPointsAsSent(1)):(c=this._wcsMessageBuilder.buildLiveDrawShapeMessage(e,b,this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName()),a._markPointsAsSent(a.getPoints().length)),this._notificationsProvider.send(c,d).then(this._getEventIdFromResponse)},b.prototype.endDrawShape=function(a,b){var c={urlSuffix:this._getCometDataUrlSuffix()},d=this._wcsMessageBuilder.buildEndDrawShapeMessage(a,b,this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._notificationsProvider.send(d,c).then(this._getEventIdFromResponse)},b.prototype.addShape=function(a,b){var c={urlSuffix:this._getCometDataUrlSuffix()},d=this._wcsMessageBuilder.buildDrawShapeMessage(a,b,this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._notificationsProvider.send(d,c).then(this._getEventIdFromResponse)},b.prototype.moveSelection=function(a,b,c){var d={urlSuffix:this._getCometDataUrlSuffix()},e=this._wcsMessageBuilder.buildMoveSelectionMessage(a,b,c.getX(),c.getY(),this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._notificationsProvider.send(e,d).then(this._getEventIdFromResponse)},b.prototype._updateReceivingBitrate=function(a){this._bytesReceivedLastSecond+=a,setTimeout(function(){this._bytesReceivedLastSecond-=a}.bind(this),1e3)},b.prototype.getReceivingBitrate=function(){return 8*this._bytesReceivedLastSecond},b.prototype.addCircle=function(a,b){var c={urlSuffix:this._getCometDataUrlSuffix()},d=this._wcsMessageBuilder.buildDrawCircleMessage(a,b,this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._notificationsProvider.send(d,c).then(this._getEventIdFromResponse)},b.prototype.addText=function(a,b){var c={urlSuffix:this._getCometDataUrlSuffix()},d=this._wcsMessageBuilder.buildDrawTextMessage(a,b,this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._notificationsProvider.send(d,c).then(this._getEventIdFromResponse)},b.prototype.startScreenSharing=function(){var a={urlSuffix:this._getCometDataUrlSuffix()},b=this._wcsMessageBuilder.buildStartScreenSharingMessage(this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._isWhiteboardActive?this.endWhiteboard().then(function(){return this._notificationsProvider.send(b,a)}.bind(this)):this._notificationsProvider.send(b,a)},b.prototype.stopScreenSharing=function(){var a={urlSuffix:this._getCometDataUrlSuffix()},b=this._wcsMessageBuilder.buildStopScreenSharingMessage(this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._notificationsProvider.send(b,a)},b.prototype.pauseScreenSharing=function(){var a={urlSuffix:this._getCometDataUrlSuffix()},b=this._wcsMessageBuilder.buildPauseScreenSharingMessage(this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._notificationsProvider.send(b,a)},b.prototype.sendLiveEvent=function(a){var b={urlSuffix:this._getCometDataUrlSuffix()},c=this._wcsMessageBuilder.buildLiveEventMessage(a,this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._notificationsProvider.send(c,b)},b.prototype.sendMessage=function(a){var b={urlSuffix:this._getCometDataUrlSuffix()};return this._notificationsProvider.send(a,b)},b.prototype.getBufferedAmount=function(){return this._notificationsProvider.getBufferedAmount()},b.prototype.startWhiteboard=function(a){var b={urlSuffix:this._getCometDataUrlSuffix()},c=this._wcsMessageBuilder.buildStartWhiteboardMessage(this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName(),a);return this._isScreenSharingActive?this.stopScreenSharing().then(function(){return this._notificationsProvider.send(c,b)}.bind(this)):this._notificationsProvider.send(c,b)},b.prototype.endWhiteboard=function(){var a={urlSuffix:this._getCometDataUrlSuffix()},b=this._wcsMessageBuilder.buildEndWhiteboardMessage(this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._notificationsProvider.send(b,a)},b.prototype.addWhiteboardSurface=function(){var a={urlSuffix:this._getCometDataUrlSuffix()},b=this._wcsMessageBuilder.buildAddWhiteboardMessage(this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._notificationsProvider.send(b,a)},b.prototype.removeWhiteboardSurface=function(a){var b={urlSuffix:this._getCometDataUrlSuffix()},c=this._wcsMessageBuilder.buildRemoveWhiteboardMessage(a,this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._notificationsProvider.send(c,b)},b.prototype.removeShape=function(a,b,c){var d={urlSuffix:this._getCometDataUrlSuffix()},e=this._wcsMessageBuilder.buildDeleteSelectionMessage(a,b,c.getX(),c.getY(),this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._notificationsProvider.send(e,d)},b.prototype.clearContent=function(a){var b={urlSuffix:this._getCometDataUrlSuffix()},c=this._wcsMessageBuilder.buildClearContentMessage(a,this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._notificationsProvider.send(c,b)},b.prototype.getParticipants=function(){var b={urlSuffix:this._getCometDataUrlSuffix()},c=this._wcsMessageBuilder.buildGetParticipantsMessage(!1);return this._notificationsProvider.send(c,b).then(function(b){for(var c=[],d=this._wcsEventsParser.parse(b),e=0;e<d[0].data.liveAttendees.length;e++){var f=a.Base.Utils.queryJSONObject(d[0],"data.liveAttendees["+e+"].attendeeId"),g=a.Base.Utils.queryJSONObject(d[0],"data.liveAttendees["+e+"].userName");c.push(new a.Services.Collaboration.Participant(f,g))}return c}.bind(this))},b.prototype.isOpened=function(){return this._notificationsProvider.isOpened()},b.prototype.isFeatureAvailable=function(a){
return!!this._supportedFeatures[a]&&this._supportedFeatures[a]},b.prototype._delegateEvent=function(b,c){if(!a.Base.Utils.isUndefined(b)&&!a.Base.Utils.isUndefined(b.type))switch(b.type){case a.Providers.WCS.WCSScreenSharingTagTypes.CURSOR_TAG:this._wcsContentSharingHandler.updateCursor(c,b);break;case a.Providers.WCS.WCSScreenSharingTagTypes.START_TAG:case a.Providers.WCS.WCSScreenSharingTagTypes.BLOCK_TAG:case a.Providers.WCS.WCSScreenSharingTagTypes.END_TAG:this._wcsContentSharingHandler.updateFrame(c,b);break;case a.Providers.WCS.WCSEventTypes.START_SCREEN_SHARING:this._isScreenSharingActive=!0,this._wcsContentSharingHandler.startScreenSharing(c,b);break;case a.Providers.WCS.WCSEventTypes.PAUSE_SCREEN_SHARING:this._wcsContentSharingHandler.pauseScreenSharing(c,b);break;case a.Providers.WCS.WCSEventTypes.END_SCREEN_SHARING:this._isScreenSharingActive=!1,this._wcsContentSharingHandler.endScreenSharing(c,b);break;case a.Providers.WCS.WCSEventTypes.FRAME_REPORT:this._wcsContentSharingHandler.frameReport(c,b);break;case a.Providers.WCS.WCSEventTypes.SERVER_CAPABILITIES:this._serverCapabilities=b.data,this.trigger(a.Providers.Interfaces.CollaborationProviderCallbackIds.SERVER_CAPABILITIES,[b.data]);break;case a.Providers.WCS.WCSEventTypes.START_WHITEBOARD:this._isWhiteboardActive=!0,this._wcsWhiteboardHandler.startWhiteboard(c,b);break;case a.Providers.WCS.WCSEventTypes.ADD_WHITEBOARD:this._wcsWhiteboardHandler.addWhiteboard(c,b);break;case a.Providers.WCS.WCSEventTypes.END_WHITEBOARD:this._isWhiteboardActive=!1,this._wcsWhiteboardHandler.endWhiteboard(c,b);break;case a.Providers.WCS.WCSEventTypes.DELETE_WHITEBOARD:this._wcsWhiteboardHandler.deleteWhiteboard(c,b);break;case a.Providers.WCS.WCSEventTypes.START_DRAW_SHAPE:this._wcsWhiteboardHandler.startDrawShape(c,b);break;case a.Providers.WCS.WCSEventTypes.DRAW_SHAPE:this._wcsWhiteboardHandler.drawShape(c,b);break;case a.Providers.WCS.WCSEventTypes.END_DRAW_SHAPE:this._wcsWhiteboardHandler.endDrawShape(c,b);break;case a.Providers.WCS.WCSEventTypes.DRAW_CIRCLE:this._wcsWhiteboardHandler.drawCircle(c,b);break;case a.Providers.WCS.WCSEventTypes.MOVE_SELECTION:this._wcsWhiteboardHandler.moveSelection(c,b);break;case a.Providers.WCS.WCSEventTypes.DRAW_TEXT:this._wcsWhiteboardHandler.drawText(c,b);break;case a.Providers.WCS.WCSEventTypes.DELETE_SELECTION:this._wcsWhiteboardHandler.deleteSelection(c,b);break;case a.Providers.WCS.WCSEventTypes.CLEAR_DRAWING:this._wcsWhiteboardHandler.clearDrawing(c,b);break;default:a.Base.Logger.warn(a.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"Unknown event type received: {0}",b.type)}},b.prototype._getEventIdFromResponse=function(b){return a.Base.Utils.queryJSONObject(b,"response[0].live_event[0].event_id[0]._text")},b.prototype.getServerCapabilities=function(){return this._serverCapabilities},a.Providers.WCS.WCSv1_1Provider=b}(AvayaClientServices),function(a,b){"use strict";var c={addOnRemoteVideoAddedCallback:function(a){this._remoteVideoAddedCallbacks.add(a)},removeOnRemoteVideoAddedCallback:function(a){this._remoteVideoAddedCallbacks.remove(a)},addOnRemoteVideoRemovedCallback:function(a){this._remoteVideoRemovedCallbacks.add(a)},removeOnRemoteVideoRemovedCallback:function(a){this._remoteVideoRemovedCallbacks.remove(a)},addOnCallVideoChannelsUpdatedCallback:function(a){this._onCallVideoChannelsUpdatedCallback.add(a)},removeOnCallVideoChannelsUpdatedCallback:function(a){this._onCallVideoChannelsUpdatedCallback.remove(a)},addOnCallStartedCallback:function(a){this._onCallStartedCallbacks.add(a)},removeOnCallStartedCallback:function(a){this._onCallStartedCallbacks.remove(a)},addOnCallRemoteAlertingCallback:function(a){this._onCallRemoteAlertingCallbacks.add(a)},removeOnCallRemoteAlertingCallback:function(a){this._onCallRemoteAlertingCallbacks.remove(a)},addOnCallRedirectedCallback:function(a){this._onCallRedirectedCallbacks.add(a)},removeOnCallRedirectedCallback:function(a){this._onCallRedirectedCallbacks.remove(a)},addOnCallQueuedCallback:function(a){this._onCallQueuedCallbacks.add(a)},removeOnCallQueuedCallback:function(a){this._onCallQueuedCallbacks.remove(a)},addOnCallIgnoredCallback:function(a){this._onCallIgnoredCallbacks.add(a)},removeOnCallIgnoredCallback:function(a){this._onCallIgnoredCallbacks.remove(a)},addOnCallEstablishedCallback:function(a){this._onCallEstablishedCallbacks.add(a)},removeOnCallEstablishedCallback:function(a){this._onCallEstablishedCallbacks.remove(a)},addOnCallEstablishingCallback:function(a){this._onCallEstablishingCallbacks.add(a)},removeOnCallEstablishingCallback:function(a){this._onCallEstablishingCallbacks.remove(a)},addOnCallRemoteAddressChangedCallback:function(a){this._onCallRemoteAddressChangedCallbacks.add(a)},removeOnCallRemoteAddressChangedCallback:function(a){this._onCallRemoteAddressChangedCallbacks.remove(a)},addOnCallHeldCallback:function(a){this._onCallHeldCallbacks.add(a)},removeOnCallHeldCallback:function(a){this._onCallHeldCallbacks.remove(a)},addOnCallUnheldCallback:function(a){this._onCallUnheldCallbacks.add(a)},removeOnCallUnheldCallback:function(a){this._onCallUnheldCallbacks.remove(a)},addOnCallHeldRemotelyCallback:function(a){this._onCallHeldRemotelyCallbacks.add(a)},removeOnCallHeldRemotelyCallback:function(a){this._onCallHeldRemotelyCallbacks.remove(a)},addOnCallUnheldRemotelyCallback:function(a){this._onCallUnheldRemotelyCallbacks.add(a)},removeOnCallUnheldRemotelyCallback:function(a){this._onCallUnheldRemotelyCallbacks.remove(a)},addOnCallJoinedCallback:function(a){this._onCallJoinedCallbacks.add(a)},removeOnCallJoinedCallback:function(a){this._onCallJoinedCallbacks.remove(a)},addOnCallEndedCallback:function(a){this._onCallEndedCallbacks.add(a)},removeOnCallEndedCallback:function(a){this._onCallEndedCallbacks.remove(a)},addOnCallAudioMuteStatusChangedCallback:function(a){this._onCallAudioMuteStatusChangedCallbacks.add(a)},removeOnCallAudioMuteStatusChangedCallback:function(a){this._onCallAudioMuteStatusChangedCallbacks.remove(a)},addOnCallSpeakerMuteStatusChangedCallback:function(a){this._onCallSpeakerMuteStatusChangedCallbacks.add(a)},removeOnCallSpeakerMuteStatusChangedCallback:function(a){this._onCallSpeakerMuteStatusChangedCallbacks.remove(a)},addOnCallIncomingVideoAddRequestReceivedCallback:function(a){this._onCallIncomingVideoAddRequestReceivedCallbacks.add(a)},removeOnCallIncomingVideoAddRequestReceivedCallback:function(a){this._onCallIncomingVideoAddRequestReceivedCallbacks.remove(a)},addOnCallIncomingVideoAddRequestAcceptedCallback:function(a){this._onCallIncomingVideoAddRequestAcceptedCallbacks.add(a)},removeOnCallIncomingVideoAddRequestAcceptedCallback:function(a){this._onCallIncomingVideoAddRequestAcceptedCallbacks.remove(a)},addOnCallIncomingVideoAddRequestDeniedCallback:function(a){this._onCallIncomingVideoAddRequestDeniedCallbacks.add(a)},removeOnCallIncomingVideoAddRequestDeniedCallback:function(a){this._onCallIncomingVideoAddRequestDeniedCallbacks.remove(a)},addOnCallIncomingVideoAddRequestTimedOutCallback:function(a){this._onCallIncomingVideoAddRequestTimedOutCallbacks.add(a)},removeOnCallIncomingVideoAddRequestTimedOutCallback:function(a){this._onCallIncomingVideoAddRequestTimedOutCallbacks.remove(a)},addOnCallVideoRemovedRemotelyCallback:function(a){},removeOnCallVideoRemovedRemotelyCallback:function(a){},addOnCallConferenceStatusChangedCallback:function(a){this._onCallConferenceStatusChangedCallbacks.add(a)},removeOnCallConferenceStatusChangedCallback:function(a){this._onCallConferenceStatusChangedCallbacks.remove(a)},addOnParticipantDroppedCallback:function(a){this._participantDroppedCallbacks.add(a)},removeOnParticipantDroppedCallback:function(a){this._participantDroppedCallbacks.remove(a)},addOnCallFailedCallback:function(a){this._callFailedCallbacks.add(a)},removeOnCallFailedCallback:function(a){this._callFailedCallbacks.remove(a)},addOnCallServiceAvailableCallback:function(a){this._callServiceAvailableCallbacks.add(a)},removeOnCallServiceAvailableCallback:function(a){this._callServiceAvailableCallbacks.remove(a)},addOnCallServiceUnavailableCallback:function(a){this._callServiceUnavailableCallbacks.add(a)},removeOnCallServiceUnavailableCallback:function(a){this._callServiceUnavailableCallbacks.remove(a)},addOnAnswerCallRequestedCallback:function(a){this._answerCallRequestedCallbacks.add(a)},removeOnAnswerCallRequestedCallback:function(a){this._answerCallRequestedCallbacks.remove(a)},addOnUpdateCallRequestedCallback:function(a){this._updateCallRequestedCallbacks.add(a)},removeOnUpdateCallRequestedCallback:function(a){this._updateCallRequestedCallbacks.remove(a)},addOnTerminateCallRequestedCallback:function(a){this._terminateCallRequestedCallbacks.add(a)},removeOnTerminateCallRequestedCallback:function(a){this._terminateCallRequestedCallbacks.remove(a)},_addOnCallStateChangedCallback:function(a){this._callStateChangedCallBacks.add(a)},_removeOnCallStateChangedCallback:function(a){this._callStateChangedCallBacks.remove(a)}};b.extend(a.Services.Call.Call.prototype,c)}(window.AvayaClientServices=window.AvayaClientServices||{},jQuery=jQuery||{}),function(a){"use strict";var b={getHoldCapability:function(){return this._holdCapability},getUnholdCapability:function(){return this._unholdCapability},getJoinCapability:function(){return this._joinCapability},getMuteCapability:function(){return this._muteCapability},getUnmuteCapability:function(){return this._unmuteCapability},getMuteSpeakerCapability:function(){return this._muteSpeakerCapability},getUnmuteSpeakerCapability:function(){return this._unmuteSpeakerCapability},getSendDTMFCapability:function(){return this._sendDTMFCapability},getTransferCapability:function(){return this._transferCapability},getTransferToCapability:function(){return this._transferToCapability},getUpdateVideoChannelsCapability:function(){return this._videoChannelsCapability},getUpdateVideoModeSendReceiveCapability:function(){return this._updateVideoModeSendReceiveCapability},getUpdateVideoModeSendOnlyCapability:function(){return this._updateVideoModeSendOnlyCapability},getUpdateVideoModeReceiveOnlyCapability:function(){return this._updateVideoModeReceiveOnlyCapability},getUpdateVideoModeInactiveCapability:function(){return this._updateVideoModeInactiveCapability},getUpdateVideoModeDisableCapability:function(){return this._updateVideoModeDisableCapability}};$.extend(a.Services.Call.Call.prototype,b)}(window.AvayaClientServices=window.AvayaClientServices||{}),function(a,b){"use strict";var c={addOnCallsServiceAvailableCallback:function(a){this._callsServiceAvailableCallbacks.add(a)},removeOnCallsServiceAvailableCallback:function(a){this._callsServiceAvailableCallbacks.remove(a)},addOnCallsServiceUnavailableCallback:function(a){this._callsServiceUnavailableCallbacks.add(a)},removeOnCallsServiceUnavailableCallback:function(a){this._callsServiceUnavailableCallbacks.remove(a)},addOnCallCreatedCallback:function(a){this._callCreatedCallbacks.add(a)},removeOnCallCreatedCallback:function(a){this._callCreatedCallbacks.remove(a)},addOnCallRemovedCallback:function(a){this._callRemovedCallbacks.add(a)},removeOnCallRemovedCallback:function(a){this._callRemovedCallbacks.remove(a)},addOnIncomingCallCallback:function(a){this._incomingCallCallbacks.add(a)},removeOnIncomingCallCallback:function(a){this._incomingCallCallbacks.remove(a)},addOnUndeliveredCallCallback:function(a){this._undeliveredCallCallbacks.add(a)},removeOnUndeliveredCallCallback:function(a){this._undeliveredCallCallbacks.remove(a)},addOnRingbackToneURLsChangedCallback:function(a){this._onRingbackToneURLsChangedCallback.add(a)},removeOnRingbackToneURLsChangedCallback:function(a){this._onRingbackToneURLsChangedCallback.remove(a)},addOnMakeCallRequestedCallback:function(a){this._makeCallRequestedCallbacks.add(a)},removeOnMakeCallRequestedCallback:function(a){this._makeCallRequestedCallbacks.remove(a)}};b.extend(a.Services.Call.Calls.prototype,c)}(window.AvayaClientServices=window.AvayaClientServices||{},jQuery=jQuery||{}),function(a){"use strict";var b={addOnCollaborationStartedCallback:function(a){this._onCollaborationStartedCallbacks.add(a)},removeOnCollaborationStartedCallback:function(a){this._onCollaborationStartedCallbacks.remove(a)},addOnCollaborationEndedCallback:function(a){this._onCollaborationEndedCallbacks.add(a)},removeOnCollaborationEndedCallback:function(a){this._onCollaborationEndedCallbacks.remove(a)},addOnCollaborationServiceAvailableCallback:function(a){this._onCollaborationServiceAvailableCallbacks.add(a)},removeOnCollaborationServiceAvailableCallback:function(a){this._onCollaborationServiceAvailableCallbacks.remove(a)},addOnCollaborationServiceUnavailableCallback:function(a){this._onCollaborationServiceUnavailableCallbacks.add(a)},removeOnCollaborationServiceUnavailableCallback:function(a){this._onCollaborationServiceUnavailableCallbacks.remove(a)},addOnCollaborationNearEndByEjectCallback:function(a){this._onCollaborationNearEndByEjectCallbacks.add(a)},removeOnCollaborationNearEndByEjectCallback:function(a){this._onCollaborationNearEndByEjectCallbacks.remove(a)},addOnCollaborationPresenterPrivilegeChangedCallback:function(a){this._onCollaborationPresenterPrivilegeChangedCallbacks.add(a)},removeOnCollaborationPresenterPrivilegeChangedCallback:function(a){this._onCollaborationPresenterPrivilegeChangedCallbacks.remove(a)},addOnCollaborationModeratorPrivilegeChangedCallback:function(a){this._onCollaborationModeratorPrivilegeChangedCallbacks.add(a)},removeOnCollaborationModeratorPrivilegeChangedCallback:function(a){this._onCollaborationModeratorPrivilegeChangedCallbacks.remove(a)},addOnCollaborationInitializedCallback:function(a){this._onCollaborationInitializedCallbacks.add(a)},removeOnCollaborationInitializedCallback:function(a){this._onCollaborationInitializedCallbacks.remove(a)}};$.extend(a.Services.Collaboration.Collaboration.prototype,b)}(AvayaClientServices),function(a){"use strict";var b={getChatCapability:function(){return this._chatCapability},_recalculateChatCapability:function(){var b,c,d=this._isAvailable,e=this._collaborationService.isFeatureSupported(this,a.Services.Collaboration.FeaturesAvailable.MESSAGES);d&&e&&this._isBrowserAllowed()?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._chatCapability._updateIfChanged(b,c)},getMeetingMinutesCapability:function(){return this._meetingMinutesCapability},_recalculateMeetingMinutesCapability:function(){var b,c,d=this._isAvailable,e=this._collaborationService.isFeatureSupported(this,a.Services.Collaboration.FeaturesAvailable.MINUTES);d&&e&&this._isBrowserAllowed()?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._meetingMinutesCapability._updateIfChanged(b,c)},getContentSharingCapability:function(){return this._contentSharingCapability},_recalculateContentSharingCapability:function(){var b,c,d=this._isAvailable,e=this._contentSharing.getShareApplicationWindowCapability(),f=this._collaborationService.isFeatureSupported(this,a.Services.Collaboration.FeaturesAvailable.SCREEN_SHARING),g=a.Base.FeatureSupported.isBrowserSharingAvailable();d&&g&&e.isAllowed&&f?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):g?g&&!e.isAllowed&&e.denialReason===a.Base.CapabilityDenialReason.CAPABILITY_NOT_INSTALLED?(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_INSTALLED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._contentSharingCapability._updateIfChanged(b,c)},getNetworkLibraryCapability:function(){return this._networkLibraryCapability},_recalculateNetworkLibraryCapability:function(){var b,c,d=this._isAvailable,e=this._collaborationService.isFeatureSupported(this,a.Services.Collaboration.FeaturesAvailable.LIBRARY);d&&e&&this._isBrowserAllowed()?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._networkLibraryCapability._updateIfChanged(b,c)},getLibrarySharingCapability:function(){return this._librarySharingCapability},_recalculateLibrarySharingCapability:function(){var b,c,d=this._isAvailable,e=this._collaborationService.isFeatureSupported(this,a.Services.Collaboration.FeaturesAvailable.LIBRARY);d&&e&&this._isBrowserAllowed()?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._librarySharingCapability._updateIfChanged(b,c)},getWhiteboardCapability:function(){return this._whiteboardCapability},_recalculateWhiteboardCapability:function(){var b,c,d=this._isAvailable,e=this._collaborationService.isFeatureSupported(this,a.Services.Collaboration.FeaturesAvailable.WHITEBOARD);d&&e&&this._isBrowserAllowed()?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._whiteboardCapability._updateIfChanged(b,c)},getRetrieveParticipantListCapability:function(){return this._retrieveParticipantListCapability},_recalculateRetrieveParticipantListCapability:function(){var b,c;this._isAvailable&&this._isBrowserAllowed()?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._retrieveParticipantListCapability._updateIfChanged(b,c)},_isBrowserAllowed:function(){return!0}};$.extend(a.Services.Collaboration.Collaboration.prototype,b)}(AvayaClientServices),function(a,b){"use strict";var c={addOnContentSharingStartedCallback:function(a){this._onContentSharingStartedCallbacks.add(a)},removeOnContentSharingStartedCallback:function(a){this._onContentSharingStartedCallbacks.remove(a)},addOnContentSharingEndedCallback:function(a){this._onContentSharingEndedCallbacks.add(a)},removeOnContentSharingEndedCallback:function(a){this._onContentSharingEndedCallbacks.remove(a)},addOnContentSharingPausedCallback:function(a){this._onContentSharingPausedCallbacks.add(a)},removeOnContentSharingPausedCallback:function(a){this._onContentSharingPausedCallbacks.remove(a)},addOnContentSharingResumedCallback:function(a){this._onContentSharingResumedCallbacks.add(a)},removeOnContentSharingResumedCallback:function(a){this._onContentSharingResumedCallbacks.remove(a)},addOnCursorReceivedCallback:function(a){this._onCursorReceivedCallbacks.add(a)},removeOnCursorReceivedCallback:function(a){this._onCursorReceivedCallbacks.remove(a)},addOnFrameChangedCallback:function(a){this._onFrameChangedCallbacks.add(a)},removeOnFrameChangedCallback:function(a){this._onFrameChangedCallbacks.remove(a)},addOnFrameReceivedCallback:function(a){this._onFrameReceivedCallbacks.add(a)},removeOnFrameReceivedCallback:function(a){this._onFrameReceivedCallbacks.remove(a)},addOnFrameReportReceivedCallbacks:function(a){this._onFrameReportReceivedCallbacks.add(a)},removeOnFrameReportReceivedCallbacks:function(a){this._onFrameReportReceivedCallbacks.remove(a)}};b.extend(a.Services.Collaboration.ContentSharing.prototype,c)}(AvayaClientServices,jQuery),function(a,b){"use strict";var c={getShareApplicationWindowCapability:function(){return this._shareApplicationWindowCapability},_recalculateShareApplicationWindowCapability:function(){var b,c,d=this._contentSharingService.getShareApplicationWindowCapability(),e=this._contentSharingService.isOpened(),f=this._contentSharingService.isFeatureAvailable(a.Services.Collaboration.FeaturesAvailable.SCREEN_SHARING),g=a.Base.Utils.isDefined(this._collaborations._activeContentSharing)&&this._getCollaborations()._activeContentSharing!==this,h=a.Base.FeatureSupported.isBrowserSharingAvailable();h&&d.isAllowed&&e&&f?g?(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):h?h&&!d.isAllowed?(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_INSTALLED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._shareApplicationWindowCapability._updateIfChanged(b,c)},getShareFullScreenCapability:function(){return this._shareFullScreenCapability},_recalculateShareFullScreenCapability:function(){var b,c,d=this._contentSharingService.getShareFullScreenCapability(),e=this._contentSharingService.isOpened(),f=this._contentSharingService.isFeatureAvailable(a.Services.Collaboration.FeaturesAvailable.SCREEN_SHARING),g=a.Base.Utils.isDefined(this._collaborations._activeContentSharing)&&this._getCollaborations()._activeContentSharing!==this,h=a.Base.FeatureSupported.isBrowserSharingAvailable();h&&d.isAllowed&&e&&f?g?(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):h?h&&!d.isAllowed?(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_INSTALLED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._shareFullScreenCapability._updateIfChanged(b,c)},getSupportRemoteControlCapability:function(){},getRequestRemoteControlCapability:function(){}};b.extend(a.Services.Collaboration.ContentSharing.prototype,c)}(AvayaClientServices,jQuery),function(a){"use strict";function b(b,c,d,e){this._id=a.Base.Utils.makeId(10,"0123456789"),this._color=d,this._width=e,this._translation=void 0,this._status=a.Services.Collaboration.SelectionStatus.PENDING,this._isMine=c,this._ownerDisplayName=b,this._finished=!1}b.prototype={getId:function(){return this._id},setId:function(a){this._id=a},getColor:function(){return this._color},getWidth:function(){return this._width},getOwnerDisplayName:function(){return this._ownerDisplayName},getTranslation:function(){return this._translation},setTranslation:function(a){this._translation=a},getStatus:function(){return this._status},isMine:function(){return this._isMine},isFinished:function(){return this._finished},finishDrawing:function(){return this._finished=!0,$.when(this._finished)}},a.Base.AOPTools.addAdvices(b,"AbstractShape",["finishDrawing"],[a.Base.AOPCommonAdvices.LOG_COLLABORATION_API_CALLS,a.Base.AOPCommonAdvices.WRAP_CAUGHT_COLLABORATION_ERROR]),a.Services.Collaboration.AbstractShape=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d,e,f,g,h,i){a.Services.Collaboration.AbstractShape.call(this,d,f,g,i),this._topLeft=b,this._bottomRight=c,this._filled=e||!1,this._alpha=h||100}b.prototype=Object.create(a.Services.Collaboration.AbstractShape.prototype),b.prototype.getTopLeft=function(){return this._topLeft},b.prototype.setTopLeft=function(a){this._topLeft=a},b.prototype.getBottomRight=function(){return this._bottomRight},b.prototype.setBottomRight=function(a){this._bottomRight=a},b.prototype.isFilled=function(){return this._filled},b.prototype.getAlpha=function(){return this._alpha},a.Services.Collaboration.Circle=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d,e,f,g){a.Services.Collaboration.AbstractShape.call(this,b,d,e,g),this._filled=c||!1,this._finished=!1,this._sentPointsPos=0,this._points=[],this._alpha=f||100,this._onShapeFinished=void 0,this._readyToSendCallbacks=$.Callbacks(),this._throttlingInterval=100}b.prototype=Object.create(a.Services.Collaboration.AbstractShape.prototype),b.prototype._addPoint=function(a,b){var c=(new Date).getTime();this._points.push({isMove:a,point:b,_timestamp:c}),0===this._getSentPointsCount()?this._readyToSendCallbacks.fire():c-this._points[this._getSentPointsCount()-1]._timestamp>this._throttlingInterval&&this._readyToSendCallbacks.fire()},b.prototype.addMovePoint=function(a){this._addPoint(!0,a)},b.prototype.addLinePoint=function(a){this._addPoint(!1,a)},b.prototype.finishDrawing=function(){return this._finished=!0,a.Base.Utils.isDefined(this._onShapeFinished)?this._onShapeFinished():$.when(this._finished)},b.prototype.getPoints=function(){return this._points},b.prototype.updatePoints=function(a){for(var b=0;b<a.length;b++)this._points.push(a[b])},b.prototype.isFilled=function(){return this._filled},b.prototype.setFilled=function(a){this._filled=a},b.prototype._hasPointsToSend=function(){return this._sentPointsPos!==this._points.length},b.prototype._getPointsToSend=function(){return this._points.slice(this._sentPointsPos)},b.prototype._markPointsAsSent=function(a){this._sentPointsPos=a},b.prototype._getSentPointsCount=function(){return this._sentPointsPos},b.prototype.getAlpha=function(){return this._alpha},a.Base.AOPTools.addAdvices(b,"Shape",["addMovePoint","updatePoints"],[a.Base.AOPCommonAdvices.LOG_COLLABORATION_API_CALLS]),a.Base.AOPTools.addAdvices(b,"Shape",["finishDrawing"],[a.Base.AOPCommonAdvices.LOG_COLLABORATION_API_CALLS,a.Base.AOPCommonAdvices.WRAP_CAUGHT_COLLABORATION_ERROR]),a.Services.Collaboration.Shape=b}(AvayaClientServices),function(a){"use strict";function b(b,c,d,e,f,g,h){a.Services.Collaboration.AbstractShape.call(this,d,f,g,h),this._content=b,this._filled=e||!1,this._fontSize=c,this._position=void 0}b.prototype=Object.create(a.Services.Collaboration.AbstractShape.prototype),b.prototype.getPosition=function(){return this._position},b.prototype.setPosition=function(a){this._position=a},b.prototype.getContent=function(){return this._content},b.prototype.getFontSize=function(){return this._fontSize},a.Services.Collaboration.WhiteboardText=b}(AvayaClientServices),function(a){"use strict";var b={addOnWhiteboardStartedCallback:function(a){this._onWhiteboardStartedCallbacks.add(a)},removeOnWhiteboardStartedCallback:function(a){this._onWhiteboardStartedCallbacks.remove(a)},addOnWhiteboardEndedCallback:function(a){this._onWhiteboardEndedCallbacks.add(a)},removeOnWhiteboardEndedCallback:function(a){this._onWhiteboardEndedCallbacks.remove(a)},addOnWhiteboardSurfaceAddedCallback:function(a){this._onWhiteboardSurfaceAddedCallbacks.add(a)},removeOnWhiteboardSurfaceAddedCallback:function(a){this._onWhiteboardSurfaceAddedCallbacks.remove(a)},addOnWhiteboardSurfaceRemovedCallback:function(a){this._onWhiteboardSurfaceRemovedCallbacks.add(a)},removeOnWhiteboardSurfaceRemovedCallback:function(a){this._onWhiteboardSurfaceRemovedCallbacks.remove(a)},addOnWhiteboardSurfaceSetActiveCallback:function(a){this._onWhiteboardSurfaceSetActiveCallbacks.add(a)},removeOnWhiteboardSurfaceSetActiveCallback:function(a){this._onWhiteboardSurfaceSetActiveCallbacks.remove(a)}};$.extend(a.Services.Collaboration.Whiteboard.prototype,b)}(AvayaClientServices),function(a,b){"use strict";var c={getRemoveWhiteboardCapability:function(){return this._removeWhiteboardCapability},_recalculateRemoveWhiteboardCapability:function(){var b,c;this._surfaces.length>1?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeWhiteboardCapability._updateIfChanged(b,c)},getDrawingCapability:function(){return this._drawingCapability},_recalculateDrawingCapability:function(b){var c,d,e=b._isAvailable,f=b._collaborationService.isFeatureSupported(b,a.Services.Collaboration.FeaturesAvailable.WHITEBOARD);e&&f&&b._isBrowserAllowed()?(c=!0,d=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(c=!1,d=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._drawingCapability._updateIfChanged(c,d)}};b.extend(a.Services.Collaboration.Whiteboard.prototype,c)}(AvayaClientServices,jQuery),function(a,b){"use strict";var c={addOnShapeAddedCallback:function(a){this._onShapeAddedCallbacks.add(a)},removeOnShapeAddedCallback:function(a){this._onShapeAddedCallbacks.remove(a)},addOnShapeUpdatedCallback:function(a){this._onShapeUpdatedCallbacks.add(a)},removeOnShapeUpdatedCallback:function(a){this._onShapeUpdatedCallbacks.remove(a)},addOnShapeDeletedCallback:function(a){this._onShapeDeletedCallbacks.add(a)},removeOnShapeDeletedCallback:function(a){this._onShapeDeletedCallbacks.remove(a)},addOnSurfaceClearedCallback:function(a){this._onSurfaceClearedCallbacks.add(a)},removeOnSurfaceClearedCallback:function(a){this._onSurfaceClearedCallbacks.remove(a)}};b.extend(a.Services.Collaboration.WhiteboardSurface.prototype,c)}(AvayaClientServices,jQuery),function(a){"use strict";function b(b,c){a.Services.Conference.Participant.call(this,b,c),this._participantURI="",this._remoteDisplayName="",this._applicationActive=!1,this._handRaised=!1,this._moderator=!1,this._presenter=!1,this._lecturer=!1,this._audioStatus=a.Services.Conference.ParticipantMediaState.MEDIA_STATUS_NO_MEDIA,this._videoStatus=a.Services.Conference.ParticipantMediaState.MEDIA_STATUS_NO_MEDIA,this._connectionStatus=a.Services.Conference.ParticipantConnectionStatus.CONNECTION_STATUS_UNKNOWN,this._disconnectionReason=void 0,this._audioId=void 0,this._videoId=void 0,this._lastSpokenTime=void 0,this._joinTime=void 0,this._lastSpokenTime=void 0,this._leaveTimeStamp=void 0,this._audioFromParticipant="",this._audioToParticipant="",this._userId="",this._sourceID="",this._feccRecvSupport=!1,this._videoFromParticipant="",this._videoToParticipant="",this._contentFromParticipant="",this._contentToParticipant="",this._canLecture=!1,this._role="",this._isVideoBlocked=!1,this._isAudioMuted=!1,this._isSelfParticipant=!1,this._status="",this._onParticipantCollaborationStatusChangedCallbacks=$.Callbacks(),this._onParticipantConnectionStatusChangedCallbacks=$.Callbacks(),this._onParticipantSetAsModeratorCallbacks=$.Callbacks(),this._onParticipantUnsetAsModeratorCallbacks=$.Callbacks(),this._onParticipantSetAsLecturerCallbacks=$.Callbacks(),this._onParticipantUnsetAsLecturerCallbacks=$.Callbacks(),this._onParticipantSetAsPresenterCallbacks=$.Callbacks(),this._onParticipantUnsetAsPresenterCallbacks=$.Callbacks(),this._onParticipantAudioStatusChangedCallbacks=$.Callbacks(),this._onParticipantVideoStatusChangedCallbacks=$.Callbacks(),this._onParticipantActiveTalkerStatusChangedCallbacks=$.Callbacks(),this._onParticipantHandRaisedCallbacks=$.Callbacks(),this._onParticipantHandLoweredCallbacks=$.Callbacks()}b.prototype=Object.create(a.Services.Conference.Participant.prototype),b.prototype.controlRemoteCamera=function(a){return this._participantService.controlRemoteCamera(this,a)},b.prototype.mute=function(){return this._participantService.mute(this)},b.prototype.unmute=function(){return this._participantService.unmute(this)},b.prototype.blockVideo=function(){return this._participantService.blockVideo(this)},b.prototype.unblockVideo=function(){return this._participantService.unblockVideo(this)},b.prototype.lowerHand=function(a){return this._participantService.lowerHand(this,a)},b.prototype.setAsLecturer=function(){return this._participantService.setAsLecturer(this)},b.prototype.unsetAsLecturer=function(){return this._participantService.unsetAsLecturer()},b.prototype.isHandRaised=function(){return this._handRaised},b.prototype.getJoinTime=function(){return this._joinTime},b.prototype.getLastSpokenTime=function(){return this._lastSpokenTime},b.prototype.isVideoBlocked=function(){return this._isVideoBlocked},b.prototype.isAudioMuted=function(){return this._isAudioMuted},b.prototype.isModerator=function(){return this._role===a.Services.Conference.ParticipantRole.MODERATOR},b.prototype.getParticipantAudioStatus=function(){return this._audioFromParticipant},b.prototype.getParticipantVideoStatus=function(){return this._videoFromParticipant},b.prototype.isLecturer=function(){return this._lecturer},b.prototype.isPresenter=function(){return this._presenter},b.prototype.getFeccRecvSupport=function(){return this._feccRecvSupport},b.prototype.getContentToParticipant=function(){return this._contentToParticipant},b.prototype.getContentFromParticipant=function(){return this._contentFromParticipant},b.prototype.getParticipantConnectionStatus=function(){return this._connectionStatus},a.Base.AOPTools.addAdvices(b,"ActiveParticipant",["controlRemoteCamera","mute","unmute","blockVideo","unblockVideo","lowerHand","setAsLecturer","unsetAsLecturer"],[a.Base.AOPCommonAdvices.LOG_CONFERENCE_API_CALLS,a.Base.AOPCommonAdvices.WRAP_CAUGHT_CONFERENCE_ERROR]),a.Services.Conference.ActiveParticipant=b
}(AvayaClientServices),function(a){"use strict";var b={addOnChatMessageReceivedCallback:function(a){this._onChatMessageReceivedCallbacks.add(a)},removeOnChatMessageReceivedCallback:function(a){this._onChatMessageReceivedCallbacks.remove(a)},addOnChatServiceAvailableCallback:function(a){this._onChatServiceAvailableCallbacks.add(a)},removeOnChatServiceAvailableCallback:function(a){this._onChatServiceAvailableCallbacks.remove(a)},addOnChatServiceUnavailableCallback:function(a){this._onChatServiceUnavailableCallbacks.add(a)},removeOnChatServiceUnavailableCallback:function(a){this._onChatServiceUnavailableCallbacks.remove(a)}};$.extend(a.Services.Conference.Chat.prototype,b)}(AvayaClientServices),function(a){"use strict";var b={addOnConferenceLockStatusChangedCallback:function(a){this._onConferenceLockStatusChangedCallbacks.add(a)},removeOnConferenceLockStatusChangedCallback:function(a){this._onConferenceLockStatusChangedCallbacks.remove(a)},addOnConferenceDisplayVideoParticipantNameChangedCallback:function(a){this._onConferenceDisplayVideoParticipantNameChangedCallbacks.add(a)},removeOnConferenceDisplayVideoParticipantNameChangedCallback:function(a){this._onConferenceDisplayVideoParticipantNameChangedCallbacks.remove(a)},addOnConferenceVideoSelfSeeChangedCallback:function(a){this._onConferenceVideoSelfSeeChangedCallbacks.add(a)},removeOnConferenceVideoSelfSeeChangedCallback:function(a){this._onConferenceVideoSelfSeeChangedCallbacks.remove(a)},addOnConferenceVideoLayoutChangedCallback:function(a){this._onConferenceVideoLayoutChangedCallbacks.add(a)},removeOnConferenceVideoLayoutChangedCallback:function(a){this._onConferenceVideoLayoutChangedCallbacks.remove(a)},addOnConferenceDisplayParticipantNameOnVideoAllowedCallback:function(a){this._onConferenceDisplayParticipantNameOnVideoAllowedCallbacks.add(a)},removeOnConferenceDisplayParticipantNameOnVideoAllowedCallback:function(a){this._onConferenceDisplayParticipantNameOnVideoAllowedCallbacks.remove(a)},addOnConferenceVideoSelfSeeAllowedCallback:function(a){this._onConferenceVideoSelfSeeAllowedCallbacks.add(a)},removeOnConferenceVideoSelfSeeAllowedCallback:function(a){this._onConferenceVideoSelfSeeAllowedCallbacks.remove(a)},addOnConferenceVideoPinAllowedCallback:function(a){this._onConferenceVideoPinAllowedCallbacks.add(a)},removeOnConferenceVideoPinAllowedCallback:function(a){this._onConferenceVideoPinAllowedCallbacks.remove(a)},addOnConferenceAvailableVideoLayoutsChangedCallback:function(a){this._onConferenceAvailableVideoLayoutsChangedCallbacks.add(a)},removeOnConferenceAvailableVideoLayoutsChangedCallback:function(a){this._onConferenceAvailableVideoLayoutsChangedCallbacks.remove(a)},addOnConferenceContinuationStatusChangedCallback:function(a){this._onConferenceContinuationStatusChangedCallbacks.add(a)},removeOnConferenceContinuationStatusChangedCallback:function(a){this._onConferenceContinuationStatusChangedCallbacks.remove(a)},addOnConferenceRecordingStatusChangedCallback:function(a){this._onConferenceRecordingStatusChangedCallbacks.add(a)},removeOnConferenceRecordingStatusChangedCallback:function(a){this._onConferenceRecordingStatusChangedCallbacks.remove(a)},addOnConferenceRecordingFailedCallbacks:function(a){this._onConferenceRecordingFailedCallbacks.add(a)},removeOnConferenceRecordingFailedCallbacks:function(a){this._onConferenceRecordingFailedCallbacks.remove(a)},addOnConferenceVideoStatusChangedCallback:function(a){this._onConferenceVideoStatusChangedCallbacks.add(a)},removeOnConferenceVideoStatusChangedCallback:function(a){this._onConferenceVideoStatusChangedCallbacks.remove(a)},addOnConferenceLectureModeStatusChangedCallback:function(a){this._onConferenceLectureModeStatusChangedCallbacks.add(a)},removeOnConferenceLectureModeStatusChangedCallback:function(a){this._onConferenceLectureModeStatusChangedCallbacks.remove(a)},addOnConferenceStreamingStatusChangedCallback:function(a){this._onConferenceStreamingStatusChangedCallbacks.add(a)},removeOnConferenceStreamingStatusChangedCallback:function(a){this._onConferenceStreamingStatusChangedCallbacks.remove(a)},addOnConferenceEncryptionStatusChangedCallback:function(a){this._onConferenceEncryptionStatusChangedCallbacks.add(a)},removeOnConferenceEncryptionStatusChangedCallback:function(a){this._onConferenceEncryptionStatusChangedCallbacks.remove(a)},addOnConferenceMeetingTerminationTimeChangedCallback:function(a){this._onConferenceMeetingTerminationTimeChangedCallbacks.add(a)},removeOnConferenceMeetingTerminationTimeChangedCallback:function(a){this._onConferenceMeetingTerminationTimeChangedCallbacks.remove(a)},addOnConferenceMeetingTerminationInProgressCallbacks:function(a){this._onConferenceMeetingTerminationInProgressCallbacks.add(a)},removeOnConferenceMeetingTerminationInProgressCallbacks:function(a){this._onConferenceMeetingTerminationInProgressCallbacks.remove(a)},addOnConferenceEntryExitToneChangedCallback:function(a){this._onConferenceEntryExitToneChangedCallbacks.add(a)},removeOnConferenceEntryExitToneChangedCallback:function(a){this._onConferenceEntryExitToneChangedCallbacks.remove(a)},addOnConferencePresentationModeStatusChangedCallback:function(a){this._onConferencePresentationModeStatusChangedCallbacks.add(a)},removeOnConferencePresentationModeStatusChangedCallback:function(a){this._onConferencePresentationModeStatusChangedCallbacks.remove(a)},addOnConferenceActiveTalkersChangedCallback:function(a){this._onConferenceActiveTalkersChangedCallbacks.add(a)},removeOnConferenceActiveTalkersChangedCallback:function(a){this._onConferenceActiveTalkersChangedCallbacks.remove(a)},addOnConferenceActiveVideoParticipantsChangedCallback:function(a){this._onConferenceActiveVideoParticipantsChangedCallbacks.add(a)},removeOnConferenceActiveVideoParticipantsChangedCallback:function(a){this._onConferenceActiveVideoParticipantsChangedCallbacks.remove(a)},addOnConferenceAllParticipantsMutedCallback:function(a){this._onConferenceAllParticipantsMutedCallbacks.add(a)},removeOnConferenceAllParticipantsMutedCallback:function(a){this._onConferenceAllParticipantsMutedCallbacks.remove(a)},addOnConferenceAllParticipantsUnmutedCallback:function(a){this._onConferenceAllParticipantsUnmutedCallbacks.add(a)},removeOnConferenceAllParticipantsUnmutedCallback:function(a){this._onConferenceAllParticipantsUnmutedCallbacks.remove(a)},addOnConferencePendingParticipantCallback:function(a){this._onConferencePendingParticipantCallbacks.add(a)},removeOnConferencePendingParticipantCallback:function(a){this._onConferencePendingParticipantCallbacks.remove(a)},addOnConferencePendingParticipantRemovedCallback:function(a){this._onConferencePendingParticipantRemovedCallbacks.add(a)},removeOnConferencePendingParticipantRemovedCallback:function(a){this._onConferencePendingParticipantRemovedCallbacks.remove(a)},addOnConferenceDroppedParticipantAddedCallback:function(a){this._onConferenceDroppedParticipantAddedCallbacks.add(a)},removeOnConferenceDroppedParticipantAddedCallback:function(a){this._onConferenceDroppedParticipantAddedCallbacks.remove(a)},addOnConferenceDroppedParticipantRemovedCallback:function(a){this._onConferenceDroppedParticipantRemovedCallbacks.add(a)},removeOnConferenceDroppedParticipantRemovedCallback:function(a){this._onConferenceDroppedParticipantRemovedCallbacks.remove(a)},addOnConferenceServiceAvailableCallback:function(a){this._onConferenceServiceAvailableCallbacks.add(a)},removeOnConferenceServiceAvailableCallback:function(a){this._onConferenceServiceAvailableCallbacks.remove(a)},addOnConferenceServiceUnavailableCallback:function(a){this._onConferenceServiceUnavailableCallbacks.add(a)},removeOnConferenceServiceUnavailableCallback:function(a){this._onConferenceServiceUnavailableCallbacks.remove(a)},addOnConferenceParticipantsAddedCallback:function(a){this._onConferenceParticipantsAddedCallbacks.add(a)},removeOnConferenceParticipantsAddedCallback:function(a){this._onConferenceParticipantsAddedCallbacks.remove(a)},addOnConferenceParticipantsRemovedCallback:function(a){this._onConferenceParticipantsRemovedCallbacks.add(a)},removeOnConferenceParticipantsRemovedCallback:function(a){this._onConferenceParticipantsRemovedCallbacks.remove(a)},addOnConferenceSubjectCallback:function(a){this._onConferenceSubjectChangedCallbacks.add(a)},removeOnConferenceSubjectCallback:function(a){this._onConferenceSubjectChangedCallbacks.remove(a)},addOnConferenceCollaborationURIChangedCallback:function(a){this._onConferenceCollaborationURIChangedCallbacks.add(a)},removeOnConferenceCollaborationURIChangedCallback:function(a){this._onConferenceCollaborationURIChangedCallbacks.remove(a)},addOnConferenceStartingCallback:function(a){this._onConferenceStartingCallbacks.add(a)},removeOnConferenceStartingCallback:function(a){this._onConferenceStartingCallbacks.remove(a)},addOnConferenceWaitingToStartCallback:function(a){this._onConferenceWaitingToStartCallbacks.add(a)},removeOnConferenceWaitingToStartCallback:function(a){this._onConferenceWaitingToStartCallbacks.remove(a)},addOnConferenceConnectionEndedCallbacks:function(a){this._onConferenceConnectionEndedCallbacks.add(a)},removeOnConferenceConnectionEndedCallbacks:function(a){this._onConferenceConnectionEndedCallbacks.remove(a)}};$.extend(a.Services.Conference.Conference.prototype,b)}(AvayaClientServices),function(a){"use strict";var b={getSupportInConferenceChatCapability:function(){},getSupportMeetingMinutesCapability:function(){return this._supportMeetingMinutesCapability},getModerateConferenceCapability:function(){return this._moderateConferenceCapability},_recalculateModerateConferenceCapability:function(){var b,c;this._isAvailable&&a.Base.Utils.isDefined(this._selfParticipant)&&this._selfParticipant.isModerator()?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._moderateConferenceCapability._updateIfChanged(b,c)},getActiveTalkerCapability:function(){return this._activeTalkerCapability},_recalculateActiveTalkerCapability:function(){var b,c;this._isUccpConference?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._activeTalkerCapability._updateIfChanged(b,c)},getMuteSelfAudioCapability:function(){return this._muteSelfAudioCapability},_recalculateMuteSelfAudioCapability:function(){var b,c;this._isUccpConference&&a.Base.Utils.isDefined(this._selfParticipant)?this._selfParticipant._audioFromParticipant===a.Services.Conference.MediaFromParticipantStatus.NA?(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._muteSelfAudioCapability._updateIfChanged(b,c)},getUnmuteSelfAudioCapability:function(){return this._unmuteSelfAudioCapability},_recalculateUnmuteSelfAudioCapability:function(){var b,c;this._isUccpConference&&a.Base.Utils.isDefined(this._selfParticipant)?this._selfParticipant._audioFromParticipant===a.Services.Conference.MediaFromParticipantStatus.NA?(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._unmuteSelfAudioCapability._updateIfChanged(b,c)},getTerminateConferenceCapability:function(){return this._terminateConferenceCapability},_recalculateTerminateConferenceCapability:function(){var b,c;this._isAvailable&&a.Base.Utils.isDefined(this._selfParticipant)&&this._selfParticipant.isModerator()?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._terminateConferenceCapability._updateIfChanged(b,c)},getUpdateLockStatusCapability:function(){return this._setLockCapability},_recalculateSetLockCapability:function(){var b,c;this._isAvailable&&a.Base.Utils.isDefined(this._selfParticipant)&&this._selfParticipant.isModerator()?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._setLockCapability._updateIfChanged(b,c)},getStartRecordingCapability:function(){return this._startRecordingCapability},getStopRecordingCapability:function(){return this._stopRecordingCapability},getPauseRecordingCapability:function(){return this._pauseRecordingCapability},getResumeRecordingCapability:function(){return this._resumeRecordingCapability},_recalculateStartStopRecordingCapability:function(){var b,c,d;this._isAvailable&&a.Base.Utils.isDefined(this._selfParticipant)&&a.Base.Utils.isDefined(this._recorderStatus)&&a.Base.Utils.isDefined(this._recordingPermissions)?this._recordingPermissions===a.Services.Conference.PermissionStatus.NOT_ALLOWED||this._recorderStatus===a.Services.Conference.RecorderStatus.NONE?(b=!1,c=!1,d=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):this._recordingPermissions===a.Services.Conference.PermissionStatus.NEED_MODERATOR?(b=!1,c=!1,d=a.Base.CapabilityDenialReason.CAPABILITY_NEED_MODERATOR):this._recordingPermissions===a.Services.Conference.PermissionStatus.NEED_SIGNIN?(b=!1,c=!1,d=a.Base.CapabilityDenialReason.CAPABILITY_NEED_SIGNIN):this._recordingPermissions===a.Services.Conference.PermissionStatus.NEED_SIGNIN_OR_MODERATOR?(b=!1,c=!1,d=a.Base.CapabilityDenialReason.CAPABILITY_NEED_SIGNIN_OR_MODERATOR):(d=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED,this.isRecordingActive()?(b=!1,c=!0):(b=!0,c=!1)):(b=!1,c=!1,d=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._startRecordingCapability._updateIfChanged(b,d),this._stopRecordingCapability._updateIfChanged(c,d)},_recalculatePauseResumeRecordingCapability:function(){var b,c,d;this._isAvailable&&a.Base.Utils.isDefined(this._selfParticipant)&&a.Base.Utils.isDefined(this._recorderStatus)&&a.Base.Utils.isDefined(this._recordingPermissions)?this._recordingPermissions===a.Services.Conference.PermissionStatus.NOT_ALLOWED||this._recorderStatus!==a.Services.Conference.RecorderStatus.WITH_PAUSE?(b=!1,c=!1,d=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):this._recordingPermissions===a.Services.Conference.PermissionStatus.NEED_MODERATOR?(b=!1,c=!1,d=a.Base.CapabilityDenialReason.CAPABILITY_NEED_MODERATOR):this._recordingPermissions===a.Services.Conference.PermissionStatus.NEED_SIGNIN?(b=!1,c=!1,d=a.Base.CapabilityDenialReason.CAPABILITY_NEED_SIGNIN):this._recordingPermissions===a.Services.Conference.PermissionStatus.NEED_SIGNIN_OR_MODERATOR?(b=!1,c=!1,d=a.Base.CapabilityDenialReason.CAPABILITY_NEED_SIGNIN_OR_MODERATOR):(d=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED,this.isRecordingActive()?this.isRecordingPaused()?(b=!1,c=!0):(b=!0,c=!1):(b=!1,c=!1)):(b=!1,c=!1,d=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._pauseRecordingCapability._updateIfChanged(b,d),this._resumeRecordingCapability._updateIfChanged(c,d)},getSupportRaiseHandCapability:function(){return this._raiseHandSupportCapability},_recalculateRaiseHandSupportCapability:function(){var b,c;this._isAvailable&&a.Base.Utils.isDefined(this._selfParticipant)&&this._selfParticipant._audioFromParticipant!==a.Services.Conference.MediaFromParticipantStatus.NA?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._raiseHandSupportCapability._updateIfChanged(b,c)},getSupportLowerHandCapability:function(){return this._lowerHandSupportCapability},_recalculateLowerHandSupportCapability:function(){var b,c;this._isAvailable&&a.Base.Utils.isDefined(this._selfParticipant)&&this._selfParticipant._audioFromParticipant!==a.Services.Conference.MediaFromParticipantStatus.NA?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._lowerHandSupportCapability._updateIfChanged(b,c)},getRetrieveParticipantListCapability:function(){return this._retrieveParticipantListCapability},_recalculateRetrieveParticipantListCapability:function(){var b,c;this._isAvailable&&a.Base.Utils.isDefined(this._selfParticipant)?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._retrieveParticipantListCapability._updateIfChanged(b,c)},getMuteAllParticipantsCapability:function(){return this._muteUnmuteAllCapability},getUnmuteAllParticipantsCapability:function(){return this._muteUnmuteAllCapability},_recalculateMuteUnmuteAllCapability:function(){var b,c;this._isAvailable&&a.Base.Utils.isDefined(this._selfParticipant)&&this._selfParticipant.isModerator()?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._muteUnmuteAllCapability._updateIfChanged(b,c)},getChangeParticipantRoleCapability:function(){},getUpdateDisplayVideoParticipantNameCapability:function(){return this._setDisplayVideoParticipantNameCapability},_recalculateDisplayVideoParticipantNameCapability:function(){var b,c;this._isAvailable&&a.Base.Utils.isDefined(this._selfParticipant)&&a.Base.Utils.isDefined(this._isVideoParticipantNameDisplayChangeAllowed)?this._isVideoParticipantNameDisplayChangeAllowed?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._setDisplayVideoParticipantNameCapability._updateIfChanged(b,c)},getUpdateVideoSelfSeeCapability:function(){return this._setVideoSelfSeeCapability},_recalculateVideoSelfSeeCapability:function(){var b,c;this._isAvailable&&a.Base.Utils.isDefined(this._selfParticipant)&&a.Base.Utils.isDefined(this._isVideoSelfSeeChangeAllowed)?this._isVideoSelfSeeChangeAllowed?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._setVideoSelfSeeCapability._updateIfChanged(b,c)},getUpdateVideoLayoutCapability:function(){return this._setVideoLayoutCapability},_recalculateSetVideoLayoutCapability:function(){var b,c;if(this._isAvailable&&a.Base.Utils.isDefined(this._selfParticipant)&&a.Base.Utils.isDefined(this._currentVideoLayout)&&a.Base.Utils.isDefined(this._supportedVideoLayouts)){b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED;for(var d=0;d<this._supportedVideoLayouts.length;++d)if(this._supportedVideoLayouts[d].geometry===this._currentVideoLayout){b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED;break}}else b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE;this._setVideoLayoutCapability._updateIfChanged(b,c)},getRequestToBecomeModeratorCapability:function(){return this._setRequestToBecomeModeratorCapability},_recalculateRequestToBecomeModeratorCapability:function(){var b,c;this._isAvailable&&a.Base.Utils.isDefined(this._selfParticipant)?this._selfParticipant.isModerator()?(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._setRequestToBecomeModeratorCapability._updateIfChanged(b,c)},getVideoPinCapability:function(){return this._setVideoPinCapability},_recalculateVideoPinCapability:function(){var b,c;this._isAvailable&&a.Base.Utils.isDefined(this._selfParticipant)&&a.Base.Utils.isDefined(this._isVideoPinAllowed)?this._isVideoPinAllowed?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._setVideoPinCapability._updateIfChanged(b,c)},getAddParticipantViaDialoutCapability:function(){return this._addParticipantViaDialoutCapability},_recalculateAddParticipantViaDialoutCapability:function(){var b,c;this._isAvailable&&a.Base.Utils.isDefined(this._selfParticipant)&&a.Base.Utils.isDefined(this._dialoutPermissions)?this._dialoutPermissions===a.Services.Conference.PermissionStatus.ALLOWED?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):this._dialoutPermissions===a.Services.Conference.PermissionStatus.NOT_ALLOWED?(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):this._dialoutPermissions===a.Services.Conference.PermissionStatus.NEED_MODERATOR?(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NEED_MODERATOR):this._dialoutPermissions===a.Services.Conference.PermissionStatus.NEED_SIGNIN&&(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NEED_SIGNIN):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._addParticipantViaDialoutCapability._updateIfChanged(b,c)},getRemoveSelectParticipantCapability:function(){return this._removeSelectParticipantCapability},_recalculateRemoveSelectParticipantCapability:function(){var b,c;this._isAvailable&&a.Base.Utils.isDefined(this._selfParticipant)&&this._selfParticipant.isModerator()?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeSelectParticipantCapability._updateIfChanged(b,c)},getSignInCapability:function(){return this._signInCapability},_recalculateSignInCapability:function(){var b,c;this._isAvailable&&a.Base.Utils.isDefined(this._selfParticipant)?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._signInCapability._updateIfChanged(b,c)},getRemoveLastParticipantCapability:function(){return this._removeLastParticipantCapability},getAcceptPendingParticipantCapability:function(){return this._acceptPendingParticipantCapability},_recalculateAcceptPendingParticipantCapability:function(){var b,c;this._isAvailable&&a.Base.Utils.isDefined(this._selfParticipant)&&this._selfParticipant.isModerator()?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._acceptPendingParticipantCapability._updateIfChanged(b,c)},getDenyPendingParticipantCapability:function(){return this._denyPendingParticipantCapability},_recalculateDenyPendingParticipantCapability:function(){var b,c;this._isAvailable&&a.Base.Utils.isDefined(this._selfParticipant)&&this._selfParticipant.isModerator()?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._denyPendingParticipantCapability._updateIfChanged(b,c)},getExtendMeetingCapability:function(){return this._extendMeetingCapability},_recalculateExtendMeetingCapability:function(){var b,c;this._isAvailable&&a.Base.Utils.isDefined(this._selfParticipant)&&this._selfParticipant.isModerator()?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._extendMeetingCapability._updateIfChanged(b,c)},getAddParticipantFromCallCapability:function(b){var c=b.getCallId();return this._addParticipantFromCallCapabilities.hasOwnProperty(c)||(b.addOnCallConferenceStatusChangedCallback(function(){this._recalculateAddParticipantFromCallCapability(b)}.bind(this)),this._addParticipantFromCallCapabilities[c]=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._recalculateAddParticipantFromCallCapability(b)),this._addParticipantFromCallCapabilities[c]},_recalculateAddParticipantFromCallCapability:function(a){this._conferenceService._recalculateAddParticipantFromCallCapability(this,a)},_recalculateAllAddParticipantFromCallCapability:function(){for(var a in this._addParticipantFromCallCapabilities)this._addParticipantFromCallCapabilities.hasOwnProperty(a)&&this._conferenceService._recalculateAddParticipantFromCallCapabilityByCallId(this,a)}};$.extend(a.Services.Conference.Conference.prototype,b)}(AvayaClientServices),function(a){"use strict";function b(b,c){a.Services.Conference.Participant.call(this,b,c)}b.prototype=Object.create(a.Services.Conference.Participant.prototype),b.prototype.reinvite=function(){},a.Base.AOPTools.addAdvices(b,"DroppedParticipant",["reinvite"],[a.Base.AOPCommonAdvices.LOG_CONFERENCE_API_CALLS,a.Base.AOPCommonAdvices.WRAP_CAUGHT_CONFERENCE_ERROR]),a.Services.Conference.DroppedParticipant=b}(AvayaClientServices),function(a){"use strict";var b={getMuteParticipantAudioCapability:function(){return this._muteAudioCapability},getUnmuteParticipantAudioCapability:function(){return this._unmuteAudioCapability},_recalculateMuteUnmuteCapability:function(){function b(a,b){j=a,l=b}function c(a,b){k=a,m=b}var d=a.Services.Conference.MediaFromParticipantStatus,e=a.Base.CapabilityDenialReason,f=e.CAPABILITY_INVALID_STATE,g=e.CAPABILITY_CALL_HAS_NO_AUDIO,h=e.CAPABILITY_NOT_ALLOWED,i=e.CAPABILITY_NOT_DENIED,j=!1,k=!1,l=h,m=h,n=this._conference._selfParticipant.isModerator(),o=this._conference.isLectureModeActive();if(this._conference._isAvailable)switch(this._audioFromParticipant){case d.NA:b(!1,g),c(!1,g);break;case d.ACTIVE:case d.SELF_MUTED:n&&b(!0,i);break;case d.MODERATOR_MUTED:case d.BOTH_MUTED:(n||this._isSelfParticipant&&!o)&&c(!0,i)}else b(!1,f),c(!1,f);this._muteAudioCapability._updateIfChanged(j,l),this._unmuteAudioCapability._updateIfChanged(k,m)},getBlockParticipantVideoCapability:function(){return this._blockVideoCapability},getUnblockParticipantVideoCapability:function(){return this._unblockVideoCapability},_recalculateBlockUnblockVideoCapability:function(){function b(a,b){j=a,l=b}function c(a,b){k=a,m=b}var d=a.Services.Conference.MediaFromParticipantStatus,e=a.Base.CapabilityDenialReason,f=e.CAPABILITY_INVALID_STATE,g=e.CAPABILITY_CALL_HAS_NO_VIDEO,h=e.CAPABILITY_NOT_ALLOWED,i=e.CAPABILITY_NOT_DENIED,j=!1,k=!1,l=h,m=h,n=this._conference._selfParticipant.isModerator(),o=this._conference.isLectureModeActive();if(this._conference._isAvailable)switch(this._videoFromParticipant){case d.NA:b(!1,g),c(!1,g);break;case d.ACTIVE:n&&b(!0,i);break;case d.MODERATOR_MUTED:(n||this._isSelfParticipant&&!o)&&c(!0,i)}else b(!1,f),c(!1,f);this._blockVideoCapability._updateIfChanged(j,l),this._unblockVideoCapability._updateIfChanged(k,m)},getChangeRoleCapability:function(){},getAssignParticipantAsLecturerCapability:function(){return this._setUnsetAsLecturerCapability},_recalculateSetAsLecturerCapability:function(){var b,c;a.Base.Utils.isUndefined(this._canLecture)&&this._audioFromParticipant===a.Services.Conference.MediaFromParticipantStatus.NA?(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_CALL_HAS_NO_AUDIO):!1===this._canLecture?(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED):this._conference._isAvailable&&a.Base.Utils.isDefined(this._conference._selfParticipant)&&this._conference._selfParticipant.isModerator()?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._setUnsetAsLecturerCapability._updateIfChanged(b,c)},getLowerParticipantHandCapability:function(){return this._lowerHandCapability},_recalculateLowerHandCapability:function(){var b,c;this._conference._isAvailable&&a.Base.Utils.isDefined(this._conference._selfParticipant)&&this._conference._selfParticipant.isModerator()?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._lowerHandCapability._updateIfChanged(b,c)},getRemoteCameraControlCapability:function(){return this._remoteCameraControlCapability},_recalculateRemoteCameraControlCapability:function(){var b,c;this._conference._isAvailable&&a.Base.Utils.isDefined(this._conference._selfParticipant)&&this._conference._selfParticipant.isModerator()?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._remoteCameraControlCapability._updateIfChanged(b,c)}};$.extend(a.Services.Conference.Participant.prototype,b)}(AvayaClientServices),function(a){"use strict";var b={addOnPendingParticipantAcceptedCallback:function(a){this._onPendingParticipantAcceptedCallbacks.add(a)},removeOnPendingParticipantAcceptedCallback:function(a){this._onPendingParticipantAcceptedCallbacks.remove(a)},addOnPendingParticipantCancelledCallback:function(a){this._onPendingParticipantCancelledCallbacks.add(a)},removeOnPendingParticipantCancelledCallback:function(a){this._onPendingParticipantCancelledCallbacks.remove(a)},addOnPendingParticipantDeniedCallback:function(a){this._onPendingParticipantDeniedCallbacks.add(a)},removeOnPendingParticipantDeniedCallback:function(a){this._onPendingParticipantDeniedCallbacks.remove(a)}};$.extend(a.Services.Conference.PendingParticipant.prototype,b)}(AvayaClientServices),function(a,b){"use strict";var c={addOnPresenceChangedCallback:function(a){this._onPresenceChangedCallbacks.add(a)},removeOnPresenceChangedCallback:function(a){this._onPresenceChangedCallbacks.remove(a)},addOnContactChangedCallback:function(a){this._onContactChangedCallbacks.add(a)},removeOnContactChangedCallback:function(a){this._onContactChangedCallbacks.remove(a)}};b.extend(a.Services.Contacts.Contact.prototype,c)}(AvayaClientServices,jQuery),function(a,b){"use strict";var c={getUpdateContactCapability:function(){return this._contactsService.getUpdateContactCapability(this)},getDeleteContactCapability:function(){return this._contactsService.getDeleteContactCapability(this)},getPresenceCapability:function(){return this._getPresenceCapability}};b.extend(a.Services.Contacts.Contact.prototype,c)}(AvayaClientServices,jQuery),function(a,b){"use strict";var c={addOnContactsServiceUnavailableCallback:function(a){this._onContactsServiceUnavailableCallbacks.add(a)},removeOnContactsServiceUnavailableCallback:function(a){this._onContactsServiceUnavailableCallbacks.remove(a)},addOnContactsServiceAvailableCallback:function(a){this._onContactsServiceAvailableCallbacks.add(a)},removeOnContactsServiceAvailableCallback:function(a){this._onContactsServiceAvailableCallbacks.remove(a)},addOnContactServicesCapabilitiesChangedCallback:function(a){this._onCapabilitiesChangedCallbacks.add(a)},removeOnContactServicesCapabilitiesChangedCallback:function(a){this._onCapabilitiesChangedCallbacks.remove(a)}};b.extend(a.Services.Contacts.Contacts.prototype,c)}(AvayaClientServices,jQuery),function(a,b){"use strict";var c={getAddContactCapability:function(){return this._contactsService.getAddContactCapability()},getNetworkSearchContactCapability:function(){return this._contactsService.getNetworkSearchContactCapability()},getNetworkSearchTerminalCapability:function(){return this._contactsService.getNetworkSearchTerminalCapability()},getNetworkResolveContactsCapability:function(){return this._contactsService.getNetworkResolveContactsCapability()}};b.extend(a.Services.Contacts.Contacts.prototype,c)}(AvayaClientServices,jQuery),function(a,b){"use strict";var c={addOnStatusChangedCallback:function(a){this._onStatusChangedCallbacks.add(a)},removeOnStatusChangedCallback:function(a){this._onStatusChangedCallbacks.remove(a)},addOnHasThumbnailChangedCallback:function(a){this._onHasThumbnailChangedCallbacks.add(a)},removeOnHasThumbnailChangedCallback:function(a){this._onHasThumbnailChangedCallbacks.remove(a)},addOnIsSelfGeneratedCallback:function(a){this._onIsSelfGeneratedCallbacks.add(a)},removeOnIsSelfGeneratedCallback:function(a){this._onIsSelfGeneratedCallbacks.remove(a)}};b.extend(a.Services.Messaging.Attachment.prototype,c)}(window.AvayaClientServices,jQuery),function(a,b){"use strict";var c={getUpdateNameCapability:function(){return this._updateNameCapability},_recalculateUpdateNameCapability:function(){var b,c;this.status!==a.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._updateNameCapability._updateIfChanged(b,c)},getUpdateMimeTypeCapability:function(){return this._updateMimeTypeCapability},_recalculateUpdateMimeTypeCapability:function(){var b,c;this.status!==a.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(b=!1,
c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._updateMimeTypeCapability._updateIfChanged(b,c)},getUpdateDurationCapability:function(){return this._updateDurationCapability},_recalculateUpdateDurationCapability:function(){var b,c;this.status!==a.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._updateDurationCapability._updateIfChanged(b,c)},getUpdateIsSelfGeneratedCapability:function(){return this._updateIsSelfGeneratedCapability},_recalculateUpdateIsSelfGeneratedCapability:function(){var b,c;b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED,this._updateIsSelfGeneratedCapability._updateIfChanged(b,c)},getCreateThumbnailCapability:function(){return this._createThumbnailCapability},_recalculateCreateThumbnailCapability:function(){var b,c;b=!1;for(var d in this._thumbnailCreator._creators)if(this._thumbnailCreator._creators.hasOwnProperty(d)){var e=d;-1!==d.indexOf("/*")&&(e=d.slice(0,d.indexOf("/*"))),-1!==this.getMimeType().indexOf(e)&&(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED)}b||(c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._createThumbnailCapability._updateIfChanged(b,c)},getRemoveThumbnailCapability:function(){return this._removeThumbnailCapability},_recalculateRemoveThumbnailCapability:function(){var b,c;this.status!==a.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._removeThumbnailCapability._updateIfChanged(b,c)},getRemoveCapability:function(){return this._removeCapability},_recalculateRemoveCapability:function(){var b,c;this.status!==a.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._removeCapability._updateIfChanged(b,c)}};b.extend(a.Services.Messaging.Attachment.prototype,c)}(AvayaClientServices,jQuery),function(a){"use strict";function b(a){this._messageBuilder=a}b.prototype={build:function(b,c){var d=new a.Services.Messaging.Conversation(c);d.attachmentCount=b.attachmentCount||0,b.counts&&(d.totalMessageCount=b.counts.messageCount||0),b.flags&&(d.active=b.flags.active,d.closed=b.flags.closed,d.sensitivity=b.flags.sensitivity),d.href=b.href,d.id=b.id,d.lastAccessTime=new Date(b.lastAccessedTime),d.participants=new a.Base.DataSet,d.lastUpdated=new Date(b.lastUpdated),d.latestEntryTimestamp=new Date(b.latestEntryTimestamp),d.subject=b.subject,d.totalCount=b.totalCount||0,d.type=b.type||a.Services.Messaging.ConversationType.THREAD,d.unreadAttachmentCount=b.unreadAttachmentCount||0,d.unreadCount=b.unreadCount||0,d.resourceStatus=b.resourceStatus||a.Services.Messaging.ResourceStatus.PUBLISHED,b.counts&&(d._counts.eventCount=b.counts.eventCount||0,d._counts.eventUnreadMessage=b.counts.eventUnreadMessage||0,d._counts.messageAttachment=b.counts.messageAttachment||0,d._counts.messageCount=b.counts.messageCount||0,d._counts.messageUnreadAttachment=b.counts.messageUnreadAttachment||0,d._counts.messageUnreadMessage=b.counts.messageUnreadMessage||0);var e=d._getLastMessage();return d.previewText=e?e.from.givenName+": "+e.body:"",c._recalculateAllConversationCapabilities(d),d},update:function(a,b,c){a.attachmentCount!==b.attachmentCount&&(a.attachmentCount=b.attachmentCount,a._onTotalAttachmentCountChangedCallbacks.fire(a,a.attachmentCount)),b.counts&&a.totalMessageCount!==b.counts.messageCount&&(a.totalMessageCount=b.counts.messageCount,a._onTotalMessagesCountChangedCallbacks.fire(a,a.totalMessageCount)),b.flags&&(a.active!==b.flags.active&&(a.active=b.flags.active,a._onActiveStatusChangedCallbacks.fire(a,a.active)),a.closed!==b.flags.closed&&(a.closed=b.flags.closed,a._onClosedStatusChangedCallbacks.fire(a,a.closed)),a.sensitivity!==b.flags.sensitivity&&(a.sensitivity=b.flags.sensitivity,a._onSensitivityChangedCallbacks.fire(a,a.sensitivity))),a.multiparty!==b.isMultiparty&&(a.multiparty=b.isMultiparty,a._onMultiPartyStatusChangedCallbacks.fire(a,a.multiparty));var d=new Date(b.lastUpdated);return a.lastUpdated&&a.lastUpdated.getTime()===d.getTime()||(a.lastUpdated=d,a._onLastUpdatedTimeChangedCallbacks.fire(a,a.lastUpdated)),d=new Date(b.lastAccessedTime),a.lastAccessTime&&a.lastAccessTime.getTime()===d.getTime()||(a.lastAccessTime=d,a._onLastAccessTimeChangedCallbacks.fire(a,a.lastAccessTime)),d=new Date(b.latestEntryTimestamp),a.latestEntryTimestamp&&a.latestEntryTimestamp.getTime()===d.getTime()||(a.latestEntryTimestamp=d,a._onLatestEntryTimeChangedCallbacks.fire(a,a.latestEntryTimestamp)),a.subject!==b.subject&&(a.subject=b.subject,a._onSubjectChangedCallbacks.fire(a,a.subject)),a.type!==b.type&&(a.type=b.type,a._onTypeChangedCallbacks.fire(a,a.type)),a.unreadAttachmentCount!==b.unreadAttachmentCount&&(a.unreadAttachmentCount=b.unreadAttachmentCount,a._onTotalUnreadAttachmentCountChangedCallbacks.fire(a,a.unreadAttachmentCount)),a.unreadCount!==b.unreadCount&&(a.unreadCount=b.unreadCount,a._onTotalUnreadMessageCountChangedCallbacks.fire(a,a.unreadCount)),b.counts&&(a._counts.eventCount!==b.counts.eventCount&&(a._counts.eventCount=b.counts.eventCount,a._onTotalEventCountChangedCallbacks.fire(a,a._counts.eventCount)),a._counts.eventUnreadMessage!==b.counts.eventUnreadMessage&&(a._counts.eventUnreadMessage=b.counts.eventUnreadMessage,a._onTotalUnreadEventCountChangedCallbacks.fire(a,a._counts.eventUnreadMessage)),a._counts.messageAttachment!==b.counts.messageAttachment&&(a._counts.messageAttachment=b.counts.messageAttachment,a._onTotalAttachmentCountChangedCallbacks.fire(a,a._counts.messageAttachment)),a._counts.messageCount!==b.counts.messageCount&&(a._counts.messageCount=b.counts.messageCount,a._onTotalMessagesCountChangedCallbacks.fire(a,a._counts.messageCount)),a._counts.messageUnreadAttachment!==b.counts.messageUnreadAttachment&&(a._counts.messageUnreadAttachment=b.counts.messageUnreadAttachment,a._onTotalUnreadAttachmentCountChangedCallbacks.fire(a,a._counts.messageUnreadAttachment)),a._counts.messageUnreadMessage!==b.counts.messageUnreadMessage&&(a._counts.messageUnreadMessage=b.counts.messageUnreadMessage,a._onTotalUnreadMessageCountChangedCallbacks.fire(a,a._counts.messageUnreadMessage))),c._recalculateAllConversationCapabilities(a),this.updateMessages(a,b,c)},updateMessages:function(b,c,d){for(var e,f=[],g=[],h=c.messages.length-1;h>=0;h--){var i=c.messages[h],j=this._getMessageById(b.messages,i.id);void 0!==j?j.getLastModifiedDate().toISOString()!==new Date(i.lastModifiedDate).toISOString()&&(c.messages[h+1]&&(e=this._getMessageById(b.messages,c.messages[h+1].id)),this._updateExistingMessage(j,i,e),f.push(j)):(c.messages[h+1]&&(e=this._getMessageById(b.messages,c.messages[h+1].id)),e=this._addNewMessage(b,i,e,d),b._onMessagesAddedCallbacks.fire(b,[e]),g.push(e))}return f.length>0&&b.messages.onDataSetChanged(f,a.Base.DataSetChangeTypes.UPDATED),g.length>0&&b.messages.onDataSetChanged(g,a.Base.DataSetChangeTypes.ADDED),(f.length>0||g.length>0)&&this._updatePreviewText(b),g},_getMessageById:function(a,b){for(var c=0;c<a.length;c++)if(a[c].id===b)return a[c]},_updatePreviewText:function(a){var b=a._getLastMessage(),c=b&&b.from?b.from.givenName+": "+b.getBody():"";c!==a.previewText&&(a.previewText=c,a._onPreviewTextChangedCallbacks.fire(a,c))},_removeParticipant:function(a,b){var c=a.participants.filter(function(a){return a.getAddress()===b.eventRelatedParticipants[0].address});if(c.length>0){var d=a.participants.indexOf(c[0]);a.participants.splice(d,1),a._onParticipantsRemovedCallbacks.fire(a,c[0])}},_updateExistingMessage:function(a,b,c){return this._messageBuilder.update(a,b),c&&a._setIsCoalesced(this._messageBuilder.isMessageCoalesced(a,c)),a},_addNewMessage:function(b,c,d,e){var f=e.createNewClientMessage(c,b);return d&&f._setIsCoalesced(this._messageBuilder.isMessageCoalesced(f,d)),b.messages.push(f),f.getType()===a.Services.Messaging.MessageType.LEFT&&this._removeParticipant(b,f),b.messages.sort(function(a,b){return a.lastModifiedDate.getTime()-b.lastModifiedDate.getTime()}),f}},a.Services.Messaging.ConversationBuilder=b}(AvayaClientServices),function(a,b){"use strict";var c={addOnTotalMessageCountChangedCallback:function(a){this._onTotalMessagesCountChangedCallbacks.add(a)},removeOnTotalMessageCountChangedCallback:function(a){this._onTotalMessagesCountChangedCallbacks.remove(a)},addOnSubjectChangedCallback:function(a){this._onSubjectChangedCallbacks.add(a)},removeOnSubjectChangedCallback:function(a){this._onSubjectChangedCallbacks.remove(a)},addOnActiveStatusChangedCallback:function(a){this._onActiveStatusChangedCallbacks.add(a)},removeOnActiveStatusChangedCallback:function(a){this._onActiveStatusChangedCallbacks.remove(a)},addOnClosedStatusChangedCallback:function(a){this._onClosedStatusChangedCallbacks.add(a)},removeOnClosedStatusChangedCallback:function(a){this._onClosedStatusChangedCallbacks.remove(a)},addOnMultiPartyStatusChangedCallback:function(a){this._onMultiPartyStatusChangedCallbacks.add(a)},removeOnMultiPartyStatusChangedCallback:function(a){this._onMultiPartyStatusChangedCallbacks.remove(a)},addOnLastAccessTimeChangedCallback:function(a){this._onLastAccessTimeChangedCallbacks.add(a)},removeOnLastAccessTimeChangedCallback:function(a){this._onLastAccessTimeChangedCallbacks.remove(a)},addOnLastUpdatedTimeChangedCallback:function(a){this._onLastUpdatedTimeChangedCallbacks.add(a)},removeOnLastUpdatedTimeChangedCallback:function(a){this._onLastUpdatedTimeChangedCallbacks.remove(a)},addOnLatestEntryTimeChangedCallback:function(a){this._onLatestEntryTimeChangedCallbacks.add(a)},removeOnLatestEntryTimeChangedCallback:function(a){this._onLatestEntryTimeChangedCallbacks.remove(a)},addOnStatusChangedCallback:function(a){this._onStatusChangedCallbacks.add(a)},removeOnStatusChangedCallback:function(a){this._onStatusChangedCallbacks.remove(a)},addOnPreviewTextChangedCallback:function(a){this._onPreviewTextChangedCallbacks.add(a)},removeOnPreviewTextChangedCallback:function(a){this._onPreviewTextChangedCallbacks.remove(a)},addOnTotalAttachmentCountChangedCallback:function(a){this._onTotalAttachmentCountChangedCallbacks.add(a)},removeOnTotalAttachmentCountChangedCallback:function(a){this._onTotalAttachmentCountChangedCallbacks.remove(a)},addOnTotalUnreadMessageCountChangedCallback:function(a){this._onTotalUnreadMessageCountChangedCallbacks.add(a)},removeOnTotalUnreadMessageCountChangedCallback:function(a){this._onTotalUnreadMessageCountChangedCallbacks.remove(a)},addOnTotalUnreadAttachmentCountChangedCallback:function(a){this._onTotalUnreadAttachmentCountChangedCallbacks.add(a)},removeOnTotalUnreadAttachmentCountChangedCallback:function(a){this._onTotalUnreadAttachmentCountChangedCallbacks.remove(a)},addOnSensitivityChangedCallback:function(a){this._onSensitivityChangedCallbacks.add(a)},removeOnSensitivityChangedCallback:function(a){this._onSensitivityChangedCallbacks.remove(a)}};b.extend(a.Services.Messaging.Conversation.prototype,c)}(window.AvayaClientServices,jQuery),function(a,b){"use strict";var c={getUpdateSubjectCapability:function(){return this._updateSubjectCapability},_recalculateUpdateSubjectCapability:function(){var b,c;!this._conversationService.isServiceAvailable()||this.closed?(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):this.resourceStatus===a.Services.Messaging.ResourceStatus.PUBLISHED?this._conversationService.isUpdateSubjectSupported()?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):this.resourceStatus===a.Services.Messaging.ResourceStatus.DRAFT_UNSENT&&(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._updateSubjectCapability._updateIfChanged(b,c)},getUpdateLastAccessTimeCapability:function(){return this._updateLastAccessTimeCapability},_recalculateUpdateLastAccessTimeCapability:function(){var b,c;!this._conversationService.isServiceAvailable()||this.closed||this.resourceStatus!==a.Services.Messaging.ResourceStatus.PUBLISHED?(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._updateLastAccessTimeCapability._updateIfChanged(b,c)},getUpdateSensitivityCapability:function(){return this._updateSensitivityCapability},_recalculateUpdateSensitivityCapability:function(){var b,c;!this._conversationService.isServiceAvailable()||this.closed||this.resourceStatus!==a.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._updateSensitivityCapability._updateIfChanged(b,c)},getRetrieveMessagesCapability:function(){return this._retrieveMessagesCapability},_recalculateOlderContentCapability:function(){var b,c;this._conversationService.isServiceAvailable()&&this.resourceStatus===a.Services.Messaging.ResourceStatus.PUBLISHED&&this.totalCount!==this.messages.length?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._retrieveMessagesCapability._updateIfChanged(b,c)},getAddParticipantsCapability:function(){return this._addParticipantsCapability},_recalculateAddParticipantsCapability:function(){var b,c;this._conversationService.isServiceAvailable()&&(this.isActive()||this.getStatus()===a.Services.Messaging.ResourceStatus.DRAFT_UNSENT)?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._addParticipantsCapability._updateIfChanged(b,c)},getRemoveParticipantsCapability:function(){return this._removeParticipantsCapability},_recalculateRemoveParticipantsCapability:function(){var b,c;this._conversationService.isServiceAvailable()&&this.getStatus()===a.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeParticipantsCapability._updateIfChanged(b,c)},getCreateMessageCapability:function(){return this._createMessageCapability},_recalculateCreateMessageCapability:function(){var b,c;!this._conversationService.isServiceAvailable()||this.closed?(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._createMessageCapability._updateIfChanged(b,c)},getCreateEscalationCapability:function(){return this._createEscalationCapability},_recalculateCreateEscalationCapability:function(){var b,c;this._conversationService.isServiceAvailable()&&this.getStatus()!==a.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._createEscalationCapability._updateIfChanged(b,c)},getMarkAllContentAsReadCapability:function(){return this._markAllContentAsReadCapability},_recalculateMarkAllContentAsReadCapability:function(){var b,c;this._conversationService.isServiceAvailable()&&0!==this._counts.messageUnreadMessage?this._conversationService.isMarkAllContentAsReadSupported()?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._markAllContentAsReadCapability._updateIfChanged(b,c)},getLeaveCapability:function(){return this._leaveCapability},_recalculateLeaveCapability:function(){var b,c;this._conversationService.isServiceAvailable()&&this.active&&!this.closed?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._leaveCapability._updateIfChanged(b,c)},getRemoveCapability:function(){return this._removeCapability},_recalculateRemoveCapability:function(){var b,c;this._conversationService.isServiceAvailable()&&this.getStatus()===a.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeCapability._updateIfChanged(b,c)},getSendCapability:function(){return this._startCapability},_recalculateStartCapability:function(){var b,c;this._conversationService.isServiceAvailable()&&!this.closed&&this.active&&this.resourceStatus===a.Services.Messaging.ResourceStatus.DRAFT_UNSENT?0===this.participants.filter(function(a){return!a.isLocalUser()}).length?(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._startCapability._updateIfChanged(b,c)},getIsTypingCapability:function(){return this._isTypingCapability},_recalculateIsTypingCapability:function(){var b,c,d=this._conversationService.isOpened();this._conversationService.isServiceAvailable()&&d&&this._isSubscribed?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._isTypingCapability._updateIfChanged(b,c)}};b.extend(a.Services.Messaging.Conversation.prototype,c)}(AvayaClientServices,jQuery),function(a,b){"use strict";function c(c,d){this._escalationService=d,this.type=a.Services.Messaging.MessageType.SESSION,this.sessionType=void 0,this.participants=new a.Base.DataSet,this.extensions={},this._resourceStatus=a.Services.Messaging.ResourceStatus.DRAFT_UNSENT,a.Base.Utils.isDefined(c)&&(this.type=c.type,this.sessionType=c.sessionType,this.extensions=c.extensions,this.conversation=c.conversation),this._onTypeChangedCallbacks=b.Callbacks(),this._onStatusChangedCallbacks=b.Callbacks(),this._onSessionTypeChangedSuccessCallbacks=b.Callbacks(),this._onSessionTypeChangedFailedCallbacks=b.Callbacks(),this._onStartSuccessCallbacks=b.Callbacks(),this._onStartFailedCallbacks=b.Callbacks(),this._onMessagingEscalationCapabilitiesChangedCallbacks=b.Callbacks(),this._sendCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._addParticipantsCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeParticipantsCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateSessionTypeCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),d._recalculateAllEscalationCapabilities(this)}c.prototype={getStatus:function(){return this._resourceStatus},getSessionType:function(){return this.sessionType},getConversation:function(){return this.conversation},setSessionType:function(a){this._escalationService.setSessionType(this,a)},addParticipants:function(a){this._escalationService.addParticipants(this,a)},removeParticipants:function(a){this._escalationService.removeParticipants(this,a)},getParticipants:function(){return this.participants},send:function(){return this._escalationService.start(this)},_setStatus:function(b){if(!a.Base.Utils.isDefined(a.Services.Messaging.ResourceStatus[b]))throw new Error("Unknown ResourceStatus");this._resourceStatus=b,this._onStatusChangedCallbacks.fire(this,b)}},a.Base.AOPTools.addAdvices(c,"Escalation",["addParticipants","removeParticipants"],[a.Base.AOPCommonAdvices.LOG_MESSAGING_API_CALLS]),a.Base.AOPTools.addAdvices(c,"Escalation",["send"],[a.Base.AOPCommonAdvices.LOG_MESSAGING_API_CALLS,a.Base.AOPCommonAdvices.WRAP_CAUGHT_MESSAGING_ERROR]),a.Services.Messaging.Escalation=c}(AvayaClientServices,jQuery),function(a,b){"use strict";var c={addOnBodyChangedCallback:function(a){this._onBodyChangedCallbacks.add(a)},removeOnBodyChangedCallback:function(a){this._onBodyChangedCallbacks.remove(a)},addOnInReplyToChangedCallback:function(a){this._onInReplyToChangedCallbacks.add(a)},removeOnInReplyToChangedCallback:function(a){this._onInReplyToChangedCallbacks.remove(a)},addOnLastModifiedDateChangedCallback:function(a){this._onLastModifiedDateChangedCallbacks.add(a)},removeOnLastModifiedDateChangedCallback:function(a){this._onLastModifiedDateChangedCallbacks.remove(a)},addOnIsCoalescedStatusChangedCallback:function(a){this._onIsCoalescedStatusChangedCallbacks.add(a)},removeOnIsCoalescedStatusChangedCallback:function(a){this._onIsCoalescedStatusChangedCallbacks.remove(a)},addOnHasAttachmentStatusChangedCallback:function(a){this._onHasAttachmentStatusChangedCallbacks.add(a)},removeOnHasAttachmentStatusChangedCallback:function(a){this._onHasAttachmentStatusChangedCallbacks.remove(a)},addOnHasUnreadAttachmentStatusChangedCallback:function(a){this._onHasUnreadAttachmentStatusChangedCallbacks.add(a)},removeOnHasUnreadAttachmentStatusChangedCallback:function(a){this._onHasUnreadAttachmentStatusChangedCallbacks.remove(a)},addOnIsPrivateStatusChangedCallback:function(a){this._onIsPrivateStatusChangedCallbacks.add(a)},removeOnIsPrivateStatusChangedCallback:function(a){this._onIsPrivateStatusChangedCallbacks.remove(a)},addOnDoNotForwardStatusChangedCallback:function(a){this._onDoNotForwardStatusChangedCallbacks.add(a)},removeOnDoNotForwardStatusChangedCallback:function(a){this._onDoNotForwardStatusChangedCallbacks.remove(a)},addOnIsReadStatusChangedCallback:function(a){this._onIsReadStatusChangedCallbacks.add(a)},removeOnIsReadStatusChangedCallback:function(a){this._onIsReadStatusChangedCallbacks.remove(a)},addOnStatusChangedCallback:function(a){this._onStatusChangedCallbacks.add(a)},removeOnStatusChangedCallback:function(a){this._onStatusChangedCallbacks.remove(a)},addOnImportanceChangedCallback:function(a){this._onImportanceChangedCallbacks.add(a)},removeOnImportanceChangedCallback:function(a){this._onImportanceChangedCallbacks.remove(a)},addOnSensitivityChangedCallback:function(a){this._onSensitivityChangedCallbacks.add(a)},removeOnSensitivityChangedCallback:function(a){this._onSensitivityChangedCallbacks.remove(a)}};b.extend(a.Services.Messaging.Message.prototype,c)}(AvayaClientServices,jQuery),function(a,b){"use strict";var c={getUpdateBodyCapability:function(){return this._updateBodyCapability},_recalculateUpdateBodyCapability:function(){var b,c;this._messageService.isServiceAvailable()&&this.resourceStatus===a.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateBodyCapability._updateIfChanged(b,c)},getUpdateSensitivityCapability:function(){return this._updateSensitivityCapability},_recalculateUpdateSensitivityCapability:function(){var b,c;this._messageService.isServiceAvailable()&&this.conversation.resourceStatus===a.Services.Messaging.ResourceStatus.DRAFT_UNSENT&&this.resourceStatus===a.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateSensitivityCapability._updateIfChanged(b,c)},getUpdateInReplyToCapability:function(){return this._updateInReplyToCapability},_recalculateUpdateInReplyToCapability:function(){var b,c;this._messageService.isServiceAvailable()&&this.resourceStatus===a.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateInReplyToCapability._updateIfChanged(b,c)},getUpdateDoNotForwardCapability:function(){return this._updateDoNotForwardCapability},_recalculateUpdateDoNotForwardCapability:function(){var b,c;this._messageService.isServiceAvailable()?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateDoNotForwardCapability._updateIfChanged(b,c)},getUpdateImportanceCapability:function(){return this._updateImportanceCapability},_recalculateUpdateImportanceCapability:function(){var b,c;this._messageService.isServiceAvailable()&&this.resourceStatus===a.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateImportanceCapability._updateIfChanged(b,c)},getCreateAttachmentCapability:function(a){return this._createAttachmentCapability},_recalculateCreateAttachmentCapability:function(){var b,c;this._messageService.isServiceAvailable()&&this.resourceStatus===a.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._createAttachmentCapability._updateIfChanged(b,c)},getSendCapability:function(){return this._sendCapability},_recalculateSendCapability:function(){var b,c;this._messageService.isServiceAvailable()&&this.resourceStatus===a.Services.Messaging.ResourceStatus.DRAFT_UNSENT&&this.conversation.active&&!this.conversation.closed?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._sendCapability._updateIfChanged(b,c)},getMarkAsReadCapability:function(){return this._markAsReadCapability},_recalculateMarkAsReadCapability:function(){var b,c;!this._messageService.isServiceAvailable()||this.read?(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._markAsReadCapability._updateIfChanged(b,c)},getRemoveCapability:function(){return this._removeCapability},_recalculateRemoveCapability:function(){var b,c;this._messageService.isServiceAvailable()&&this.resourceStatus===a.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeCapability._updateIfChanged(b,c)}};b.extend(a.Services.Messaging.Message.prototype,c)}(AvayaClientServices,jQuery),function(a,b){"use strict";var c={addOnMessagingLimitsChangedCallback:function(a){this._onMessagingLimitsChangedCallbacks.add(a)},removeOnMessagingLimitsChangedCallback:function(a){this._onMessagingLimitsChangedCallbacks.remove(a)},addOnRoutableDomainsChangedCallback:function(a){this._onRoutableDomainsChangedCallbacks.add(a)},removeOnRoutableDomainsChangedCallback:function(a){this._onRoutableDomainsChangedCallbacks.remove(a)},addOnNumberOfConversationsWithUnreadContentChangedCallback:function(a){this._onNumberOfConversationsWithUnreadContentChangedCallbacks.add(a)},removeOnNumberOfConversationsWithUnreadContentChangedCallback:function(a){this._onNumberOfConversationsWithUnreadContentChangedCallbacks.remove(a)},addOnNumberOfConversationsWithUnreadContentSinceLastAccessChangedCallback:function(a){this._onNumberOfConversationsWithUnreadContentSinceLastAccessChangedCallbacks.add(a)},removeOnNumberOfConversationsWithUnreadContentSinceLastAccessChangedCallback:function(a){this._onNumberOfConversationsWithUnreadContentSinceLastAccessChangedCallbacks.remove(a)},addOnMessagingServiceUnavailableCallback:function(a){this._onMessagingServiceUnavailableCallbacks.add(a)},removeOnMessagingServiceUnavailableCallback:function(a){this._onMessagingServiceUnavailableCallbacks.remove(a)},addOnMessagingServiceAvailableCallback:function(a){this._onMessagingServiceAvailableCallbacks.add(a)},removeOnMessagingServiceAvailableCallback:function(a){this._onMessagingServiceAvailableCallbacks.remove(a)}};b.extend(a.Services.Messaging.Messaging.prototype,c)}(AvayaClientServices,jQuery),function(a,b){"use strict";var c={getStartServiceCapability:function(){return this._startServiceCapability},_recalculateStartServiceCapability:function(){var b,c;this._isAvailable?(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._startServiceCapability._updateIfChanged(b,c)},getCreateConversationCapability:function(){return this._createConversationCapability},_recalculateCreateConversationCapability:function(){var b,c;this._isAvailable?this._messagingService.getConversationResource()?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._createConversationCapability._updateIfChanged(b,c)},getRetrieveConversationsCapability:function(){return this._retrieveConversationsCapability},_recalculateRetrieveConversationsCapability:function(){var b,c;this._isAvailable&&this._messagingService.getConversationResource()?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._retrieveConversationsCapability._updateIfChanged(b,c)},getSearchConversationsCapability:function(){return this._searchConversationsCapability},_recalculateSearchConversationsCapability:function(){var b,c;this._isAvailable?this._messagingService.getConversationResource()?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._searchConversationsCapability._updateIfChanged(b,c)},getValidateParticipantAddressesCapability:function(){return this._validateParticipantAddressesCapability},_recalculateValidateParticipantAddressCapability:function(){var b,c,d=this._isAvailable;d&&this._messagingService.getValidateAddressResource()?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):d&&!this._messagingService.getValidateAddressResource()?(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._validateParticipantAddressesCapability._updateIfChanged(b,c)},getMarkContentAsReadCapability:function(){return this._markContentAsReadCapability},_recalculateMarkContentAsReadCapability:function(){var b,c,d=this._isAvailable;d&&this._messagingService.getMarkAsReadResource()?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):d&&!this._messagingService.getMarkAsReadResource()?(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._markContentAsReadCapability._updateIfChanged(b,c)}};b.extend(a.Services.Messaging.Messaging.prototype,c)}(AvayaClientServices,jQuery),function(a,b){"use strict";var c={addOnStartedCallback:function(a){this._onStartedCallbacks.add(a)},removeOnStartedCallback:function(a){this._onStartedCallbacks.remove(a)},addOnStoppedCallback:function(a){this._onStoppedCallbacks.add(a)},removeOnStoppedCallback:function(a){this._onStoppedCallbacks.remove(a)},addOnPresenceReceivedCallback:function(a){this._onPresenceReceivedCallbacks.add(a)},removeOnPresenceReceivedCallback:function(a){this._onPresenceReceivedCallbacks.remove(a)},_addOnInternalPresenceReceivedCallback:function(a){this._onInternalPresenceReceivedCallbacks.add(a)},_removeOnInternalPresenceReceivedCallback:function(a){this._onInternalPresenceReceivedCallbacks.remove(a)},_addOnSelfPresenceReceivedCallback:function(a){this._onSelfPresenceReceivedCallbacks.add(a)},_removeOnSelfPresenceReceivedCallback:function(a){this._onSelfPresenceReceivedCallbacks.remove(a)}};b.extend(a.Services.Presence.PresenceListSubscription.prototype,c)}(AvayaClientServices,$),function(a,b){"use strict";var c={addOnSelfPresenceReceivedCallback:function(a){this._onSelfPresenceReceivedCallbacks.add(a)},removeOnSelfPresenceReceivedCallback:function(a){this._onSelfPresenceReceivedCallbacks.remove(a)},addOnPresenceServiceAvailableCallback:function(a){this._onPresenceServiceAvailableCallbacks.add(a)},removeOnPresenceServiceAvailableCallback:function(a){this._onPresenceServiceAvailableCallbacks.remove(a)},addOnPresenceServiceUnavailableCallback:function(a){
this._onPresenceServiceUnavailableCallbacks.add(a)},removeOnPresenceServiceUnavailableCallback:function(a){this._onPresenceServiceUnavailableCallbacks.remove(a)}};b.extend(a.Services.Presence.PresenceService.prototype,c)}(AvayaClientServices,$),function(a){"use strict";var b=a.Base.Utils,c=a.Providers.Analytics.AnalyticsStatistic,d={CATEGORY:"ec",ACTION:"ea",LABEL:"el",VALUE:"ev"};a.Providers.Analytics.AnalyticsEventStatistic={send:function(a,b,d,e,f){if(c.isCollectionEnabled()){var g=this._getEventParams.apply(this,arguments);c.addHit(g)}},_getEventParams:function(a,e,f,g,h){var i=c.addHitTypeParameter("event"),j=[[d.CATEGORY,a],[d.ACTION,e]];f&&j.push([d.LABEL,f]),b.isInteger(g)&&j.push([d.VALUE,g]);for(var k=0;k<j.length;k++)i+=c.addURIParam(j[k][0],j[k][1]);return i+=c.addCustomDimensionsParameters(h)}}}(AvayaClientServices),function(a){"use strict";function b(){this._category=void 0,this._customDimensions=void 0,this._init()}var c=a.Providers.Analytics.AnalyticsEventStatistic,d=a.Providers.Analytics.AnalyticsTimingStatistic;b.prototype._init=function(){this._category=this._createCategory(),this._customDimensions=this._createCustomDimensions()},b.prototype.sendTiming=function(a,b,c,e){if((e=!!e)&&!this._customDimensions)throw"Provider type is not set";var f=e?this._customDimensions:{};d.send(this._category,a,c,b,f)},b.prototype.sendEvent=function(a,b,d,e){if(!this._category)throw"The category is not set";if(e&&!this._customDimensions)throw"Provider type is not set";var f=e?this._customDimensions:{};c.send(this._category,a,b,d,f)},b.prototype._createCategory=function(){throw"You must create a category using the method _createCategory"},b.prototype._createCustomDimensions=function(){return{}},b.prototype.startTimingMetric=function(){return new Date},a.Services.Analytics.AnalyticsService=b}(AvayaClientServices),function(a){"use strict";function b(){a.Services.Analytics.AnalyticsService.call(this),this._callMediaTypes={AUDIO:1,VIDEO:0}}var c={AUDIO:"Audio",CONFERENCE:"Conference",DURATION:"Duration",DROPPED:"Dropped",ERROR:"Error",FAILURE:"Failure",INCOMING:"Incoming",MEDIA_TYPES:"Media Types",OUTGOING:"Outgoing",P2P:"P2P",PRESERVATION:"Preservation",SERVICE_UNAVAILABLE:"Service Unavailable",START_TYPE:"Start Type",SUCCESS_CALL_CONTINUED:"Success (call continued)",SUCCESS_CALL_ENDED:"Success (call ended)",VIDEO:"Video"},d=a.Providers.Analytics.AnalyticsStatistic,e=a.Providers.Analytics.AnalyticsCategories,f=a.Providers.Analytics.AnalyticsCustomDimensions,g=a.Providers.Analytics.AnalyticsProvidersTypes;b.prototype=Object.create(a.Services.Analytics.AnalyticsService.prototype),b.prototype._createCategory=function(){return e.CALLS},b.prototype._createCustomDimensions=function(){var a={};return a[f.PROVIDER_TYPE]=g.CALLS,a},b.prototype.sendCallInfo=function(a,b){var d=a?c.INCOMING:c.OUTGOING,e=c.AUDIO;e+=b?"+"+c.VIDEO:"",this.sendEvent(d,e,null,!0)},b.prototype.callTimeEnd=function(a){if(a){var b=new Date,e=b-a,f=d.getCallDurationLabel(e);this.sendTiming(c.DURATION,f,e,!0)}},b.prototype.setCallMediaTypes=function(a){this._callMediaTypes.VIDEO=a?1:0},b.prototype.sendCallMediaTypes=function(){var a="";this._callMediaTypes.AUDIO&&(a+=c.AUDIO),this._callMediaTypes.VIDEO&&(a+=(a?"+":"")+c.VIDEO),this.sendEvent(c.MEDIA_TYPES,a,null,!0)},b.prototype.sendOperationFailureEvent=function(a,b){this.sendEvent(a+" "+c.ERROR,b,null,!0)},b.prototype.sendCallType=function(a){var b=a?c.CONFERENCE:c.P2P;this.sendEvent(c.START_TYPE,b,null,!0)},b.prototype.sendUnavailableEvent=function(a){this.sendEvent(c.SERVICE_UNAVAILABLE,a,null,!0)},b.prototype.serviceUnavailableTimeEnd=function(a){if(a){var b=new Date,e=b-a,f=d.getServiceOutageLabel(e);this.sendTiming(c.SERVICE_UNAVAILABLE,f,e,!0)}},b.prototype.sendDroppedCallEvent=function(a){this.sendEvent(c.DROPPED,a,null,!0)},b.prototype.sendPreservationEvent=function(a,b){if(b){var d;d=a?c.SUCCESS_CALL_CONTINUED:b>5e3?c.SUCCESS_CALL_ENDED:c.FAILURE,this.sendEvent(c.PRESERVATION,d,null,!0)}},b.prototype.callPreservationTimeStart=function(a){return a?this.startTimingMetric():void 0},b.prototype.callPreservationTimeEnd=function(a){var b;if(a){b=new Date-a;var e=d.getCallPreservation(b);this.sendTiming(c.PRESERVATION,e,b,!0)}return b},a.Services.Analytics.CallsAnalyticsService=b}(AvayaClientServices),function(a){"use strict";function b(b,c){this._productName=b,this._productVersion=c,a.Services.Analytics.AnalyticsService.call(this)}var c={CRASH_RECOVERY:"Crash Recovery",GRACEFUL:"Graceful",NORMAL:"Normal",PRODUCT_VENDOR:"Avaya",SHUTDOWN:"Shutdown",STARTUP:"Startup",UNGRACEFUL:"Ungraceful"},d="ga_jscsdk_running",e=a.Base.Storage,f=a.Providers.Analytics.AnalyticsCategories,g=a.Providers.Analytics.AnalyticsCustomDimensions;b.prototype=Object.create(a.Services.Analytics.AnalyticsService.prototype),b.prototype._createCategory=function(){return f.CLIENT},b.prototype._createCustomDimensions=function(){var a={};return a[g.PRODUCT_VENDOR]=c.PRODUCT_VENDOR,a[g.PRODUCT_NAME]=this._productName,a[g.PRODUCT_VERSION]=this._productVersion,a},b.prototype.sendStartupEvent=function(){this.sendEvent(c.STARTUP,null,null,!0)},b.prototype._getJSCSDKStartupStatus=function(){return e.get(e.TYPES.LOCAL,d)},b.prototype.setJSCSDKStartupStatus=function(a){e.set(e.TYPES.LOCAL,d,a)},b.prototype.sendStartupStatus=function(){var a;a=this._getJSCSDKStartupStatus()?c.CRASH_RECOVERY:c.NORMAL,this.sendEvent(c.STARTUP,a,null,!0)},b.prototype.sendShutdownEvent=function(a){var b=a?c.GRACEFUL:c.UNGRACEFUL;this.sendEvent(c.SHUTDOWN,b,null,!0)},b.prototype.shutdownTimeEnd=function(a,b){if(a){var d=new Date,e=d-a,f=b?c.GRACEFUL:c.UNGRACEFUL;this.sendTiming(c.SHUTDOWN,f,e,!0)}},a.Services.Analytics.ClientAnalyticsService=b}(AvayaClientServices),function(a){"use strict";function b(){a.Services.Analytics.AnalyticsService.call(this)}var c={START_ERROR:"Start Error",DURATION:"Duration",END:"End",END_ERROR:"End Error",FAILURE:"Failure",START:"Start",SUCCESS:"Success"},d=a.Providers.Analytics.AnalyticsStatistic,e=a.Providers.Analytics.AnalyticsCategories,f=a.Providers.Analytics.AnalyticsCustomDimensions,g=a.Providers.Analytics.AnalyticsProvidersTypes;b.prototype=Object.create(a.Services.Analytics.AnalyticsService.prototype),b.prototype._createCategory=function(){return e.COLLABORATIONS},b.prototype._createCustomDimensions=function(){var a={};return a[f.PROVIDER_TYPE]=g.COLLABORATION,a},b.prototype.sendStartupEvent=function(a){var b=a?c.SUCCESS:c.FAILURE;this.sendEvent(c.START,b,null,!0)},b.prototype.durationTimeEnd=function(a){if(a){var b=new Date,e=b-a,f=d.getCallDurationLabel(e);this.sendTiming(c.DURATION,f,e,!0)}},b.prototype.sendStartErrorEvent=function(a){this.sendEvent(c.START_ERROR,a,null,!0)},b.prototype.sendStopEvent=function(a){var b=a?c.SUCCESS:c.FAILURE;this.sendEvent(c.END,b,null,!0)},b.prototype.sendFailureStopEvent=function(a){this.sendEvent(c.END_ERROR,a,null,!0)},a.Services.Analytics.CollaborationsAnalyticsService=b}(AvayaClientServices),function(a){"use strict";function b(){a.Services.Analytics.AnalyticsService.call(this)}var c=a.Providers.Analytics.AnalyticsStatistic,d={LOADED:"Loaded",CACHE_SEARCH:"Cache Search",DIRECTORY_SEARCH:"Directory Search",SERVICE_UNAVAILABLE:"Service Unavailable",RESOLVE_CONTACTS:"RESOLVE_CONTACTS"};b.prototype=Object.create(a.Services.Analytics.AnalyticsService.prototype),b.prototype._createCategory=function(){return a.Providers.Analytics.AnalyticsCategories.CONTACTS},b.prototype._createCustomDimensions=function(){var b={};return b[a.Providers.Analytics.AnalyticsCustomDimensions.PROVIDER_TYPE]=a.Providers.Analytics.AnalyticsProvidersTypes.CONTACTS,b},b.prototype.sendNumContactsLoaded=function(a){var b=c.getContactCountLabel(a);this.sendEvent(d.LOADED,b,a,!0)},b.prototype.contactsLoadTimeEnd=function(b){if(b){var e=new Date,f=e-b,g=c.getOperationTimingLabel(f);this.sendTiming(d.LOADED,g,f,!0)}else a.Base.Logger.warn(a.Base.LoggerTags.ANALYTICS_SERVICE,"Contacts, contactsLoadTimeEnd: start time was not defined")},b.prototype.cachedContactsSearchTimeEnd=function(b){if(b){var e=new Date,f=e-b,g=c.getOperationTimingLabel(f);this.sendTiming(d.CACHE_SEARCH,g,f,!1)}else a.Base.Logger.warn(a.Base.LoggerTags.ANALYTICS_SERVICE,"Contacts, cachedContactsSearchTimeEnd: start time was not defined")},b.prototype.sendNumCachedContactSearches=function(a){this.sendEvent(d.CACHE_SEARCH,a,null,!1)},b.prototype.sendNumDirectorySearches=function(a){this.sendEvent(d.DIRECTORY_SEARCH,a,null,!0)},b.prototype.directorySearchTimeEnd=function(b){if(b){var e=new Date,f=e-b,g=c.getOperationTimingLabel(f);this.sendTiming(d.DIRECTORY_SEARCH,g,f,!0)}else a.Base.Logger.warn(a.Base.LoggerTags.ANALYTICS_SERVICE,"Contacts, directorySearchTimeEnd: start time was not defined")},b.prototype.trackContactProvidersUnavailable=function(a){this.sendEvent(d.SERVICE_UNAVAILABLE,a,null,!0)},b.prototype.durationContactProviderOutagesEnd=function(a){if(a){var b=new Date,e=b-a,f=c.getServiceOutageLabel(e);this.sendTiming(d.SERVICE_UNAVAILABLE,f,e,!0)}},b.prototype.sendNumResolveContacts=function(a){this.sendEvent(d.RESOLVE_CONTACTS,a,null,!0)},b.prototype.resolveContactsTimeEnd=function(b){if(b){var e=new Date,f=e-b,g=c.getOperationTimingLabel(f);this.sendTiming(d.RESOLVE_CONTACTS,g,f,!0)}else a.Base.Logger.warn(a.Base.LoggerTags.ANALYTICS_SERVICE,"Contacts, resolveContactsTimeEnd: start time was not defined")},a.Services.Analytics.ContactsAnalyticsService=b}(AvayaClientServices),function(a){"use strict";function b(){a.Services.Analytics.AnalyticsService.call(this)}var c={MISSED_HITS:"Missed Hits"},d="ga_missed_hits",e=a.Base.Storage,f=a.Providers.Analytics.AnalyticsCategories;b.prototype=Object.create(a.Services.Analytics.AnalyticsService.prototype),b.prototype._createCategory=function(){return f.ANALYTICS},b.prototype._getMissedHitsObj=function(){return e.get(e.TYPES.LOCAL,d)},b.prototype.setMissedHitsObj=function(a){e.set(e.TYPES.LOCAL,d,a)},b.prototype.createMissedHitsObj=function(a,b){var c=this._getMissedHitsObj();a+=c?c.count:0,this.setMissedHitsObj({count:a,reason:b})},b.prototype.sendMissedHitsCount=function(){var a=this._getMissedHitsObj();a&&this.sendEvent(c.MISSED_HITS,a.reason,a.count)},a.Services.Analytics.InfrastructureAnalyticsService=b}(AvayaClientServices),function(a){"use strict";function b(){a.Services.Analytics.AnalyticsService.call(this)}var c=a.Providers.Analytics.AnalyticsStatistic,d={SEND_MESSAGE:"SendMessage",TEXT_SIZE:"Text Size",ATTACHMENT_SIZE:"Attachment Size",SEARCH_CONVERSATIONS:"SearchConversations",VALIDATE_ADDRESSES:"ValidateAddresses",VALIDATE_ADDRESSES_RESULT:"ValidateAddresses Result",SERVICE_UNAVAILABLE:"Service Unavailable"},e={GET_CONVERSATIONS:"GetConversations",SEARCH_CONVERSATIONS:"SearchConversations",LEAVE_CONVERSATIONS:"LeaveConversations",VALIDATE_ADDRESSES:"ValidateAddresses",SEND_MESSAGE:"SendMessage"},f={INVALID_DOMAIN:"InvalidDomain",NOT_VALID:"NotValid",VALID:"Valid"},g={TEXT:"Text",ATTACHMENT:"Attachment"},h={BODY:"Body",SUBJECT:"Subject",PARTICIPANTS:"Participants"},i="+";b.prototype=Object.create(a.Services.Analytics.AnalyticsService.prototype),b.prototype._createCategory=function(){return a.Providers.Analytics.AnalyticsCategories.MESSAGING},b.prototype._createCustomDimensions=function(){return{}},b.prototype._setCustomDimensionsMimeType=function(b){this._customDimensions[a.Providers.Analytics.AnalyticsCustomDimensions.MIME_TYPE]=b},b.prototype._resetCustomDimensionsMimeType=function(){delete this._customDimensions[a.Providers.Analytics.AnalyticsCustomDimensions.MIME_TYPE]},b.prototype.trackNumMessagesSent=function(a,b){var c=this._getLabelTypeMessage(a,b);this.sendEvent(d.SEND_MESSAGE,c,null,!1)},b.prototype.trackMessageTextSize=function(a,b){if(a){var c=this._getLabelTypeMessage(!0,b);this.sendEvent(d.TEXT_SIZE,c,a,!1)}},b.prototype._getLabelTypeMessage=function(a,b){var c=[];return a&&c.push(g.TEXT),b&&c.push(g.ATTACHMENT),c.join(i)},b.prototype.trackMessageAttachmentSize=function(a,b){this._setCustomDimensionsMimeType(b);var e=c.getAttachmentSizeLabel(a);this.sendEvent(d.ATTACHMENT_SIZE,e,a,!0),this._resetCustomDimensionsMimeType()},b.prototype.trackNumConversationSearchRequests=function(a,b,c){var e=[];a&&e.push(h.BODY),b&&e.push(h.SUBJECT),c&&e.push(h.PARTICIPANTS);var f=e.join(i);this.sendEvent(d.SEARCH_CONVERSATIONS,f,null,!1)},b.prototype.trackNumAddressValidationRequests=function(a){this.sendEvent(d.VALIDATE_ADDRESSES,null,a,!1)},b.prototype.trackAddrValidationResInvalidDomain=function(a){this._trackAddressValidationResults(f.INVALID_DOMAIN,a)},b.prototype.trackAddrValidationResNotValid=function(a){this._trackAddressValidationResults(f.NOT_VALID,a)},b.prototype.trackAddrValidationResValid=function(a){this._trackAddressValidationResults(f.VALID,a)},b.prototype._trackAddressValidationResults=function(a,b){this.sendEvent(d.VALIDATE_ADDRESSES_RESULT,a,b,!1)},b.prototype.trackTimeRequestsGetConversationsEnd=function(a){this._sendTrackTimeRequests(e.GET_CONVERSATIONS,a)},b.prototype.trackTimeRequestsSearchConversationsEnd=function(a){this._sendTrackTimeRequests(e.SEARCH_CONVERSATIONS,a)},b.prototype.trackTimeRequestsLeaveConversationsEnd=function(a){this._sendTrackTimeRequests(e.LEAVE_CONVERSATIONS,a)},b.prototype.trackTimeRequestsValidateAddressesEnd=function(a){this._sendTrackTimeRequests(e.VALIDATE_ADDRESSES,a)},b.prototype.trackTimeRequestsSendMessageEnd=function(a){this._sendTrackTimeRequests(e.SEND_MESSAGE,a)},b.prototype._sendTrackTimeRequests=function(b,d){if(d){var e=new Date,f=e-d,g=c.getOperationTimingLabel(f);this.sendTiming(b,g,f,!1)}else a.Base.Logger.warn(a.Base.LoggerTags.ANALYTICS_SERVICE,"Messaging, sendTrackTimeRequests: start time was not defined")},b.prototype.trackErrorsResponseGetConversations=function(a){this._trackErrorsResponse(e.GET_CONVERSATIONS,a)},b.prototype.trackErrorsResponseSearchConversations=function(a){this._trackErrorsResponse(e.SEARCH_CONVERSATIONS,a)},b.prototype.trackErrorsResponseLeaveConversations=function(a){this._trackErrorsResponse(e.LEAVE_CONVERSATIONS,a)},b.prototype.trackErrorsResponseValidateAddresses=function(a){this._trackErrorsResponse(e.VALIDATE_ADDRESSES,a)},b.prototype.trackErrorsResponseSendMessage=function(a){this._trackErrorsResponse(e.SEND_MESSAGE,a)},b.prototype._trackErrorsResponse=function(a,b){this.sendEvent(a,b,null,!1)},b.prototype.trackServiceUnavailable=function(a){this.sendEvent(d.SERVICE_UNAVAILABLE,a,null,!1)},b.prototype.trackDurationServiceUnavailableEnd=function(a){if(a){var b=new Date,e=b-a,f=c.getServiceOutageLabel(e);this.sendTiming(d.SERVICE_UNAVAILABLE,f,e,!1)}},a.Services.Analytics.MessagingAnalyticsService=b}(AvayaClientServices),function(a){"use strict";function b(){a.Services.Analytics.AnalyticsService.call(this)}var c={CONFIGURED:"Configured",NOT_CONFIGURED:"Not Configured"},d=a.Providers.Analytics.AnalyticsCategories,e=a.Providers.Analytics.AnalyticsProvidersTypes;b.prototype=Object.create(a.Services.Analytics.AnalyticsService.prototype),b.prototype._createCategory=function(){return d.PROVIDERS},b.prototype.sendInfoByUseOfProviders=function(a){var b=a.uccpConfiguration&&a.uccpConfiguration.enabled?c.CONFIGURED:c.NOT_CONFIGURED;this.sendEvent(e.CONFERENCE,b);var d=a.acsConfiguration&&a.acsConfiguration.enabled?c.CONFIGURED:c.NOT_CONFIGURED;this.sendEvent(e.CONTACTS,d);var f=a.ammConfiguration&&a.ammConfiguration.enabled?c.CONFIGURED:c.NOT_CONFIGURED;this.sendEvent(e.MESSAGING,f);var g=a.wcsConfiguration&&a.wcsConfiguration.enabled?c.CONFIGURED:c.NOT_CONFIGURED;this.sendEvent(e.COLLABORATION,g)},a.Services.Analytics.ProvidersAnalyticsService=b}(AvayaClientServices),function(a){"use strict";function b(){a.Services.Analytics.AnalyticsService.call(this)}var c={CONFIGURED:"Configured",NOT_CONFIGURED:"Not Configured"},d=a.Providers.Analytics.AnalyticsCategories,e=a.Providers.Analytics.AnalyticsServicesNames;b.prototype=Object.create(a.Services.Analytics.AnalyticsService.prototype),b.prototype._createCategory=function(){return d.SERVICES},b.prototype.sendInfoByUseOfServices=function(a,b,d,f,g,h){var i=a?c.CONFIGURED:c.NOT_CONFIGURED;this.sendEvent(e.CALL,i);var j=b?c.CONFIGURED:c.NOT_CONFIGURED;this.sendEvent(e.COLLABORATION,j);var k=d?c.CONFIGURED:c.NOT_CONFIGURED;this.sendEvent(e.CONTACT,k);var l=f?c.CONFIGURED:c.NOT_CONFIGURED;this.sendEvent(e.MESSAGING,l);var m=g?c.CONFIGURED:c.NOT_CONFIGURED;this.sendEvent(e.PRESENCE,m);var n=h?c.CONFIGURED:c.NOT_CONFIGURED;this.sendEvent(e.VOICE_MESSAGING,n)},a.Services.Analytics.ServicesAnalyticsService=b}(AvayaClientServices),function(a){"use strict";function b(){a.Services.Analytics.AnalyticsService.call(this)}var c={CREATE:"Create",FAILURE:"Failure",SUCCESS:"Success"},d=a.Providers.Analytics.AnalyticsCategories,e=a.Providers.Analytics.AnalyticsProvidersTypes;b.prototype=Object.create(a.Services.Analytics.AnalyticsService.prototype),b.prototype._createCategory=function(){return d.USER},b.prototype.sendUserConfiguration=function(a){var b="";a.uccpConfiguration&&a.uccpConfiguration.enabled&&(b+=e.CONFERENCE),a.acsConfiguration&&a.acsConfiguration.enabled&&(b&&(b+="+"),b+=e.CONTACTS),a.ammConfiguration&&a.ammConfiguration.enabled&&(b&&(b+="+"),b+=e.MESSAGING),a.wcsConfiguration&&a.wcsConfiguration.enabled&&(b&&(b+="+"),b+=e.COLLABORATION),this.sendEvent(c.CREATE,b)},b.prototype.userCreationTimeEnd=function(a,b){if(a){var d=new Date,e=d-a,f=b?c.SUCCESS:c.FAILURE;this.sendTiming(c.CREATE,f,e)}},a.Services.Analytics.UserAnalyticsService=b}(AvayaClientServices),function(a){"use strict";function b(a,b){this._collaborationProvider=a,this._collaborationProviderInitialized=!1,this._whiteboards={},this._nextCollaborationId=1,this._colaborationsAnalyticsService=b}b.prototype={start:function(b,c,d){return b._isStarted?$.Deferred().resolve().promise():(this._durationAnalyticsInit(b),b._isStopped=!1,a.Base.Logger.debug(a.Base.LoggerTags.COLLABORATION_SERVICE,"Collaboration Service is starting..."),this._collaborationProvider.start(c,d).then(function(){this._discoveryResource(b),b._isStarted=!0,b.addOnCollaborationServiceAvailableCallback(function(){b.getContentSharing()._clearActiveContentSharing(),this._recalculateAllCollaborationCapabilities(b)}.bind(this)),b.addOnCollaborationServiceUnavailableCallback(function(){b.getContentSharing()._clearActiveContentSharing(),this._recalculateAllCollaborationCapabilities(b)}.bind(this)),b.getContentSharing().getShareApplicationWindowCapability().addOnChangedCallback(b._recalculateContentSharingCapability.bind(b))}.bind(this),function(b){return this._colaborationsAnalyticsService.sendStartErrorEvent(a.Services.Analytics.AnalyticsErrorCode.STARTING_COLLABORATION_ERROR),$.Deferred().reject(b).promise()}.bind(this)))},_durationAnalyticsInit:function(a){var b,c;a._whiteboard.addOnWhiteboardStartedCallback(function(){c=this._colaborationsAnalyticsService.startTimingMetric()}.bind(this)),a._whiteboard.addOnWhiteboardEndedCallback(function(){this._colaborationsAnalyticsService.durationTimeEnd(c)}.bind(this)),a._contentSharing.addOnContentSharingStartedCallback(function(){b=this._colaborationsAnalyticsService.startTimingMetric()}.bind(this)),a._contentSharing.addOnContentSharingEndedCallback(function(){this._colaborationsAnalyticsService.durationTimeEnd(b)}.bind(this))},_discoveryResource:function(b){return this._collaborationProvider.discoverResources(b).done(function(c){b._selfParticipant=c,b._participants.push(c),b._participants.onDataSetChanged([c],a.Base.DataSetChangeTypes.ADDED),this._collaborationProvider.observeCollaboration(b),!a.Base.Utils.isUndefined(b._isAvailable)&&b._isAvailable||(b._isAvailable=!0,b._onCollaborationServiceAvailableCallbacks.fire(b)),this._recalculateAllCollaborationCapabilities(b)}.bind(this))},stop:function(b){return b._isStopped?$.Deferred().resolve().promise():(b._isStarted=!1,b._isAvailable&&(b._isAvailable=void 0,b._onCollaborationServiceUnavailableCallbacks.fire(b)),a.Base.Logger.debug(a.Base.LoggerTags.COLLABORATION_SERVICE,"Collaboration Service stop"),b._selfParticipant=void 0,b._participants.length=0,b._participants.onDataSetChanged(b._participants,a.Base.DataSetChangeTypes.REMOVED),b._onCollaborationStartedCallbacks.empty(),b._onCollaborationEndedCallbacks.empty(),b._onCollaborationServiceAvailableCallbacks.empty(),b._onCollaborationServiceUnavailableCallbacks.empty(),b._onCollaborationNearEndByEjectCallbacks.empty(),b._onCollaborationPresenterPrivilegeChangedCallbacks.empty(),b._onCollaborationModeratorPrivilegeChangedCallbacks.empty(),b._onCollaborationInitializedCallbacks.empty(),b._isPaused=!1,b._callId=void 0,this._collaborationProvider.stop().then(function(){b._isStopped=!0}))},getNextCollaborationId:function(){return this._nextCollaborationId++},getParticipants:function(b){var c=new a.Base.DataRetrieval(b._participants),d=function(a){this.updateParticipantList(b,a),c._dataRetrievalProgress.fire(a.length,!1),c._dataRetrievalDone.fire()}.bind(this);return this._collaborationProvider.getParticipants(b).then(d),c},updateParticipantList:function(b,c){function d(a,b){return b.getParticipantId()===c[a].getParticipantId()}for(var e=[],f=0;f<c.length;f++){0===b._participants.filter(d.bind(this,f)).length&&(b._participants.push(c[f]),e.push(c[f]))}e.length>0&&b._participants.onDataSetChanged(e,a.Base.DataSetChangeTypes.ADDED)},_recalculateAllCollaborationCapabilities:function(a){a.getContentSharing()._recalculateShareApplicationWindowCapability(),a.getContentSharing()._recalculateShareFullScreenCapability(),a._recalculateChatCapability(),a._recalculateMeetingMinutesCapability(),a._recalculateContentSharingCapability(),a._recalculateNetworkLibraryCapability(),a._recalculateLibrarySharingCapability(),a._recalculateWhiteboardCapability(),a._recalculateRetrieveParticipantListCapability(),a.getWhiteboard()._recalculateDrawingCapability(a)},isFeatureSupported:function(a,b){return a._supportedFeatures.indexOf(b)>=0&&this._collaborationProvider.isFeatureAvailable(b)},isServiceAvailable:function(){return this._collaborationProvider.isOpened()},pause:function(a){return this._collaborationProvider.pause()},resume:function(a){return this._collaborationProvider.resume()}},a.Services.Collaboration.CollaborationService=b}(AvayaClientServices),function(a){"use strict";var b={addOnParticipantCollaborationStatusChangedCallback:function(a){this._onParticipantCollaborationStatusChangedCallbacks.add(a)},removeOnParticipantCollaborationStatusChangedCallback:function(a){this._onParticipantCollaborationStatusChangedCallbacks.remove(a)},addOnParticipantStatusChangedCallback:function(a){this._onParticipantStatusChangedCallbacks.add(a)},removeOnParticipantStatusChangedCallback:function(a){this._onParticipantStatusChangedCallbacks.remove(a)},addOnParticipantConnectionStatusChangedCallback:function(a){this._onParticipantConnectionStatusChangedCallbacks.add(a)},removeOnParticipantConnectionStatusChangedCallback:function(a){this._onParticipantConnectionStatusChangedCallbacks.remove(a)},addOnParticipantSetAsModeratorCallback:function(a){this._onParticipantSetAsModeratorCallbacks.add(a)},removeOnParticipantSetAsModeratorCallback:function(a){this._onParticipantSetAsModeratorCallbacks.remove(a)},addOnParticipantUnsetAsModeratorCallback:function(a){this._onParticipantUnsetAsModeratorCallbacks.add(a)},removeOnParticipantUnsetAsModeratorCallback:function(a){this._onParticipantUnsetAsModeratorCallbacks.remove(a)},addOnParticipantSetAsLecturerCallback:function(a){this._onParticipantSetAsLecturerCallbacks.add(a)},removeOnParticipantSetAsLecturerCallback:function(a){this._onParticipantSetAsLecturerCallbacks.remove(a)},addOnParticipantUnsetAsLecturerCallback:function(a){this._onParticipantUnsetAsLecturerCallbacks.add(a)},removeOnParticipantUnsetAsLecturerCallback:function(a){this._onParticipantUnsetAsLecturerCallbacks.remove(a)},addOnParticipantSetAsPresenterCallback:function(a){this._onParticipantSetAsPresenterCallbacks.add(a)},removeOnParticipantSetAsPresenterCallback:function(a){this._onParticipantSetAsPresenterCallbacks.remove(a)},addOnParticipantUnsetAsPresenterCallback:function(a){this._onParticipantUnsetAsPresenterCallbacks.add(a)},removeOnParticipantUnsetAsPresenterCallback:function(a){this._onParticipantUnsetAsPresenterCallbacks.remove(a)},addOnParticipantAudioStatusChangedCallback:function(a){this._onParticipantAudioStatusChangedCallbacks.add(a)},removeOnParticipantAudioStatusChangedCallback:function(a){this._onParticipantAudioStatusChangedCallbacks.remove(a)},addOnParticipantVideoStatusChangedCallback:function(a){this._onParticipantVideoStatusChangedCallbacks.add(a)},removeOnParticipantVideoStatusChangedCallback:function(a){this._onParticipantVideoStatusChangedCallbacks.remove(a)},addOnParticipantActiveTalkerStatusChangedCallback:function(a){this._onParticipantActiveTalkerStatusChangedCallbacks.add(a)},removeOnParticipantActiveTalkerStatusChangedCallback:function(a){this._onParticipantActiveTalkerStatusChangedCallbacks.remove(a)},addOnParticipantHandRaisedCallback:function(a){this._onParticipantHandRaisedCallbacks.add(a)},removeOnParticipantHandRaisedCallback:function(a){this._onParticipantHandRaisedCallbacks.remove(a)},addOnParticipantHandLoweredCallback:function(a){this._onParticipantHandLoweredCallbacks.add(a)},removeOnParticipantHandLoweredCallback:function(a){this._onParticipantHandLoweredCallbacks.remove(a)}};$.extend(a.Services.Conference.ActiveParticipant.prototype,b)}(AvayaClientServices),function(a,b){"use strict";var c={addOnSessionTypeChangedCallback:function(a){this._onTypeChangedCallbacks.add(a)},removeOnSessionTypeChangedCallback:function(a){this._onTypeChangedCallbacks.remove(a)},addOnStatusChangedCallback:function(a){this._onStatusChangedCallbacks.add(a)},removeOnStatusChangedCallback:function(a){this._onStatusChangedCallbacks.remove(a)}};b.extend(a.Services.Messaging.Escalation.prototype,c)}(AvayaClientServices,jQuery),function(a,b){"use strict";var c={getSendCapability:function(){return this._sendCapability},_recalculateStartCapability:function(){var b,c;this._escalationService.isServiceAvailable()?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._sendCapability._updateIfChanged(b,c)},getAddParticipantsCapability:function(){return this._addParticipantsCapability},_recalculateAddParticipantsCapability:function(){var b,c;this._escalationService.isServiceAvailable()?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._addParticipantsCapability._updateIfChanged(b,c)},getRemoveParticipantsCapability:function(){return this._removeParticipantsCapability},_recalculateRemoveParticipantsCapability:function(){var b,c;this._escalationService.isServiceAvailable()&&this._resourceStatus===a.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeParticipantsCapability._updateIfChanged(b,c)},getUpdateSessionTypeCapability:function(){return this._updateSessionTypeCapability},_recalculateUpdateSessionTypeCapability:function(){var b,c;this._escalationService.isServiceAvailable()&&this._resourceStatus===a.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateSessionTypeCapability._updateIfChanged(b,c)},getRemoveCapability:function(){return this._removeCapability},_recalculateRemoveCapability:function(){var b,c;this._escalationService.isServiceAvailable()&&this._resourceStatus===a.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(b=!0,c=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(b=!1,c=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeCapability._updateIfChanged(b,c)}};b.extend(a.Services.Messaging.Escalation.prototype,c)}(AvayaClientServices,jQuery),function(a,b){"use strict";function c(a){var c=new b.Config.ServerInfo("www.google-analytics.com",null,!0,"/batch"),d=new b.Base.RESTProvider;this._networkProviderConfiguration=new b.Config.NetworkProviderConfiguration(c),this._networkProvider=new b.Base.NetworkProvider(d),this._dfdStop=null,this._reportingTimer=null,this._isRunning=!1,this._stopRequested=!1,this._httpRequestsOutstanding=0,this._hitTransmissionQueue=[],this._pendingRequest="",this._countHitsRequest=0,this._retriedOnce=!1,this._commonHitParameters=h.getCommonRequestsParams(a,this._getClientID()),this._infrastructureAnalyticsService=new b.Services.Analytics.InfrastructureAnalyticsService}var d=20,e="ga_client_id",f=b.Base.Storage,g=b.Base.Utils,h=b.Providers.Analytics.AnalyticsStatistic;c.prototype={},c.prototype.start=function(){return h.setCollectionEnabledState(!0),this._startProvider()},c.prototype.stop=function(){return this._dfdStop=a.Deferred(),this._isRunning?(this._stopRequested=!0,this._stopProvider()):this._stopCompleted(),h.setCollectionEnabledState(!1),this._dfdStop.promise()},c.prototype._isCollectionEnabled=function(){return h.isCollectionEnabled()},c.prototype._startReportingCycle=function(){this._hitTransmissionQueue.length||(h.queueCollectedHits.call(this),this._hitTransmissionQueue.length&&(this._infrastructureAnalyticsService.sendMissedHitsCount(),h.queueCollectedHits.call(this),this._sendBatch()))},c.prototype._sendBatch=function(){for(this._countHitsRequest=0,this._pendingRequest="";this._hitTransmissionQueue.length&&this._countHitsRequest<d;){var a=this._commonHitParameters;if(a+=this._hitTransmissionQueue[0]+"\n",g.getBytesCount(a)>8192)this._hitTransmissionQueue.shift();else{if(g.getBytesCount(this._pendingRequest+a)>16384)break;this._pendingRequest+=a,this._countHitsRequest++,this._hitTransmissionQueue.shift()}}this._retriedOnce=!1,this._sendRequest()},c.prototype._sendRequest=function(){this._networkProvider.send(this._pendingRequest,{contentType:"text/plain"}).then(function(a){this._onDataReceived()}.bind(this),function(a){b.Base.Logger.error(b.Base.LoggerTags.ANALYTICS_PROVIDER,"Failed to send request",a),this._onErrorReceived(a)}.bind(this)),this._httpRequestsOutstanding++},c.prototype._onDataReceived=function(){this._infrastructureAnalyticsService.setMissedHitsObj(null),this._pendingRequest="",this._hitTransmissionQueue.length&&this._sendBatch(),this._onRequestCompleted()},c.prototype._onErrorReceived=function(a){this._stopRequested||this._retriedOnce||!this._pendingRequest?(this._infrastructureAnalyticsService.createMissedHitsObj(this._countHitsRequest+this._hitTransmissionQueue.length,a.name),this._pendingRequest="",this._hitTransmissionQueue.length=0):(this._retriedOnce=!0,this._sendRequest()),this._onRequestCompleted()},c.prototype._onRequestCompleted=function(){--this._httpRequestsOutstanding<=0&&(this._httpRequestsOutstanding=0,this._stopRequested&&this._stopCompleted())},c.prototype._stopCompleted=function(){this._stopRequested=!1,this._httpRequestsOutstanding=0,this._dfdStop&&this._dfdStop.resolve()},c.prototype._startProvider=function(){this._networkProvider.start(this._networkProviderConfiguration),this._startReportingTimer(),this._isRunning=!0;var b=a.Deferred();return b.resolve(),b.promise()},c.prototype._stopProvider=function(){if(this._stopReportingTimer(),this._isRunning){for(this._isRunning=!1,h.queueCollectedHits.call(this);this._hitTransmissionQueue.length;)this._sendBatch();this._httpRequestsOutstanding<=0&&this._stopCompleted()}},c.prototype._startReportingTimer=function(){this._reportingTimer||(this._reportingTimer=window.setInterval(function(){this._startReportingCycle()}.bind(this),5e3))},c.prototype._stopReportingTimer=function(){this._reportingTimer&&(window.clearInterval(this._reportingTimer),this._reportingTimer=null)},c.prototype._getClientID=function(){var a=f.get(f.TYPES.LOCAL,e);return void 0===a&&(a=b.Base.Utils.generateUUID(),f.set(f.TYPES.LOCAL,e,a)),a},b.Providers.Analytics.AnalyticsProvider=c}(jQuery,AvayaClientServices),function(a){"use strict";function b(b,c,d){
if(this._config=a.Base.Utils.deepMerge(new a.Config.UserConfiguration,b),this._mediaServiceFactory=c,this._version=d,this._collaborationFactory=void 0,this._collaboration=void 0,this._collaborations=void 0,this._callFactory=void 0,this._calls=void 0,this._messagingFactory=void 0,this._messaging=void 0,this._contacts=void 0,this._contactsService=void 0,this._contactsIntegrationService=void 0,this._presenceService=void 0,this._voiceMessaging=void 0,this._bandwidthManager=new a.Base.BandwidthManager(this._config),this._diagnosticDataGenerator=new a.Base.DiagnosticDataGenerator,this._loggingInterval=void 0,this._isStopping=!1,this._isStarting=!1,this._isStarted=!1,this._userRegistrationSuccessfulCallbacks=$.Callbacks(),this._userUnregistrationSuccessfulCallbacks=$.Callbacks(),this._userRegistrationFailedCallbacks=$.Callbacks(),this._userUnregistrationFailedCallbacks=$.Callbacks(),this._providerFactory=new a.Base.ProviderFactory,this._contactsIntegrationService=new a.Services.Contacts.ContactsIntegrationService,this._config.presenceConfiguration&&this._config.presenceConfiguration.enabled&&this._config.sgConfiguration&&this._config.sgConfiguration.enabled){var e=this._config.sgConfiguration.networkProviderConfiguration.restConfig,f=e.hostName+":"+e.port,g=this._providerFactory.getPresenceProviders(f)[0];this._presenceService=new a.Services.Presence.PresenceService(g)}if(this._config.acsConfiguration&&this._config.acsConfiguration.enabled){var h=this._providerFactory.getContactsProviders(this._config)[0],i=this._providerFactory.getDirectorySearchProviders(this._config)[0],j=new a.Services.Analytics.ContactsAnalyticsService;this._contactsService=new a.Services.Contacts.ContactsService(h,i,this._contactsIntegrationService,this._presenceService,j),this._contacts=new a.Services.Contacts.Contacts(this._contactsService)}if(this._config.wspConfiguration&&this._config.wspConfiguration.enabled&&a.Base.Logger.error("WSP is no longer supported and has been replaced by AAWG"),this._config.sgConfiguration&&this._config.sgConfiguration.enabled){var k=new a.Services.Analytics.CallsAnalyticsService;this._callFactory=new a.Services.Call.CallFactory(this._providerFactory,this._mediaServiceFactory,this._contactsIntegrationService,this._bandwidthManager,k),this._callFactory.init(this._config),this._calls=this._callFactory.getCalls();var l=this._providerFactory.getVoiceMessagingProvider(this._config.sgConfiguration);this._voiceMessaging=new a.Services.VoiceMessaging.VoiceMessaging(l)}if(this._config.ammConfiguration&&this._config.ammConfiguration.enabled&&(this._messagingFactory=new a.Services.Messaging.MessagingFactory(this._config,this._providerFactory,this._contactsIntegrationService),this._messaging=this._messagingFactory.create()),this._config.wcsConfiguration&&this._config.wcsConfiguration.enabled){var m=new a.Services.Analytics.CollaborationsAnalyticsService;this._collaborationFactory=new a.Services.Collaboration.CollaborationFactory(this._config,this._providerFactory,this._bandwidthManager,m),this._collaborations=new a.Services.Collaboration.Collaborations(this._collaborationFactory),this._collaboration=this._collaborations.getCollaborationById("standalone"),this._callFactory&&this._callFactory._callService&&this._callFactory._callService.setCollaborations(this._collaborations)}this._config.analyticsConfiguration&&(this._analyticsProvider=new a.Providers.Analytics.AnalyticsProvider(d)),this._clientAnalyticsService=new a.Services.Analytics.ClientAnalyticsService(this._config.applicationProductName,this._config.applicationProductVersion),this._userAnalyticsService=new a.Services.Analytics.UserAnalyticsService,this._servicesAnalyticsService=new a.Services.Analytics.ServicesAnalyticsService,this._providersAnalyticsService=new a.Services.Analytics.ProvidersAnalyticsService}var c=a.Providers.Analytics.AnalyticsStatistic;b.prototype={getCollaboration:function(){return a.Base.Logger.warn(a.Base.LoggerTags.USER_SERVICE,"getCollaboration function is deprecated. Please use AvayaClientServices.User.prototype.getCollaborations instead. Usage of the new function is slightly different."),this._collaboration},getCollaborations:function(){return this._collaborations},getMessaging:function(){return this._messaging},getContacts:function(){return this._contacts},getSelfContact:function(){return this._contactsService.getSelfContact()},getPresenceService:function(){return this._presenceService},getCalls:function(){return this._calls},getVoiceMessaging:function(){return this._voiceMessaging},stop:function(){var b=this._clientAnalyticsService.startTimingMetric(),d=$.Deferred(),e=[];if(this._isStopping)return a.Base.Logger.warn(a.Base.LoggerTags.USER_SERVICE,"Cannot stop while services are still stopping."),d.reject(new a.Base.BaseError(a.Base.ErrorReasons.CAPABILITY_INVALID_STATE)),d.promise();if(this._isStarting)return a.Base.Logger.warn(a.Base.LoggerTags.USER_SERVICE,"Cannot stop while services are still starting."),d.reject(new a.Base.BaseError(a.Base.ErrorReasons.CAPABILITY_INVALID_STATE)),d.promise();if(this._isStopping=!0,this._messaging){var f=this._messaging.stop();e.push(f)}if(this._voiceMessaging){var g=this._voiceMessaging.stop();e.push(g)}if(this._calls){var h=this._config.callUserConfiguration.incomingCall,i=this._calls._stop();e.push(i),i.then(function(){return h&&this._userUnregistrationSuccessfulCallbacks.fire(),this._resetRegistrationCallbacks(),this._mediaServiceFactory.stop()}.bind(this),function(a){return h&&this._userUnregistrationFailedCallbacks.fire(a),this._mediaServiceFactory.stop()}.bind(this))}else if(this._mediaServiceFactory){var j=this._mediaServiceFactory.stop();e.push(j)}if(this._presenceService){var k=this._presenceService.stop();e.push(k)}if(this._contacts){var l=this._contacts.stop();e.push(l)}if(this._collaborations){var m=this._collaborations._stopAndDeleteAllCollaborations();e.push(m)}return clearInterval(this._loggingInterval),$.when.apply(this,e).then(function(){this._isStopping=!1,c.isCollectionEnabled()?(this._clientAnalyticsService.sendShutdownEvent(!0),this._clientAnalyticsService.shutdownTimeEnd(b,!0),this._analyticsProvider.stop().then(function(){this._clientAnalyticsService.setJSCSDKStartupStatus(!1),d.resolve()}.bind(this))):d.resolve()}.bind(this),function(a){this._isStopping=!1,c.isCollectionEnabled()?(this._clientAnalyticsService.sendShutdownEvent(!1),this._clientAnalyticsService.shutdownTimeEnd(b,!1),this._analyticsProvider.stop().always(function(){d.reject(a)})):d.reject(a)}.bind(this)).always(function(){this._isStarted=!1}.bind(this)),d.promise()},stopImmediately:function(){var b=this._clientAnalyticsService.startTimingMetric(),d=$.Deferred(),e=[];if(this._isStopping)return a.Base.Logger.warn(a.Base.LoggerTags.USER_SERVICE,"Cannot stop while services are still stopping."),d.reject(new a.Base.BaseError(a.Base.ErrorReasons.CAPABILITY_INVALID_STATE)),d.promise();if(this._isStarting)return a.Base.Logger.warn(a.Base.LoggerTags.USER_SERVICE,"Cannot stop while services are still starting."),d.reject(new a.Base.BaseError(a.Base.ErrorReasons.CAPABILITY_INVALID_STATE)),d.promise();if(this._isStopping=!0,this._calls){var f=this._calls._stopImmediately();e.push(f)}if(this._voiceMessaging){var g=this._voiceMessaging.stop();e.push(g)}if(this._presenceService){var h=this._presenceService.stop();e.push(h)}if(this._messaging){var i=this._messaging.stop();e.push(i)}if(this._contacts){var j=this._contacts.stop();e.push(j)}if(this._collaborations){var k=this._collaborations._stopAndDeleteAllCollaborations();e.push(k)}return $.when.apply(this,e).then(function(){this._isStopping=!1,c.isCollectionEnabled()?(this._clientAnalyticsService.sendShutdownEvent(!0),this._clientAnalyticsService.shutdownTimeEnd(b,!0),this._analyticsProvider.stop().then(function(){this._clientAnalyticsService.setJSCSDKStartupStatus(!1),d.resolve()}.bind(this))):d.resolve()}.bind(this),function(a){this._isStopping=!1,c.isCollectionEnabled()?(this._clientAnalyticsService.sendShutdownEvent(!1),this._clientAnalyticsService.shutdownTimeEnd(b,!1),this._analyticsProvider.stop().always(function(){d.reject(a)})):d.reject(a)}.bind(this)).always(function(){this._isStarted=!1}.bind(this)),d.promise()},start:function(){var b=this._clientAnalyticsService.startTimingMetric();a.Base.Logger.info(a.Base.LoggerTags.USER_SERVICE,"Starting SDK, version is "+this._version);var c=$.Deferred(),d=[];if(this._isStopping)return a.Base.Logger.warn(a.Base.LoggerTags.USER_SERVICE,"Cannot start while services are still stopping."),c.reject(new a.Base.BaseError(a.Base.ErrorReasons.CAPABILITY_INVALID_STATE)),c.promise();if(this._isStarting)return a.Base.Logger.warn(a.Base.LoggerTags.USER_SERVICE,"Cannot start service while services are still starting."),c.reject(new a.Base.BaseError(a.Base.ErrorReasons.CAPABILITY_INVALID_STATE)),c.promise();if(this._isStarted)return a.Base.Logger.warn(a.Base.LoggerTags.USER_SERVICE,"Cannot start service while service is already started."),c.reject(new a.Base.BaseError(a.Base.ErrorReasons.CAPABILITY_INVALID_STATE)),c.promise();if(this._isStarting=!0,this._analyticsProvider&&this._config.analyticsConfiguration&&this._config.analyticsConfiguration.enabled){var e=this._analyticsProvider.start();d.push(e),this._clientAnalyticsService.sendStartupStatus(),this._clientAnalyticsService.setJSCSDKStartupStatus(!0),this._userAnalyticsService.sendUserConfiguration(this._config),this._providersAnalyticsService.sendInfoByUseOfProviders(this._config),this._servicesAnalyticsService.sendInfoByUseOfServices(this._calls,this._collaboration||this._collaborations,this._contacts,this._messaging,this._presenceService,this._voiceMessaging)}if(this._contacts){var f=this._contacts.start(this._config);d.push(f)}if(this._messaging){var g=this._messaging.start(this._config);d.push(g)}if(this._presenceService){var h=this._presenceService.start(this._config);d.push(h)}var i;if(this._calls){if(i=$.Deferred(),window.navigator.mediaDevices&&window.navigator.mediaDevices.getUserMedia){var j=window.navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then(function(a){return a.getTracks().forEach(function(a){a.stop()}),this._mediaServiceFactory.start()}.bind(this)).catch(function(a){return this._mediaServiceFactory.start()}.bind(this));d.push(j)}else d.push(this._mediaServiceFactory.start());var k=this._config.callUserConfiguration.incomingCall,l=this._calls._start();d.push(l),this._calls._onIviewTokenChanged=function(a){k&&this._userRegistrationSuccessfulCallbacks.fire(a)}.bind(this),l.then(function(a){k&&this._userRegistrationSuccessfulCallbacks.fire(a),i.resolve()}.bind(this),function(a){k&&this._userRegistrationFailedCallbacks.fire(a),i.resolve()}.bind(this))}if(this._voiceMessaging)if(this._calls){var m=$.Deferred();d.push(m),i.promise().always(function(){this._voiceMessaging.start(this._config).then(function(){m.resolve()},function(a){m.reject(a)})}.bind(this))}else{var n=this._voiceMessaging.start(this._config);d.push(n)}this._loggingInterval=setInterval(function(){this._logDiagnosticData()}.bind(this),3e5);var o=0,p=0;return a.Base.Logger.info(a.Base.LoggerTags.USER_SERVICE,"Starting "+d.length+" services."),d.forEach(function(e){e.then(function(){p++,c.state()===a.Base.DeferredStates.PENDING&&p+o===d.length&&(this._userAnalyticsService.userCreationTimeEnd(b,!0),this._isStarting=!1,this._isStarted=!0,c.resolve())}.bind(this),function(){o++,c.state()===a.Base.DeferredStates.PENDING&&(o===d.length?(this._userAnalyticsService.userCreationTimeEnd(b,!1),this._isStarting=!1,c.reject()):p+o===d.length&&(this._userAnalyticsService.userCreationTimeEnd(b,!0),this._isStarting=!1,this._isStarted=!0,c.resolve()))}.bind(this))}.bind(this)),this._clientAnalyticsService.sendStartupEvent(),c.promise()},_resetRegistrationCallbacks:function(){this._userRegistrationSuccessfulCallbacks.empty(),this._userUnregistrationSuccessfulCallbacks.empty(),this._userRegistrationFailedCallbacks.empty(),this._userUnregistrationFailedCallbacks.empty()},_logDiagnosticData:function(){var b=[];this._diagnosticDataGenerator.generateBatteryLogs(this._config).then(function(a){return b=b.concat(a),this._diagnosticDataGenerator.generateMessagingLogs(this._messaging)}.bind(this)).then(function(a){return b=b.concat(a),this._diagnosticDataGenerator.generateContactsLogs(this._contacts)}.bind(this)).then(function(a){return b=b.concat(a),this._diagnosticDataGenerator.generateCallLogs(this._calls)}.bind(this)).then(function(a){return b=b.concat(a),this._diagnosticDataGenerator.generatePerformanceLogs()}.bind(this)).then(function(c){b=b.concat(c),a.Base.Logger.info(a.Base.LoggerTags.USER_SERVICE,b.join("\r\n"))}.bind(this))}},a.Base.AOPTools.addAdvices(b,"User",["getSelfContact"],[a.Base.AOPCommonAdvices.LOG_USER_API_CALLS]),a.Base.AOPTools.addAdvices(b,"User",["start","stop","stopImmediately"],[a.Base.AOPCommonAdvices.LOG_USER_API_CALLS,a.Base.AOPCommonAdvices.WRAP_CAUGHT_USER_ERROR]),a.Base.AOPTools.addAdvices(window.AvayaClientServices,"AvayaClientServices",["createUser","registerLogger"],[a.Base.AOPCommonAdvices.LOG_USER_API_CALLS]),a.User=b}(AvayaClientServices),function(a,b){"use strict";var c={addOnUserRegistrationSuccessful:function(a){this._userRegistrationSuccessfulCallbacks.add(a)},removeOnUserRegistrationSuccessful:function(a){this._userRegistrationSuccessfulCallbacks.remove(a)},addOnUserRegistrationFailed:function(a){this._userRegistrationFailedCallbacks.add(a)},removeOnUserRegistrationFailed:function(a){this._userRegistrationFailedCallbacks.remove(a)},addOnUserUnregistrationSuccessful:function(a){this._userUnregistrationSuccessfulCallbacks.add(a)},removeOnUserUnregistrationSuccessful:function(a){this._userUnregistrationSuccessfulCallbacks.remove(a)},addOnUserUnregistrationFailed:function(a){this._userUnregistrationFailedCallbacks.add(a)},removeOnUserUnregistrationFailed:function(a){this._userUnregistrationFailedCallbacks.remove(a)}};b.extend(a.User.prototype,c)}(window.AvayaClientServices=window.AvayaClientServices||{},jQuery=jQuery||{});